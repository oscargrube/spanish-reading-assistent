(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function wC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Tg={exports:{}},$u={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var V0;function NN(){if(V0)return $u;V0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var d in s)d!=="key"&&(a[d]=s[d])}else a=s;return s=a.ref,{$$typeof:n,type:i,key:l,ref:s!==void 0?s:null,props:a}}return $u.Fragment=e,$u.jsx=t,$u.jsxs=t,$u}var L0;function DN(){return L0||(L0=1,Tg.exports=NN()),Tg.exports}var R=DN(),Ag={exports:{}},Me={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U0;function MN(){if(U0)return Me;U0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),T=Symbol.iterator;function C(q){return q===null||typeof q!="object"?null:(q=T&&q[T]||q["@@iterator"],typeof q=="function"?q:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,k={};function Q(q,re,he){this.props=q,this.context=re,this.refs=k,this.updater=he||P}Q.prototype.isReactComponent={},Q.prototype.setState=function(q,re){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,re,"setState")},Q.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function j(){}j.prototype=Q.prototype;function X(q,re,he){this.props=q,this.context=re,this.refs=k,this.updater=he||P}var se=X.prototype=new j;se.constructor=X,O(se,Q.prototype),se.isPureReactComponent=!0;var le=Array.isArray;function ue(){}var N={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function x(q,re,he){var ge=he.ref;return{$$typeof:n,type:q,key:re,ref:ge!==void 0?ge:null,props:he}}function L(q,re){return x(q.type,re,q.props)}function V(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function F(q){var re={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(he){return re[he]})}var M=/\/+/g;function me(q,re){return typeof q=="object"&&q!==null&&q.key!=null?F(""+q.key):re.toString(36)}function Te(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(ue,ue):(q.status="pending",q.then(function(re){q.status==="pending"&&(q.status="fulfilled",q.value=re)},function(re){q.status==="pending"&&(q.status="rejected",q.reason=re)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function Y(q,re,he,ge,xe){var Ve=typeof q;(Ve==="undefined"||Ve==="boolean")&&(q=null);var Ye=!1;if(q===null)Ye=!0;else switch(Ve){case"bigint":case"string":case"number":Ye=!0;break;case"object":switch(q.$$typeof){case n:case e:Ye=!0;break;case _:return Ye=q._init,Y(Ye(q._payload),re,he,ge,xe)}}if(Ye)return xe=xe(q),Ye=ge===""?"."+me(q,0):ge,le(xe)?(he="",Ye!=null&&(he=Ye.replace(M,"$&/")+"/"),Y(xe,re,he,"",function(Hs){return Hs})):xe!=null&&(V(xe)&&(xe=L(xe,he+(xe.key==null||q&&q.key===xe.key?"":(""+xe.key).replace(M,"$&/")+"/")+Ye)),re.push(xe)),1;Ye=0;var Ht=ge===""?".":ge+":";if(le(q))for(var gt=0;gt<q.length;gt++)ge=q[gt],Ve=Ht+me(ge,gt),Ye+=Y(ge,re,he,Ve,xe);else if(gt=C(q),typeof gt=="function")for(q=gt.call(q),gt=0;!(ge=q.next()).done;)ge=ge.value,Ve=Ht+me(ge,gt++),Ye+=Y(ge,re,he,Ve,xe);else if(Ve==="object"){if(typeof q.then=="function")return Y(Te(q),re,he,ge,xe);throw re=String(q),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return Ye}function oe(q,re,he){if(q==null)return q;var ge=[],xe=0;return Y(q,ge,"","",function(Ve){return re.call(he,Ve,xe++)}),ge}function _e(q){if(q._status===-1){var re=q._result;re=re(),re.then(function(he){(q._status===0||q._status===-1)&&(q._status=1,q._result=he)},function(he){(q._status===0||q._status===-1)&&(q._status=2,q._result=he)}),q._status===-1&&(q._status=0,q._result=re)}if(q._status===1)return q._result.default;throw q._result}var Oe=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Qe={map:oe,forEach:function(q,re,he){oe(q,function(){re.apply(this,arguments)},he)},count:function(q){var re=0;return oe(q,function(){re++}),re},toArray:function(q){return oe(q,function(re){return re})||[]},only:function(q){if(!V(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return Me.Activity=E,Me.Children=Qe,Me.Component=Q,Me.Fragment=t,Me.Profiler=s,Me.PureComponent=X,Me.StrictMode=i,Me.Suspense=f,Me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Me.__COMPILER_RUNTIME={__proto__:null,c:function(q){return N.H.useMemoCache(q)}},Me.cache=function(q){return function(){return q.apply(null,arguments)}},Me.cacheSignal=function(){return null},Me.cloneElement=function(q,re,he){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var ge=O({},q.props),xe=q.key;if(re!=null)for(Ve in re.key!==void 0&&(xe=""+re.key),re)!D.call(re,Ve)||Ve==="key"||Ve==="__self"||Ve==="__source"||Ve==="ref"&&re.ref===void 0||(ge[Ve]=re[Ve]);var Ve=arguments.length-2;if(Ve===1)ge.children=he;else if(1<Ve){for(var Ye=Array(Ve),Ht=0;Ht<Ve;Ht++)Ye[Ht]=arguments[Ht+2];ge.children=Ye}return x(q.type,xe,ge)},Me.createContext=function(q){return q={$$typeof:l,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:a,_context:q},q},Me.createElement=function(q,re,he){var ge,xe={},Ve=null;if(re!=null)for(ge in re.key!==void 0&&(Ve=""+re.key),re)D.call(re,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(xe[ge]=re[ge]);var Ye=arguments.length-2;if(Ye===1)xe.children=he;else if(1<Ye){for(var Ht=Array(Ye),gt=0;gt<Ye;gt++)Ht[gt]=arguments[gt+2];xe.children=Ht}if(q&&q.defaultProps)for(ge in Ye=q.defaultProps,Ye)xe[ge]===void 0&&(xe[ge]=Ye[ge]);return x(q,Ve,xe)},Me.createRef=function(){return{current:null}},Me.forwardRef=function(q){return{$$typeof:d,render:q}},Me.isValidElement=V,Me.lazy=function(q){return{$$typeof:_,_payload:{_status:-1,_result:q},_init:_e}},Me.memo=function(q,re){return{$$typeof:p,type:q,compare:re===void 0?null:re}},Me.startTransition=function(q){var re=N.T,he={};N.T=he;try{var ge=q(),xe=N.S;xe!==null&&xe(he,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(ue,Oe)}catch(Ve){Oe(Ve)}finally{re!==null&&he.types!==null&&(re.types=he.types),N.T=re}},Me.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Me.use=function(q){return N.H.use(q)},Me.useActionState=function(q,re,he){return N.H.useActionState(q,re,he)},Me.useCallback=function(q,re){return N.H.useCallback(q,re)},Me.useContext=function(q){return N.H.useContext(q)},Me.useDebugValue=function(){},Me.useDeferredValue=function(q,re){return N.H.useDeferredValue(q,re)},Me.useEffect=function(q,re){return N.H.useEffect(q,re)},Me.useEffectEvent=function(q){return N.H.useEffectEvent(q)},Me.useId=function(){return N.H.useId()},Me.useImperativeHandle=function(q,re,he){return N.H.useImperativeHandle(q,re,he)},Me.useInsertionEffect=function(q,re){return N.H.useInsertionEffect(q,re)},Me.useLayoutEffect=function(q,re){return N.H.useLayoutEffect(q,re)},Me.useMemo=function(q,re){return N.H.useMemo(q,re)},Me.useOptimistic=function(q,re){return N.H.useOptimistic(q,re)},Me.useReducer=function(q,re,he){return N.H.useReducer(q,re,he)},Me.useRef=function(q){return N.H.useRef(q)},Me.useState=function(q){return N.H.useState(q)},Me.useSyncExternalStore=function(q,re,he){return N.H.useSyncExternalStore(q,re,he)},Me.useTransition=function(){return N.H.useTransition()},Me.version="19.2.3",Me}var O0;function Hy(){return O0||(O0=1,Ag.exports=MN()),Ag.exports}var we=Hy();const PN=wC(we);var Sg={exports:{}},Qu={},Ig={exports:{}},Cg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F0;function kN(){return F0||(F0=1,(function(n){function e(Y,oe){var _e=Y.length;Y.push(oe);e:for(;0<_e;){var Oe=_e-1>>>1,Qe=Y[Oe];if(0<s(Qe,oe))Y[Oe]=oe,Y[_e]=Qe,_e=Oe;else break e}}function t(Y){return Y.length===0?null:Y[0]}function i(Y){if(Y.length===0)return null;var oe=Y[0],_e=Y.pop();if(_e!==oe){Y[0]=_e;e:for(var Oe=0,Qe=Y.length,q=Qe>>>1;Oe<q;){var re=2*(Oe+1)-1,he=Y[re],ge=re+1,xe=Y[ge];if(0>s(he,_e))ge<Qe&&0>s(xe,he)?(Y[Oe]=xe,Y[ge]=_e,Oe=ge):(Y[Oe]=he,Y[re]=_e,Oe=re);else if(ge<Qe&&0>s(xe,_e))Y[Oe]=xe,Y[ge]=_e,Oe=ge;else break e}}return oe}function s(Y,oe){var _e=Y.sortIndex-oe.sortIndex;return _e!==0?_e:Y.id-oe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var f=[],p=[],_=1,E=null,T=3,C=!1,P=!1,O=!1,k=!1,Q=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function se(Y){for(var oe=t(p);oe!==null;){if(oe.callback===null)i(p);else if(oe.startTime<=Y)i(p),oe.sortIndex=oe.expirationTime,e(f,oe);else break;oe=t(p)}}function le(Y){if(O=!1,se(Y),!P)if(t(f)!==null)P=!0,ue||(ue=!0,F());else{var oe=t(p);oe!==null&&Te(le,oe.startTime-Y)}}var ue=!1,N=-1,D=5,x=-1;function L(){return k?!0:!(n.unstable_now()-x<D)}function V(){if(k=!1,ue){var Y=n.unstable_now();x=Y;var oe=!0;try{e:{P=!1,O&&(O=!1,j(N),N=-1),C=!0;var _e=T;try{t:{for(se(Y),E=t(f);E!==null&&!(E.expirationTime>Y&&L());){var Oe=E.callback;if(typeof Oe=="function"){E.callback=null,T=E.priorityLevel;var Qe=Oe(E.expirationTime<=Y);if(Y=n.unstable_now(),typeof Qe=="function"){E.callback=Qe,se(Y),oe=!0;break t}E===t(f)&&i(f),se(Y)}else i(f);E=t(f)}if(E!==null)oe=!0;else{var q=t(p);q!==null&&Te(le,q.startTime-Y),oe=!1}}break e}finally{E=null,T=_e,C=!1}oe=void 0}}finally{oe?F():ue=!1}}}var F;if(typeof X=="function")F=function(){X(V)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,me=M.port2;M.port1.onmessage=V,F=function(){me.postMessage(null)}}else F=function(){Q(V,0)};function Te(Y,oe){N=Q(function(){Y(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Y){Y.callback=null},n.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Y?Math.floor(1e3/Y):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(Y){switch(T){case 1:case 2:case 3:var oe=3;break;default:oe=T}var _e=T;T=oe;try{return Y()}finally{T=_e}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(Y,oe){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var _e=T;T=Y;try{return oe()}finally{T=_e}},n.unstable_scheduleCallback=function(Y,oe,_e){var Oe=n.unstable_now();switch(typeof _e=="object"&&_e!==null?(_e=_e.delay,_e=typeof _e=="number"&&0<_e?Oe+_e:Oe):_e=Oe,Y){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=_e+Qe,Y={id:_++,callback:oe,priorityLevel:Y,startTime:_e,expirationTime:Qe,sortIndex:-1},_e>Oe?(Y.sortIndex=_e,e(p,Y),t(f)===null&&Y===t(p)&&(O?(j(N),N=-1):O=!0,Te(le,_e-Oe))):(Y.sortIndex=Qe,e(f,Y),P||C||(P=!0,ue||(ue=!0,F()))),Y},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(Y){var oe=T;return function(){var _e=T;T=oe;try{return Y.apply(this,arguments)}finally{T=_e}}}})(Cg)),Cg}var B0;function VN(){return B0||(B0=1,Ig.exports=kN()),Ig.exports}var wg={exports:{}},cn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q0;function LN(){if(q0)return cn;q0=1;var n=Hy();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(f,p,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:E==null?null:""+E,children:f,containerInfo:p,implementation:_}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,cn.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(f,p,null,_)},cn.flushSync=function(f){var p=l.T,_=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=p,i.p=_,i.d.f()}},cn.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},cn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},cn.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,E=d(_,p.crossOrigin),T=typeof p.integrity=="string"?p.integrity:void 0,C=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:E,integrity:T,fetchPriority:C}):_==="script"&&i.d.X(f,{crossOrigin:E,integrity:T,fetchPriority:C,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},cn.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=d(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},cn.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,E=d(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:E,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},cn.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=d(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},cn.requestFormReset=function(f){i.d.r(f)},cn.unstable_batchedUpdates=function(f,p){return f(p)},cn.useFormState=function(f,p,_){return l.H.useFormState(f,p,_)},cn.useFormStatus=function(){return l.H.useHostTransitionStatus()},cn.version="19.2.3",cn}var G0;function UN(){if(G0)return wg.exports;G0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),wg.exports=LN(),wg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var z0;function ON(){if(z0)return Qu;z0=1;var n=VN(),e=Hy(),t=UN();function i(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function d(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function f(r){if(a(r)!==r)throw Error(i(188))}function p(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(i(188));return o!==r?null:r}for(var u=r,c=o;;){var y=u.return;if(y===null)break;var v=y.alternate;if(v===null){if(c=y.return,c!==null){u=c;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===u)return f(y),r;if(v===c)return f(y),o;v=v.sibling}throw Error(i(188))}if(u.return!==c.return)u=y,c=v;else{for(var S=!1,w=y.child;w;){if(w===u){S=!0,u=y,c=v;break}if(w===c){S=!0,c=y,u=v;break}w=w.sibling}if(!S){for(w=v.child;w;){if(w===u){S=!0,u=v,c=y;break}if(w===c){S=!0,c=v,u=y;break}w=w.sibling}if(!S)throw Error(i(189))}}if(u.alternate!==c)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?r:o}function _(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=_(r),o!==null)return o;r=r.sibling}return null}var E=Object.assign,T=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),Q=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),X=Symbol.for("react.context"),se=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function F(r){return r===null||typeof r!="object"?null:(r=V&&r[V]||r["@@iterator"],typeof r=="function"?r:null)}var M=Symbol.for("react.client.reference");function me(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===M?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case O:return"Fragment";case Q:return"Profiler";case k:return"StrictMode";case le:return"Suspense";case ue:return"SuspenseList";case x:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case P:return"Portal";case X:return r.displayName||"Context";case j:return(r._context.displayName||"Context")+".Consumer";case se:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case N:return o=r.displayName||null,o!==null?o:me(r.type)||"Memo";case D:o=r._payload,r=r._init;try{return me(r(o))}catch{}}return null}var Te=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e={pending:!1,data:null,method:null,action:null},Oe=[],Qe=-1;function q(r){return{current:r}}function re(r){0>Qe||(r.current=Oe[Qe],Oe[Qe]=null,Qe--)}function he(r,o){Qe++,Oe[Qe]=r.current,r.current=o}var ge=q(null),xe=q(null),Ve=q(null),Ye=q(null);function Ht(r,o){switch(he(Ve,o),he(xe,r),he(ge,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?r0(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=r0(o),r=s0(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}re(ge),he(ge,r)}function gt(){re(ge),re(xe),re(Ve)}function Hs(r){r.memoizedState!==null&&he(Ye,r);var o=ge.current,u=s0(o,r.type);o!==u&&(he(xe,r),he(ge,u))}function jo(r){xe.current===r&&(re(ge),re(xe)),Ye.current===r&&(re(Ye),Hu._currentValue=_e)}var ea,ta;function wi(r){if(ea===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);ea=o&&o[1]||"",ta=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ea+r+ta}var Hl=!1;function Ks(r,o){if(!r||Hl)return"";Hl=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(o){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(Z){var $=Z}Reflect.construct(r,[],ie)}else{try{ie.call()}catch(Z){$=Z}r.call(ie.prototype)}}else{try{throw Error()}catch(Z){$=Z}(ie=r())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(Z){if(Z&&$&&typeof Z.stack=="string")return[Z.stack,$.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=c.DetermineComponentFrameRoot(),S=v[0],w=v[1];if(S&&w){var U=S.split(`
`),J=w.split(`
`);for(y=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;y<J.length&&!J[y].includes("DetermineComponentFrameRoot");)y++;if(c===U.length||y===J.length)for(c=U.length-1,y=J.length-1;1<=c&&0<=y&&U[c]!==J[y];)y--;for(;1<=c&&0<=y;c--,y--)if(U[c]!==J[y]){if(c!==1||y!==1)do if(c--,y--,0>y||U[c]!==J[y]){var te=`
`+U[c].replace(" at new "," at ");return r.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",r.displayName)),te}while(1<=c&&0<=y);break}}}finally{Hl=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?wi(u):""}function Kl(r,o){switch(r.tag){case 26:case 27:case 5:return wi(r.type);case 16:return wi("Lazy");case 13:return r.child!==o&&o!==null?wi("Suspense Fallback"):wi("Suspense");case 19:return wi("SuspenseList");case 0:case 15:return Ks(r.type,!1);case 11:return Ks(r.type.render,!1);case 1:return Ks(r.type,!0);case 31:return wi("Activity");default:return""}}function Jl(r){try{var o="",u=null;do o+=Kl(r,u),u=r,r=r.return;while(r);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Mt=Object.prototype.hasOwnProperty,Kt=n.unstable_scheduleCallback,Or=n.unstable_cancelCallback,Sp=n.unstable_shouldYield,id=n.unstable_requestPaint,yn=n.unstable_now,Js=n.unstable_getCurrentPriorityLevel,Yl=n.unstable_ImmediatePriority,$l=n.unstable_UserBlockingPriority,Fr=n.unstable_NormalPriority,Ip=n.unstable_LowPriority,rd=n.unstable_IdlePriority,sd=n.log,od=n.unstable_setDisableYieldValue,li=null,tn=null;function Kn(r){if(typeof sd=="function"&&od(r),tn&&typeof tn.setStrictMode=="function")try{tn.setStrictMode(li,r)}catch{}}var Ct=Math.clz32?Math.clz32:ld,ad=Math.log,na=Math.LN2;function ld(r){return r>>>=0,r===0?32:31-(ad(r)/na|0)|0}var Ri=256,Ys=262144,Pt=4194304;function bi(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function xi(r,o,u){var c=r.pendingLanes;if(c===0)return 0;var y=0,v=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var w=c&134217727;return w!==0?(c=w&~v,c!==0?y=bi(c):(S&=w,S!==0?y=bi(S):u||(u=w&~r,u!==0&&(y=bi(u))))):(w=c&~v,w!==0?y=bi(w):S!==0?y=bi(S):u||(u=c&~r,u!==0&&(y=bi(u)))),y===0?0:o!==0&&o!==y&&(o&v)===0&&(v=y&-y,u=o&-o,v>=u||v===32&&(u&4194048)!==0)?o:y}function ui(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function Cp(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ud(){var r=Pt;return Pt<<=1,(Pt&62914560)===0&&(Pt=4194304),r}function Ni(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function $s(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function wp(r,o,u,c,y,v){var S=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var w=r.entanglements,U=r.expirationTimes,J=r.hiddenUpdates;for(u=S&~u;0<u;){var te=31-Ct(u),ie=1<<te;w[te]=0,U[te]=-1;var $=J[te];if($!==null)for(J[te]=null,te=0;te<$.length;te++){var Z=$[te];Z!==null&&(Z.lane&=-536870913)}u&=~ie}c!==0&&Qs(r,c,0),v!==0&&y===0&&r.tag!==0&&(r.suspendedLanes|=v&~(S&~o))}function Qs(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var c=31-Ct(o);r.entangledLanes|=o,r.entanglements[c]=r.entanglements[c]|1073741824|u&261930}function Ql(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var c=31-Ct(u),y=1<<c;y&o|r[c]&o&&(r[c]|=o),u&=~y}}function Xl(r,o){var u=o&-o;return u=(u&42)!==0?1:Xs(u),(u&(r.suspendedLanes|o))!==0?0:u}function Xs(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function ir(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function cd(){var r=oe.p;return r!==0?r:(r=window.event,r===void 0?32:b0(r.type))}function ci(r,o){var u=oe.p;try{return oe.p=r,o()}finally{oe.p=u}}var di=Math.random().toString(36).slice(2),kt="__reactFiber$"+di,Xt="__reactProps$"+di,Di="__reactContainer$"+di,ia="__reactEvents$"+di,Rp="__reactListeners$"+di,dd="__reactHandles$"+di,fd="__reactResources$"+di,Mi="__reactMarker$"+di;function ra(r){delete r[kt],delete r[Xt],delete r[ia],delete r[Rp],delete r[dd]}function Pi(r){var o=r[kt];if(o)return o;for(var u=r.parentNode;u;){if(o=u[Di]||u[kt]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=f0(r);r!==null;){if(u=r[kt])return u;r=f0(r)}return o}r=u,u=r.parentNode}return null}function Jn(r){if(r=r[kt]||r[Di]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function Mn(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(i(33))}function ki(r){var o=r[fd];return o||(o=r[fd]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Vt(r){r[Mi]=!0}var Wl=new Set,Zl={};function Vi(r,o){Li(r,o),Li(r+"Capture",o)}function Li(r,o){for(Zl[r]=o,r=0;r<o.length;r++)Wl.add(o[r])}var jl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),eu={},tu={};function hd(r){return Mt.call(tu,r)?!0:Mt.call(eu,r)?!1:jl.test(r)?tu[r]=!0:(eu[r]=!0,!1)}function sa(r,o,u){if(hd(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var c=o.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function Pn(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function Lt(r,o,u,c){if(c===null)r.removeAttribute(u);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+c)}}function Wt(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Br(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function nu(r,o,u){var c=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var y=c.get,v=c.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return y.call(this)},set:function(S){u=""+S,v.call(this,S)}}),Object.defineProperty(r,o,{enumerable:c.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function nt(r){if(!r._valueTracker){var o=Br(r)?"checked":"value";r._valueTracker=nu(r,o,""+r[o])}}function Ws(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),c="";return r&&(c=Br(r)?r.checked?"true":"false":r.value),r=c,r!==u?(o.setValue(r),!0):!1}function Ui(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Zs=/[\n"\\]/g;function Sn(r){return r.replace(Zs,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function oa(r,o,u,c,y,v,S,w){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),o!=null?S==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+Wt(o)):r.value!==""+Wt(o)&&(r.value=""+Wt(o)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),o!=null?iu(r,S,Wt(o)):u!=null?iu(r,S,Wt(u)):c!=null&&r.removeAttribute("value"),y==null&&v!=null&&(r.defaultChecked=!!v),y!=null&&(r.checked=y&&typeof y!="function"&&typeof y!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.name=""+Wt(w):r.removeAttribute("name")}function pd(r,o,u,c,y,v,S,w){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(r.type=v),o!=null||u!=null){if(!(v!=="submit"&&v!=="reset"||o!=null)){nt(r);return}u=u!=null?""+Wt(u):"",o=o!=null?""+Wt(o):u,w||o===r.value||(r.value=o),r.defaultValue=o}c=c??y,c=typeof c!="function"&&typeof c!="symbol"&&!!c,r.checked=w?r.checked:!!c,r.defaultChecked=!!c,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S),nt(r)}function iu(r,o,u){o==="number"&&Ui(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function qr(r,o,u,c){if(r=r.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<r.length;u++)y=o.hasOwnProperty("$"+r[u].value),r[u].selected!==y&&(r[u].selected=y),y&&c&&(r[u].defaultSelected=!0)}else{for(u=""+Wt(u),o=null,y=0;y<r.length;y++){if(r[y].value===u){r[y].selected=!0,c&&(r[y].defaultSelected=!0);return}o!==null||r[y].disabled||(o=r[y])}o!==null&&(o.selected=!0)}}function md(r,o,u){if(o!=null&&(o=""+Wt(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+Wt(u):""}function Gr(r,o,u,c){if(o==null){if(c!=null){if(u!=null)throw Error(i(92));if(Te(c)){if(1<c.length)throw Error(i(93));c=c[0]}u=c}u==null&&(u=""),o=u}u=Wt(o),r.defaultValue=u,c=r.textContent,c===u&&c!==""&&c!==null&&(r.value=c),nt(r)}function In(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var gd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ru(r,o,u){var c=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?c?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":c?r.setProperty(o,u):typeof u!="number"||u===0||gd.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function su(r,o,u){if(o!=null&&typeof o!="object")throw Error(i(62));if(r=r.style,u!=null){for(var c in u)!u.hasOwnProperty(c)||o!=null&&o.hasOwnProperty(c)||(c.indexOf("--")===0?r.setProperty(c,""):c==="float"?r.cssFloat="":r[c]="");for(var y in o)c=o[y],o.hasOwnProperty(y)&&u[y]!==c&&ru(r,y,c)}else for(var v in o)o.hasOwnProperty(v)&&ru(r,v,o[v])}function aa(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),zr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function la(r){return zr.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function fi(){}var ou=null;function Yn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Hr=null,Oi=null;function js(r){var o=Jn(r);if(o&&(r=o.stateNode)){var u=r[Xt]||null;e:switch(r=o.stateNode,o.type){case"input":if(oa(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Sn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var c=u[o];if(c!==r&&c.form===r.form){var y=c[Xt]||null;if(!y)throw Error(i(90));oa(c,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)c=u[o],c.form===r.form&&Ws(c)}break e;case"textarea":md(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&qr(r,!!u.multiple,o,!1)}}}var ua=!1;function Kr(r,o,u){if(ua)return r(o,u);ua=!0;try{var c=r(o);return c}finally{if(ua=!1,(Hr!==null||Oi!==null)&&(df(),Hr&&(o=Hr,r=Oi,Oi=Hr=null,js(o),r)))for(o=0;o<r.length;o++)js(r[o])}}function hi(r,o){var u=r.stateNode;if(u===null)return null;var c=u[Xt]||null;if(c===null)return null;u=c[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(r=r.type,c=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!c;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(i(231,o,typeof u));return u}var $n=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eo=!1;if($n)try{var lt={};Object.defineProperty(lt,"passive",{get:function(){eo=!0}}),window.addEventListener("test",lt,lt),window.removeEventListener("test",lt,lt)}catch{eo=!1}var Fi=null,au=null,to=null;function lu(){if(to)return to;var r,o=au,u=o.length,c,y="value"in Fi?Fi.value:Fi.textContent,v=y.length;for(r=0;r<u&&o[r]===y[r];r++);var S=u-r;for(c=1;c<=S&&o[u-c]===y[v-c];c++);return to=y.slice(r,1<c?1-c:void 0)}function no(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function rr(){return!0}function pi(){return!1}function nn(r){function o(u,c,y,v,S){this._reactName=u,this._targetInst=y,this.type=c,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var w in r)r.hasOwnProperty(w)&&(u=r[w],this[w]=u?u(v):v[w]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?rr:pi,this.isPropagationStopped=pi,this}return E(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),o}var sr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bi=nn(sr),Jr=E({},sr,{view:0,detail:0}),uu=nn(Jr),Yr,ca,qi,da=E({},Jr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$r,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==qi&&(qi&&r.type==="mousemove"?(Yr=r.screenX-qi.screenX,ca=r.screenY-qi.screenY):ca=Yr=0,qi=r),Yr)},movementY:function(r){return"movementY"in r?r.movementY:ca}}),cu=nn(da),io=E({},da,{dataTransfer:0}),_d=nn(io),vd=E({},Jr,{relatedTarget:0}),ro=nn(vd),du=E({},sr,{animationName:0,elapsedTime:0,pseudoElement:0}),Ed=nn(du),fa=E({},sr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Td=nn(fa),Ad=E({},sr,{data:0}),Gi=nn(Ad),Sd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Id={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wd(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Cd[r])?!!o[r]:!1}function $r(){return wd}var _n=E({},Jr,{key:function(r){if(r.key){var o=Sd[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=no(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Id[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$r,charCode:function(r){return r.type==="keypress"?no(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?no(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Rd=nn(_n),bd=E({},da,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),or=nn(bd),g=E({},Jr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$r}),A=nn(g),I=E({},sr,{propertyName:0,elapsedTime:0,pseudoElement:0}),b=nn(I),H=E({},da,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),W=nn(H),de=E({},sr,{newState:0,oldState:0}),Pe=nn(de),wt=[9,13,27,32],je=$n&&"CompositionEvent"in window,yt=null;$n&&"documentMode"in document&&(yt=document.documentMode);var Qn=$n&&"TextEvent"in window&&!yt,zi=$n&&(!je||yt&&8<yt&&11>=yt),mi=" ",gi=!1;function so(r,o){switch(r){case"keyup":return wt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ha(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var pa=!1;function e1(r,o){switch(r){case"compositionend":return ha(o);case"keypress":return o.which!==32?null:(gi=!0,mi);case"textInput":return r=o.data,r===mi&&gi?null:r;default:return null}}function t1(r,o){if(pa)return r==="compositionend"||!je&&so(r,o)?(r=lu(),to=au=Fi=null,pa=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return zi&&o.locale!=="ko"?null:o.data;default:return null}}var n1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mv(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!n1[r.type]:o==="textarea"}function gv(r,o,u,c){Hr?Oi?Oi.push(c):Oi=[c]:Hr=c,o=_f(o,"onChange"),0<o.length&&(u=new Bi("onChange","change",null,u,c),r.push({event:u,listeners:o}))}var fu=null,hu=null;function i1(r){ZT(r,0)}function xd(r){var o=Mn(r);if(Ws(o))return r}function yv(r,o){if(r==="change")return o}var _v=!1;if($n){var bp;if($n){var xp="oninput"in document;if(!xp){var vv=document.createElement("div");vv.setAttribute("oninput","return;"),xp=typeof vv.oninput=="function"}bp=xp}else bp=!1;_v=bp&&(!document.documentMode||9<document.documentMode)}function Ev(){fu&&(fu.detachEvent("onpropertychange",Tv),hu=fu=null)}function Tv(r){if(r.propertyName==="value"&&xd(hu)){var o=[];gv(o,hu,r,Yn(r)),Kr(i1,o)}}function r1(r,o,u){r==="focusin"?(Ev(),fu=o,hu=u,fu.attachEvent("onpropertychange",Tv)):r==="focusout"&&Ev()}function s1(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return xd(hu)}function o1(r,o){if(r==="click")return xd(o)}function a1(r,o){if(r==="input"||r==="change")return xd(o)}function l1(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var kn=typeof Object.is=="function"?Object.is:l1;function pu(r,o){if(kn(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),c=Object.keys(o);if(u.length!==c.length)return!1;for(c=0;c<u.length;c++){var y=u[c];if(!Mt.call(o,y)||!kn(r[y],o[y]))return!1}return!0}function Av(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Sv(r,o){var u=Av(r);r=0;for(var c;u;){if(u.nodeType===3){if(c=r+u.textContent.length,r<=o&&c>=o)return{node:u,offset:o-r};r=c}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Av(u)}}function Iv(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Iv(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Cv(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Ui(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=Ui(r.document)}return o}function Np(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var u1=$n&&"documentMode"in document&&11>=document.documentMode,ma=null,Dp=null,mu=null,Mp=!1;function wv(r,o,u){var c=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Mp||ma==null||ma!==Ui(c)||(c=ma,"selectionStart"in c&&Np(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),mu&&pu(mu,c)||(mu=c,c=_f(Dp,"onSelect"),0<c.length&&(o=new Bi("onSelect","select",null,o,u),r.push({event:o,listeners:c}),o.target=ma)))}function oo(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var ga={animationend:oo("Animation","AnimationEnd"),animationiteration:oo("Animation","AnimationIteration"),animationstart:oo("Animation","AnimationStart"),transitionrun:oo("Transition","TransitionRun"),transitionstart:oo("Transition","TransitionStart"),transitioncancel:oo("Transition","TransitionCancel"),transitionend:oo("Transition","TransitionEnd")},Pp={},Rv={};$n&&(Rv=document.createElement("div").style,"AnimationEvent"in window||(delete ga.animationend.animation,delete ga.animationiteration.animation,delete ga.animationstart.animation),"TransitionEvent"in window||delete ga.transitionend.transition);function ao(r){if(Pp[r])return Pp[r];if(!ga[r])return r;var o=ga[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in Rv)return Pp[r]=o[u];return r}var bv=ao("animationend"),xv=ao("animationiteration"),Nv=ao("animationstart"),c1=ao("transitionrun"),d1=ao("transitionstart"),f1=ao("transitioncancel"),Dv=ao("transitionend"),Mv=new Map,kp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");kp.push("scrollEnd");function yi(r,o){Mv.set(r,o),Vi(o,[r])}var Nd=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Xn=[],ya=0,Vp=0;function Dd(){for(var r=ya,o=Vp=ya=0;o<r;){var u=Xn[o];Xn[o++]=null;var c=Xn[o];Xn[o++]=null;var y=Xn[o];Xn[o++]=null;var v=Xn[o];if(Xn[o++]=null,c!==null&&y!==null){var S=c.pending;S===null?y.next=y:(y.next=S.next,S.next=y),c.pending=y}v!==0&&Pv(u,y,v)}}function Md(r,o,u,c){Xn[ya++]=r,Xn[ya++]=o,Xn[ya++]=u,Xn[ya++]=c,Vp|=c,r.lanes|=c,r=r.alternate,r!==null&&(r.lanes|=c)}function Lp(r,o,u,c){return Md(r,o,u,c),Pd(r)}function lo(r,o){return Md(r,null,null,o),Pd(r)}function Pv(r,o,u){r.lanes|=u;var c=r.alternate;c!==null&&(c.lanes|=u);for(var y=!1,v=r.return;v!==null;)v.childLanes|=u,c=v.alternate,c!==null&&(c.childLanes|=u),v.tag===22&&(r=v.stateNode,r===null||r._visibility&1||(y=!0)),r=v,v=v.return;return r.tag===3?(v=r.stateNode,y&&o!==null&&(y=31-Ct(u),r=v.hiddenUpdates,c=r[y],c===null?r[y]=[o]:c.push(o),o.lane=u|536870912),v):null}function Pd(r){if(50<Uu)throw Uu=0,Km=null,Error(i(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var _a={};function h1(r,o,u,c){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(r,o,u,c){return new h1(r,o,u,c)}function Up(r){return r=r.prototype,!(!r||!r.isReactComponent)}function ar(r,o){var u=r.alternate;return u===null?(u=Vn(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function kv(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function kd(r,o,u,c,y,v){var S=0;if(c=r,typeof r=="function")Up(r)&&(S=1);else if(typeof r=="string")S=_N(r,u,ge.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case x:return r=Vn(31,u,o,y),r.elementType=x,r.lanes=v,r;case O:return uo(u.children,y,v,o);case k:S=8,y|=24;break;case Q:return r=Vn(12,u,o,y|2),r.elementType=Q,r.lanes=v,r;case le:return r=Vn(13,u,o,y),r.elementType=le,r.lanes=v,r;case ue:return r=Vn(19,u,o,y),r.elementType=ue,r.lanes=v,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case X:S=10;break e;case j:S=9;break e;case se:S=11;break e;case N:S=14;break e;case D:S=16,c=null;break e}S=29,u=Error(i(130,r===null?"null":typeof r,"")),c=null}return o=Vn(S,u,o,y),o.elementType=r,o.type=c,o.lanes=v,o}function uo(r,o,u,c){return r=Vn(7,r,c,o),r.lanes=u,r}function Op(r,o,u){return r=Vn(6,r,null,o),r.lanes=u,r}function Vv(r){var o=Vn(18,null,null,0);return o.stateNode=r,o}function Fp(r,o,u){return o=Vn(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var Lv=new WeakMap;function Wn(r,o){if(typeof r=="object"&&r!==null){var u=Lv.get(r);return u!==void 0?u:(o={value:r,source:o,stack:Jl(o)},Lv.set(r,o),o)}return{value:r,source:o,stack:Jl(o)}}var va=[],Ea=0,Vd=null,gu=0,Zn=[],jn=0,Qr=null,Hi=1,Ki="";function lr(r,o){va[Ea++]=gu,va[Ea++]=Vd,Vd=r,gu=o}function Uv(r,o,u){Zn[jn++]=Hi,Zn[jn++]=Ki,Zn[jn++]=Qr,Qr=r;var c=Hi;r=Ki;var y=32-Ct(c)-1;c&=~(1<<y),u+=1;var v=32-Ct(o)+y;if(30<v){var S=y-y%5;v=(c&(1<<S)-1).toString(32),c>>=S,y-=S,Hi=1<<32-Ct(o)+y|u<<y|c,Ki=v+r}else Hi=1<<v|u<<y|c,Ki=r}function Bp(r){r.return!==null&&(lr(r,1),Uv(r,1,0))}function qp(r){for(;r===Vd;)Vd=va[--Ea],va[Ea]=null,gu=va[--Ea],va[Ea]=null;for(;r===Qr;)Qr=Zn[--jn],Zn[jn]=null,Ki=Zn[--jn],Zn[jn]=null,Hi=Zn[--jn],Zn[jn]=null}function Ov(r,o){Zn[jn++]=Hi,Zn[jn++]=Ki,Zn[jn++]=Qr,Hi=o.id,Ki=o.overflow,Qr=r}var rn=null,pt=null,Je=!1,Xr=null,ei=!1,Gp=Error(i(519));function Wr(r){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw yu(Wn(o,r)),Gp}function Fv(r){var o=r.stateNode,u=r.type,c=r.memoizedProps;switch(o[kt]=r,o[Xt]=c,u){case"dialog":Be("cancel",o),Be("close",o);break;case"iframe":case"object":case"embed":Be("load",o);break;case"video":case"audio":for(u=0;u<Fu.length;u++)Be(Fu[u],o);break;case"source":Be("error",o);break;case"img":case"image":case"link":Be("error",o),Be("load",o);break;case"details":Be("toggle",o);break;case"input":Be("invalid",o),pd(o,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Be("invalid",o);break;case"textarea":Be("invalid",o),Gr(o,c.value,c.defaultValue,c.children)}u=c.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||c.suppressHydrationWarning===!0||n0(o.textContent,u)?(c.popover!=null&&(Be("beforetoggle",o),Be("toggle",o)),c.onScroll!=null&&Be("scroll",o),c.onScrollEnd!=null&&Be("scrollend",o),c.onClick!=null&&(o.onclick=fi),o=!0):o=!1,o||Wr(r,!0)}function Bv(r){for(rn=r.return;rn;)switch(rn.tag){case 5:case 31:case 13:ei=!1;return;case 27:case 3:ei=!0;return;default:rn=rn.return}}function Ta(r){if(r!==rn)return!1;if(!Je)return Bv(r),Je=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||og(r.type,r.memoizedProps)),u=!u),u&&pt&&Wr(r),Bv(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));pt=d0(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));pt=d0(r)}else o===27?(o=pt,ds(r.type)?(r=dg,dg=null,pt=r):pt=o):pt=rn?ni(r.stateNode.nextSibling):null;return!0}function co(){pt=rn=null,Je=!1}function zp(){var r=Xr;return r!==null&&(bn===null?bn=r:bn.push.apply(bn,r),Xr=null),r}function yu(r){Xr===null?Xr=[r]:Xr.push(r)}var Hp=q(null),fo=null,ur=null;function Zr(r,o,u){he(Hp,o._currentValue),o._currentValue=u}function cr(r){r._currentValue=Hp.current,re(Hp)}function Kp(r,o,u){for(;r!==null;){var c=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,c!==null&&(c.childLanes|=o)):c!==null&&(c.childLanes&o)!==o&&(c.childLanes|=o),r===u)break;r=r.return}}function Jp(r,o,u,c){var y=r.child;for(y!==null&&(y.return=r);y!==null;){var v=y.dependencies;if(v!==null){var S=y.child;v=v.firstContext;e:for(;v!==null;){var w=v;v=y;for(var U=0;U<o.length;U++)if(w.context===o[U]){v.lanes|=u,w=v.alternate,w!==null&&(w.lanes|=u),Kp(v.return,u,r),c||(S=null);break e}v=w.next}}else if(y.tag===18){if(S=y.return,S===null)throw Error(i(341));S.lanes|=u,v=S.alternate,v!==null&&(v.lanes|=u),Kp(S,u,r),S=null}else S=y.child;if(S!==null)S.return=y;else for(S=y;S!==null;){if(S===r){S=null;break}if(y=S.sibling,y!==null){y.return=S.return,S=y;break}S=S.return}y=S}}function Aa(r,o,u,c){r=null;for(var y=o,v=!1;y!==null;){if(!v){if((y.flags&524288)!==0)v=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var S=y.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var w=y.type;kn(y.pendingProps.value,S.value)||(r!==null?r.push(w):r=[w])}}else if(y===Ye.current){if(S=y.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(r!==null?r.push(Hu):r=[Hu])}y=y.return}r!==null&&Jp(o,r,u,c),o.flags|=262144}function Ld(r){for(r=r.firstContext;r!==null;){if(!kn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function ho(r){fo=r,ur=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function sn(r){return qv(fo,r)}function Ud(r,o){return fo===null&&ho(r),qv(r,o)}function qv(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},ur===null){if(r===null)throw Error(i(308));ur=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else ur=ur.next=o;return u}var p1=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,c){r.push(c)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},m1=n.unstable_scheduleCallback,g1=n.unstable_NormalPriority,Ut={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Yp(){return{controller:new p1,data:new Map,refCount:0}}function _u(r){r.refCount--,r.refCount===0&&m1(g1,function(){r.controller.abort()})}var vu=null,$p=0,Sa=0,Ia=null;function y1(r,o){if(vu===null){var u=vu=[];$p=0,Sa=Wm(),Ia={status:"pending",value:void 0,then:function(c){u.push(c)}}}return $p++,o.then(Gv,Gv),o}function Gv(){if(--$p===0&&vu!==null){Ia!==null&&(Ia.status="fulfilled");var r=vu;vu=null,Sa=0,Ia=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function _1(r,o){var u=[],c={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return r.then(function(){c.status="fulfilled",c.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(c.status="rejected",c.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),c}var zv=Y.S;Y.S=function(r,o){wT=yn(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&y1(r,o),zv!==null&&zv(r,o)};var po=q(null);function Qp(){var r=po.current;return r!==null?r:ft.pooledCache}function Od(r,o){o===null?he(po,po.current):he(po,o.pool)}function Hv(){var r=Qp();return r===null?null:{parent:Ut._currentValue,pool:r}}var Ca=Error(i(460)),Xp=Error(i(474)),Fd=Error(i(542)),Bd={then:function(){}};function Kv(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Jv(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(fi,fi),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,$v(r),r;default:if(typeof o.status=="string")o.then(fi,fi);else{if(r=ft,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=o,r.status="pending",r.then(function(c){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=c}},function(c){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=c}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,$v(r),r}throw go=o,Ca}}function mo(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(go=u,Ca):u}}var go=null;function Yv(){if(go===null)throw Error(i(459));var r=go;return go=null,r}function $v(r){if(r===Ca||r===Fd)throw Error(i(483))}var wa=null,Eu=0;function qd(r){var o=Eu;return Eu+=1,wa===null&&(wa=[]),Jv(wa,r,o)}function Tu(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Gd(r,o){throw o.$$typeof===T?Error(i(525)):(r=Object.prototype.toString.call(o),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function Qv(r){function o(G,B){if(r){var K=G.deletions;K===null?(G.deletions=[B],G.flags|=16):K.push(B)}}function u(G,B){if(!r)return null;for(;B!==null;)o(G,B),B=B.sibling;return null}function c(G){for(var B=new Map;G!==null;)G.key!==null?B.set(G.key,G):B.set(G.index,G),G=G.sibling;return B}function y(G,B){return G=ar(G,B),G.index=0,G.sibling=null,G}function v(G,B,K){return G.index=K,r?(K=G.alternate,K!==null?(K=K.index,K<B?(G.flags|=67108866,B):K):(G.flags|=67108866,B)):(G.flags|=1048576,B)}function S(G){return r&&G.alternate===null&&(G.flags|=67108866),G}function w(G,B,K,ne){return B===null||B.tag!==6?(B=Op(K,G.mode,ne),B.return=G,B):(B=y(B,K),B.return=G,B)}function U(G,B,K,ne){var Ie=K.type;return Ie===O?te(G,B,K.props.children,ne,K.key):B!==null&&(B.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===D&&mo(Ie)===B.type)?(B=y(B,K.props),Tu(B,K),B.return=G,B):(B=kd(K.type,K.key,K.props,null,G.mode,ne),Tu(B,K),B.return=G,B)}function J(G,B,K,ne){return B===null||B.tag!==4||B.stateNode.containerInfo!==K.containerInfo||B.stateNode.implementation!==K.implementation?(B=Fp(K,G.mode,ne),B.return=G,B):(B=y(B,K.children||[]),B.return=G,B)}function te(G,B,K,ne,Ie){return B===null||B.tag!==7?(B=uo(K,G.mode,ne,Ie),B.return=G,B):(B=y(B,K),B.return=G,B)}function ie(G,B,K){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Op(""+B,G.mode,K),B.return=G,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case C:return K=kd(B.type,B.key,B.props,null,G.mode,K),Tu(K,B),K.return=G,K;case P:return B=Fp(B,G.mode,K),B.return=G,B;case D:return B=mo(B),ie(G,B,K)}if(Te(B)||F(B))return B=uo(B,G.mode,K,null),B.return=G,B;if(typeof B.then=="function")return ie(G,qd(B),K);if(B.$$typeof===X)return ie(G,Ud(G,B),K);Gd(G,B)}return null}function $(G,B,K,ne){var Ie=B!==null?B.key:null;if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return Ie!==null?null:w(G,B,""+K,ne);if(typeof K=="object"&&K!==null){switch(K.$$typeof){case C:return K.key===Ie?U(G,B,K,ne):null;case P:return K.key===Ie?J(G,B,K,ne):null;case D:return K=mo(K),$(G,B,K,ne)}if(Te(K)||F(K))return Ie!==null?null:te(G,B,K,ne,null);if(typeof K.then=="function")return $(G,B,qd(K),ne);if(K.$$typeof===X)return $(G,B,Ud(G,K),ne);Gd(G,K)}return null}function Z(G,B,K,ne,Ie){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return G=G.get(K)||null,w(B,G,""+ne,Ie);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case C:return G=G.get(ne.key===null?K:ne.key)||null,U(B,G,ne,Ie);case P:return G=G.get(ne.key===null?K:ne.key)||null,J(B,G,ne,Ie);case D:return ne=mo(ne),Z(G,B,K,ne,Ie)}if(Te(ne)||F(ne))return G=G.get(K)||null,te(B,G,ne,Ie,null);if(typeof ne.then=="function")return Z(G,B,K,qd(ne),Ie);if(ne.$$typeof===X)return Z(G,B,K,Ud(B,ne),Ie);Gd(B,ne)}return null}function ve(G,B,K,ne){for(var Ie=null,Xe=null,Ae=B,Le=B=0,Ge=null;Ae!==null&&Le<K.length;Le++){Ae.index>Le?(Ge=Ae,Ae=null):Ge=Ae.sibling;var We=$(G,Ae,K[Le],ne);if(We===null){Ae===null&&(Ae=Ge);break}r&&Ae&&We.alternate===null&&o(G,Ae),B=v(We,B,Le),Xe===null?Ie=We:Xe.sibling=We,Xe=We,Ae=Ge}if(Le===K.length)return u(G,Ae),Je&&lr(G,Le),Ie;if(Ae===null){for(;Le<K.length;Le++)Ae=ie(G,K[Le],ne),Ae!==null&&(B=v(Ae,B,Le),Xe===null?Ie=Ae:Xe.sibling=Ae,Xe=Ae);return Je&&lr(G,Le),Ie}for(Ae=c(Ae);Le<K.length;Le++)Ge=Z(Ae,G,Le,K[Le],ne),Ge!==null&&(r&&Ge.alternate!==null&&Ae.delete(Ge.key===null?Le:Ge.key),B=v(Ge,B,Le),Xe===null?Ie=Ge:Xe.sibling=Ge,Xe=Ge);return r&&Ae.forEach(function(gs){return o(G,gs)}),Je&&lr(G,Le),Ie}function Re(G,B,K,ne){if(K==null)throw Error(i(151));for(var Ie=null,Xe=null,Ae=B,Le=B=0,Ge=null,We=K.next();Ae!==null&&!We.done;Le++,We=K.next()){Ae.index>Le?(Ge=Ae,Ae=null):Ge=Ae.sibling;var gs=$(G,Ae,We.value,ne);if(gs===null){Ae===null&&(Ae=Ge);break}r&&Ae&&gs.alternate===null&&o(G,Ae),B=v(gs,B,Le),Xe===null?Ie=gs:Xe.sibling=gs,Xe=gs,Ae=Ge}if(We.done)return u(G,Ae),Je&&lr(G,Le),Ie;if(Ae===null){for(;!We.done;Le++,We=K.next())We=ie(G,We.value,ne),We!==null&&(B=v(We,B,Le),Xe===null?Ie=We:Xe.sibling=We,Xe=We);return Je&&lr(G,Le),Ie}for(Ae=c(Ae);!We.done;Le++,We=K.next())We=Z(Ae,G,Le,We.value,ne),We!==null&&(r&&We.alternate!==null&&Ae.delete(We.key===null?Le:We.key),B=v(We,B,Le),Xe===null?Ie=We:Xe.sibling=We,Xe=We);return r&&Ae.forEach(function(xN){return o(G,xN)}),Je&&lr(G,Le),Ie}function dt(G,B,K,ne){if(typeof K=="object"&&K!==null&&K.type===O&&K.key===null&&(K=K.props.children),typeof K=="object"&&K!==null){switch(K.$$typeof){case C:e:{for(var Ie=K.key;B!==null;){if(B.key===Ie){if(Ie=K.type,Ie===O){if(B.tag===7){u(G,B.sibling),ne=y(B,K.props.children),ne.return=G,G=ne;break e}}else if(B.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===D&&mo(Ie)===B.type){u(G,B.sibling),ne=y(B,K.props),Tu(ne,K),ne.return=G,G=ne;break e}u(G,B);break}else o(G,B);B=B.sibling}K.type===O?(ne=uo(K.props.children,G.mode,ne,K.key),ne.return=G,G=ne):(ne=kd(K.type,K.key,K.props,null,G.mode,ne),Tu(ne,K),ne.return=G,G=ne)}return S(G);case P:e:{for(Ie=K.key;B!==null;){if(B.key===Ie)if(B.tag===4&&B.stateNode.containerInfo===K.containerInfo&&B.stateNode.implementation===K.implementation){u(G,B.sibling),ne=y(B,K.children||[]),ne.return=G,G=ne;break e}else{u(G,B);break}else o(G,B);B=B.sibling}ne=Fp(K,G.mode,ne),ne.return=G,G=ne}return S(G);case D:return K=mo(K),dt(G,B,K,ne)}if(Te(K))return ve(G,B,K,ne);if(F(K)){if(Ie=F(K),typeof Ie!="function")throw Error(i(150));return K=Ie.call(K),Re(G,B,K,ne)}if(typeof K.then=="function")return dt(G,B,qd(K),ne);if(K.$$typeof===X)return dt(G,B,Ud(G,K),ne);Gd(G,K)}return typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint"?(K=""+K,B!==null&&B.tag===6?(u(G,B.sibling),ne=y(B,K),ne.return=G,G=ne):(u(G,B),ne=Op(K,G.mode,ne),ne.return=G,G=ne),S(G)):u(G,B)}return function(G,B,K,ne){try{Eu=0;var Ie=dt(G,B,K,ne);return wa=null,Ie}catch(Ae){if(Ae===Ca||Ae===Fd)throw Ae;var Xe=Vn(29,Ae,null,G.mode);return Xe.lanes=ne,Xe.return=G,Xe}finally{}}}var yo=Qv(!0),Xv=Qv(!1),jr=!1;function Wp(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Zp(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function es(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ts(r,o,u){var c=r.updateQueue;if(c===null)return null;if(c=c.shared,(et&2)!==0){var y=c.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),c.pending=o,o=Pd(r),Pv(r,null,u),o}return Md(r,c,o,u),Pd(r)}function Au(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var c=o.lanes;c&=r.pendingLanes,u|=c,o.lanes=u,Ql(r,u)}}function jp(r,o){var u=r.updateQueue,c=r.alternate;if(c!==null&&(c=c.updateQueue,u===c)){var y=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var S={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};v===null?y=v=S:v=v.next=S,u=u.next}while(u!==null);v===null?y=v=o:v=v.next=o}else y=v=o;u={baseState:c.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:c.shared,callbacks:c.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var em=!1;function Su(){if(em){var r=Ia;if(r!==null)throw r}}function Iu(r,o,u,c){em=!1;var y=r.updateQueue;jr=!1;var v=y.firstBaseUpdate,S=y.lastBaseUpdate,w=y.shared.pending;if(w!==null){y.shared.pending=null;var U=w,J=U.next;U.next=null,S===null?v=J:S.next=J,S=U;var te=r.alternate;te!==null&&(te=te.updateQueue,w=te.lastBaseUpdate,w!==S&&(w===null?te.firstBaseUpdate=J:w.next=J,te.lastBaseUpdate=U))}if(v!==null){var ie=y.baseState;S=0,te=J=U=null,w=v;do{var $=w.lane&-536870913,Z=$!==w.lane;if(Z?(qe&$)===$:(c&$)===$){$!==0&&$===Sa&&(em=!0),te!==null&&(te=te.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var ve=r,Re=w;$=o;var dt=u;switch(Re.tag){case 1:if(ve=Re.payload,typeof ve=="function"){ie=ve.call(dt,ie,$);break e}ie=ve;break e;case 3:ve.flags=ve.flags&-65537|128;case 0:if(ve=Re.payload,$=typeof ve=="function"?ve.call(dt,ie,$):ve,$==null)break e;ie=E({},ie,$);break e;case 2:jr=!0}}$=w.callback,$!==null&&(r.flags|=64,Z&&(r.flags|=8192),Z=y.callbacks,Z===null?y.callbacks=[$]:Z.push($))}else Z={lane:$,tag:w.tag,payload:w.payload,callback:w.callback,next:null},te===null?(J=te=Z,U=ie):te=te.next=Z,S|=$;if(w=w.next,w===null){if(w=y.shared.pending,w===null)break;Z=w,w=Z.next,Z.next=null,y.lastBaseUpdate=Z,y.shared.pending=null}}while(!0);te===null&&(U=ie),y.baseState=U,y.firstBaseUpdate=J,y.lastBaseUpdate=te,v===null&&(y.shared.lanes=0),os|=S,r.lanes=S,r.memoizedState=ie}}function Wv(r,o){if(typeof r!="function")throw Error(i(191,r));r.call(o)}function Zv(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)Wv(u[r],o)}var Ra=q(null),zd=q(0);function jv(r,o){r=vr,he(zd,r),he(Ra,o),vr=r|o.baseLanes}function tm(){he(zd,vr),he(Ra,Ra.current)}function nm(){vr=zd.current,re(Ra),re(zd)}var Ln=q(null),ti=null;function ns(r){var o=r.alternate;he(Rt,Rt.current&1),he(Ln,r),ti===null&&(o===null||Ra.current!==null||o.memoizedState!==null)&&(ti=r)}function im(r){he(Rt,Rt.current),he(Ln,r),ti===null&&(ti=r)}function eE(r){r.tag===22?(he(Rt,Rt.current),he(Ln,r),ti===null&&(ti=r)):is()}function is(){he(Rt,Rt.current),he(Ln,Ln.current)}function Un(r){re(Ln),ti===r&&(ti=null),re(Rt)}var Rt=q(0);function Hd(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||ug(u)||cg(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var dr=0,ke=null,ut=null,Ot=null,Kd=!1,ba=!1,_o=!1,Jd=0,Cu=0,xa=null,v1=0;function Tt(){throw Error(i(321))}function rm(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!kn(r[u],o[u]))return!1;return!0}function sm(r,o,u,c,y,v){return dr=v,ke=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Y.H=r===null||r.memoizedState===null?UE:Em,_o=!1,v=u(c,y),_o=!1,ba&&(v=nE(o,u,c,y)),tE(r),v}function tE(r){Y.H=bu;var o=ut!==null&&ut.next!==null;if(dr=0,Ot=ut=ke=null,Kd=!1,Cu=0,xa=null,o)throw Error(i(300));r===null||Ft||(r=r.dependencies,r!==null&&Ld(r)&&(Ft=!0))}function nE(r,o,u,c){ke=r;var y=0;do{if(ba&&(xa=null),Cu=0,ba=!1,25<=y)throw Error(i(301));if(y+=1,Ot=ut=null,r.updateQueue!=null){var v=r.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}Y.H=OE,v=o(u,c)}while(ba);return v}function E1(){var r=Y.H,o=r.useState()[0];return o=typeof o.then=="function"?wu(o):o,r=r.useState()[0],(ut!==null?ut.memoizedState:null)!==r&&(ke.flags|=1024),o}function om(){var r=Jd!==0;return Jd=0,r}function am(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function lm(r){if(Kd){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Kd=!1}dr=0,Ot=ut=ke=null,ba=!1,Cu=Jd=0,xa=null}function vn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?ke.memoizedState=Ot=r:Ot=Ot.next=r,Ot}function bt(){if(ut===null){var r=ke.alternate;r=r!==null?r.memoizedState:null}else r=ut.next;var o=Ot===null?ke.memoizedState:Ot.next;if(o!==null)Ot=o,ut=r;else{if(r===null)throw ke.alternate===null?Error(i(467)):Error(i(310));ut=r,r={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},Ot===null?ke.memoizedState=Ot=r:Ot=Ot.next=r}return Ot}function Yd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function wu(r){var o=Cu;return Cu+=1,xa===null&&(xa=[]),r=Jv(xa,r,o),o=ke,(Ot===null?o.memoizedState:Ot.next)===null&&(o=o.alternate,Y.H=o===null||o.memoizedState===null?UE:Em),r}function $d(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return wu(r);if(r.$$typeof===X)return sn(r)}throw Error(i(438,String(r)))}function um(r){var o=null,u=ke.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var c=ke.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(o={data:c.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Yd(),ke.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),c=0;c<r;c++)u[c]=L;return o.index++,u}function fr(r,o){return typeof o=="function"?o(r):o}function Qd(r){var o=bt();return cm(o,ut,r)}function cm(r,o,u){var c=r.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=u;var y=r.baseQueue,v=c.pending;if(v!==null){if(y!==null){var S=y.next;y.next=v.next,v.next=S}o.baseQueue=y=v,c.pending=null}if(v=r.baseState,y===null)r.memoizedState=v;else{o=y.next;var w=S=null,U=null,J=o,te=!1;do{var ie=J.lane&-536870913;if(ie!==J.lane?(qe&ie)===ie:(dr&ie)===ie){var $=J.revertLane;if($===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null}),ie===Sa&&(te=!0);else if((dr&$)===$){J=J.next,$===Sa&&(te=!0);continue}else ie={lane:0,revertLane:J.revertLane,gesture:null,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(w=U=ie,S=v):U=U.next=ie,ke.lanes|=$,os|=$;ie=J.action,_o&&u(v,ie),v=J.hasEagerState?J.eagerState:u(v,ie)}else $={lane:ie,revertLane:J.revertLane,gesture:J.gesture,action:J.action,hasEagerState:J.hasEagerState,eagerState:J.eagerState,next:null},U===null?(w=U=$,S=v):U=U.next=$,ke.lanes|=ie,os|=ie;J=J.next}while(J!==null&&J!==o);if(U===null?S=v:U.next=w,!kn(v,r.memoizedState)&&(Ft=!0,te&&(u=Ia,u!==null)))throw u;r.memoizedState=v,r.baseState=S,r.baseQueue=U,c.lastRenderedState=v}return y===null&&(c.lanes=0),[r.memoizedState,c.dispatch]}function dm(r){var o=bt(),u=o.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=r;var c=u.dispatch,y=u.pending,v=o.memoizedState;if(y!==null){u.pending=null;var S=y=y.next;do v=r(v,S.action),S=S.next;while(S!==y);kn(v,o.memoizedState)||(Ft=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),u.lastRenderedState=v}return[v,c]}function iE(r,o,u){var c=ke,y=bt(),v=Je;if(v){if(u===void 0)throw Error(i(407));u=u()}else u=o();var S=!kn((ut||y).memoizedState,u);if(S&&(y.memoizedState=u,Ft=!0),y=y.queue,pm(oE.bind(null,c,y,r),[r]),y.getSnapshot!==o||S||Ot!==null&&Ot.memoizedState.tag&1){if(c.flags|=2048,Na(9,{destroy:void 0},sE.bind(null,c,y,u,o),null),ft===null)throw Error(i(349));v||(dr&127)!==0||rE(c,o,u)}return u}function rE(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=ke.updateQueue,o===null?(o=Yd(),ke.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function sE(r,o,u,c){o.value=u,o.getSnapshot=c,aE(o)&&lE(r)}function oE(r,o,u){return u(function(){aE(o)&&lE(r)})}function aE(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!kn(r,u)}catch{return!0}}function lE(r){var o=lo(r,2);o!==null&&xn(o,r,2)}function fm(r){var o=vn();if(typeof r=="function"){var u=r;if(r=u(),_o){Kn(!0);try{u()}finally{Kn(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fr,lastRenderedState:r},o}function uE(r,o,u,c){return r.baseState=u,cm(r,ut,typeof c=="function"?c:fr)}function T1(r,o,u,c,y){if(Zd(r))throw Error(i(485));if(r=o.action,r!==null){var v={payload:y,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){v.listeners.push(S)}};Y.T!==null?u(!0):v.isTransition=!1,c(v),u=o.pending,u===null?(v.next=o.pending=v,cE(o,v)):(v.next=u.next,o.pending=u.next=v)}}function cE(r,o){var u=o.action,c=o.payload,y=r.state;if(o.isTransition){var v=Y.T,S={};Y.T=S;try{var w=u(y,c),U=Y.S;U!==null&&U(S,w),dE(r,o,w)}catch(J){hm(r,o,J)}finally{v!==null&&S.types!==null&&(v.types=S.types),Y.T=v}}else try{v=u(y,c),dE(r,o,v)}catch(J){hm(r,o,J)}}function dE(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(c){fE(r,o,c)},function(c){return hm(r,o,c)}):fE(r,o,u)}function fE(r,o,u){o.status="fulfilled",o.value=u,hE(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,cE(r,u)))}function hm(r,o,u){var c=r.pending;if(r.pending=null,c!==null){c=c.next;do o.status="rejected",o.reason=u,hE(o),o=o.next;while(o!==c)}r.action=null}function hE(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function pE(r,o){return o}function mE(r,o){if(Je){var u=ft.formState;if(u!==null){e:{var c=ke;if(Je){if(pt){t:{for(var y=pt,v=ei;y.nodeType!==8;){if(!v){y=null;break t}if(y=ni(y.nextSibling),y===null){y=null;break t}}v=y.data,y=v==="F!"||v==="F"?y:null}if(y){pt=ni(y.nextSibling),c=y.data==="F!";break e}}Wr(c)}c=!1}c&&(o=u[0])}}return u=vn(),u.memoizedState=u.baseState=o,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pE,lastRenderedState:o},u.queue=c,u=kE.bind(null,ke,c),c.dispatch=u,c=fm(!1),v=vm.bind(null,ke,!1,c.queue),c=vn(),y={state:o,dispatch:null,action:r,pending:null},c.queue=y,u=T1.bind(null,ke,y,v,u),y.dispatch=u,c.memoizedState=r,[o,u,!1]}function gE(r){var o=bt();return yE(o,ut,r)}function yE(r,o,u){if(o=cm(r,o,pE)[0],r=Qd(fr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var c=wu(o)}catch(S){throw S===Ca?Fd:S}else c=o;o=bt();var y=o.queue,v=y.dispatch;return u!==o.memoizedState&&(ke.flags|=2048,Na(9,{destroy:void 0},A1.bind(null,y,u),null)),[c,v,r]}function A1(r,o){r.action=o}function _E(r){var o=bt(),u=ut;if(u!==null)return yE(o,u,r);bt(),o=o.memoizedState,u=bt();var c=u.queue.dispatch;return u.memoizedState=r,[o,c,!1]}function Na(r,o,u,c){return r={tag:r,create:u,deps:c,inst:o,next:null},o=ke.updateQueue,o===null&&(o=Yd(),ke.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(c=u.next,u.next=r,r.next=c,o.lastEffect=r),r}function vE(){return bt().memoizedState}function Xd(r,o,u,c){var y=vn();ke.flags|=r,y.memoizedState=Na(1|o,{destroy:void 0},u,c===void 0?null:c)}function Wd(r,o,u,c){var y=bt();c=c===void 0?null:c;var v=y.memoizedState.inst;ut!==null&&c!==null&&rm(c,ut.memoizedState.deps)?y.memoizedState=Na(o,v,u,c):(ke.flags|=r,y.memoizedState=Na(1|o,v,u,c))}function EE(r,o){Xd(8390656,8,r,o)}function pm(r,o){Wd(2048,8,r,o)}function S1(r){ke.flags|=4;var o=ke.updateQueue;if(o===null)o=Yd(),ke.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function TE(r){var o=bt().memoizedState;return S1({ref:o,nextImpl:r}),function(){if((et&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function AE(r,o){return Wd(4,2,r,o)}function SE(r,o){return Wd(4,4,r,o)}function IE(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function CE(r,o,u){u=u!=null?u.concat([r]):null,Wd(4,4,IE.bind(null,o,r),u)}function mm(){}function wE(r,o){var u=bt();o=o===void 0?null:o;var c=u.memoizedState;return o!==null&&rm(o,c[1])?c[0]:(u.memoizedState=[r,o],r)}function RE(r,o){var u=bt();o=o===void 0?null:o;var c=u.memoizedState;if(o!==null&&rm(o,c[1]))return c[0];if(c=r(),_o){Kn(!0);try{r()}finally{Kn(!1)}}return u.memoizedState=[c,o],c}function gm(r,o,u){return u===void 0||(dr&1073741824)!==0&&(qe&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=bT(),ke.lanes|=r,os|=r,u)}function bE(r,o,u,c){return kn(u,o)?u:Ra.current!==null?(r=gm(r,u,c),kn(r,o)||(Ft=!0),r):(dr&42)===0||(dr&1073741824)!==0&&(qe&261930)===0?(Ft=!0,r.memoizedState=u):(r=bT(),ke.lanes|=r,os|=r,o)}function xE(r,o,u,c,y){var v=oe.p;oe.p=v!==0&&8>v?v:8;var S=Y.T,w={};Y.T=w,vm(r,!1,o,u);try{var U=y(),J=Y.S;if(J!==null&&J(w,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var te=_1(U,c);Ru(r,o,te,Bn(r))}else Ru(r,o,c,Bn(r))}catch(ie){Ru(r,o,{then:function(){},status:"rejected",reason:ie},Bn())}finally{oe.p=v,S!==null&&w.types!==null&&(S.types=w.types),Y.T=S}}function I1(){}function ym(r,o,u,c){if(r.tag!==5)throw Error(i(476));var y=NE(r).queue;xE(r,y,o,_e,u===null?I1:function(){return DE(r),u(c)})}function NE(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:_e,baseState:_e,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fr,lastRenderedState:_e},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fr,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function DE(r){var o=NE(r);o.next===null&&(o=r.alternate.memoizedState),Ru(r,o.next.queue,{},Bn())}function _m(){return sn(Hu)}function ME(){return bt().memoizedState}function PE(){return bt().memoizedState}function C1(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=Bn();r=es(u);var c=ts(o,r,u);c!==null&&(xn(c,o,u),Au(c,o,u)),o={cache:Yp()},r.payload=o;return}o=o.return}}function w1(r,o,u){var c=Bn();u={lane:c,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Zd(r)?VE(o,u):(u=Lp(r,o,u,c),u!==null&&(xn(u,r,c),LE(u,o,c)))}function kE(r,o,u){var c=Bn();Ru(r,o,u,c)}function Ru(r,o,u,c){var y={lane:c,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Zd(r))VE(o,y);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var S=o.lastRenderedState,w=v(S,u);if(y.hasEagerState=!0,y.eagerState=w,kn(w,S))return Md(r,o,y,0),ft===null&&Dd(),!1}catch{}finally{}if(u=Lp(r,o,y,c),u!==null)return xn(u,r,c),LE(u,o,c),!0}return!1}function vm(r,o,u,c){if(c={lane:2,revertLane:Wm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Zd(r)){if(o)throw Error(i(479))}else o=Lp(r,u,c,2),o!==null&&xn(o,r,2)}function Zd(r){var o=r.alternate;return r===ke||o!==null&&o===ke}function VE(r,o){ba=Kd=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function LE(r,o,u){if((u&4194048)!==0){var c=o.lanes;c&=r.pendingLanes,u|=c,o.lanes=u,Ql(r,u)}}var bu={readContext:sn,use:$d,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useLayoutEffect:Tt,useInsertionEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useSyncExternalStore:Tt,useId:Tt,useHostTransitionStatus:Tt,useFormState:Tt,useActionState:Tt,useOptimistic:Tt,useMemoCache:Tt,useCacheRefresh:Tt};bu.useEffectEvent=Tt;var UE={readContext:sn,use:$d,useCallback:function(r,o){return vn().memoizedState=[r,o===void 0?null:o],r},useContext:sn,useEffect:EE,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,Xd(4194308,4,IE.bind(null,o,r),u)},useLayoutEffect:function(r,o){return Xd(4194308,4,r,o)},useInsertionEffect:function(r,o){Xd(4,2,r,o)},useMemo:function(r,o){var u=vn();o=o===void 0?null:o;var c=r();if(_o){Kn(!0);try{r()}finally{Kn(!1)}}return u.memoizedState=[c,o],c},useReducer:function(r,o,u){var c=vn();if(u!==void 0){var y=u(o);if(_o){Kn(!0);try{u(o)}finally{Kn(!1)}}}else y=o;return c.memoizedState=c.baseState=y,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:y},c.queue=r,r=r.dispatch=w1.bind(null,ke,r),[c.memoizedState,r]},useRef:function(r){var o=vn();return r={current:r},o.memoizedState=r},useState:function(r){r=fm(r);var o=r.queue,u=kE.bind(null,ke,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:mm,useDeferredValue:function(r,o){var u=vn();return gm(u,r,o)},useTransition:function(){var r=fm(!1);return r=xE.bind(null,ke,r.queue,!0,!1),vn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var c=ke,y=vn();if(Je){if(u===void 0)throw Error(i(407));u=u()}else{if(u=o(),ft===null)throw Error(i(349));(qe&127)!==0||rE(c,o,u)}y.memoizedState=u;var v={value:u,getSnapshot:o};return y.queue=v,EE(oE.bind(null,c,v,r),[r]),c.flags|=2048,Na(9,{destroy:void 0},sE.bind(null,c,v,u,o),null),u},useId:function(){var r=vn(),o=ft.identifierPrefix;if(Je){var u=Ki,c=Hi;u=(c&~(1<<32-Ct(c)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Jd++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=v1++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:_m,useFormState:mE,useActionState:mE,useOptimistic:function(r){var o=vn();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=vm.bind(null,ke,!0,u),u.dispatch=o,[r,o]},useMemoCache:um,useCacheRefresh:function(){return vn().memoizedState=C1.bind(null,ke)},useEffectEvent:function(r){var o=vn(),u={impl:r};return o.memoizedState=u,function(){if((et&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},Em={readContext:sn,use:$d,useCallback:wE,useContext:sn,useEffect:pm,useImperativeHandle:CE,useInsertionEffect:AE,useLayoutEffect:SE,useMemo:RE,useReducer:Qd,useRef:vE,useState:function(){return Qd(fr)},useDebugValue:mm,useDeferredValue:function(r,o){var u=bt();return bE(u,ut.memoizedState,r,o)},useTransition:function(){var r=Qd(fr)[0],o=bt().memoizedState;return[typeof r=="boolean"?r:wu(r),o]},useSyncExternalStore:iE,useId:ME,useHostTransitionStatus:_m,useFormState:gE,useActionState:gE,useOptimistic:function(r,o){var u=bt();return uE(u,ut,r,o)},useMemoCache:um,useCacheRefresh:PE};Em.useEffectEvent=TE;var OE={readContext:sn,use:$d,useCallback:wE,useContext:sn,useEffect:pm,useImperativeHandle:CE,useInsertionEffect:AE,useLayoutEffect:SE,useMemo:RE,useReducer:dm,useRef:vE,useState:function(){return dm(fr)},useDebugValue:mm,useDeferredValue:function(r,o){var u=bt();return ut===null?gm(u,r,o):bE(u,ut.memoizedState,r,o)},useTransition:function(){var r=dm(fr)[0],o=bt().memoizedState;return[typeof r=="boolean"?r:wu(r),o]},useSyncExternalStore:iE,useId:ME,useHostTransitionStatus:_m,useFormState:_E,useActionState:_E,useOptimistic:function(r,o){var u=bt();return ut!==null?uE(u,ut,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:um,useCacheRefresh:PE};OE.useEffectEvent=TE;function Tm(r,o,u,c){o=r.memoizedState,u=u(c,o),u=u==null?o:E({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var Am={enqueueSetState:function(r,o,u){r=r._reactInternals;var c=Bn(),y=es(c);y.payload=o,u!=null&&(y.callback=u),o=ts(r,y,c),o!==null&&(xn(o,r,c),Au(o,r,c))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var c=Bn(),y=es(c);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=ts(r,y,c),o!==null&&(xn(o,r,c),Au(o,r,c))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=Bn(),c=es(u);c.tag=2,o!=null&&(c.callback=o),o=ts(r,c,u),o!==null&&(xn(o,r,u),Au(o,r,u))}};function FE(r,o,u,c,y,v,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(c,v,S):o.prototype&&o.prototype.isPureReactComponent?!pu(u,c)||!pu(y,v):!0}function BE(r,o,u,c){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,c),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,c),o.state!==r&&Am.enqueueReplaceState(o,o.state,null)}function vo(r,o){var u=o;if("ref"in o){u={};for(var c in o)c!=="ref"&&(u[c]=o[c])}if(r=r.defaultProps){u===o&&(u=E({},u));for(var y in r)u[y]===void 0&&(u[y]=r[y])}return u}function qE(r){Nd(r)}function GE(r){console.error(r)}function zE(r){Nd(r)}function jd(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(c){setTimeout(function(){throw c})}}function HE(r,o,u){try{var c=r.onCaughtError;c(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Sm(r,o,u){return u=es(u),u.tag=3,u.payload={element:null},u.callback=function(){jd(r,o)},u}function KE(r){return r=es(r),r.tag=3,r}function JE(r,o,u,c){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var v=c.value;r.payload=function(){return y(v)},r.callback=function(){HE(o,u,c)}}var S=u.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){HE(o,u,c),typeof y!="function"&&(as===null?as=new Set([this]):as.add(this));var w=c.stack;this.componentDidCatch(c.value,{componentStack:w!==null?w:""})})}function R1(r,o,u,c,y){if(u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(o=u.alternate,o!==null&&Aa(o,u,y,!0),u=Ln.current,u!==null){switch(u.tag){case 31:case 13:return ti===null?ff():u.alternate===null&&At===0&&(At=3),u.flags&=-257,u.flags|=65536,u.lanes=y,c===Bd?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([c]):o.add(c),$m(r,c,y)),!1;case 22:return u.flags|=65536,c===Bd?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([c])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([c]):u.add(c)),$m(r,c,y)),!1}throw Error(i(435,u.tag))}return $m(r,c,y),ff(),!1}if(Je)return o=Ln.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,c!==Gp&&(r=Error(i(422),{cause:c}),yu(Wn(r,u)))):(c!==Gp&&(o=Error(i(423),{cause:c}),yu(Wn(o,u))),r=r.current.alternate,r.flags|=65536,y&=-y,r.lanes|=y,c=Wn(c,u),y=Sm(r.stateNode,c,y),jp(r,y),At!==4&&(At=2)),!1;var v=Error(i(520),{cause:c});if(v=Wn(v,u),Lu===null?Lu=[v]:Lu.push(v),At!==4&&(At=2),o===null)return!0;c=Wn(c,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=y&-y,u.lanes|=r,r=Sm(u.stateNode,c,r),jp(u,r),!1;case 1:if(o=u.type,v=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(as===null||!as.has(v))))return u.flags|=65536,y&=-y,u.lanes|=y,y=KE(y),JE(y,r,u,c),jp(u,y),!1}u=u.return}while(u!==null);return!1}var Im=Error(i(461)),Ft=!1;function on(r,o,u,c){o.child=r===null?Xv(o,null,u,c):yo(o,r.child,u,c)}function YE(r,o,u,c,y){u=u.render;var v=o.ref;if("ref"in c){var S={};for(var w in c)w!=="ref"&&(S[w]=c[w])}else S=c;return ho(o),c=sm(r,o,u,S,v,y),w=om(),r!==null&&!Ft?(am(r,o,y),hr(r,o,y)):(Je&&w&&Bp(o),o.flags|=1,on(r,o,c,y),o.child)}function $E(r,o,u,c,y){if(r===null){var v=u.type;return typeof v=="function"&&!Up(v)&&v.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=v,QE(r,o,v,c,y)):(r=kd(u.type,null,c,o,o.mode,y),r.ref=o.ref,r.return=o,o.child=r)}if(v=r.child,!Mm(r,y)){var S=v.memoizedProps;if(u=u.compare,u=u!==null?u:pu,u(S,c)&&r.ref===o.ref)return hr(r,o,y)}return o.flags|=1,r=ar(v,c),r.ref=o.ref,r.return=o,o.child=r}function QE(r,o,u,c,y){if(r!==null){var v=r.memoizedProps;if(pu(v,c)&&r.ref===o.ref)if(Ft=!1,o.pendingProps=c=v,Mm(r,y))(r.flags&131072)!==0&&(Ft=!0);else return o.lanes=r.lanes,hr(r,o,y)}return Cm(r,o,u,c,y)}function XE(r,o,u,c){var y=c.children,v=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((o.flags&128)!==0){if(v=v!==null?v.baseLanes|u:u,r!==null){for(c=o.child=r.child,y=0;c!==null;)y=y|c.lanes|c.childLanes,c=c.sibling;c=y&~v}else c=0,o.child=null;return WE(r,o,v,u,c)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Od(o,v!==null?v.cachePool:null),v!==null?jv(o,v):tm(),eE(o);else return c=o.lanes=536870912,WE(r,o,v!==null?v.baseLanes|u:u,u,c)}else v!==null?(Od(o,v.cachePool),jv(o,v),is(),o.memoizedState=null):(r!==null&&Od(o,null),tm(),is());return on(r,o,y,u),o.child}function xu(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function WE(r,o,u,c,y){var v=Qp();return v=v===null?null:{parent:Ut._currentValue,pool:v},o.memoizedState={baseLanes:u,cachePool:v},r!==null&&Od(o,null),tm(),eE(o),r!==null&&Aa(r,o,c,!0),o.childLanes=y,null}function ef(r,o){return o=nf({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function ZE(r,o,u){return yo(o,r.child,null,u),r=ef(o,o.pendingProps),r.flags|=2,Un(o),o.memoizedState=null,r}function b1(r,o,u){var c=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Je){if(c.mode==="hidden")return r=ef(o,c),o.lanes=536870912,xu(null,r);if(im(o),(r=pt)?(r=c0(r,ei),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Qr!==null?{id:Hi,overflow:Ki}:null,retryLane:536870912,hydrationErrors:null},u=Vv(r),u.return=o,o.child=u,rn=o,pt=null)):r=null,r===null)throw Wr(o);return o.lanes=536870912,null}return ef(o,c)}var v=r.memoizedState;if(v!==null){var S=v.dehydrated;if(im(o),y)if(o.flags&256)o.flags&=-257,o=ZE(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(i(558));else if(Ft||Aa(r,o,u,!1),y=(u&r.childLanes)!==0,Ft||y){if(c=ft,c!==null&&(S=Xl(c,u),S!==0&&S!==v.retryLane))throw v.retryLane=S,lo(r,S),xn(c,r,S),Im;ff(),o=ZE(r,o,u)}else r=v.treeContext,pt=ni(S.nextSibling),rn=o,Je=!0,Xr=null,ei=!1,r!==null&&Ov(o,r),o=ef(o,c),o.flags|=4096;return o}return r=ar(r.child,{mode:c.mode,children:c.children}),r.ref=o.ref,o.child=r,r.return=o,r}function tf(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function Cm(r,o,u,c,y){return ho(o),u=sm(r,o,u,c,void 0,y),c=om(),r!==null&&!Ft?(am(r,o,y),hr(r,o,y)):(Je&&c&&Bp(o),o.flags|=1,on(r,o,u,y),o.child)}function jE(r,o,u,c,y,v){return ho(o),o.updateQueue=null,u=nE(o,c,u,y),tE(r),c=om(),r!==null&&!Ft?(am(r,o,v),hr(r,o,v)):(Je&&c&&Bp(o),o.flags|=1,on(r,o,u,v),o.child)}function eT(r,o,u,c,y){if(ho(o),o.stateNode===null){var v=_a,S=u.contextType;typeof S=="object"&&S!==null&&(v=sn(S)),v=new u(c,v),o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Am,o.stateNode=v,v._reactInternals=o,v=o.stateNode,v.props=c,v.state=o.memoizedState,v.refs={},Wp(o),S=u.contextType,v.context=typeof S=="object"&&S!==null?sn(S):_a,v.state=o.memoizedState,S=u.getDerivedStateFromProps,typeof S=="function"&&(Tm(o,u,S,c),v.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(S=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),S!==v.state&&Am.enqueueReplaceState(v,v.state,null),Iu(o,c,v,y),Su(),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308),c=!0}else if(r===null){v=o.stateNode;var w=o.memoizedProps,U=vo(u,w);v.props=U;var J=v.context,te=u.contextType;S=_a,typeof te=="object"&&te!==null&&(S=sn(te));var ie=u.getDerivedStateFromProps;te=typeof ie=="function"||typeof v.getSnapshotBeforeUpdate=="function",w=o.pendingProps!==w,te||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w||J!==S)&&BE(o,v,c,S),jr=!1;var $=o.memoizedState;v.state=$,Iu(o,c,v,y),Su(),J=o.memoizedState,w||$!==J||jr?(typeof ie=="function"&&(Tm(o,u,ie,c),J=o.memoizedState),(U=jr||FE(o,u,U,c,$,J,S))?(te||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(o.flags|=4194308)):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=c,o.memoizedState=J),v.props=c,v.state=J,v.context=S,c=U):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),c=!1)}else{v=o.stateNode,Zp(r,o),S=o.memoizedProps,te=vo(u,S),v.props=te,ie=o.pendingProps,$=v.context,J=u.contextType,U=_a,typeof J=="object"&&J!==null&&(U=sn(J)),w=u.getDerivedStateFromProps,(J=typeof w=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(S!==ie||$!==U)&&BE(o,v,c,U),jr=!1,$=o.memoizedState,v.state=$,Iu(o,c,v,y),Su();var Z=o.memoizedState;S!==ie||$!==Z||jr||r!==null&&r.dependencies!==null&&Ld(r.dependencies)?(typeof w=="function"&&(Tm(o,u,w,c),Z=o.memoizedState),(te=jr||FE(o,u,te,c,$,Z,U)||r!==null&&r.dependencies!==null&&Ld(r.dependencies))?(J||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,Z,U),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,Z,U)),typeof v.componentDidUpdate=="function"&&(o.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof v.componentDidUpdate!="function"||S===r.memoizedProps&&$===r.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&$===r.memoizedState||(o.flags|=1024),o.memoizedProps=c,o.memoizedState=Z),v.props=c,v.state=Z,v.context=U,c=te):(typeof v.componentDidUpdate!="function"||S===r.memoizedProps&&$===r.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&$===r.memoizedState||(o.flags|=1024),c=!1)}return v=c,tf(r,o),c=(o.flags&128)!==0,v||c?(v=o.stateNode,u=c&&typeof u.getDerivedStateFromError!="function"?null:v.render(),o.flags|=1,r!==null&&c?(o.child=yo(o,r.child,null,y),o.child=yo(o,null,u,y)):on(r,o,u,y),o.memoizedState=v.state,r=o.child):r=hr(r,o,y),r}function tT(r,o,u,c){return co(),o.flags|=256,on(r,o,u,c),o.child}var wm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Rm(r){return{baseLanes:r,cachePool:Hv()}}function bm(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=Fn),r}function nT(r,o,u){var c=o.pendingProps,y=!1,v=(o.flags&128)!==0,S;if((S=v)||(S=r!==null&&r.memoizedState===null?!1:(Rt.current&2)!==0),S&&(y=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,r===null){if(Je){if(y?ns(o):is(),(r=pt)?(r=c0(r,ei),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Qr!==null?{id:Hi,overflow:Ki}:null,retryLane:536870912,hydrationErrors:null},u=Vv(r),u.return=o,o.child=u,rn=o,pt=null)):r=null,r===null)throw Wr(o);return cg(r)?o.lanes=32:o.lanes=536870912,null}var w=c.children;return c=c.fallback,y?(is(),y=o.mode,w=nf({mode:"hidden",children:w},y),c=uo(c,y,u,null),w.return=o,c.return=o,w.sibling=c,o.child=w,c=o.child,c.memoizedState=Rm(u),c.childLanes=bm(r,S,u),o.memoizedState=wm,xu(null,c)):(ns(o),xm(o,w))}var U=r.memoizedState;if(U!==null&&(w=U.dehydrated,w!==null)){if(v)o.flags&256?(ns(o),o.flags&=-257,o=Nm(r,o,u)):o.memoizedState!==null?(is(),o.child=r.child,o.flags|=128,o=null):(is(),w=c.fallback,y=o.mode,c=nf({mode:"visible",children:c.children},y),w=uo(w,y,u,null),w.flags|=2,c.return=o,w.return=o,c.sibling=w,o.child=c,yo(o,r.child,null,u),c=o.child,c.memoizedState=Rm(u),c.childLanes=bm(r,S,u),o.memoizedState=wm,o=xu(null,c));else if(ns(o),cg(w)){if(S=w.nextSibling&&w.nextSibling.dataset,S)var J=S.dgst;S=J,c=Error(i(419)),c.stack="",c.digest=S,yu({value:c,source:null,stack:null}),o=Nm(r,o,u)}else if(Ft||Aa(r,o,u,!1),S=(u&r.childLanes)!==0,Ft||S){if(S=ft,S!==null&&(c=Xl(S,u),c!==0&&c!==U.retryLane))throw U.retryLane=c,lo(r,c),xn(S,r,c),Im;ug(w)||ff(),o=Nm(r,o,u)}else ug(w)?(o.flags|=192,o.child=r.child,o=null):(r=U.treeContext,pt=ni(w.nextSibling),rn=o,Je=!0,Xr=null,ei=!1,r!==null&&Ov(o,r),o=xm(o,c.children),o.flags|=4096);return o}return y?(is(),w=c.fallback,y=o.mode,U=r.child,J=U.sibling,c=ar(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,J!==null?w=ar(J,w):(w=uo(w,y,u,null),w.flags|=2),w.return=o,c.return=o,c.sibling=w,o.child=c,xu(null,c),c=o.child,w=r.child.memoizedState,w===null?w=Rm(u):(y=w.cachePool,y!==null?(U=Ut._currentValue,y=y.parent!==U?{parent:U,pool:U}:y):y=Hv(),w={baseLanes:w.baseLanes|u,cachePool:y}),c.memoizedState=w,c.childLanes=bm(r,S,u),o.memoizedState=wm,xu(r.child,c)):(ns(o),u=r.child,r=u.sibling,u=ar(u,{mode:"visible",children:c.children}),u.return=o,u.sibling=null,r!==null&&(S=o.deletions,S===null?(o.deletions=[r],o.flags|=16):S.push(r)),o.child=u,o.memoizedState=null,u)}function xm(r,o){return o=nf({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function nf(r,o){return r=Vn(22,r,null,o),r.lanes=0,r}function Nm(r,o,u){return yo(o,r.child,null,u),r=xm(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function iT(r,o,u){r.lanes|=o;var c=r.alternate;c!==null&&(c.lanes|=o),Kp(r.return,o,u)}function Dm(r,o,u,c,y,v){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:c,tail:u,tailMode:y,treeForkCount:v}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=c,S.tail=u,S.tailMode=y,S.treeForkCount=v)}function rT(r,o,u){var c=o.pendingProps,y=c.revealOrder,v=c.tail;c=c.children;var S=Rt.current,w=(S&2)!==0;if(w?(S=S&1|2,o.flags|=128):S&=1,he(Rt,S),on(r,o,c,u),c=Je?gu:0,!w&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&iT(r,u,o);else if(r.tag===19)iT(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(y){case"forwards":for(u=o.child,y=null;u!==null;)r=u.alternate,r!==null&&Hd(r)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),Dm(o,!1,y,u,v,c);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(r=y.alternate,r!==null&&Hd(r)===null){o.child=y;break}r=y.sibling,y.sibling=u,u=y,y=r}Dm(o,!0,u,null,v,c);break;case"together":Dm(o,!1,null,null,void 0,c);break;default:o.memoizedState=null}return o.child}function hr(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),os|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(Aa(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(i(153));if(o.child!==null){for(r=o.child,u=ar(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=ar(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function Mm(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Ld(r)))}function x1(r,o,u){switch(o.tag){case 3:Ht(o,o.stateNode.containerInfo),Zr(o,Ut,r.memoizedState.cache),co();break;case 27:case 5:Hs(o);break;case 4:Ht(o,o.stateNode.containerInfo);break;case 10:Zr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,im(o),null;break;case 13:var c=o.memoizedState;if(c!==null)return c.dehydrated!==null?(ns(o),o.flags|=128,null):(u&o.child.childLanes)!==0?nT(r,o,u):(ns(o),r=hr(r,o,u),r!==null?r.sibling:null);ns(o);break;case 19:var y=(r.flags&128)!==0;if(c=(u&o.childLanes)!==0,c||(Aa(r,o,u,!1),c=(u&o.childLanes)!==0),y){if(c)return rT(r,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),he(Rt,Rt.current),c)break;return null;case 22:return o.lanes=0,XE(r,o,u,o.pendingProps);case 24:Zr(o,Ut,r.memoizedState.cache)}return hr(r,o,u)}function sT(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)Ft=!0;else{if(!Mm(r,u)&&(o.flags&128)===0)return Ft=!1,x1(r,o,u);Ft=(r.flags&131072)!==0}else Ft=!1,Je&&(o.flags&1048576)!==0&&Uv(o,gu,o.index);switch(o.lanes=0,o.tag){case 16:e:{var c=o.pendingProps;if(r=mo(o.elementType),o.type=r,typeof r=="function")Up(r)?(c=vo(r,c),o.tag=1,o=eT(null,o,r,c,u)):(o.tag=0,o=Cm(null,o,r,c,u));else{if(r!=null){var y=r.$$typeof;if(y===se){o.tag=11,o=YE(null,o,r,c,u);break e}else if(y===N){o.tag=14,o=$E(null,o,r,c,u);break e}}throw o=me(r)||r,Error(i(306,o,""))}}return o;case 0:return Cm(r,o,o.type,o.pendingProps,u);case 1:return c=o.type,y=vo(c,o.pendingProps),eT(r,o,c,y,u);case 3:e:{if(Ht(o,o.stateNode.containerInfo),r===null)throw Error(i(387));c=o.pendingProps;var v=o.memoizedState;y=v.element,Zp(r,o),Iu(o,c,null,u);var S=o.memoizedState;if(c=S.cache,Zr(o,Ut,c),c!==v.cache&&Jp(o,[Ut],u,!0),Su(),c=S.element,v.isDehydrated)if(v={element:c,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=tT(r,o,c,u);break e}else if(c!==y){y=Wn(Error(i(424)),o),yu(y),o=tT(r,o,c,u);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(pt=ni(r.firstChild),rn=o,Je=!0,Xr=null,ei=!0,u=Xv(o,null,c,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(co(),c===y){o=hr(r,o,u);break e}on(r,o,c,u)}o=o.child}return o;case 26:return tf(r,o),r===null?(u=g0(o.type,null,o.pendingProps,null))?o.memoizedState=u:Je||(u=o.type,r=o.pendingProps,c=vf(Ve.current).createElement(u),c[kt]=o,c[Xt]=r,an(c,u,r),Vt(c),o.stateNode=c):o.memoizedState=g0(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Hs(o),r===null&&Je&&(c=o.stateNode=h0(o.type,o.pendingProps,Ve.current),rn=o,ei=!0,y=pt,ds(o.type)?(dg=y,pt=ni(c.firstChild)):pt=y),on(r,o,o.pendingProps.children,u),tf(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Je&&((y=c=pt)&&(c=sN(c,o.type,o.pendingProps,ei),c!==null?(o.stateNode=c,rn=o,pt=ni(c.firstChild),ei=!1,y=!0):y=!1),y||Wr(o)),Hs(o),y=o.type,v=o.pendingProps,S=r!==null?r.memoizedProps:null,c=v.children,og(y,v)?c=null:S!==null&&og(y,S)&&(o.flags|=32),o.memoizedState!==null&&(y=sm(r,o,E1,null,null,u),Hu._currentValue=y),tf(r,o),on(r,o,c,u),o.child;case 6:return r===null&&Je&&((r=u=pt)&&(u=oN(u,o.pendingProps,ei),u!==null?(o.stateNode=u,rn=o,pt=null,r=!0):r=!1),r||Wr(o)),null;case 13:return nT(r,o,u);case 4:return Ht(o,o.stateNode.containerInfo),c=o.pendingProps,r===null?o.child=yo(o,null,c,u):on(r,o,c,u),o.child;case 11:return YE(r,o,o.type,o.pendingProps,u);case 7:return on(r,o,o.pendingProps,u),o.child;case 8:return on(r,o,o.pendingProps.children,u),o.child;case 12:return on(r,o,o.pendingProps.children,u),o.child;case 10:return c=o.pendingProps,Zr(o,o.type,c.value),on(r,o,c.children,u),o.child;case 9:return y=o.type._context,c=o.pendingProps.children,ho(o),y=sn(y),c=c(y),o.flags|=1,on(r,o,c,u),o.child;case 14:return $E(r,o,o.type,o.pendingProps,u);case 15:return QE(r,o,o.type,o.pendingProps,u);case 19:return rT(r,o,u);case 31:return b1(r,o,u);case 22:return XE(r,o,u,o.pendingProps);case 24:return ho(o),c=sn(Ut),r===null?(y=Qp(),y===null&&(y=ft,v=Yp(),y.pooledCache=v,v.refCount++,v!==null&&(y.pooledCacheLanes|=u),y=v),o.memoizedState={parent:c,cache:y},Wp(o),Zr(o,Ut,y)):((r.lanes&u)!==0&&(Zp(r,o),Iu(o,null,null,u),Su()),y=r.memoizedState,v=o.memoizedState,y.parent!==c?(y={parent:c,cache:c},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),Zr(o,Ut,c)):(c=v.cache,Zr(o,Ut,c),c!==y.cache&&Jp(o,[Ut],u,!0))),on(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function pr(r){r.flags|=4}function Pm(r,o,u,c,y){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(y&335544128)===y)if(r.stateNode.complete)r.flags|=8192;else if(MT())r.flags|=8192;else throw go=Bd,Xp}else r.flags&=-16777217}function oT(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!T0(o))if(MT())r.flags|=8192;else throw go=Bd,Xp}function rf(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?ud():536870912,r.lanes|=o,ka|=o)}function Nu(r,o){if(!Je)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var c=null;u!==null;)u.alternate!==null&&(c=u),u=u.sibling;c===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:c.sibling=null}}function mt(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,c=0;if(o)for(var y=r.child;y!==null;)u|=y.lanes|y.childLanes,c|=y.subtreeFlags&65011712,c|=y.flags&65011712,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)u|=y.lanes|y.childLanes,c|=y.subtreeFlags,c|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=c,r.childLanes=u,o}function N1(r,o,u){var c=o.pendingProps;switch(qp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(o),null;case 1:return mt(o),null;case 3:return u=o.stateNode,c=null,r!==null&&(c=r.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),cr(Ut),gt(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(Ta(o)?pr(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,zp())),mt(o),null;case 26:var y=o.type,v=o.memoizedState;return r===null?(pr(o),v!==null?(mt(o),oT(o,v)):(mt(o),Pm(o,y,null,c,u))):v?v!==r.memoizedState?(pr(o),mt(o),oT(o,v)):(mt(o),o.flags&=-16777217):(r=r.memoizedProps,r!==c&&pr(o),mt(o),Pm(o,y,r,c,u)),null;case 27:if(jo(o),u=Ve.current,y=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==c&&pr(o);else{if(!c){if(o.stateNode===null)throw Error(i(166));return mt(o),null}r=ge.current,Ta(o)?Fv(o):(r=h0(y,c,u),o.stateNode=r,pr(o))}return mt(o),null;case 5:if(jo(o),y=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==c&&pr(o);else{if(!c){if(o.stateNode===null)throw Error(i(166));return mt(o),null}if(v=ge.current,Ta(o))Fv(o);else{var S=vf(Ve.current);switch(v){case 1:v=S.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:v=S.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":v=S.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":v=S.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":v=S.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof c.is=="string"?S.createElement("select",{is:c.is}):S.createElement("select"),c.multiple?v.multiple=!0:c.size&&(v.size=c.size);break;default:v=typeof c.is=="string"?S.createElement(y,{is:c.is}):S.createElement(y)}}v[kt]=o,v[Xt]=c;e:for(S=o.child;S!==null;){if(S.tag===5||S.tag===6)v.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===o)break e;for(;S.sibling===null;){if(S.return===null||S.return===o)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}o.stateNode=v;e:switch(an(v,y,c),y){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&pr(o)}}return mt(o),Pm(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==c&&pr(o);else{if(typeof c!="string"&&o.stateNode===null)throw Error(i(166));if(r=Ve.current,Ta(o)){if(r=o.stateNode,u=o.memoizedProps,c=null,y=rn,y!==null)switch(y.tag){case 27:case 5:c=y.memoizedProps}r[kt]=o,r=!!(r.nodeValue===u||c!==null&&c.suppressHydrationWarning===!0||n0(r.nodeValue,u)),r||Wr(o,!0)}else r=vf(r).createTextNode(c),r[kt]=o,o.stateNode=r}return mt(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(c=Ta(o),u!==null){if(r===null){if(!c)throw Error(i(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[kt]=o}else co(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;mt(o),r=!1}else u=zp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(Un(o),o):(Un(o),null);if((o.flags&128)!==0)throw Error(i(558))}return mt(o),null;case 13:if(c=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(y=Ta(o),c!==null&&c.dehydrated!==null){if(r===null){if(!y)throw Error(i(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[kt]=o}else co(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;mt(o),y=!1}else y=zp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(Un(o),o):(Un(o),null)}return Un(o),(o.flags&128)!==0?(o.lanes=u,o):(u=c!==null,r=r!==null&&r.memoizedState!==null,u&&(c=o.child,y=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(y=c.alternate.memoizedState.cachePool.pool),v=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==y&&(c.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),rf(o,o.updateQueue),mt(o),null);case 4:return gt(),r===null&&tg(o.stateNode.containerInfo),mt(o),null;case 10:return cr(o.type),mt(o),null;case 19:if(re(Rt),c=o.memoizedState,c===null)return mt(o),null;if(y=(o.flags&128)!==0,v=c.rendering,v===null)if(y)Nu(c,!1);else{if(At!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(v=Hd(r),v!==null){for(o.flags|=128,Nu(c,!1),r=v.updateQueue,o.updateQueue=r,rf(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)kv(u,r),u=u.sibling;return he(Rt,Rt.current&1|2),Je&&lr(o,c.treeForkCount),o.child}r=r.sibling}c.tail!==null&&yn()>uf&&(o.flags|=128,y=!0,Nu(c,!1),o.lanes=4194304)}else{if(!y)if(r=Hd(v),r!==null){if(o.flags|=128,y=!0,r=r.updateQueue,o.updateQueue=r,rf(o,r),Nu(c,!0),c.tail===null&&c.tailMode==="hidden"&&!v.alternate&&!Je)return mt(o),null}else 2*yn()-c.renderingStartTime>uf&&u!==536870912&&(o.flags|=128,y=!0,Nu(c,!1),o.lanes=4194304);c.isBackwards?(v.sibling=o.child,o.child=v):(r=c.last,r!==null?r.sibling=v:o.child=v,c.last=v)}return c.tail!==null?(r=c.tail,c.rendering=r,c.tail=r.sibling,c.renderingStartTime=yn(),r.sibling=null,u=Rt.current,he(Rt,y?u&1|2:u&1),Je&&lr(o,c.treeForkCount),r):(mt(o),null);case 22:case 23:return Un(o),nm(),c=o.memoizedState!==null,r!==null?r.memoizedState!==null!==c&&(o.flags|=8192):c&&(o.flags|=8192),c?(u&536870912)!==0&&(o.flags&128)===0&&(mt(o),o.subtreeFlags&6&&(o.flags|=8192)):mt(o),u=o.updateQueue,u!==null&&rf(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),c=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(c=o.memoizedState.cachePool.pool),c!==u&&(o.flags|=2048),r!==null&&re(po),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),cr(Ut),mt(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function D1(r,o){switch(qp(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return cr(Ut),gt(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return jo(o),null;case 31:if(o.memoizedState!==null){if(Un(o),o.alternate===null)throw Error(i(340));co()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(Un(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(i(340));co()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return re(Rt),null;case 4:return gt(),null;case 10:return cr(o.type),null;case 22:case 23:return Un(o),nm(),r!==null&&re(po),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return cr(Ut),null;case 25:return null;default:return null}}function aT(r,o){switch(qp(o),o.tag){case 3:cr(Ut),gt();break;case 26:case 27:case 5:jo(o);break;case 4:gt();break;case 31:o.memoizedState!==null&&Un(o);break;case 13:Un(o);break;case 19:re(Rt);break;case 10:cr(o.type);break;case 22:case 23:Un(o),nm(),r!==null&&re(po);break;case 24:cr(Ut)}}function Du(r,o){try{var u=o.updateQueue,c=u!==null?u.lastEffect:null;if(c!==null){var y=c.next;u=y;do{if((u.tag&r)===r){c=void 0;var v=u.create,S=u.inst;c=v(),S.destroy=c}u=u.next}while(u!==y)}}catch(w){rt(o,o.return,w)}}function rs(r,o,u){try{var c=o.updateQueue,y=c!==null?c.lastEffect:null;if(y!==null){var v=y.next;c=v;do{if((c.tag&r)===r){var S=c.inst,w=S.destroy;if(w!==void 0){S.destroy=void 0,y=o;var U=u,J=w;try{J()}catch(te){rt(y,U,te)}}}c=c.next}while(c!==v)}}catch(te){rt(o,o.return,te)}}function lT(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{Zv(o,u)}catch(c){rt(r,r.return,c)}}}function uT(r,o,u){u.props=vo(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(c){rt(r,o,c)}}function Mu(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var c=r.stateNode;break;case 30:c=r.stateNode;break;default:c=r.stateNode}typeof u=="function"?r.refCleanup=u(c):u.current=c}}catch(y){rt(r,o,y)}}function Ji(r,o){var u=r.ref,c=r.refCleanup;if(u!==null)if(typeof c=="function")try{c()}catch(y){rt(r,o,y)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){rt(r,o,y)}else u.current=null}function cT(r){var o=r.type,u=r.memoizedProps,c=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&c.focus();break e;case"img":u.src?c.src=u.src:u.srcSet&&(c.srcset=u.srcSet)}}catch(y){rt(r,r.return,y)}}function km(r,o,u){try{var c=r.stateNode;j1(c,r.type,u,o),c[Xt]=o}catch(y){rt(r,r.return,y)}}function dT(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&ds(r.type)||r.tag===4}function Vm(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||dT(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&ds(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Lm(r,o,u){var c=r.tag;if(c===5||c===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=fi));else if(c!==4&&(c===27&&ds(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(Lm(r,o,u),r=r.sibling;r!==null;)Lm(r,o,u),r=r.sibling}function sf(r,o,u){var c=r.tag;if(c===5||c===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(c!==4&&(c===27&&ds(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(sf(r,o,u),r=r.sibling;r!==null;)sf(r,o,u),r=r.sibling}function fT(r){var o=r.stateNode,u=r.memoizedProps;try{for(var c=r.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);an(o,c,u),o[kt]=r,o[Xt]=u}catch(v){rt(r,r.return,v)}}var mr=!1,Bt=!1,Um=!1,hT=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function M1(r,o){if(r=r.containerInfo,rg=wf,r=Cv(r),Np(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var c=u.getSelection&&u.getSelection();if(c&&c.rangeCount!==0){u=c.anchorNode;var y=c.anchorOffset,v=c.focusNode;c=c.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var S=0,w=-1,U=-1,J=0,te=0,ie=r,$=null;t:for(;;){for(var Z;ie!==u||y!==0&&ie.nodeType!==3||(w=S+y),ie!==v||c!==0&&ie.nodeType!==3||(U=S+c),ie.nodeType===3&&(S+=ie.nodeValue.length),(Z=ie.firstChild)!==null;)$=ie,ie=Z;for(;;){if(ie===r)break t;if($===u&&++J===y&&(w=S),$===v&&++te===c&&(U=S),(Z=ie.nextSibling)!==null)break;ie=$,$=ie.parentNode}ie=Z}u=w===-1||U===-1?null:{start:w,end:U}}else u=null}u=u||{start:0,end:0}}else u=null;for(sg={focusedElem:r,selectionRange:u},wf=!1,Zt=o;Zt!==null;)if(o=Zt,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Zt=r;else for(;Zt!==null;){switch(o=Zt,v=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)y=r[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&v!==null){r=void 0,u=o,y=v.memoizedProps,v=v.memoizedState,c=u.stateNode;try{var ve=vo(u.type,y);r=c.getSnapshotBeforeUpdate(ve,v),c.__reactInternalSnapshotBeforeUpdate=r}catch(Re){rt(u,u.return,Re)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)lg(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":lg(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=o.sibling,r!==null){r.return=o.return,Zt=r;break}Zt=o.return}}function pT(r,o,u){var c=u.flags;switch(u.tag){case 0:case 11:case 15:yr(r,u),c&4&&Du(5,u);break;case 1:if(yr(r,u),c&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(S){rt(u,u.return,S)}else{var y=vo(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(y,o,r.__reactInternalSnapshotBeforeUpdate)}catch(S){rt(u,u.return,S)}}c&64&&lT(u),c&512&&Mu(u,u.return);break;case 3:if(yr(r,u),c&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Zv(r,o)}catch(S){rt(u,u.return,S)}}break;case 27:o===null&&c&4&&fT(u);case 26:case 5:yr(r,u),o===null&&c&4&&cT(u),c&512&&Mu(u,u.return);break;case 12:yr(r,u);break;case 31:yr(r,u),c&4&&yT(r,u);break;case 13:yr(r,u),c&4&&_T(r,u),c&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=q1.bind(null,u),aN(r,u))));break;case 22:if(c=u.memoizedState!==null||mr,!c){o=o!==null&&o.memoizedState!==null||Bt,y=mr;var v=Bt;mr=c,(Bt=o)&&!v?_r(r,u,(u.subtreeFlags&8772)!==0):yr(r,u),mr=y,Bt=v}break;case 30:break;default:yr(r,u)}}function mT(r){var o=r.alternate;o!==null&&(r.alternate=null,mT(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&ra(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var _t=null,Cn=!1;function gr(r,o,u){for(u=u.child;u!==null;)gT(r,o,u),u=u.sibling}function gT(r,o,u){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(li,u)}catch{}switch(u.tag){case 26:Bt||Ji(u,o),gr(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Bt||Ji(u,o);var c=_t,y=Cn;ds(u.type)&&(_t=u.stateNode,Cn=!1),gr(r,o,u),qu(u.stateNode),_t=c,Cn=y;break;case 5:Bt||Ji(u,o);case 6:if(c=_t,y=Cn,_t=null,gr(r,o,u),_t=c,Cn=y,_t!==null)if(Cn)try{(_t.nodeType===9?_t.body:_t.nodeName==="HTML"?_t.ownerDocument.body:_t).removeChild(u.stateNode)}catch(v){rt(u,o,v)}else try{_t.removeChild(u.stateNode)}catch(v){rt(u,o,v)}break;case 18:_t!==null&&(Cn?(r=_t,l0(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),Ga(r)):l0(_t,u.stateNode));break;case 4:c=_t,y=Cn,_t=u.stateNode.containerInfo,Cn=!0,gr(r,o,u),_t=c,Cn=y;break;case 0:case 11:case 14:case 15:rs(2,u,o),Bt||rs(4,u,o),gr(r,o,u);break;case 1:Bt||(Ji(u,o),c=u.stateNode,typeof c.componentWillUnmount=="function"&&uT(u,o,c)),gr(r,o,u);break;case 21:gr(r,o,u);break;case 22:Bt=(c=Bt)||u.memoizedState!==null,gr(r,o,u),Bt=c;break;default:gr(r,o,u)}}function yT(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Ga(r)}catch(u){rt(o,o.return,u)}}}function _T(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ga(r)}catch(u){rt(o,o.return,u)}}function P1(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new hT),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new hT),o;default:throw Error(i(435,r.tag))}}function of(r,o){var u=P1(r);o.forEach(function(c){if(!u.has(c)){u.add(c);var y=G1.bind(null,r,c);c.then(y,y)}})}function wn(r,o){var u=o.deletions;if(u!==null)for(var c=0;c<u.length;c++){var y=u[c],v=r,S=o,w=S;e:for(;w!==null;){switch(w.tag){case 27:if(ds(w.type)){_t=w.stateNode,Cn=!1;break e}break;case 5:_t=w.stateNode,Cn=!1;break e;case 3:case 4:_t=w.stateNode.containerInfo,Cn=!0;break e}w=w.return}if(_t===null)throw Error(i(160));gT(v,S,y),_t=null,Cn=!1,v=y.alternate,v!==null&&(v.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)vT(o,r),o=o.sibling}var _i=null;function vT(r,o){var u=r.alternate,c=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:wn(o,r),Rn(r),c&4&&(rs(3,r,r.return),Du(3,r),rs(5,r,r.return));break;case 1:wn(o,r),Rn(r),c&512&&(Bt||u===null||Ji(u,u.return)),c&64&&mr&&(r=r.updateQueue,r!==null&&(c=r.callbacks,c!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?c:u.concat(c))));break;case 26:var y=_i;if(wn(o,r),Rn(r),c&512&&(Bt||u===null||Ji(u,u.return)),c&4){var v=u!==null?u.memoizedState:null;if(c=r.memoizedState,u===null)if(c===null)if(r.stateNode===null){e:{c=r.type,u=r.memoizedProps,y=y.ownerDocument||y;t:switch(c){case"title":v=y.getElementsByTagName("title")[0],(!v||v[Mi]||v[kt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=y.createElement(c),y.head.insertBefore(v,y.querySelector("head > title"))),an(v,c,u),v[kt]=r,Vt(v),c=v;break e;case"link":var S=v0("link","href",y).get(c+(u.href||""));if(S){for(var w=0;w<S.length;w++)if(v=S[w],v.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&v.getAttribute("rel")===(u.rel==null?null:u.rel)&&v.getAttribute("title")===(u.title==null?null:u.title)&&v.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){S.splice(w,1);break t}}v=y.createElement(c),an(v,c,u),y.head.appendChild(v);break;case"meta":if(S=v0("meta","content",y).get(c+(u.content||""))){for(w=0;w<S.length;w++)if(v=S[w],v.getAttribute("content")===(u.content==null?null:""+u.content)&&v.getAttribute("name")===(u.name==null?null:u.name)&&v.getAttribute("property")===(u.property==null?null:u.property)&&v.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&v.getAttribute("charset")===(u.charSet==null?null:u.charSet)){S.splice(w,1);break t}}v=y.createElement(c),an(v,c,u),y.head.appendChild(v);break;default:throw Error(i(468,c))}v[kt]=r,Vt(v),c=v}r.stateNode=c}else E0(y,r.type,r.stateNode);else r.stateNode=_0(y,c,r.memoizedProps);else v!==c?(v===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):v.count--,c===null?E0(y,r.type,r.stateNode):_0(y,c,r.memoizedProps)):c===null&&r.stateNode!==null&&km(r,r.memoizedProps,u.memoizedProps)}break;case 27:wn(o,r),Rn(r),c&512&&(Bt||u===null||Ji(u,u.return)),u!==null&&c&4&&km(r,r.memoizedProps,u.memoizedProps);break;case 5:if(wn(o,r),Rn(r),c&512&&(Bt||u===null||Ji(u,u.return)),r.flags&32){y=r.stateNode;try{In(y,"")}catch(ve){rt(r,r.return,ve)}}c&4&&r.stateNode!=null&&(y=r.memoizedProps,km(r,y,u!==null?u.memoizedProps:y)),c&1024&&(Um=!0);break;case 6:if(wn(o,r),Rn(r),c&4){if(r.stateNode===null)throw Error(i(162));c=r.memoizedProps,u=r.stateNode;try{u.nodeValue=c}catch(ve){rt(r,r.return,ve)}}break;case 3:if(Af=null,y=_i,_i=Ef(o.containerInfo),wn(o,r),_i=y,Rn(r),c&4&&u!==null&&u.memoizedState.isDehydrated)try{Ga(o.containerInfo)}catch(ve){rt(r,r.return,ve)}Um&&(Um=!1,ET(r));break;case 4:c=_i,_i=Ef(r.stateNode.containerInfo),wn(o,r),Rn(r),_i=c;break;case 12:wn(o,r),Rn(r);break;case 31:wn(o,r),Rn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,of(r,c)));break;case 13:wn(o,r),Rn(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(lf=yn()),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,of(r,c)));break;case 22:y=r.memoizedState!==null;var U=u!==null&&u.memoizedState!==null,J=mr,te=Bt;if(mr=J||y,Bt=te||U,wn(o,r),Bt=te,mr=J,Rn(r),c&8192)e:for(o=r.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||U||mr||Bt||Eo(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){U=u=o;try{if(v=U.stateNode,y)S=v.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{w=U.stateNode;var ie=U.memoizedProps.style,$=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;w.style.display=$==null||typeof $=="boolean"?"":(""+$).trim()}}catch(ve){rt(U,U.return,ve)}}}else if(o.tag===6){if(u===null){U=o;try{U.stateNode.nodeValue=y?"":U.memoizedProps}catch(ve){rt(U,U.return,ve)}}}else if(o.tag===18){if(u===null){U=o;try{var Z=U.stateNode;y?u0(Z,!0):u0(U.stateNode,!1)}catch(ve){rt(U,U.return,ve)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}c&4&&(c=r.updateQueue,c!==null&&(u=c.retryQueue,u!==null&&(c.retryQueue=null,of(r,u))));break;case 19:wn(o,r),Rn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,of(r,c)));break;case 30:break;case 21:break;default:wn(o,r),Rn(r)}}function Rn(r){var o=r.flags;if(o&2){try{for(var u,c=r.return;c!==null;){if(dT(c)){u=c;break}c=c.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var y=u.stateNode,v=Vm(r);sf(r,v,y);break;case 5:var S=u.stateNode;u.flags&32&&(In(S,""),u.flags&=-33);var w=Vm(r);sf(r,w,S);break;case 3:case 4:var U=u.stateNode.containerInfo,J=Vm(r);Lm(r,J,U);break;default:throw Error(i(161))}}catch(te){rt(r,r.return,te)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function ET(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;ET(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function yr(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)pT(r,o.alternate,o),o=o.sibling}function Eo(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:rs(4,o,o.return),Eo(o);break;case 1:Ji(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&uT(o,o.return,u),Eo(o);break;case 27:qu(o.stateNode);case 26:case 5:Ji(o,o.return),Eo(o);break;case 22:o.memoizedState===null&&Eo(o);break;case 30:Eo(o);break;default:Eo(o)}r=r.sibling}}function _r(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var c=o.alternate,y=r,v=o,S=v.flags;switch(v.tag){case 0:case 11:case 15:_r(y,v,u),Du(4,v);break;case 1:if(_r(y,v,u),c=v,y=c.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(J){rt(c,c.return,J)}if(c=v,y=c.updateQueue,y!==null){var w=c.stateNode;try{var U=y.shared.hiddenCallbacks;if(U!==null)for(y.shared.hiddenCallbacks=null,y=0;y<U.length;y++)Wv(U[y],w)}catch(J){rt(c,c.return,J)}}u&&S&64&&lT(v),Mu(v,v.return);break;case 27:fT(v);case 26:case 5:_r(y,v,u),u&&c===null&&S&4&&cT(v),Mu(v,v.return);break;case 12:_r(y,v,u);break;case 31:_r(y,v,u),u&&S&4&&yT(y,v);break;case 13:_r(y,v,u),u&&S&4&&_T(y,v);break;case 22:v.memoizedState===null&&_r(y,v,u),Mu(v,v.return);break;case 30:break;default:_r(y,v,u)}o=o.sibling}}function Om(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&_u(u))}function Fm(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&_u(r))}function vi(r,o,u,c){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)TT(r,o,u,c),o=o.sibling}function TT(r,o,u,c){var y=o.flags;switch(o.tag){case 0:case 11:case 15:vi(r,o,u,c),y&2048&&Du(9,o);break;case 1:vi(r,o,u,c);break;case 3:vi(r,o,u,c),y&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&_u(r)));break;case 12:if(y&2048){vi(r,o,u,c),r=o.stateNode;try{var v=o.memoizedProps,S=v.id,w=v.onPostCommit;typeof w=="function"&&w(S,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(U){rt(o,o.return,U)}}else vi(r,o,u,c);break;case 31:vi(r,o,u,c);break;case 13:vi(r,o,u,c);break;case 23:break;case 22:v=o.stateNode,S=o.alternate,o.memoizedState!==null?v._visibility&2?vi(r,o,u,c):Pu(r,o):v._visibility&2?vi(r,o,u,c):(v._visibility|=2,Da(r,o,u,c,(o.subtreeFlags&10256)!==0||!1)),y&2048&&Om(S,o);break;case 24:vi(r,o,u,c),y&2048&&Fm(o.alternate,o);break;default:vi(r,o,u,c)}}function Da(r,o,u,c,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var v=r,S=o,w=u,U=c,J=S.flags;switch(S.tag){case 0:case 11:case 15:Da(v,S,w,U,y),Du(8,S);break;case 23:break;case 22:var te=S.stateNode;S.memoizedState!==null?te._visibility&2?Da(v,S,w,U,y):Pu(v,S):(te._visibility|=2,Da(v,S,w,U,y)),y&&J&2048&&Om(S.alternate,S);break;case 24:Da(v,S,w,U,y),y&&J&2048&&Fm(S.alternate,S);break;default:Da(v,S,w,U,y)}o=o.sibling}}function Pu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,c=o,y=c.flags;switch(c.tag){case 22:Pu(u,c),y&2048&&Om(c.alternate,c);break;case 24:Pu(u,c),y&2048&&Fm(c.alternate,c);break;default:Pu(u,c)}o=o.sibling}}var ku=8192;function Ma(r,o,u){if(r.subtreeFlags&ku)for(r=r.child;r!==null;)AT(r,o,u),r=r.sibling}function AT(r,o,u){switch(r.tag){case 26:Ma(r,o,u),r.flags&ku&&r.memoizedState!==null&&vN(u,_i,r.memoizedState,r.memoizedProps);break;case 5:Ma(r,o,u);break;case 3:case 4:var c=_i;_i=Ef(r.stateNode.containerInfo),Ma(r,o,u),_i=c;break;case 22:r.memoizedState===null&&(c=r.alternate,c!==null&&c.memoizedState!==null?(c=ku,ku=16777216,Ma(r,o,u),ku=c):Ma(r,o,u));break;default:Ma(r,o,u)}}function ST(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function Vu(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var c=o[u];Zt=c,CT(c,r)}ST(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)IT(r),r=r.sibling}function IT(r){switch(r.tag){case 0:case 11:case 15:Vu(r),r.flags&2048&&rs(9,r,r.return);break;case 3:Vu(r);break;case 12:Vu(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,af(r)):Vu(r);break;default:Vu(r)}}function af(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var c=o[u];Zt=c,CT(c,r)}ST(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:rs(8,o,o.return),af(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,af(o));break;default:af(o)}r=r.sibling}}function CT(r,o){for(;Zt!==null;){var u=Zt;switch(u.tag){case 0:case 11:case 15:rs(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var c=u.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:_u(u.memoizedState.cache)}if(c=u.child,c!==null)c.return=u,Zt=c;else e:for(u=r;Zt!==null;){c=Zt;var y=c.sibling,v=c.return;if(mT(c),c===u){Zt=null;break e}if(y!==null){y.return=v,Zt=y;break e}Zt=v}}}var k1={getCacheForType:function(r){var o=sn(Ut),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return sn(Ut).controller.signal}},V1=typeof WeakMap=="function"?WeakMap:Map,et=0,ft=null,Fe=null,qe=0,it=0,On=null,ss=!1,Pa=!1,Bm=!1,vr=0,At=0,os=0,To=0,qm=0,Fn=0,ka=0,Lu=null,bn=null,Gm=!1,lf=0,wT=0,uf=1/0,cf=null,as=null,Jt=0,ls=null,Va=null,Er=0,zm=0,Hm=null,RT=null,Uu=0,Km=null;function Bn(){return(et&2)!==0&&qe!==0?qe&-qe:Y.T!==null?Wm():cd()}function bT(){if(Fn===0)if((qe&536870912)===0||Je){var r=Ys;Ys<<=1,(Ys&3932160)===0&&(Ys=262144),Fn=r}else Fn=536870912;return r=Ln.current,r!==null&&(r.flags|=32),Fn}function xn(r,o,u){(r===ft&&(it===2||it===9)||r.cancelPendingCommit!==null)&&(La(r,0),us(r,qe,Fn,!1)),$s(r,u),((et&2)===0||r!==ft)&&(r===ft&&((et&2)===0&&(To|=u),At===4&&us(r,qe,Fn,!1)),Yi(r))}function xT(r,o,u){if((et&6)!==0)throw Error(i(327));var c=!u&&(o&127)===0&&(o&r.expiredLanes)===0||ui(r,o),y=c?O1(r,o):Ym(r,o,!0),v=c;do{if(y===0){Pa&&!c&&us(r,o,0,!1);break}else{if(u=r.current.alternate,v&&!L1(u)){y=Ym(r,o,!1),v=!1;continue}if(y===2){if(v=o,r.errorRecoveryDisabledLanes&v)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var w=r;y=Lu;var U=w.current.memoizedState.isDehydrated;if(U&&(La(w,S).flags|=256),S=Ym(w,S,!1),S!==2){if(Bm&&!U){w.errorRecoveryDisabledLanes|=v,To|=v,y=4;break e}v=bn,bn=y,v!==null&&(bn===null?bn=v:bn.push.apply(bn,v))}y=S}if(v=!1,y!==2)continue}}if(y===1){La(r,0),us(r,o,0,!0);break}e:{switch(c=r,v=y,v){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:us(c,o,Fn,!ss);break e;case 2:bn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(y=lf+300-yn(),10<y)){if(us(c,o,Fn,!ss),xi(c,0,!0)!==0)break e;Er=o,c.timeoutHandle=o0(NT.bind(null,c,u,bn,cf,Gm,o,Fn,To,ka,ss,v,"Throttled",-0,0),y);break e}NT(c,u,bn,cf,Gm,o,Fn,To,ka,ss,v,null,-0,0)}}break}while(!0);Yi(r)}function NT(r,o,u,c,y,v,S,w,U,J,te,ie,$,Z){if(r.timeoutHandle=-1,ie=o.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:fi},AT(o,v,ie);var ve=(v&62914560)===v?lf-yn():(v&4194048)===v?wT-yn():0;if(ve=EN(ie,ve),ve!==null){Er=v,r.cancelPendingCommit=ve(OT.bind(null,r,o,v,u,c,y,S,w,U,te,ie,null,$,Z)),us(r,v,S,!J);return}}OT(r,o,v,u,c,y,S,w,U)}function L1(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var c=0;c<u.length;c++){var y=u[c],v=y.getSnapshot;y=y.value;try{if(!kn(v(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function us(r,o,u,c){o&=~qm,o&=~To,r.suspendedLanes|=o,r.pingedLanes&=~o,c&&(r.warmLanes|=o),c=r.expirationTimes;for(var y=o;0<y;){var v=31-Ct(y),S=1<<v;c[v]=-1,y&=~S}u!==0&&Qs(r,u,o)}function df(){return(et&6)===0?(Ou(0),!1):!0}function Jm(){if(Fe!==null){if(it===0)var r=Fe.return;else r=Fe,ur=fo=null,lm(r),wa=null,Eu=0,r=Fe;for(;r!==null;)aT(r.alternate,r),r=r.return;Fe=null}}function La(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,nN(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Er=0,Jm(),ft=r,Fe=u=ar(r.current,null),qe=o,it=0,On=null,ss=!1,Pa=ui(r,o),Bm=!1,ka=Fn=qm=To=os=At=0,bn=Lu=null,Gm=!1,(o&8)!==0&&(o|=o&32);var c=r.entangledLanes;if(c!==0)for(r=r.entanglements,c&=o;0<c;){var y=31-Ct(c),v=1<<y;o|=r[y],c&=~v}return vr=o,Dd(),u}function DT(r,o){ke=null,Y.H=bu,o===Ca||o===Fd?(o=Yv(),it=3):o===Xp?(o=Yv(),it=4):it=o===Im?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,On=o,Fe===null&&(At=1,jd(r,Wn(o,r.current)))}function MT(){var r=Ln.current;return r===null?!0:(qe&4194048)===qe?ti===null:(qe&62914560)===qe||(qe&536870912)!==0?r===ti:!1}function PT(){var r=Y.H;return Y.H=bu,r===null?bu:r}function kT(){var r=Y.A;return Y.A=k1,r}function ff(){At=4,ss||(qe&4194048)!==qe&&Ln.current!==null||(Pa=!0),(os&134217727)===0&&(To&134217727)===0||ft===null||us(ft,qe,Fn,!1)}function Ym(r,o,u){var c=et;et|=2;var y=PT(),v=kT();(ft!==r||qe!==o)&&(cf=null,La(r,o)),o=!1;var S=At;e:do try{if(it!==0&&Fe!==null){var w=Fe,U=On;switch(it){case 8:Jm(),S=6;break e;case 3:case 2:case 9:case 6:Ln.current===null&&(o=!0);var J=it;if(it=0,On=null,Ua(r,w,U,J),u&&Pa){S=0;break e}break;default:J=it,it=0,On=null,Ua(r,w,U,J)}}U1(),S=At;break}catch(te){DT(r,te)}while(!0);return o&&r.shellSuspendCounter++,ur=fo=null,et=c,Y.H=y,Y.A=v,Fe===null&&(ft=null,qe=0,Dd()),S}function U1(){for(;Fe!==null;)VT(Fe)}function O1(r,o){var u=et;et|=2;var c=PT(),y=kT();ft!==r||qe!==o?(cf=null,uf=yn()+500,La(r,o)):Pa=ui(r,o);e:do try{if(it!==0&&Fe!==null){o=Fe;var v=On;t:switch(it){case 1:it=0,On=null,Ua(r,o,v,1);break;case 2:case 9:if(Kv(v)){it=0,On=null,LT(o);break}o=function(){it!==2&&it!==9||ft!==r||(it=7),Yi(r)},v.then(o,o);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:Kv(v)?(it=0,On=null,LT(o)):(it=0,On=null,Ua(r,o,v,7));break;case 5:var S=null;switch(Fe.tag){case 26:S=Fe.memoizedState;case 5:case 27:var w=Fe;if(S?T0(S):w.stateNode.complete){it=0,On=null;var U=w.sibling;if(U!==null)Fe=U;else{var J=w.return;J!==null?(Fe=J,hf(J)):Fe=null}break t}}it=0,On=null,Ua(r,o,v,5);break;case 6:it=0,On=null,Ua(r,o,v,6);break;case 8:Jm(),At=6;break e;default:throw Error(i(462))}}F1();break}catch(te){DT(r,te)}while(!0);return ur=fo=null,Y.H=c,Y.A=y,et=u,Fe!==null?0:(ft=null,qe=0,Dd(),At)}function F1(){for(;Fe!==null&&!Sp();)VT(Fe)}function VT(r){var o=sT(r.alternate,r,vr);r.memoizedProps=r.pendingProps,o===null?hf(r):Fe=o}function LT(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=jE(u,o,o.pendingProps,o.type,void 0,qe);break;case 11:o=jE(u,o,o.pendingProps,o.type.render,o.ref,qe);break;case 5:lm(o);default:aT(u,o),o=Fe=kv(o,vr),o=sT(u,o,vr)}r.memoizedProps=r.pendingProps,o===null?hf(r):Fe=o}function Ua(r,o,u,c){ur=fo=null,lm(o),wa=null,Eu=0;var y=o.return;try{if(R1(r,y,o,u,qe)){At=1,jd(r,Wn(u,r.current)),Fe=null;return}}catch(v){if(y!==null)throw Fe=y,v;At=1,jd(r,Wn(u,r.current)),Fe=null;return}o.flags&32768?(Je||c===1?r=!0:Pa||(qe&536870912)!==0?r=!1:(ss=r=!0,(c===2||c===9||c===3||c===6)&&(c=Ln.current,c!==null&&c.tag===13&&(c.flags|=16384))),UT(o,r)):hf(o)}function hf(r){var o=r;do{if((o.flags&32768)!==0){UT(o,ss);return}r=o.return;var u=N1(o.alternate,o,vr);if(u!==null){Fe=u;return}if(o=o.sibling,o!==null){Fe=o;return}Fe=o=r}while(o!==null);At===0&&(At=5)}function UT(r,o){do{var u=D1(r.alternate,r);if(u!==null){u.flags&=32767,Fe=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){Fe=r;return}Fe=r=u}while(r!==null);At=6,Fe=null}function OT(r,o,u,c,y,v,S,w,U){r.cancelPendingCommit=null;do pf();while(Jt!==0);if((et&6)!==0)throw Error(i(327));if(o!==null){if(o===r.current)throw Error(i(177));if(v=o.lanes|o.childLanes,v|=Vp,wp(r,u,v,S,w,U),r===ft&&(Fe=ft=null,qe=0),Va=o,ls=r,Er=u,zm=v,Hm=y,RT=c,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,z1(Fr,function(){return zT(),null})):(r.callbackNode=null,r.callbackPriority=0),c=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||c){c=Y.T,Y.T=null,y=oe.p,oe.p=2,S=et,et|=4;try{M1(r,o,u)}finally{et=S,oe.p=y,Y.T=c}}Jt=1,FT(),BT(),qT()}}function FT(){if(Jt===1){Jt=0;var r=ls,o=Va,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=Y.T,Y.T=null;var c=oe.p;oe.p=2;var y=et;et|=4;try{vT(o,r);var v=sg,S=Cv(r.containerInfo),w=v.focusedElem,U=v.selectionRange;if(S!==w&&w&&w.ownerDocument&&Iv(w.ownerDocument.documentElement,w)){if(U!==null&&Np(w)){var J=U.start,te=U.end;if(te===void 0&&(te=J),"selectionStart"in w)w.selectionStart=J,w.selectionEnd=Math.min(te,w.value.length);else{var ie=w.ownerDocument||document,$=ie&&ie.defaultView||window;if($.getSelection){var Z=$.getSelection(),ve=w.textContent.length,Re=Math.min(U.start,ve),dt=U.end===void 0?Re:Math.min(U.end,ve);!Z.extend&&Re>dt&&(S=dt,dt=Re,Re=S);var G=Sv(w,Re),B=Sv(w,dt);if(G&&B&&(Z.rangeCount!==1||Z.anchorNode!==G.node||Z.anchorOffset!==G.offset||Z.focusNode!==B.node||Z.focusOffset!==B.offset)){var K=ie.createRange();K.setStart(G.node,G.offset),Z.removeAllRanges(),Re>dt?(Z.addRange(K),Z.extend(B.node,B.offset)):(K.setEnd(B.node,B.offset),Z.addRange(K))}}}}for(ie=[],Z=w;Z=Z.parentNode;)Z.nodeType===1&&ie.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<ie.length;w++){var ne=ie[w];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}wf=!!rg,sg=rg=null}finally{et=y,oe.p=c,Y.T=u}}r.current=o,Jt=2}}function BT(){if(Jt===2){Jt=0;var r=ls,o=Va,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=Y.T,Y.T=null;var c=oe.p;oe.p=2;var y=et;et|=4;try{pT(r,o.alternate,o)}finally{et=y,oe.p=c,Y.T=u}}Jt=3}}function qT(){if(Jt===4||Jt===3){Jt=0,id();var r=ls,o=Va,u=Er,c=RT;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Jt=5:(Jt=0,Va=ls=null,GT(r,r.pendingLanes));var y=r.pendingLanes;if(y===0&&(as=null),ir(u),o=o.stateNode,tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(li,o,void 0,(o.current.flags&128)===128)}catch{}if(c!==null){o=Y.T,y=oe.p,oe.p=2,Y.T=null;try{for(var v=r.onRecoverableError,S=0;S<c.length;S++){var w=c[S];v(w.value,{componentStack:w.stack})}}finally{Y.T=o,oe.p=y}}(Er&3)!==0&&pf(),Yi(r),y=r.pendingLanes,(u&261930)!==0&&(y&42)!==0?r===Km?Uu++:(Uu=0,Km=r):Uu=0,Ou(0)}}function GT(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,_u(o)))}function pf(){return FT(),BT(),qT(),zT()}function zT(){if(Jt!==5)return!1;var r=ls,o=zm;zm=0;var u=ir(Er),c=Y.T,y=oe.p;try{oe.p=32>u?32:u,Y.T=null,u=Hm,Hm=null;var v=ls,S=Er;if(Jt=0,Va=ls=null,Er=0,(et&6)!==0)throw Error(i(331));var w=et;if(et|=4,IT(v.current),TT(v,v.current,S,u),et=w,Ou(0,!1),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(li,v)}catch{}return!0}finally{oe.p=y,Y.T=c,GT(r,o)}}function HT(r,o,u){o=Wn(u,o),o=Sm(r.stateNode,o,2),r=ts(r,o,2),r!==null&&($s(r,2),Yi(r))}function rt(r,o,u){if(r.tag===3)HT(r,r,u);else for(;o!==null;){if(o.tag===3){HT(o,r,u);break}else if(o.tag===1){var c=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(as===null||!as.has(c))){r=Wn(u,r),u=KE(2),c=ts(o,u,2),c!==null&&(JE(u,c,o,r),$s(c,2),Yi(c));break}}o=o.return}}function $m(r,o,u){var c=r.pingCache;if(c===null){c=r.pingCache=new V1;var y=new Set;c.set(o,y)}else y=c.get(o),y===void 0&&(y=new Set,c.set(o,y));y.has(u)||(Bm=!0,y.add(u),r=B1.bind(null,r,o,u),o.then(r,r))}function B1(r,o,u){var c=r.pingCache;c!==null&&c.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,ft===r&&(qe&u)===u&&(At===4||At===3&&(qe&62914560)===qe&&300>yn()-lf?(et&2)===0&&La(r,0):qm|=u,ka===qe&&(ka=0)),Yi(r)}function KT(r,o){o===0&&(o=ud()),r=lo(r,o),r!==null&&($s(r,o),Yi(r))}function q1(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),KT(r,u)}function G1(r,o){var u=0;switch(r.tag){case 31:case 13:var c=r.stateNode,y=r.memoizedState;y!==null&&(u=y.retryLane);break;case 19:c=r.stateNode;break;case 22:c=r.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(o),KT(r,u)}function z1(r,o){return Kt(r,o)}var mf=null,Oa=null,Qm=!1,gf=!1,Xm=!1,cs=0;function Yi(r){r!==Oa&&r.next===null&&(Oa===null?mf=Oa=r:Oa=Oa.next=r),gf=!0,Qm||(Qm=!0,K1())}function Ou(r,o){if(!Xm&&gf){Xm=!0;do for(var u=!1,c=mf;c!==null;){if(r!==0){var y=c.pendingLanes;if(y===0)var v=0;else{var S=c.suspendedLanes,w=c.pingedLanes;v=(1<<31-Ct(42|r)+1)-1,v&=y&~(S&~w),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(u=!0,QT(c,v))}else v=qe,v=xi(c,c===ft?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(v&3)===0||ui(c,v)||(u=!0,QT(c,v));c=c.next}while(u);Xm=!1}}function H1(){JT()}function JT(){gf=Qm=!1;var r=0;cs!==0&&tN()&&(r=cs);for(var o=yn(),u=null,c=mf;c!==null;){var y=c.next,v=YT(c,o);v===0?(c.next=null,u===null?mf=y:u.next=y,y===null&&(Oa=u)):(u=c,(r!==0||(v&3)!==0)&&(gf=!0)),c=y}Jt!==0&&Jt!==5||Ou(r),cs!==0&&(cs=0)}function YT(r,o){for(var u=r.suspendedLanes,c=r.pingedLanes,y=r.expirationTimes,v=r.pendingLanes&-62914561;0<v;){var S=31-Ct(v),w=1<<S,U=y[S];U===-1?((w&u)===0||(w&c)!==0)&&(y[S]=Cp(w,o)):U<=o&&(r.expiredLanes|=w),v&=~w}if(o=ft,u=qe,u=xi(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c=r.callbackNode,u===0||r===o&&(it===2||it===9)||r.cancelPendingCommit!==null)return c!==null&&c!==null&&Or(c),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||ui(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(c!==null&&Or(c),ir(u)){case 2:case 8:u=$l;break;case 32:u=Fr;break;case 268435456:u=rd;break;default:u=Fr}return c=$T.bind(null,r),u=Kt(u,c),r.callbackPriority=o,r.callbackNode=u,o}return c!==null&&c!==null&&Or(c),r.callbackPriority=2,r.callbackNode=null,2}function $T(r,o){if(Jt!==0&&Jt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(pf()&&r.callbackNode!==u)return null;var c=qe;return c=xi(r,r===ft?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c===0?null:(xT(r,c,o),YT(r,yn()),r.callbackNode!=null&&r.callbackNode===u?$T.bind(null,r):null)}function QT(r,o){if(pf())return null;xT(r,o,!0)}function K1(){iN(function(){(et&6)!==0?Kt(Yl,H1):JT()})}function Wm(){if(cs===0){var r=Sa;r===0&&(r=Ri,Ri<<=1,(Ri&261888)===0&&(Ri=256)),cs=r}return cs}function XT(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:la(""+r)}function WT(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function J1(r,o,u,c,y){if(o==="submit"&&u&&u.stateNode===y){var v=XT((y[Xt]||null).action),S=c.submitter;S&&(o=(o=S[Xt]||null)?XT(o.formAction):S.getAttribute("formAction"),o!==null&&(v=o,S=null));var w=new Bi("action","action",null,c,y);r.push({event:w,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(cs!==0){var U=S?WT(y,S):new FormData(y);ym(u,{pending:!0,data:U,method:y.method,action:v},null,U)}}else typeof v=="function"&&(w.preventDefault(),U=S?WT(y,S):new FormData(y),ym(u,{pending:!0,data:U,method:y.method,action:v},v,U))},currentTarget:y}]})}}for(var Zm=0;Zm<kp.length;Zm++){var jm=kp[Zm],Y1=jm.toLowerCase(),$1=jm[0].toUpperCase()+jm.slice(1);yi(Y1,"on"+$1)}yi(bv,"onAnimationEnd"),yi(xv,"onAnimationIteration"),yi(Nv,"onAnimationStart"),yi("dblclick","onDoubleClick"),yi("focusin","onFocus"),yi("focusout","onBlur"),yi(c1,"onTransitionRun"),yi(d1,"onTransitionStart"),yi(f1,"onTransitionCancel"),yi(Dv,"onTransitionEnd"),Li("onMouseEnter",["mouseout","mouseover"]),Li("onMouseLeave",["mouseout","mouseover"]),Li("onPointerEnter",["pointerout","pointerover"]),Li("onPointerLeave",["pointerout","pointerover"]),Vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Q1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Fu));function ZT(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var c=r[u],y=c.event;c=c.listeners;e:{var v=void 0;if(o)for(var S=c.length-1;0<=S;S--){var w=c[S],U=w.instance,J=w.currentTarget;if(w=w.listener,U!==v&&y.isPropagationStopped())break e;v=w,y.currentTarget=J;try{v(y)}catch(te){Nd(te)}y.currentTarget=null,v=U}else for(S=0;S<c.length;S++){if(w=c[S],U=w.instance,J=w.currentTarget,w=w.listener,U!==v&&y.isPropagationStopped())break e;v=w,y.currentTarget=J;try{v(y)}catch(te){Nd(te)}y.currentTarget=null,v=U}}}}function Be(r,o){var u=o[ia];u===void 0&&(u=o[ia]=new Set);var c=r+"__bubble";u.has(c)||(jT(o,r,2,!1),u.add(c))}function eg(r,o,u){var c=0;o&&(c|=4),jT(u,r,c,o)}var yf="_reactListening"+Math.random().toString(36).slice(2);function tg(r){if(!r[yf]){r[yf]=!0,Wl.forEach(function(u){u!=="selectionchange"&&(Q1.has(u)||eg(u,!1,r),eg(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[yf]||(o[yf]=!0,eg("selectionchange",!1,o))}}function jT(r,o,u,c){switch(b0(o)){case 2:var y=SN;break;case 8:y=IN;break;default:y=gg}u=y.bind(null,o,u,r),y=void 0,!eo||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),c?y!==void 0?r.addEventListener(o,u,{capture:!0,passive:y}):r.addEventListener(o,u,!0):y!==void 0?r.addEventListener(o,u,{passive:y}):r.addEventListener(o,u,!1)}function ng(r,o,u,c,y){var v=c;if((o&1)===0&&(o&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var w=c.stateNode.containerInfo;if(w===y)break;if(S===4)for(S=c.return;S!==null;){var U=S.tag;if((U===3||U===4)&&S.stateNode.containerInfo===y)return;S=S.return}for(;w!==null;){if(S=Pi(w),S===null)return;if(U=S.tag,U===5||U===6||U===26||U===27){c=v=S;continue e}w=w.parentNode}}c=c.return}Kr(function(){var J=v,te=Yn(u),ie=[];e:{var $=Mv.get(r);if($!==void 0){var Z=Bi,ve=r;switch(r){case"keypress":if(no(u)===0)break e;case"keydown":case"keyup":Z=Rd;break;case"focusin":ve="focus",Z=ro;break;case"focusout":ve="blur",Z=ro;break;case"beforeblur":case"afterblur":Z=ro;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=cu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=_d;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=A;break;case bv:case xv:case Nv:Z=Ed;break;case Dv:Z=b;break;case"scroll":case"scrollend":Z=uu;break;case"wheel":Z=W;break;case"copy":case"cut":case"paste":Z=Td;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=or;break;case"toggle":case"beforetoggle":Z=Pe}var Re=(o&4)!==0,dt=!Re&&(r==="scroll"||r==="scrollend"),G=Re?$!==null?$+"Capture":null:$;Re=[];for(var B=J,K;B!==null;){var ne=B;if(K=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||K===null||G===null||(ne=hi(B,G),ne!=null&&Re.push(Bu(B,ne,K))),dt)break;B=B.return}0<Re.length&&($=new Z($,ve,null,u,te),ie.push({event:$,listeners:Re}))}}if((o&7)===0){e:{if($=r==="mouseover"||r==="pointerover",Z=r==="mouseout"||r==="pointerout",$&&u!==ou&&(ve=u.relatedTarget||u.fromElement)&&(Pi(ve)||ve[Di]))break e;if((Z||$)&&($=te.window===te?te:($=te.ownerDocument)?$.defaultView||$.parentWindow:window,Z?(ve=u.relatedTarget||u.toElement,Z=J,ve=ve?Pi(ve):null,ve!==null&&(dt=a(ve),Re=ve.tag,ve!==dt||Re!==5&&Re!==27&&Re!==6)&&(ve=null)):(Z=null,ve=J),Z!==ve)){if(Re=cu,ne="onMouseLeave",G="onMouseEnter",B="mouse",(r==="pointerout"||r==="pointerover")&&(Re=or,ne="onPointerLeave",G="onPointerEnter",B="pointer"),dt=Z==null?$:Mn(Z),K=ve==null?$:Mn(ve),$=new Re(ne,B+"leave",Z,u,te),$.target=dt,$.relatedTarget=K,ne=null,Pi(te)===J&&(Re=new Re(G,B+"enter",ve,u,te),Re.target=K,Re.relatedTarget=dt,ne=Re),dt=ne,Z&&ve)t:{for(Re=X1,G=Z,B=ve,K=0,ne=G;ne;ne=Re(ne))K++;ne=0;for(var Ie=B;Ie;Ie=Re(Ie))ne++;for(;0<K-ne;)G=Re(G),K--;for(;0<ne-K;)B=Re(B),ne--;for(;K--;){if(G===B||B!==null&&G===B.alternate){Re=G;break t}G=Re(G),B=Re(B)}Re=null}else Re=null;Z!==null&&e0(ie,$,Z,Re,!1),ve!==null&&dt!==null&&e0(ie,dt,ve,Re,!0)}}e:{if($=J?Mn(J):window,Z=$.nodeName&&$.nodeName.toLowerCase(),Z==="select"||Z==="input"&&$.type==="file")var Xe=yv;else if(mv($))if(_v)Xe=a1;else{Xe=s1;var Ae=r1}else Z=$.nodeName,!Z||Z.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?J&&aa(J.elementType)&&(Xe=yv):Xe=o1;if(Xe&&(Xe=Xe(r,J))){gv(ie,Xe,u,te);break e}Ae&&Ae(r,$,J),r==="focusout"&&J&&$.type==="number"&&J.memoizedProps.value!=null&&iu($,"number",$.value)}switch(Ae=J?Mn(J):window,r){case"focusin":(mv(Ae)||Ae.contentEditable==="true")&&(ma=Ae,Dp=J,mu=null);break;case"focusout":mu=Dp=ma=null;break;case"mousedown":Mp=!0;break;case"contextmenu":case"mouseup":case"dragend":Mp=!1,wv(ie,u,te);break;case"selectionchange":if(u1)break;case"keydown":case"keyup":wv(ie,u,te)}var Le;if(je)e:{switch(r){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else pa?so(r,u)&&(Ge="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Ge="onCompositionStart");Ge&&(zi&&u.locale!=="ko"&&(pa||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&pa&&(Le=lu()):(Fi=te,au="value"in Fi?Fi.value:Fi.textContent,pa=!0)),Ae=_f(J,Ge),0<Ae.length&&(Ge=new Gi(Ge,r,null,u,te),ie.push({event:Ge,listeners:Ae}),Le?Ge.data=Le:(Le=ha(u),Le!==null&&(Ge.data=Le)))),(Le=Qn?e1(r,u):t1(r,u))&&(Ge=_f(J,"onBeforeInput"),0<Ge.length&&(Ae=new Gi("onBeforeInput","beforeinput",null,u,te),ie.push({event:Ae,listeners:Ge}),Ae.data=Le)),J1(ie,r,J,u,te)}ZT(ie,o)})}function Bu(r,o,u){return{instance:r,listener:o,currentTarget:u}}function _f(r,o){for(var u=o+"Capture",c=[];r!==null;){var y=r,v=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||v===null||(y=hi(r,u),y!=null&&c.unshift(Bu(r,y,v)),y=hi(r,o),y!=null&&c.push(Bu(r,y,v))),r.tag===3)return c;r=r.return}return[]}function X1(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function e0(r,o,u,c,y){for(var v=o._reactName,S=[];u!==null&&u!==c;){var w=u,U=w.alternate,J=w.stateNode;if(w=w.tag,U!==null&&U===c)break;w!==5&&w!==26&&w!==27||J===null||(U=J,y?(J=hi(u,v),J!=null&&S.unshift(Bu(u,J,U))):y||(J=hi(u,v),J!=null&&S.push(Bu(u,J,U)))),u=u.return}S.length!==0&&r.push({event:o,listeners:S})}var W1=/\r\n?/g,Z1=/\u0000|\uFFFD/g;function t0(r){return(typeof r=="string"?r:""+r).replace(W1,`
`).replace(Z1,"")}function n0(r,o){return o=t0(o),t0(r)===o}function ct(r,o,u,c,y,v){switch(u){case"children":typeof c=="string"?o==="body"||o==="textarea"&&c===""||In(r,c):(typeof c=="number"||typeof c=="bigint")&&o!=="body"&&In(r,""+c);break;case"className":Pn(r,"class",c);break;case"tabIndex":Pn(r,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Pn(r,u,c);break;case"style":su(r,c,v);break;case"data":if(o!=="object"){Pn(r,"data",c);break}case"src":case"href":if(c===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(u);break}c=la(""+c),r.setAttribute(u,c);break;case"action":case"formAction":if(typeof c=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(u==="formAction"?(o!=="input"&&ct(r,o,"name",y.name,y,null),ct(r,o,"formEncType",y.formEncType,y,null),ct(r,o,"formMethod",y.formMethod,y,null),ct(r,o,"formTarget",y.formTarget,y,null)):(ct(r,o,"encType",y.encType,y,null),ct(r,o,"method",y.method,y,null),ct(r,o,"target",y.target,y,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(u);break}c=la(""+c),r.setAttribute(u,c);break;case"onClick":c!=null&&(r.onclick=fi);break;case"onScroll":c!=null&&Be("scroll",r);break;case"onScrollEnd":c!=null&&Be("scrollend",r);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(u=c.__html,u!=null){if(y.children!=null)throw Error(i(60));r.innerHTML=u}}break;case"multiple":r.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":r.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){r.removeAttribute("xlink:href");break}u=la(""+c),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(u,""+c):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":c===!0?r.setAttribute(u,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(u,c):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?r.setAttribute(u,c):r.removeAttribute(u);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?r.removeAttribute(u):r.setAttribute(u,c);break;case"popover":Be("beforetoggle",r),Be("toggle",r),sa(r,"popover",c);break;case"xlinkActuate":Lt(r,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Lt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Lt(r,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Lt(r,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Lt(r,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Lt(r,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":sa(r,"is",c);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=yd.get(u)||u,sa(r,u,c))}}function ig(r,o,u,c,y,v){switch(u){case"style":su(r,c,v);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(u=c.__html,u!=null){if(y.children!=null)throw Error(i(60));r.innerHTML=u}}break;case"children":typeof c=="string"?In(r,c):(typeof c=="number"||typeof c=="bigint")&&In(r,""+c);break;case"onScroll":c!=null&&Be("scroll",r);break;case"onScrollEnd":c!=null&&Be("scrollend",r);break;case"onClick":c!=null&&(r.onclick=fi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zl.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),v=r[Xt]||null,v=v!=null?v[u]:null,typeof v=="function"&&r.removeEventListener(o,v,y),typeof c=="function")){typeof v!="function"&&v!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,c,y);break e}u in r?r[u]=c:c===!0?r.setAttribute(u,""):sa(r,u,c)}}}function an(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Be("error",r),Be("load",r);var c=!1,y=!1,v;for(v in u)if(u.hasOwnProperty(v)){var S=u[v];if(S!=null)switch(v){case"src":c=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ct(r,o,v,S,u,null)}}y&&ct(r,o,"srcSet",u.srcSet,u,null),c&&ct(r,o,"src",u.src,u,null);return;case"input":Be("invalid",r);var w=v=S=y=null,U=null,J=null;for(c in u)if(u.hasOwnProperty(c)){var te=u[c];if(te!=null)switch(c){case"name":y=te;break;case"type":S=te;break;case"checked":U=te;break;case"defaultChecked":J=te;break;case"value":v=te;break;case"defaultValue":w=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(i(137,o));break;default:ct(r,o,c,te,u,null)}}pd(r,v,w,U,J,S,y,!1);return;case"select":Be("invalid",r),c=S=v=null;for(y in u)if(u.hasOwnProperty(y)&&(w=u[y],w!=null))switch(y){case"value":v=w;break;case"defaultValue":S=w;break;case"multiple":c=w;default:ct(r,o,y,w,u,null)}o=v,u=S,r.multiple=!!c,o!=null?qr(r,!!c,o,!1):u!=null&&qr(r,!!c,u,!0);return;case"textarea":Be("invalid",r),v=y=c=null;for(S in u)if(u.hasOwnProperty(S)&&(w=u[S],w!=null))switch(S){case"value":c=w;break;case"defaultValue":y=w;break;case"children":v=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:ct(r,o,S,w,u,null)}Gr(r,c,y,v);return;case"option":for(U in u)if(u.hasOwnProperty(U)&&(c=u[U],c!=null))switch(U){case"selected":r.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:ct(r,o,U,c,u,null)}return;case"dialog":Be("beforetoggle",r),Be("toggle",r),Be("cancel",r),Be("close",r);break;case"iframe":case"object":Be("load",r);break;case"video":case"audio":for(c=0;c<Fu.length;c++)Be(Fu[c],r);break;case"image":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"embed":case"source":case"link":Be("error",r),Be("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(J in u)if(u.hasOwnProperty(J)&&(c=u[J],c!=null))switch(J){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ct(r,o,J,c,u,null)}return;default:if(aa(o)){for(te in u)u.hasOwnProperty(te)&&(c=u[te],c!==void 0&&ig(r,o,te,c,u,void 0));return}}for(w in u)u.hasOwnProperty(w)&&(c=u[w],c!=null&&ct(r,o,w,c,u,null))}function j1(r,o,u,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,v=null,S=null,w=null,U=null,J=null,te=null;for(Z in u){var ie=u[Z];if(u.hasOwnProperty(Z)&&ie!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":U=ie;default:c.hasOwnProperty(Z)||ct(r,o,Z,null,c,ie)}}for(var $ in c){var Z=c[$];if(ie=u[$],c.hasOwnProperty($)&&(Z!=null||ie!=null))switch($){case"type":v=Z;break;case"name":y=Z;break;case"checked":J=Z;break;case"defaultChecked":te=Z;break;case"value":S=Z;break;case"defaultValue":w=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,o));break;default:Z!==ie&&ct(r,o,$,Z,c,ie)}}oa(r,S,w,U,J,te,v,y);return;case"select":Z=S=w=$=null;for(v in u)if(U=u[v],u.hasOwnProperty(v)&&U!=null)switch(v){case"value":break;case"multiple":Z=U;default:c.hasOwnProperty(v)||ct(r,o,v,null,c,U)}for(y in c)if(v=c[y],U=u[y],c.hasOwnProperty(y)&&(v!=null||U!=null))switch(y){case"value":$=v;break;case"defaultValue":w=v;break;case"multiple":S=v;default:v!==U&&ct(r,o,y,v,c,U)}o=w,u=S,c=Z,$!=null?qr(r,!!u,$,!1):!!c!=!!u&&(o!=null?qr(r,!!u,o,!0):qr(r,!!u,u?[]:"",!1));return;case"textarea":Z=$=null;for(w in u)if(y=u[w],u.hasOwnProperty(w)&&y!=null&&!c.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:ct(r,o,w,null,c,y)}for(S in c)if(y=c[S],v=u[S],c.hasOwnProperty(S)&&(y!=null||v!=null))switch(S){case"value":$=y;break;case"defaultValue":Z=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==v&&ct(r,o,S,y,c,v)}md(r,$,Z);return;case"option":for(var ve in u)if($=u[ve],u.hasOwnProperty(ve)&&$!=null&&!c.hasOwnProperty(ve))switch(ve){case"selected":r.selected=!1;break;default:ct(r,o,ve,null,c,$)}for(U in c)if($=c[U],Z=u[U],c.hasOwnProperty(U)&&$!==Z&&($!=null||Z!=null))switch(U){case"selected":r.selected=$&&typeof $!="function"&&typeof $!="symbol";break;default:ct(r,o,U,$,c,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Re in u)$=u[Re],u.hasOwnProperty(Re)&&$!=null&&!c.hasOwnProperty(Re)&&ct(r,o,Re,null,c,$);for(J in c)if($=c[J],Z=u[J],c.hasOwnProperty(J)&&$!==Z&&($!=null||Z!=null))switch(J){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(i(137,o));break;default:ct(r,o,J,$,c,Z)}return;default:if(aa(o)){for(var dt in u)$=u[dt],u.hasOwnProperty(dt)&&$!==void 0&&!c.hasOwnProperty(dt)&&ig(r,o,dt,void 0,c,$);for(te in c)$=c[te],Z=u[te],!c.hasOwnProperty(te)||$===Z||$===void 0&&Z===void 0||ig(r,o,te,$,c,Z);return}}for(var G in u)$=u[G],u.hasOwnProperty(G)&&$!=null&&!c.hasOwnProperty(G)&&ct(r,o,G,null,c,$);for(ie in c)$=c[ie],Z=u[ie],!c.hasOwnProperty(ie)||$===Z||$==null&&Z==null||ct(r,o,ie,$,c,Z)}function i0(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function eN(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),c=0;c<u.length;c++){var y=u[c],v=y.transferSize,S=y.initiatorType,w=y.duration;if(v&&w&&i0(S)){for(S=0,w=y.responseEnd,c+=1;c<u.length;c++){var U=u[c],J=U.startTime;if(J>w)break;var te=U.transferSize,ie=U.initiatorType;te&&i0(ie)&&(U=U.responseEnd,S+=te*(U<w?1:(w-J)/(U-J)))}if(--c,o+=8*(v+S)/(y.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var rg=null,sg=null;function vf(r){return r.nodeType===9?r:r.ownerDocument}function r0(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function s0(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function og(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var ag=null;function tN(){var r=window.event;return r&&r.type==="popstate"?r===ag?!1:(ag=r,!0):(ag=null,!1)}var o0=typeof setTimeout=="function"?setTimeout:void 0,nN=typeof clearTimeout=="function"?clearTimeout:void 0,a0=typeof Promise=="function"?Promise:void 0,iN=typeof queueMicrotask=="function"?queueMicrotask:typeof a0<"u"?function(r){return a0.resolve(null).then(r).catch(rN)}:o0;function rN(r){setTimeout(function(){throw r})}function ds(r){return r==="head"}function l0(r,o){var u=o,c=0;do{var y=u.nextSibling;if(r.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(c===0){r.removeChild(y),Ga(o);return}c--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")c++;else if(u==="html")qu(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,qu(u);for(var v=u.firstChild;v;){var S=v.nextSibling,w=v.nodeName;v[Mi]||w==="SCRIPT"||w==="STYLE"||w==="LINK"&&v.rel.toLowerCase()==="stylesheet"||u.removeChild(v),v=S}}else u==="body"&&qu(r.ownerDocument.body);u=y}while(u);Ga(o)}function u0(r,o){var u=r;r=0;do{var c=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),c&&c.nodeType===8)if(u=c.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=c}while(u)}function lg(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":lg(u),ra(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function sN(r,o,u,c){for(;r.nodeType===1;){var y=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!c&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(c){if(!r[Mi])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(v=r.getAttribute("rel"),v==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(v!==y.rel||r.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||r.getAttribute("title")!==(y.title==null?null:y.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(v=r.getAttribute("src"),(v!==(y.src==null?null:y.src)||r.getAttribute("type")!==(y.type==null?null:y.type)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&v&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var v=y.name==null?null:""+y.name;if(y.type==="hidden"&&r.getAttribute("name")===v)return r}else return r;if(r=ni(r.nextSibling),r===null)break}return null}function oN(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=ni(r.nextSibling),r===null))return null;return r}function c0(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=ni(r.nextSibling),r===null))return null;return r}function ug(r){return r.data==="$?"||r.data==="$~"}function cg(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function aN(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var c=function(){o(),u.removeEventListener("DOMContentLoaded",c)};u.addEventListener("DOMContentLoaded",c),r._reactRetry=c}}function ni(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var dg=null;function d0(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return ni(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function f0(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function h0(r,o,u){switch(o=vf(u),r){case"html":if(r=o.documentElement,!r)throw Error(i(452));return r;case"head":if(r=o.head,!r)throw Error(i(453));return r;case"body":if(r=o.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function qu(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);ra(r)}var ii=new Map,p0=new Set;function Ef(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Tr=oe.d;oe.d={f:lN,r:uN,D:cN,C:dN,L:fN,m:hN,X:mN,S:pN,M:gN};function lN(){var r=Tr.f(),o=df();return r||o}function uN(r){var o=Jn(r);o!==null&&o.tag===5&&o.type==="form"?DE(o):Tr.r(r)}var Fa=typeof document>"u"?null:document;function m0(r,o,u){var c=Fa;if(c&&typeof o=="string"&&o){var y=Sn(o);y='link[rel="'+r+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),p0.has(y)||(p0.add(y),r={rel:r,crossOrigin:u,href:o},c.querySelector(y)===null&&(o=c.createElement("link"),an(o,"link",r),Vt(o),c.head.appendChild(o)))}}function cN(r){Tr.D(r),m0("dns-prefetch",r,null)}function dN(r,o){Tr.C(r,o),m0("preconnect",r,o)}function fN(r,o,u){Tr.L(r,o,u);var c=Fa;if(c&&r&&o){var y='link[rel="preload"][as="'+Sn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+Sn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+Sn(u.imageSizes)+'"]')):y+='[href="'+Sn(r)+'"]';var v=y;switch(o){case"style":v=Ba(r);break;case"script":v=qa(r)}ii.has(v)||(r=E({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),ii.set(v,r),c.querySelector(y)!==null||o==="style"&&c.querySelector(Gu(v))||o==="script"&&c.querySelector(zu(v))||(o=c.createElement("link"),an(o,"link",r),Vt(o),c.head.appendChild(o)))}}function hN(r,o){Tr.m(r,o);var u=Fa;if(u&&r){var c=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+Sn(c)+'"][href="'+Sn(r)+'"]',v=y;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=qa(r)}if(!ii.has(v)&&(r=E({rel:"modulepreload",href:r},o),ii.set(v,r),u.querySelector(y)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(zu(v)))return}c=u.createElement("link"),an(c,"link",r),Vt(c),u.head.appendChild(c)}}}function pN(r,o,u){Tr.S(r,o,u);var c=Fa;if(c&&r){var y=ki(c).hoistableStyles,v=Ba(r);o=o||"default";var S=y.get(v);if(!S){var w={loading:0,preload:null};if(S=c.querySelector(Gu(v)))w.loading=5;else{r=E({rel:"stylesheet",href:r,"data-precedence":o},u),(u=ii.get(v))&&fg(r,u);var U=S=c.createElement("link");Vt(U),an(U,"link",r),U._p=new Promise(function(J,te){U.onload=J,U.onerror=te}),U.addEventListener("load",function(){w.loading|=1}),U.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Tf(S,o,c)}S={type:"stylesheet",instance:S,count:1,state:w},y.set(v,S)}}}function mN(r,o){Tr.X(r,o);var u=Fa;if(u&&r){var c=ki(u).hoistableScripts,y=qa(r),v=c.get(y);v||(v=u.querySelector(zu(y)),v||(r=E({src:r,async:!0},o),(o=ii.get(y))&&hg(r,o),v=u.createElement("script"),Vt(v),an(v,"link",r),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(y,v))}}function gN(r,o){Tr.M(r,o);var u=Fa;if(u&&r){var c=ki(u).hoistableScripts,y=qa(r),v=c.get(y);v||(v=u.querySelector(zu(y)),v||(r=E({src:r,async:!0,type:"module"},o),(o=ii.get(y))&&hg(r,o),v=u.createElement("script"),Vt(v),an(v,"link",r),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(y,v))}}function g0(r,o,u,c){var y=(y=Ve.current)?Ef(y):null;if(!y)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Ba(u.href),u=ki(y).hoistableStyles,c=u.get(o),c||(c={type:"style",instance:null,count:0,state:null},u.set(o,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Ba(u.href);var v=ki(y).hoistableStyles,S=v.get(r);if(S||(y=y.ownerDocument||y,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(r,S),(v=y.querySelector(Gu(r)))&&!v._p&&(S.instance=v,S.state.loading=5),ii.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ii.set(r,u),v||yN(y,r,u,S.state))),o&&c===null)throw Error(i(528,""));return S}if(o&&c!==null)throw Error(i(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=qa(u),u=ki(y).hoistableScripts,c=u.get(o),c||(c={type:"script",instance:null,count:0,state:null},u.set(o,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Ba(r){return'href="'+Sn(r)+'"'}function Gu(r){return'link[rel="stylesheet"]['+r+"]"}function y0(r){return E({},r,{"data-precedence":r.precedence,precedence:null})}function yN(r,o,u,c){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?c.loading=1:(o=r.createElement("link"),c.preload=o,o.addEventListener("load",function(){return c.loading|=1}),o.addEventListener("error",function(){return c.loading|=2}),an(o,"link",u),Vt(o),r.head.appendChild(o))}function qa(r){return'[src="'+Sn(r)+'"]'}function zu(r){return"script[async]"+r}function _0(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var c=r.querySelector('style[data-href~="'+Sn(u.href)+'"]');if(c)return o.instance=c,Vt(c),c;var y=E({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return c=(r.ownerDocument||r).createElement("style"),Vt(c),an(c,"style",y),Tf(c,u.precedence,r),o.instance=c;case"stylesheet":y=Ba(u.href);var v=r.querySelector(Gu(y));if(v)return o.state.loading|=4,o.instance=v,Vt(v),v;c=y0(u),(y=ii.get(y))&&fg(c,y),v=(r.ownerDocument||r).createElement("link"),Vt(v);var S=v;return S._p=new Promise(function(w,U){S.onload=w,S.onerror=U}),an(v,"link",c),o.state.loading|=4,Tf(v,u.precedence,r),o.instance=v;case"script":return v=qa(u.src),(y=r.querySelector(zu(v)))?(o.instance=y,Vt(y),y):(c=u,(y=ii.get(v))&&(c=E({},u),hg(c,y)),r=r.ownerDocument||r,y=r.createElement("script"),Vt(y),an(y,"link",c),r.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(c=o.instance,o.state.loading|=4,Tf(c,u.precedence,r));return o.instance}function Tf(r,o,u){for(var c=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=c.length?c[c.length-1]:null,v=y,S=0;S<c.length;S++){var w=c[S];if(w.dataset.precedence===o)v=w;else if(v!==y)break}v?v.parentNode.insertBefore(r,v.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function fg(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function hg(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var Af=null;function v0(r,o,u){if(Af===null){var c=new Map,y=Af=new Map;y.set(u,c)}else y=Af,c=y.get(u),c||(c=new Map,y.set(u,c));if(c.has(r))return c;for(c.set(r,null),u=u.getElementsByTagName(r),y=0;y<u.length;y++){var v=u[y];if(!(v[Mi]||v[kt]||r==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var S=v.getAttribute(o)||"";S=r+S;var w=c.get(S);w?w.push(v):c.set(S,[v])}}return c}function E0(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function _N(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function T0(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function vN(r,o,u,c){if(u.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Ba(c.href),v=o.querySelector(Gu(y));if(v){o=v._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=Sf.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=v,Vt(v);return}v=o.ownerDocument||o,c=y0(c),(y=ii.get(y))&&fg(c,y),v=v.createElement("link"),Vt(v);var S=v;S._p=new Promise(function(w,U){S.onload=w,S.onerror=U}),an(v,"link",c),u.instance=v}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=Sf.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var pg=0;function EN(r,o){return r.stylesheets&&r.count===0&&Cf(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var c=setTimeout(function(){if(r.stylesheets&&Cf(r,r.stylesheets),r.unsuspend){var v=r.unsuspend;r.unsuspend=null,v()}},6e4+o);0<r.imgBytes&&pg===0&&(pg=62500*eN());var y=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Cf(r,r.stylesheets),r.unsuspend)){var v=r.unsuspend;r.unsuspend=null,v()}},(r.imgBytes>pg?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(c),clearTimeout(y)}}:null}function Sf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Cf(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var If=null;function Cf(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,If=new Map,o.forEach(TN,r),If=null,Sf.call(r))}function TN(r,o){if(!(o.state.loading&4)){var u=If.get(r);if(u)var c=u.get(null);else{u=new Map,If.set(r,u);for(var y=r.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<y.length;v++){var S=y[v];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(u.set(S.dataset.precedence,S),c=S)}c&&u.set(null,c)}y=o.instance,S=y.getAttribute("data-precedence"),v=u.get(S)||c,v===c&&u.set(null,y),u.set(S,y),this.count++,c=Sf.bind(this),y.addEventListener("load",c),y.addEventListener("error",c),v?v.parentNode.insertBefore(y,v.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(y,r.firstChild)),o.state.loading|=4}}var Hu={$$typeof:X,Provider:null,Consumer:null,_currentValue:_e,_currentValue2:_e,_threadCount:0};function AN(r,o,u,c,y,v,S,w,U){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ni(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ni(0),this.hiddenUpdates=Ni(null),this.identifierPrefix=c,this.onUncaughtError=y,this.onCaughtError=v,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function A0(r,o,u,c,y,v,S,w,U,J,te,ie){return r=new AN(r,o,u,S,U,J,te,ie,w),o=1,v===!0&&(o|=24),v=Vn(3,null,null,o),r.current=v,v.stateNode=r,o=Yp(),o.refCount++,r.pooledCache=o,o.refCount++,v.memoizedState={element:c,isDehydrated:u,cache:o},Wp(v),r}function S0(r){return r?(r=_a,r):_a}function I0(r,o,u,c,y,v){y=S0(y),c.context===null?c.context=y:c.pendingContext=y,c=es(o),c.payload={element:u},v=v===void 0?null:v,v!==null&&(c.callback=v),u=ts(r,c,o),u!==null&&(xn(u,r,o),Au(u,r,o))}function C0(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function mg(r,o){C0(r,o),(r=r.alternate)&&C0(r,o)}function w0(r){if(r.tag===13||r.tag===31){var o=lo(r,67108864);o!==null&&xn(o,r,67108864),mg(r,67108864)}}function R0(r){if(r.tag===13||r.tag===31){var o=Bn();o=Xs(o);var u=lo(r,o);u!==null&&xn(u,r,o),mg(r,o)}}var wf=!0;function SN(r,o,u,c){var y=Y.T;Y.T=null;var v=oe.p;try{oe.p=2,gg(r,o,u,c)}finally{oe.p=v,Y.T=y}}function IN(r,o,u,c){var y=Y.T;Y.T=null;var v=oe.p;try{oe.p=8,gg(r,o,u,c)}finally{oe.p=v,Y.T=y}}function gg(r,o,u,c){if(wf){var y=yg(c);if(y===null)ng(r,o,c,Rf,u),x0(r,c);else if(wN(y,r,o,u,c))c.stopPropagation();else if(x0(r,c),o&4&&-1<CN.indexOf(r)){for(;y!==null;){var v=Jn(y);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var S=bi(v.pendingLanes);if(S!==0){var w=v;for(w.pendingLanes|=2,w.entangledLanes|=2;S;){var U=1<<31-Ct(S);w.entanglements[1]|=U,S&=~U}Yi(v),(et&6)===0&&(uf=yn()+500,Ou(0))}}break;case 31:case 13:w=lo(v,2),w!==null&&xn(w,v,2),df(),mg(v,2)}if(v=yg(c),v===null&&ng(r,o,c,Rf,u),v===y)break;y=v}y!==null&&c.stopPropagation()}else ng(r,o,c,null,u)}}function yg(r){return r=Yn(r),_g(r)}var Rf=null;function _g(r){if(Rf=null,r=Pi(r),r!==null){var o=a(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=l(o),r!==null)return r;r=null}else if(u===31){if(r=d(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Rf=r,null}function b0(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Js()){case Yl:return 2;case $l:return 8;case Fr:case Ip:return 32;case rd:return 268435456;default:return 32}default:return 32}}var vg=!1,fs=null,hs=null,ps=null,Ku=new Map,Ju=new Map,ms=[],CN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function x0(r,o){switch(r){case"focusin":case"focusout":fs=null;break;case"dragenter":case"dragleave":hs=null;break;case"mouseover":case"mouseout":ps=null;break;case"pointerover":case"pointerout":Ku.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ju.delete(o.pointerId)}}function Yu(r,o,u,c,y,v){return r===null||r.nativeEvent!==v?(r={blockedOn:o,domEventName:u,eventSystemFlags:c,nativeEvent:v,targetContainers:[y]},o!==null&&(o=Jn(o),o!==null&&w0(o)),r):(r.eventSystemFlags|=c,o=r.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),r)}function wN(r,o,u,c,y){switch(o){case"focusin":return fs=Yu(fs,r,o,u,c,y),!0;case"dragenter":return hs=Yu(hs,r,o,u,c,y),!0;case"mouseover":return ps=Yu(ps,r,o,u,c,y),!0;case"pointerover":var v=y.pointerId;return Ku.set(v,Yu(Ku.get(v)||null,r,o,u,c,y)),!0;case"gotpointercapture":return v=y.pointerId,Ju.set(v,Yu(Ju.get(v)||null,r,o,u,c,y)),!0}return!1}function N0(r){var o=Pi(r.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){r.blockedOn=o,ci(r.priority,function(){R0(u)});return}}else if(o===31){if(o=d(u),o!==null){r.blockedOn=o,ci(r.priority,function(){R0(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function bf(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=yg(r.nativeEvent);if(u===null){u=r.nativeEvent;var c=new u.constructor(u.type,u);ou=c,u.target.dispatchEvent(c),ou=null}else return o=Jn(u),o!==null&&w0(o),r.blockedOn=u,!1;o.shift()}return!0}function D0(r,o,u){bf(r)&&u.delete(o)}function RN(){vg=!1,fs!==null&&bf(fs)&&(fs=null),hs!==null&&bf(hs)&&(hs=null),ps!==null&&bf(ps)&&(ps=null),Ku.forEach(D0),Ju.forEach(D0)}function xf(r,o){r.blockedOn===o&&(r.blockedOn=null,vg||(vg=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,RN)))}var Nf=null;function M0(r){Nf!==r&&(Nf=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Nf===r&&(Nf=null);for(var o=0;o<r.length;o+=3){var u=r[o],c=r[o+1],y=r[o+2];if(typeof c!="function"){if(_g(c||u)===null)continue;break}var v=Jn(u);v!==null&&(r.splice(o,3),o-=3,ym(v,{pending:!0,data:y,method:u.method,action:c},c,y))}}))}function Ga(r){function o(U){return xf(U,r)}fs!==null&&xf(fs,r),hs!==null&&xf(hs,r),ps!==null&&xf(ps,r),Ku.forEach(o),Ju.forEach(o);for(var u=0;u<ms.length;u++){var c=ms[u];c.blockedOn===r&&(c.blockedOn=null)}for(;0<ms.length&&(u=ms[0],u.blockedOn===null);)N0(u),u.blockedOn===null&&ms.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(c=0;c<u.length;c+=3){var y=u[c],v=u[c+1],S=y[Xt]||null;if(typeof v=="function")S||M0(u);else if(S){var w=null;if(v&&v.hasAttribute("formAction")){if(y=v,S=v[Xt]||null)w=S.formAction;else if(_g(y)!==null)continue}else w=S.action;typeof w=="function"?u[c+1]=w:(u.splice(c,3),c-=3),M0(u)}}}function P0(){function r(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(S){return y=S})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),c||setTimeout(u,20)}function u(){if(!c&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,y=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){c=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function Eg(r){this._internalRoot=r}Df.prototype.render=Eg.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(i(409));var u=o.current,c=Bn();I0(u,c,r,o,null,null)},Df.prototype.unmount=Eg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;I0(r.current,2,null,r,null,null),df(),o[Di]=null}};function Df(r){this._internalRoot=r}Df.prototype.unstable_scheduleHydration=function(r){if(r){var o=cd();r={blockedOn:null,target:r,priority:o};for(var u=0;u<ms.length&&o!==0&&o<ms[u].priority;u++);ms.splice(u,0,r),u===0&&N0(r)}};var k0=e.version;if(k0!=="19.2.3")throw Error(i(527,k0,"19.2.3"));oe.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=p(o),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var bN={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mf.isDisabled&&Mf.supportsFiber)try{li=Mf.inject(bN),tn=Mf}catch{}}return Qu.createRoot=function(r,o){if(!s(r))throw Error(i(299));var u=!1,c="",y=qE,v=GE,S=zE;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(c=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError)),o=A0(r,1,!1,null,null,u,c,null,y,v,S,P0),r[Di]=o.current,tg(r),new Eg(o)},Qu.hydrateRoot=function(r,o,u){if(!s(r))throw Error(i(299));var c=!1,y="",v=qE,S=GE,w=zE,U=null;return u!=null&&(u.unstable_strictMode===!0&&(c=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(v=u.onUncaughtError),u.onCaughtError!==void 0&&(S=u.onCaughtError),u.onRecoverableError!==void 0&&(w=u.onRecoverableError),u.formState!==void 0&&(U=u.formState)),o=A0(r,1,!0,o,u??null,c,y,U,v,S,w,P0),o.context=S0(null),u=o.current,c=Bn(),c=Xs(c),y=es(c),y.callback=null,ts(u,y,c),u=c,o.current.lanes=u,$s(o,u),Yi(o),r[Di]=o.current,tg(r),new Df(o)},Qu.version="19.2.3",Qu}var H0;function FN(){if(H0)return Sg.exports;H0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Sg.exports=ON(),Sg.exports}var BN=FN();const qN=wC(BN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),zN=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),K0=n=>{const e=zN(n);return e.charAt(0).toUpperCase()+e.slice(1)},RC=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),HN=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var KN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=we.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:s="",children:a,iconNode:l,...d},f)=>we.createElement("svg",{ref:f,...KN,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:RC("lucide",s),...!a&&!HN(d)&&{"aria-hidden":"true"},...d},[...l.map(([p,_])=>we.createElement(p,_)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=(n,e)=>{const t=we.forwardRef(({className:i,...s},a)=>we.createElement(JN,{ref:a,iconNode:e,className:RC(`lucide-${GN(K0(n))}`,`lucide-${n}`,i),...s}));return t.displayName=K0(n),t};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Yf=Ke("arrow-right",YN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],bC=Ke("book-open",$N);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],Jg=Ke("book",QN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],xC=Ke("bookmark",XN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],NC=Ke("camera",WN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],jN=Ke("chevron-right",ZN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],tD=Ke("chevron-left",eD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],iD=Ke("circle-alert",nD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],fh=Ke("circle-check-big",rD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],J0=Ke("circle-check",sD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],aD=Ke("circle-user",oD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],uD=Ke("circle-x",lD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],dD=Ke("download",cD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],hD=Ke("graduation-cap",fD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pD=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],mD=Ke("history",pD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gD=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],hh=Ke("key",gD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yD=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],_D=Ke("layers",yD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vD=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Mo=Ke("loader-circle",vD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ED=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],TD=Ke("lock",ED);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AD=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],SD=Ke("log-in",AD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ID=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],CD=Ke("log-out",ID);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wD=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],RD=Ke("mail",wD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bD=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],xD=Ke("moon",bD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ND=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],ph=Ke("play",ND);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DD=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],MD=Ke("quote",DD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PD=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],kD=Ke("refresh-cw",PD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],LD=Ke("save",VD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],DC=Ke("settings",UD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],MC=Ke("shield-check",OD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],PC=Ke("sparkles",FD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],qD=Ke("sun",BD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],kC=Ke("trash-2",GD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zD=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Y0=Ke("upload",zD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],KD=Ke("user-plus",HD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],VC=Ke("user",JD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YD=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],$D=Ke("x",YD);var St=(n=>(n.HOME="HOME",n.ANALYZE="ANALYZE",n.VOCAB="VOCAB",n.HISTORY="HISTORY",n.SETTINGS="SETTINGS",n))(St||{});const QD=()=>{};var $0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},XD=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[i++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],d=n[t++],f=((s&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},UC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,d=l?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,_=a>>2,E=(a&3)<<4|d>>4;let T=(d&15)<<2|p>>6,C=p&63;f||(C=64,l||(T=64)),i.push(t[_],t[E],t[T],t[C])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(LC(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):XD(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const E=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||d==null||p==null||E==null)throw new WD;const T=a<<2|d>>4;if(i.push(T),p!==64){const C=d<<4&240|p>>2;if(i.push(C),E!==64){const P=p<<6&192|E;i.push(P)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class WD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZD=function(n){const e=LC(n);return UC.encodeByteArray(e,!0)},OC=function(n){return ZD(n).replace(/\./g,"")},FC=function(n){try{return UC.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jD=()=>BC().__FIREBASE_DEFAULTS__,e2=()=>{if(typeof process>"u"||typeof $0>"u")return;const n=$0.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},t2=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&FC(n[1]);return e&&JSON.parse(e)},Kh=()=>{try{return QD()||jD()||e2()||t2()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},n2=n=>{var e,t;return(t=(e=Kh())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},qC=()=>{var n;return(n=Kh())==null?void 0:n.config},GC=n=>{var e;return(e=Kh())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function zC(n){return(await fetch(n,{credentials:"include"})).ok}const cc={};function r2(){const n={prod:[],emulator:[]};for(const e of Object.keys(cc))cc[e]?n.emulator.push(e):n.prod.push(e);return n}function s2(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let Q0=!1;function o2(n,e){if(typeof window>"u"||typeof document>"u"||!Ml(window.location.host)||cc[n]===e||cc[n]||Q0)return;cc[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",a=r2().prod.length>0;function l(){const T=document.getElementById(i);T&&T.remove()}function d(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function f(T,C){T.setAttribute("width","24"),T.setAttribute("id",C),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function p(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{Q0=!0,l()},T}function _(T,C){T.setAttribute("id",C),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function E(){const T=s2(i),C=t("text"),P=document.getElementById(C)||document.createElement("span"),O=t("learnmore"),k=document.getElementById(O)||document.createElement("a"),Q=t("preprendIcon"),j=document.getElementById(Q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const X=T.element;d(X),_(k,O);const se=p();f(j,Q),X.append(j,P,k,se),document.body.appendChild(X)}a?(P.innerText="Preview backend disconnected.",j.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(j.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function a2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($t())}function HC(){var e;const n=(e=Kh())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function l2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function u2(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function c2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function d2(){const n=$t();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function KC(){return!HC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JC(){return!HC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function YC(){try{return typeof indexedDB=="object"}catch{return!1}}function f2(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var a;e(((a=s.error)==null?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2="FirebaseError";class Mr extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=h2,Object.setPrototypeOf(this,Mr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fc.prototype.create)}}class Fc{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?p2(a,i):"Error",d=`${this.serviceName}: ${l} (${s}).`;return new Mr(s,d,i)}}function p2(n,e){return n.replace(m2,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const m2=/\{\$([^}]+)}/g;function g2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Uo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const a=n[s],l=e[s];if(X0(a)&&X0(l)){if(!Uo(a,l))return!1}else if(a!==l)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function X0(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function ic(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,a]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function rc(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function y2(n,e){const t=new _2(n,e);return t.subscribe.bind(t)}class _2{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");v2(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=Rg),s.error===void 0&&(s.error=Rg),s.complete===void 0&&(s.complete=Rg);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function v2(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Rg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(n){return n&&n._delegate?n._delegate:n}class Oo{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const So="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new i2;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(A2(e))try{this.getOrInitializeService({instanceIdentifier:So})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});i.resolve(a)}catch{}}}}clearInstance(e=So){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=So){return this.instances.has(e)}getOptions(e=So){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);i===d&&l.resolve(s)}return s}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(i)??new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:T2(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=So){return this.component?this.component.multipleInstances?e:So:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function T2(n){return n===So?void 0:n}function A2(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new E2(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ze||(ze={}));const I2={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},C2=ze.INFO,w2={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},R2=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=w2[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ky{constructor(e){this.name=e,this._logLevel=C2,this._logHandler=R2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?I2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const b2=(n,e)=>e.some(t=>n instanceof t);let W0,Z0;function x2(){return W0||(W0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function N2(){return Z0||(Z0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $C=new WeakMap,Yg=new WeakMap,QC=new WeakMap,bg=new WeakMap,Jy=new WeakMap;function D2(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(Rs(n.result)),s()},l=()=>{i(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&$C.set(t,n)}).catch(()=>{}),Jy.set(e,n),e}function M2(n){if(Yg.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Yg.set(n,e)}let $g={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Yg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||QC.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Rs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function P2(n){$g=n($g)}function k2(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(xg(this),e,...t);return QC.set(i,e.sort?e.sort():[e]),Rs(i)}:N2().includes(n)?function(...e){return n.apply(xg(this),e),Rs($C.get(this))}:function(...e){return Rs(n.apply(xg(this),e))}}function V2(n){return typeof n=="function"?k2(n):(n instanceof IDBTransaction&&M2(n),b2(n,x2())?new Proxy(n,$g):n)}function Rs(n){if(n instanceof IDBRequest)return D2(n);if(bg.has(n))return bg.get(n);const e=V2(n);return e!==n&&(bg.set(n,e),Jy.set(e,n)),e}const xg=n=>Jy.get(n);function L2(n,e,{blocked:t,upgrade:i,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),d=Rs(l);return i&&l.addEventListener("upgradeneeded",f=>{i(Rs(l.result),f.oldVersion,f.newVersion,Rs(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const U2=["get","getKey","getAll","getAllKeys","count"],O2=["put","add","delete","clear"],Ng=new Map;function j0(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ng.get(e))return Ng.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=O2.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||U2.includes(t)))return;const a=async function(l,...d){const f=this.transaction(l,s?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(d.shift())),(await Promise.all([p[t](...d),s&&f.done]))[0]};return Ng.set(e,a),a}P2(n=>({...n,get:(e,t,i)=>j0(e,t)||n.get(e,t,i),has:(e,t)=>!!j0(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(B2(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function B2(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Qg="@firebase/app",eA="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=new Ky("@firebase/app"),q2="@firebase/app-compat",G2="@firebase/analytics-compat",z2="@firebase/analytics",H2="@firebase/app-check-compat",K2="@firebase/app-check",J2="@firebase/auth",Y2="@firebase/auth-compat",$2="@firebase/database",Q2="@firebase/data-connect",X2="@firebase/database-compat",W2="@firebase/functions",Z2="@firebase/functions-compat",j2="@firebase/installations",eM="@firebase/installations-compat",tM="@firebase/messaging",nM="@firebase/messaging-compat",iM="@firebase/performance",rM="@firebase/performance-compat",sM="@firebase/remote-config",oM="@firebase/remote-config-compat",aM="@firebase/storage",lM="@firebase/storage-compat",uM="@firebase/firestore",cM="@firebase/ai",dM="@firebase/firestore-compat",fM="firebase",hM="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="[DEFAULT]",pM={[Qg]:"fire-core",[q2]:"fire-core-compat",[z2]:"fire-analytics",[G2]:"fire-analytics-compat",[K2]:"fire-app-check",[H2]:"fire-app-check-compat",[J2]:"fire-auth",[Y2]:"fire-auth-compat",[$2]:"fire-rtdb",[Q2]:"fire-data-connect",[X2]:"fire-rtdb-compat",[W2]:"fire-fn",[Z2]:"fire-fn-compat",[j2]:"fire-iid",[eM]:"fire-iid-compat",[tM]:"fire-fcm",[nM]:"fire-fcm-compat",[iM]:"fire-perf",[rM]:"fire-perf-compat",[sM]:"fire-rc",[oM]:"fire-rc-compat",[aM]:"fire-gcs",[lM]:"fire-gcs-compat",[uM]:"fire-fst",[dM]:"fire-fst-compat",[cM]:"fire-vertex","fire-js":"fire-js",[fM]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=new Map,mM=new Map,Wg=new Map;function tA(n,e){try{n.container.addComponent(e)}catch(t){Rr.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function fl(n){const e=n.name;if(Wg.has(e))return Rr.debug(`There were multiple attempts to register component ${e}.`),!1;Wg.set(e,n);for(const t of mh.values())tA(t,n);for(const t of mM.values())tA(t,n);return!0}function Yy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ri(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bs=new Fc("app","Firebase",gM);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Oo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pl=hM;function XC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Xg,automaticDataCollectionEnabled:!0,...e},s=i.name;if(typeof s!="string"||!s)throw bs.create("bad-app-name",{appName:String(s)});if(t||(t=qC()),!t)throw bs.create("no-options");const a=mh.get(s);if(a){if(Uo(t,a.options)&&Uo(i,a.config))return a;throw bs.create("duplicate-app",{appName:s})}const l=new S2(s);for(const f of Wg.values())l.addComponent(f);const d=new yM(t,i,l);return mh.set(s,d),d}function _M(n=Xg){const e=mh.get(n);if(!e&&n===Xg&&qC())return XC();if(!e)throw bs.create("no-app",{appName:n});return e}function xs(n,e,t){let i=pM[n]??n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Rr.warn(l.join(" "));return}fl(new Oo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM="firebase-heartbeat-database",EM=1,Tc="firebase-heartbeat-store";let Dg=null;function WC(){return Dg||(Dg=L2(vM,EM,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Tc)}catch(t){console.warn(t)}}}}).catch(n=>{throw bs.create("idb-open",{originalErrorMessage:n.message})})),Dg}async function TM(n){try{const t=(await WC()).transaction(Tc),i=await t.objectStore(Tc).get(ZC(n));return await t.done,i}catch(e){if(e instanceof Mr)Rr.warn(e.message);else{const t=bs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Rr.warn(t.message)}}}async function nA(n,e){try{const i=(await WC()).transaction(Tc,"readwrite");await i.objectStore(Tc).put(e,ZC(n)),await i.done}catch(t){if(t instanceof Mr)Rr.warn(t.message);else{const i=bs.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Rr.warn(i.message)}}}function ZC(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM=1024,SM=30;class IM{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new wM(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=iA();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>SM){const l=RM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Rr.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=iA(),{heartbeatsToSend:i,unsentEntries:s}=CM(this._heartbeatsCache.heartbeats),a=OC(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Rr.warn(t),""}}}function iA(){return new Date().toISOString().substring(0,10)}function CM(n,e=AM){const t=[];let i=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),rA(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),rA(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class wM{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return YC()?f2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await TM(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return nA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return nA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function rA(n){return OC(JSON.stringify({version:2,heartbeats:n})).length}function RM(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bM(n){fl(new Oo("platform-logger",e=>new F2(e),"PRIVATE")),fl(new Oo("heartbeat",e=>new IM(e),"PRIVATE")),xs(Qg,eA,n),xs(Qg,eA,"esm2020"),xs("fire-js","")}bM("");var xM="firebase",NM="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xs(xM,NM,"app");function jC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const DM=jC,ew=new Fc("auth","Firebase",jC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh=new Ky("@firebase/auth");function MM(n,...e){gh.logLevel<=ze.WARN&&gh.warn(`Auth (${Pl}): ${n}`,...e)}function $f(n,...e){gh.logLevel<=ze.ERROR&&gh.error(`Auth (${Pl}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ii(n,...e){throw $y(n,...e)}function Zi(n,...e){return $y(n,...e)}function tw(n,e,t){const i={...DM(),[e]:t};return new Fc("auth","Firebase",i).create(e,{appName:n.name})}function Cr(n){return tw(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $y(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return ew.create(n,...e)}function be(n,e,...t){if(!n)throw $y(e,...t)}function Ar(n){const e="INTERNAL ASSERTION FAILED: "+n;throw $f(e),new Error(e)}function br(n,e){n||Ar(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zg(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function PM(){return sA()==="http:"||sA()==="https:"}function sA(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PM()||u2()||"connection"in navigator)?navigator.onLine:!0}function VM(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,t){this.shortDelay=e,this.longDelay=t,br(t>e,"Short delay should be less than long delay!"),this.isMobile=a2()||c2()}get(){return kM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qy(n,e){br(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ar("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ar("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ar("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UM=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],OM=new qc(3e4,6e4);function Os(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Pr(n,e,t,i,s={}){return iw(n,s,async()=>{let a={},l={};i&&(e==="GET"?l=i:a={body:JSON.stringify(i)});const d=Bc({key:n.config.apiKey,...l}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...a};return l2()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Ml(n.emulatorConfig.host)&&(p.credentials="include"),nw.fetch()(await rw(n,n.config.apiHost,t,d),p)})}async function iw(n,e,t){n._canInitEmulator=!1;const i={...LM,...e};try{const s=new BM(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Pf(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Pf(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Pf(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw Pf(n,"user-disabled",l);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw tw(n,_,p);Ii(n,_)}}catch(s){if(s instanceof Mr)throw s;Ii(n,"network-request-failed",{message:String(s)})}}async function Gc(n,e,t,i,s={}){const a=await Pr(n,e,t,i,s);return"mfaPendingCredential"in a&&Ii(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function rw(n,e,t,i){const s=`${e}${t}?${i}`,a=n,l=a.config.emulator?Qy(n.config,s):`${n.config.apiScheme}://${s}`;return UM.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function FM(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class BM{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Zi(this.auth,"network-request-failed")),OM.get())})}}function Pf(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=Zi(n,e,i);return s.customData._tokenResponse=t,s}function oA(n){return n!==void 0&&n.enterprise!==void 0}class qM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return FM(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function GM(n,e){return Pr(n,"GET","/v2/recaptchaConfig",Os(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zM(n,e){return Pr(n,"POST","/v1/accounts:delete",e)}async function yh(n,e){return Pr(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HM(n,e=!1){const t=zt(n),i=await t.getIdToken(e),s=Xy(i);be(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:s,token:i,authTime:dc(Mg(s.auth_time)),issuedAtTime:dc(Mg(s.iat)),expirationTime:dc(Mg(s.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Mg(n){return Number(n)*1e3}function Xy(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return $f("JWT malformed, contained fewer than 3 sections"),null;try{const s=FC(t);return s?JSON.parse(s):($f("Failed to decode base64 JWT payload"),null)}catch(s){return $f("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function aA(n){const e=Xy(n);return be(e,"internal-error"),be(typeof e.exp<"u","internal-error"),be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hl(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Mr&&KM(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function KM({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=dc(this.lastLoginAt),this.creationTime=dc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _h(n){var E;const e=n.auth,t=await n.getIdToken(),i=await hl(n,yh(e,{idToken:t}));be(i==null?void 0:i.users.length,e,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=(E=s.providerUserInfo)!=null&&E.length?sw(s.providerUserInfo):[],l=$M(n.providerData,a),d=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=d?f:!1,_={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new jg(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,_)}async function YM(n){const e=zt(n);await _h(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function $M(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function sw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QM(n,e){const t=await iw(n,{},async()=>{const i=Bc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await rw(n,s,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:i};return n.emulatorConfig&&Ml(n.emulatorConfig.host)&&(f.credentials="include"),nw.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function XM(n,e){return Pr(n,"POST","/v2/accounts:revokeToken",Os(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){be(e.idToken,"internal-error"),be(typeof e.idToken<"u","internal-error"),be(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){be(e.length!==0,"internal-error");const t=aA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:a}=await QM(e,t);this.updateTokensAndExpiration(i,s,Number(a))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:a}=t,l=new rl;return i&&(be(typeof i=="string","internal-error",{appName:e}),l.refreshToken=i),s&&(be(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(be(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new rl,this.toJSON())}_performRefresh(){return Ar("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(n,e){be(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ti{constructor({uid:e,auth:t,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new JM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new jg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await hl(this,this.stsTokenManager.getToken(this.auth,e));return be(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return HM(this,e)}reload(){return YM(this)}_assign(e){this!==e&&(be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ti({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await _h(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ri(this.auth.app))return Promise.reject(Cr(this.auth));const e=await this.getIdToken();return await hl(this,zM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,s=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,d=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:E,emailVerified:T,isAnonymous:C,providerData:P,stsTokenManager:O}=t;be(E&&O,e,"internal-error");const k=rl.fromJSON(this.name,O);be(typeof E=="string",e,"internal-error"),ys(i,e.name),ys(s,e.name),be(typeof T=="boolean",e,"internal-error"),be(typeof C=="boolean",e,"internal-error"),ys(a,e.name),ys(l,e.name),ys(d,e.name),ys(f,e.name),ys(p,e.name),ys(_,e.name);const Q=new Ti({uid:E,auth:e,email:s,emailVerified:T,displayName:i,isAnonymous:C,photoURL:l,phoneNumber:a,tenantId:d,stsTokenManager:k,createdAt:p,lastLoginAt:_});return P&&Array.isArray(P)&&(Q.providerData=P.map(j=>({...j}))),f&&(Q._redirectEventId=f),Q}static async _fromIdTokenResponse(e,t,i=!1){const s=new rl;s.updateFromServerResponse(t);const a=new Ti({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await _h(a),a}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];be(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?sw(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),d=new rl;d.updateFromIdToken(i);const f=new Ti({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new jg(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lA=new Map;function Sr(n){br(n instanceof Function,"Expected a class definition");let e=lA.get(n);return e?(br(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,lA.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ow{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ow.type="NONE";const uA=ow;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(n,e,t){return`firebase:${n}:${e}:${t}`}class sl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:a}=this.auth;this.fullUserKey=Qf(this.userKey,s.apiKey,a),this.fullPersistenceKey=Qf("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await yh(this.auth,{idToken:e}).catch(()=>{});return t?Ti._fromGetAccountInfoResponse(this.auth,t,e):null}return Ti._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new sl(Sr(uA),e,i);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||Sr(uA);const l=Qf(i,e.config.apiKey,e.name);let d=null;for(const p of t)try{const _=await p._get(l);if(_){let E;if(typeof _=="string"){const T=await yh(e,{idToken:_}).catch(()=>{});if(!T)break;E=await Ti._fromGetAccountInfoResponse(e,T,_)}else E=Ti._fromJSON(e,_);p!==a&&(d=E),a=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new sl(a,e,i):(a=f[0],d&&await a._set(l,d.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new sl(a,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(cw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(aw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fw(e))return"Blackberry";if(hw(e))return"Webos";if(lw(e))return"Safari";if((e.includes("chrome/")||uw(e))&&!e.includes("edge/"))return"Chrome";if(dw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function aw(n=$t()){return/firefox\//i.test(n)}function lw(n=$t()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uw(n=$t()){return/crios\//i.test(n)}function cw(n=$t()){return/iemobile/i.test(n)}function dw(n=$t()){return/android/i.test(n)}function fw(n=$t()){return/blackberry/i.test(n)}function hw(n=$t()){return/webos/i.test(n)}function Wy(n=$t()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function WM(n=$t()){var e;return Wy(n)&&!!((e=window.navigator)!=null&&e.standalone)}function ZM(){return d2()&&document.documentMode===10}function pw(n=$t()){return Wy(n)||dw(n)||hw(n)||fw(n)||/windows phone/i.test(n)||cw(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(n,e=[]){let t;switch(n){case"Browser":t=cA($t());break;case"Worker":t=`${cA($t())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Pl}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=a=>new Promise((l,d)=>{try{const f=e(a);l(f)}catch(f){d(f)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eP(n,e={}){return Pr(n,"GET","/v2/passwordPolicy",Os(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tP=6;class nP{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??tP,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dA(this),this.idTokenSubscription=new dA(this),this.beforeStateQueue=new jM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ew,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Sr(t)),this._initializationPromise=this.queue(async()=>{var i,s,a;if(!this._deleted&&(this.persistenceManager=await sl.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await yh(this,{idToken:e}),i=await Ti._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(ri(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(a=this.redirectUser)==null?void 0:a._redirectEventId,d=i==null?void 0:i._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===d)&&(f!=null&&f.user)&&(i=f.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await _h(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ri(this.app))return Promise.reject(Cr(this));const t=e?zt(e):null;return t&&be(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ri(this.app)?Promise.reject(Cr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ri(this.app)?Promise.reject(Cr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Sr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await eP(this),t=new nP(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Fc("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await XM(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Sr(e)||this._popupRedirectResolver;be(t,this,"argument-error"),this.redirectPersistenceManager=await sl.create(this,[Sr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(be(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,i,s);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=mw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(ri(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&MM(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function $o(n){return zt(n)}class dA{constructor(e){this.auth=e,this.observer=null,this.addObserver=y2(t=>this.observer=t)}get next(){return be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rP(n){Jh=n}function gw(n){return Jh.loadJS(n)}function sP(){return Jh.recaptchaEnterpriseScript}function oP(){return Jh.gapiScript}function aP(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class lP{constructor(){this.enterprise=new uP}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class uP{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const cP="recaptcha-enterprise",yw="NO_RECAPTCHA";class dP{constructor(e){this.type=cP,this.auth=$o(e)}async verify(e="verify",t=!1){async function i(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,d)=>{GM(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const p=new qM(f);return a.tenantId==null?a._agentRecaptchaConfig=p:a._tenantRecaptchaConfigs[a.tenantId]=p,l(p.siteKey)}}).catch(f=>{d(f)})})}function s(a,l,d){const f=window.grecaptcha;oA(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(p=>{l(p)}).catch(()=>{l(yw)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new lP().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{i(this.auth).then(d=>{if(!t&&oA(window.grecaptcha))s(d,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=sP();f.length!==0&&(f+=d),gw(f).then(()=>{s(d,a,l)}).catch(p=>{l(p)})}}).catch(d=>{l(d)})})}}async function fA(n,e,t,i=!1,s=!1){const a=new dP(n);let l;if(s)l=yw;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,p=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:l}):Object.assign(d,{captchaResponse:l}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function ey(n,e,t,i,s){var a;if((a=n._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await fA(n,e,t,t==="getOobCode");return i(n,l)}else return i(n,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await fA(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fP(n,e){const t=Yy(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),a=t.getOptions();if(Uo(a,e??{}))return s;Ii(s,"already-initialized")}return t.initialize({options:e})}function hP(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Sr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function pP(n,e,t){const i=$o(n);be(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,a=_w(e),{host:l,port:d}=mP(e),f=d===null?"":`:${d}`,p={url:`${a}//${l}${f}/`},_=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){be(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),be(Uo(p,i.config.emulator)&&Uo(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Ml(l)?(zC(`${a}//${l}${f}`),o2("Auth",!0)):gP()}function _w(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mP(n){const e=_w(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const a=s[1];return{host:a,port:hA(i.substr(a.length+1))}}else{const[a,l]=i.split(":");return{host:a,port:hA(l)}}}function hA(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function gP(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ar("not implemented")}_getIdTokenResponse(e){return Ar("not implemented")}_linkToIdToken(e,t){return Ar("not implemented")}_getReauthenticationResolver(e){return Ar("not implemented")}}async function yP(n,e){return Pr(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _P(n,e){return Gc(n,"POST","/v1/accounts:signInWithPassword",Os(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vP(n,e){return Gc(n,"POST","/v1/accounts:signInWithEmailLink",Os(n,e))}async function EP(n,e){return Gc(n,"POST","/v1/accounts:signInWithEmailLink",Os(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac extends Zy{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Ac(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Ac(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ey(e,t,"signInWithPassword",_P);case"emailLink":return vP(e,{email:this._email,oobCode:this._password});default:Ii(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return ey(e,i,"signUpPassword",yP);case"emailLink":return EP(e,{idToken:t,email:this._email,oobCode:this._password});default:Ii(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ol(n,e){return Gc(n,"POST","/v1/accounts:signInWithIdp",Os(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP="http://localhost";class Fo extends Zy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Fo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ii("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,...a}=t;if(!i||!s)return null;const l=new Fo(i,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return ol(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,ol(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ol(e,t)}buildRequest(){const e={requestUri:TP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AP(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function SP(n){const e=ic(rc(n)).link,t=e?ic(rc(e)).deep_link_id:null,i=ic(rc(n)).deep_link_id;return(i?ic(rc(i)).link:null)||i||t||e||n}class jy{constructor(e){const t=ic(rc(e)),i=t.apiKey??null,s=t.oobCode??null,a=AP(t.mode??null);be(i&&s&&a,"argument-error"),this.apiKey=i,this.operation=a,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=SP(e);try{return new jy(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kl{constructor(){this.providerId=kl.PROVIDER_ID}static credential(e,t){return Ac._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=jy.parseLink(t);return be(i,"argument-error"),Ac._fromEmailAndCode(e,i.code,i.tenantId)}}kl.PROVIDER_ID="password";kl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";kl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc extends vw{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends zc{constructor(){super("facebook.com")}static credential(e){return Fo._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ts.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends zc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Fo._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return As.credential(t,i)}catch{return null}}}As.GOOGLE_SIGN_IN_METHOD="google.com";As.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends zc{constructor(){super("github.com")}static credential(e){return Fo._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ss.credential(e.oauthAccessToken)}catch{return null}}}Ss.GITHUB_SIGN_IN_METHOD="github.com";Ss.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends zc{constructor(){super("twitter.com")}static credential(e,t){return Fo._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Is.credential(t,i)}catch{return null}}}Is.TWITTER_SIGN_IN_METHOD="twitter.com";Is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IP(n,e){return Gc(n,"POST","/v1/accounts:signUp",Os(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const a=await Ti._fromIdTokenResponse(e,i,s),l=pA(i);return new Bo({user:a,providerId:l,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=pA(i);return new Bo({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function pA(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh extends Mr{constructor(e,t,i,s){super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,vh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new vh(e,t,i,s)}}function Ew(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?vh._fromErrorAndOperation(n,a,e,i):a})}async function CP(n,e,t=!1){const i=await hl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Bo._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wP(n,e,t=!1){const{auth:i}=n;if(ri(i.app))return Promise.reject(Cr(i));const s="reauthenticate";try{const a=await hl(n,Ew(i,s,e,n),t);be(a.idToken,i,"internal-error");const l=Xy(a.idToken);be(l,i,"internal-error");const{sub:d}=l;return be(n.uid===d,i,"user-mismatch"),Bo._forOperation(n,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Ii(i,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tw(n,e,t=!1){if(ri(n.app))return Promise.reject(Cr(n));const i="signIn",s=await Ew(n,i,e),a=await Bo._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(a.user),a}async function RP(n,e){return Tw($o(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aw(n){const e=$o(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function bP(n,e,t){if(ri(n.app))return Promise.reject(Cr(n));const i=$o(n),l=await ey(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",IP).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&Aw(n),f}),d=await Bo._fromIdTokenResponse(i,"signIn",l);return await i._updateCurrentUser(d.user),d}function xP(n,e,t){return ri(n.app)?Promise.reject(Cr(n)):RP(zt(n),kl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Aw(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NP(n,e){return Pr(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DP(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=zt(n),a={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await hl(i,NP(i.auth,a));i.displayName=l.displayName||null,i.photoURL=l.photoUrl||null;const d=i.providerData.find(({providerId:f})=>f==="password");d&&(d.displayName=i.displayName,d.photoURL=i.photoURL),await i._updateTokensIfNecessary(l)}function MP(n,e,t,i){return zt(n).onIdTokenChanged(e,t,i)}function PP(n,e,t){return zt(n).beforeAuthStateChanged(e,t)}function Sw(n,e,t,i){return zt(n).onAuthStateChanged(e,t,i)}function kP(n){return zt(n).signOut()}const Eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Eh,"1"),this.storage.removeItem(Eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP=1e3,LP=10;class Cw extends Iw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,f)=>{this.notifyListeners(l,f)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(i);!t&&this.localCache[i]===l||this.notifyListeners(i,l)},a=this.storage.getItem(i);ZM()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,LP):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},VP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Cw.type="LOCAL";const UP=Cw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww extends Iw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ww.type="SESSION";const Rw=ww;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new Yh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const d=Array.from(l).map(async p=>p(t.origin,a)),f=await OP(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e_(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((d,f)=>{const p=e_("",20);s.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);l={messageChannel:s,onMessage(E){const T=E;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(_),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(T.data.response);break;default:clearTimeout(_),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ji(){return window}function BP(n){ji().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw(){return typeof ji().WorkerGlobalScope<"u"&&typeof ji().importScripts=="function"}async function qP(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GP(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function zP(){return bw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw="firebaseLocalStorageDb",HP=1,Th="firebaseLocalStorage",Nw="fbase_key";class Hc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function $h(n,e){return n.transaction([Th],e?"readwrite":"readonly").objectStore(Th)}function KP(){const n=indexedDB.deleteDatabase(xw);return new Hc(n).toPromise()}function ty(){const n=indexedDB.open(xw,HP);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Th,{keyPath:Nw})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Th)?e(i):(i.close(),await KP(),e(await ty()))})})}async function mA(n,e,t){const i=$h(n,!0).put({[Nw]:e,value:t});return new Hc(i).toPromise()}async function JP(n,e){const t=$h(n,!1).get(e),i=await new Hc(t).toPromise();return i===void 0?null:i.value}function gA(n,e){const t=$h(n,!0).delete(e);return new Hc(t).toPromise()}const YP=800,$P=3;class Dw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ty(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>$P)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return bw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yh._getInstance(zP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await qP(),!this.activeServiceWorker)return;this.sender=new FP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||GP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ty();return await mA(e,Eh,"1"),await gA(e,Eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>mA(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>JP(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>gA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=$h(s,!1).getAll();return new Hc(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Dw.type="LOCAL";const QP=Dw;new qc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XP(n,e){return e?Sr(e):(be(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_ extends Zy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ol(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ol(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ol(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function WP(n){return Tw(n.auth,new t_(n),n.bypassAuthState)}function ZP(n){const{auth:e,user:t}=n;return be(t,e,"internal-error"),wP(t,new t_(n),n.bypassAuthState)}async function jP(n){const{auth:e,user:t}=n;return be(t,e,"internal-error"),CP(t,new t_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,t,i,s,a=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:i,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return WP;case"linkViaPopup":case"linkViaRedirect":return jP;case"reauthViaPopup":case"reauthViaRedirect":return ZP;default:Ii(this.auth,"internal-error")}}resolve(e){br(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){br(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek=new qc(2e3,1e4);class tl extends Mw{constructor(e,t,i,s,a){super(e,t,s,a),this.provider=i,this.authWindow=null,this.pollId=null,tl.currentPopupAction&&tl.currentPopupAction.cancel(),tl.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return be(e,this.auth,"internal-error"),e}async onExecution(){br(this.filter.length===1,"Popup operations only handle one event");const e=e_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Zi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Zi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,tl.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Zi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ek.get())};e()}}tl.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk="pendingRedirect",Xf=new Map;class nk extends Mw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Xf.get(this.auth._key());if(!e){try{const i=await ik(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Xf.set(this.auth._key(),e)}return this.bypassAuthState||Xf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function ik(n,e){const t=ok(e),i=sk(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function rk(n,e){Xf.set(n._key(),e)}function sk(n){return Sr(n._redirectPersistence)}function ok(n){return Qf(tk,n.config.apiKey,n.name)}async function ak(n,e,t=!1){if(ri(n.app))return Promise.reject(Cr(n));const i=$o(n),s=XP(i,e),l=await new nk(i,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk=600*1e3;class uk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!ck(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!Pw(e)){const s=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Zi(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=lk&&this.cachedEventUids.clear(),this.cachedEventUids.has(yA(e))}saveEventToCache(e){this.cachedEventUids.add(yA(e)),this.lastProcessedEventTime=Date.now()}}function yA(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Pw({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function ck(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pw(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dk(n,e={}){return Pr(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hk=/^https?/;async function pk(n){if(n.config.emulator)return;const{authorizedDomains:e}=await dk(n);for(const t of e)try{if(mk(t))return}catch{}Ii(n,"unauthorized-domain")}function mk(n){const e=Zg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===i}if(!hk.test(t))return!1;if(fk.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gk=new qc(3e4,6e4);function _A(){const n=ji().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function yk(n){return new Promise((e,t)=>{var s,a,l;function i(){_A(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_A(),t(Zi(n,"network-request-failed"))},timeout:gk.get()})}if((a=(s=ji().gapi)==null?void 0:s.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((l=ji().gapi)!=null&&l.load)i();else{const d=aP("iframefcb");return ji()[d]=()=>{gapi.load?i():t(Zi(n,"network-request-failed"))},gw(`${oP()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw Wf=null,e})}let Wf=null;function _k(n){return Wf=Wf||yk(n),Wf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vk=new qc(5e3,15e3),Ek="__/auth/iframe",Tk="emulator/auth/iframe",Ak={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Sk=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ik(n){const e=n.config;be(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qy(e,Tk):`https://${n.config.authDomain}/${Ek}`,i={apiKey:e.apiKey,appName:n.name,v:Pl},s=Sk.get(n.config.apiHost);s&&(i.eid=s);const a=n._getFrameworks();return a.length&&(i.fw=a.join(",")),`${t}?${Bc(i).slice(1)}`}async function Ck(n){const e=await _k(n),t=ji().gapi;return be(t,n,"internal-error"),e.open({where:document.body,url:Ik(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Ak,dontclear:!0},i=>new Promise(async(s,a)=>{await i.restyle({setHideOnLeave:!1});const l=Zi(n,"network-request-failed"),d=ji().setTimeout(()=>{a(l)},vk.get());function f(){ji().clearTimeout(d),s(i)}i.ping(f).then(f,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wk={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Rk=500,bk=600,xk="_blank",Nk="http://localhost";class vA{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Dk(n,e,t,i=Rk,s=bk){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const f={...wk,width:i.toString(),height:s.toString(),top:a,left:l},p=$t().toLowerCase();t&&(d=uw(p)?xk:t),aw(p)&&(e=e||Nk,f.scrollbars="yes");const _=Object.entries(f).reduce((T,[C,P])=>`${T}${C}=${P},`,"");if(WM(p)&&d!=="_self")return Mk(e||"",d),new vA(null);const E=window.open(e||"",d,_);be(E,n,"popup-blocked");try{E.focus()}catch{}return new vA(E)}function Mk(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk="__/auth/handler",kk="emulator/auth/handler",Vk=encodeURIComponent("fac");async function EA(n,e,t,i,s,a){be(n.config.authDomain,n,"auth-domain-config-required"),be(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Pl,eventId:s};if(e instanceof vw){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",g2(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,E]of Object.entries({}))l[_]=E}if(e instanceof zc){const _=e.getScopes().filter(E=>E!=="");_.length>0&&(l.scopes=_.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const f=await n._getAppCheckToken(),p=f?`#${Vk}=${encodeURIComponent(f)}`:"";return`${Lk(n)}?${Bc(d).slice(1)}${p}`}function Lk({config:n}){return n.emulator?Qy(n,kk):`https://${n.authDomain}/${Pk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pg="webStorageSupport";class Uk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Rw,this._completeRedirectFn=ak,this._overrideRedirectResult=rk}async _openPopup(e,t,i,s){var l;br((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const a=await EA(e,t,i,Zg(),s);return Dk(e,a,e_())}async _openRedirect(e,t,i,s){await this._originValidation(e);const a=await EA(e,t,i,Zg(),s);return BP(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(br(a,"If manager is not set, promise should be"),a)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Ck(e),i=new uk(e);return t.register("authEvent",s=>(be(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Pg,{type:Pg},s=>{var l;const a=(l=s==null?void 0:s[0])==null?void 0:l[Pg];a!==void 0&&t(!!a),Ii(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=pk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return pw()||lw()||Wy()}}const Ok=Uk;var TA="@firebase/auth",AA="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qk(n){fl(new Oo("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=i.options;be(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:mw(n)},p=new iP(i,s,a,f);return hP(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),fl(new Oo("auth-internal",e=>{const t=$o(e.getProvider("auth").getImmediate());return(i=>new Fk(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),xs(TA,AA,Bk(n)),xs(TA,AA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk=300,zk=GC("authIdTokenMaxAge")||Gk;let SA=null;const Hk=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>zk)return;const s=t==null?void 0:t.token;SA!==s&&(SA=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Kk(n=_M()){const e=Yy(n,"auth");if(e.isInitialized())return e.getImmediate();const t=fP(n,{popupRedirectResolver:Ok,persistence:[QP,UP,Rw]}),i=GC("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(i,location.origin);if(location.origin===a.origin){const l=Hk(a.toString());PP(t,l,()=>l(t.currentUser)),MP(t,d=>l(d))}}const s=n2("auth");return s&&pP(t,`http://${s}`),t}function Jk(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}rP({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const a=Zi("internal-error");a.customData=s,t(a)},i.type="text/javascript",i.charset="UTF-8",Jk().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qk("Browser");var IA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ns,kw;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,D){function x(){}x.prototype=D.prototype,N.F=D.prototype,N.prototype=new x,N.prototype.constructor=N,N.D=function(L,V,F){for(var M=Array(arguments.length-2),me=2;me<arguments.length;me++)M[me-2]=arguments[me];return D.prototype[V].apply(L,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,D,x){x||(x=0);const L=Array(16);if(typeof D=="string")for(var V=0;V<16;++V)L[V]=D.charCodeAt(x++)|D.charCodeAt(x++)<<8|D.charCodeAt(x++)<<16|D.charCodeAt(x++)<<24;else for(V=0;V<16;++V)L[V]=D[x++]|D[x++]<<8|D[x++]<<16|D[x++]<<24;D=N.g[0],x=N.g[1],V=N.g[2];let F=N.g[3],M;M=D+(F^x&(V^F))+L[0]+3614090360&4294967295,D=x+(M<<7&4294967295|M>>>25),M=F+(V^D&(x^V))+L[1]+3905402710&4294967295,F=D+(M<<12&4294967295|M>>>20),M=V+(x^F&(D^x))+L[2]+606105819&4294967295,V=F+(M<<17&4294967295|M>>>15),M=x+(D^V&(F^D))+L[3]+3250441966&4294967295,x=V+(M<<22&4294967295|M>>>10),M=D+(F^x&(V^F))+L[4]+4118548399&4294967295,D=x+(M<<7&4294967295|M>>>25),M=F+(V^D&(x^V))+L[5]+1200080426&4294967295,F=D+(M<<12&4294967295|M>>>20),M=V+(x^F&(D^x))+L[6]+2821735955&4294967295,V=F+(M<<17&4294967295|M>>>15),M=x+(D^V&(F^D))+L[7]+4249261313&4294967295,x=V+(M<<22&4294967295|M>>>10),M=D+(F^x&(V^F))+L[8]+1770035416&4294967295,D=x+(M<<7&4294967295|M>>>25),M=F+(V^D&(x^V))+L[9]+2336552879&4294967295,F=D+(M<<12&4294967295|M>>>20),M=V+(x^F&(D^x))+L[10]+4294925233&4294967295,V=F+(M<<17&4294967295|M>>>15),M=x+(D^V&(F^D))+L[11]+2304563134&4294967295,x=V+(M<<22&4294967295|M>>>10),M=D+(F^x&(V^F))+L[12]+1804603682&4294967295,D=x+(M<<7&4294967295|M>>>25),M=F+(V^D&(x^V))+L[13]+4254626195&4294967295,F=D+(M<<12&4294967295|M>>>20),M=V+(x^F&(D^x))+L[14]+2792965006&4294967295,V=F+(M<<17&4294967295|M>>>15),M=x+(D^V&(F^D))+L[15]+1236535329&4294967295,x=V+(M<<22&4294967295|M>>>10),M=D+(V^F&(x^V))+L[1]+4129170786&4294967295,D=x+(M<<5&4294967295|M>>>27),M=F+(x^V&(D^x))+L[6]+3225465664&4294967295,F=D+(M<<9&4294967295|M>>>23),M=V+(D^x&(F^D))+L[11]+643717713&4294967295,V=F+(M<<14&4294967295|M>>>18),M=x+(F^D&(V^F))+L[0]+3921069994&4294967295,x=V+(M<<20&4294967295|M>>>12),M=D+(V^F&(x^V))+L[5]+3593408605&4294967295,D=x+(M<<5&4294967295|M>>>27),M=F+(x^V&(D^x))+L[10]+38016083&4294967295,F=D+(M<<9&4294967295|M>>>23),M=V+(D^x&(F^D))+L[15]+3634488961&4294967295,V=F+(M<<14&4294967295|M>>>18),M=x+(F^D&(V^F))+L[4]+3889429448&4294967295,x=V+(M<<20&4294967295|M>>>12),M=D+(V^F&(x^V))+L[9]+568446438&4294967295,D=x+(M<<5&4294967295|M>>>27),M=F+(x^V&(D^x))+L[14]+3275163606&4294967295,F=D+(M<<9&4294967295|M>>>23),M=V+(D^x&(F^D))+L[3]+4107603335&4294967295,V=F+(M<<14&4294967295|M>>>18),M=x+(F^D&(V^F))+L[8]+1163531501&4294967295,x=V+(M<<20&4294967295|M>>>12),M=D+(V^F&(x^V))+L[13]+2850285829&4294967295,D=x+(M<<5&4294967295|M>>>27),M=F+(x^V&(D^x))+L[2]+4243563512&4294967295,F=D+(M<<9&4294967295|M>>>23),M=V+(D^x&(F^D))+L[7]+1735328473&4294967295,V=F+(M<<14&4294967295|M>>>18),M=x+(F^D&(V^F))+L[12]+2368359562&4294967295,x=V+(M<<20&4294967295|M>>>12),M=D+(x^V^F)+L[5]+4294588738&4294967295,D=x+(M<<4&4294967295|M>>>28),M=F+(D^x^V)+L[8]+2272392833&4294967295,F=D+(M<<11&4294967295|M>>>21),M=V+(F^D^x)+L[11]+1839030562&4294967295,V=F+(M<<16&4294967295|M>>>16),M=x+(V^F^D)+L[14]+4259657740&4294967295,x=V+(M<<23&4294967295|M>>>9),M=D+(x^V^F)+L[1]+2763975236&4294967295,D=x+(M<<4&4294967295|M>>>28),M=F+(D^x^V)+L[4]+1272893353&4294967295,F=D+(M<<11&4294967295|M>>>21),M=V+(F^D^x)+L[7]+4139469664&4294967295,V=F+(M<<16&4294967295|M>>>16),M=x+(V^F^D)+L[10]+3200236656&4294967295,x=V+(M<<23&4294967295|M>>>9),M=D+(x^V^F)+L[13]+681279174&4294967295,D=x+(M<<4&4294967295|M>>>28),M=F+(D^x^V)+L[0]+3936430074&4294967295,F=D+(M<<11&4294967295|M>>>21),M=V+(F^D^x)+L[3]+3572445317&4294967295,V=F+(M<<16&4294967295|M>>>16),M=x+(V^F^D)+L[6]+76029189&4294967295,x=V+(M<<23&4294967295|M>>>9),M=D+(x^V^F)+L[9]+3654602809&4294967295,D=x+(M<<4&4294967295|M>>>28),M=F+(D^x^V)+L[12]+3873151461&4294967295,F=D+(M<<11&4294967295|M>>>21),M=V+(F^D^x)+L[15]+530742520&4294967295,V=F+(M<<16&4294967295|M>>>16),M=x+(V^F^D)+L[2]+3299628645&4294967295,x=V+(M<<23&4294967295|M>>>9),M=D+(V^(x|~F))+L[0]+4096336452&4294967295,D=x+(M<<6&4294967295|M>>>26),M=F+(x^(D|~V))+L[7]+1126891415&4294967295,F=D+(M<<10&4294967295|M>>>22),M=V+(D^(F|~x))+L[14]+2878612391&4294967295,V=F+(M<<15&4294967295|M>>>17),M=x+(F^(V|~D))+L[5]+4237533241&4294967295,x=V+(M<<21&4294967295|M>>>11),M=D+(V^(x|~F))+L[12]+1700485571&4294967295,D=x+(M<<6&4294967295|M>>>26),M=F+(x^(D|~V))+L[3]+2399980690&4294967295,F=D+(M<<10&4294967295|M>>>22),M=V+(D^(F|~x))+L[10]+4293915773&4294967295,V=F+(M<<15&4294967295|M>>>17),M=x+(F^(V|~D))+L[1]+2240044497&4294967295,x=V+(M<<21&4294967295|M>>>11),M=D+(V^(x|~F))+L[8]+1873313359&4294967295,D=x+(M<<6&4294967295|M>>>26),M=F+(x^(D|~V))+L[15]+4264355552&4294967295,F=D+(M<<10&4294967295|M>>>22),M=V+(D^(F|~x))+L[6]+2734768916&4294967295,V=F+(M<<15&4294967295|M>>>17),M=x+(F^(V|~D))+L[13]+1309151649&4294967295,x=V+(M<<21&4294967295|M>>>11),M=D+(V^(x|~F))+L[4]+4149444226&4294967295,D=x+(M<<6&4294967295|M>>>26),M=F+(x^(D|~V))+L[11]+3174756917&4294967295,F=D+(M<<10&4294967295|M>>>22),M=V+(D^(F|~x))+L[2]+718787259&4294967295,V=F+(M<<15&4294967295|M>>>17),M=x+(F^(V|~D))+L[9]+3951481745&4294967295,N.g[0]=N.g[0]+D&4294967295,N.g[1]=N.g[1]+(V+(M<<21&4294967295|M>>>11))&4294967295,N.g[2]=N.g[2]+V&4294967295,N.g[3]=N.g[3]+F&4294967295}i.prototype.v=function(N,D){D===void 0&&(D=N.length);const x=D-this.blockSize,L=this.C;let V=this.h,F=0;for(;F<D;){if(V==0)for(;F<=x;)s(this,N,F),F+=this.blockSize;if(typeof N=="string"){for(;F<D;)if(L[V++]=N.charCodeAt(F++),V==this.blockSize){s(this,L),V=0;break}}else for(;F<D;)if(L[V++]=N[F++],V==this.blockSize){s(this,L),V=0;break}}this.h=V,this.o+=D},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var D=1;D<N.length-8;++D)N[D]=0;D=this.o*8;for(var x=N.length-8;x<N.length;++x)N[x]=D&255,D/=256;for(this.v(N),N=Array(16),D=0,x=0;x<4;++x)for(let L=0;L<32;L+=8)N[D++]=this.g[x]>>>L&255;return N};function a(N,D){var x=d;return Object.prototype.hasOwnProperty.call(x,N)?x[N]:x[N]=D(N)}function l(N,D){this.h=D;const x=[];let L=!0;for(let V=N.length-1;V>=0;V--){const F=N[V]|0;L&&F==D||(x[V]=F,L=!1)}this.g=x}var d={};function f(N){return-128<=N&&N<128?a(N,function(D){return new l([D|0],D<0?-1:0)}):new l([N|0],N<0?-1:0)}function p(N){if(isNaN(N)||!isFinite(N))return E;if(N<0)return k(p(-N));const D=[];let x=1;for(let L=0;N>=x;L++)D[L]=N/x|0,x*=4294967296;return new l(D,0)}function _(N,D){if(N.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(N.charAt(0)=="-")return k(_(N.substring(1),D));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const x=p(Math.pow(D,8));let L=E;for(let F=0;F<N.length;F+=8){var V=Math.min(8,N.length-F);const M=parseInt(N.substring(F,F+V),D);V<8?(V=p(Math.pow(D,V)),L=L.j(V).add(p(M))):(L=L.j(x),L=L.add(p(M)))}return L}var E=f(0),T=f(1),C=f(16777216);n=l.prototype,n.m=function(){if(O(this))return-k(this).m();let N=0,D=1;for(let x=0;x<this.g.length;x++){const L=this.i(x);N+=(L>=0?L:4294967296+L)*D,D*=4294967296}return N},n.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(P(this))return"0";if(O(this))return"-"+k(this).toString(N);const D=p(Math.pow(N,6));var x=this;let L="";for(;;){const V=se(x,D).g;x=Q(x,V.j(D));let F=((x.g.length>0?x.g[0]:x.h)>>>0).toString(N);if(x=V,P(x))return F+L;for(;F.length<6;)F="0"+F;L=F+L}},n.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function P(N){if(N.h!=0)return!1;for(let D=0;D<N.g.length;D++)if(N.g[D]!=0)return!1;return!0}function O(N){return N.h==-1}n.l=function(N){return N=Q(this,N),O(N)?-1:P(N)?0:1};function k(N){const D=N.g.length,x=[];for(let L=0;L<D;L++)x[L]=~N.g[L];return new l(x,~N.h).add(T)}n.abs=function(){return O(this)?k(this):this},n.add=function(N){const D=Math.max(this.g.length,N.g.length),x=[];let L=0;for(let V=0;V<=D;V++){let F=L+(this.i(V)&65535)+(N.i(V)&65535),M=(F>>>16)+(this.i(V)>>>16)+(N.i(V)>>>16);L=M>>>16,F&=65535,M&=65535,x[V]=M<<16|F}return new l(x,x[x.length-1]&-2147483648?-1:0)};function Q(N,D){return N.add(k(D))}n.j=function(N){if(P(this)||P(N))return E;if(O(this))return O(N)?k(this).j(k(N)):k(k(this).j(N));if(O(N))return k(this.j(k(N)));if(this.l(C)<0&&N.l(C)<0)return p(this.m()*N.m());const D=this.g.length+N.g.length,x=[];for(var L=0;L<2*D;L++)x[L]=0;for(L=0;L<this.g.length;L++)for(let V=0;V<N.g.length;V++){const F=this.i(L)>>>16,M=this.i(L)&65535,me=N.i(V)>>>16,Te=N.i(V)&65535;x[2*L+2*V]+=M*Te,j(x,2*L+2*V),x[2*L+2*V+1]+=F*Te,j(x,2*L+2*V+1),x[2*L+2*V+1]+=M*me,j(x,2*L+2*V+1),x[2*L+2*V+2]+=F*me,j(x,2*L+2*V+2)}for(N=0;N<D;N++)x[N]=x[2*N+1]<<16|x[2*N];for(N=D;N<2*D;N++)x[N]=0;return new l(x,0)};function j(N,D){for(;(N[D]&65535)!=N[D];)N[D+1]+=N[D]>>>16,N[D]&=65535,D++}function X(N,D){this.g=N,this.h=D}function se(N,D){if(P(D))throw Error("division by zero");if(P(N))return new X(E,E);if(O(N))return D=se(k(N),D),new X(k(D.g),k(D.h));if(O(D))return D=se(N,k(D)),new X(k(D.g),D.h);if(N.g.length>30){if(O(N)||O(D))throw Error("slowDivide_ only works with positive integers.");for(var x=T,L=D;L.l(N)<=0;)x=le(x),L=le(L);var V=ue(x,1),F=ue(L,1);for(L=ue(L,2),x=ue(x,2);!P(L);){var M=F.add(L);M.l(N)<=0&&(V=V.add(x),F=M),L=ue(L,1),x=ue(x,1)}return D=Q(N,V.j(D)),new X(V,D)}for(V=E;N.l(D)>=0;){for(x=Math.max(1,Math.floor(N.m()/D.m())),L=Math.ceil(Math.log(x)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),F=p(x),M=F.j(D);O(M)||M.l(N)>0;)x-=L,F=p(x),M=F.j(D);P(F)&&(F=T),V=V.add(F),N=Q(N,M)}return new X(V,N)}n.B=function(N){return se(this,N).h},n.and=function(N){const D=Math.max(this.g.length,N.g.length),x=[];for(let L=0;L<D;L++)x[L]=this.i(L)&N.i(L);return new l(x,this.h&N.h)},n.or=function(N){const D=Math.max(this.g.length,N.g.length),x=[];for(let L=0;L<D;L++)x[L]=this.i(L)|N.i(L);return new l(x,this.h|N.h)},n.xor=function(N){const D=Math.max(this.g.length,N.g.length),x=[];for(let L=0;L<D;L++)x[L]=this.i(L)^N.i(L);return new l(x,this.h^N.h)};function le(N){const D=N.g.length+1,x=[];for(let L=0;L<D;L++)x[L]=N.i(L)<<1|N.i(L-1)>>>31;return new l(x,N.h)}function ue(N,D){const x=D>>5;D%=32;const L=N.g.length-x,V=[];for(let F=0;F<L;F++)V[F]=D>0?N.i(F+x)>>>D|N.i(F+x+1)<<32-D:N.i(F+x);return new l(V,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,kw=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=_,Ns=l}).apply(typeof IA<"u"?IA:typeof self<"u"?self:typeof window<"u"?window:{});var kf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vw,sc,Lw,Zf,ny,Uw,Ow,Fw;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof kf=="object"&&kf];for(var A=0;A<g.length;++A){var I=g[A];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var i=t(this);function s(g,A){if(A)e:{var I=i;g=g.split(".");for(var b=0;b<g.length-1;b++){var H=g[b];if(!(H in I))break e;I=I[H]}g=g[g.length-1],b=I[g],A=A(b),A!=b&&A!=null&&e(I,g,{configurable:!0,writable:!0,value:A})}}s("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(g){return g||function(A){var I=[],b;for(b in A)Object.prototype.hasOwnProperty.call(A,b)&&I.push([b,A[b]]);return I}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function d(g){var A=typeof g;return A=="object"&&g!=null||A=="function"}function f(g,A,I){return g.call.apply(g.bind,arguments)}function p(g,A,I){return p=f,p.apply(null,arguments)}function _(g,A){var I=Array.prototype.slice.call(arguments,1);return function(){var b=I.slice();return b.push.apply(b,arguments),g.apply(this,b)}}function E(g,A){function I(){}I.prototype=A.prototype,g.Z=A.prototype,g.prototype=new I,g.prototype.constructor=g,g.Ob=function(b,H,W){for(var de=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)de[Pe-2]=arguments[Pe];return A.prototype[H].apply(b,de)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function C(g){const A=g.length;if(A>0){const I=Array(A);for(let b=0;b<A;b++)I[b]=g[b];return I}return[]}function P(g,A){for(let b=1;b<arguments.length;b++){const H=arguments[b];var I=typeof H;if(I=I!="object"?I:H?Array.isArray(H)?"array":I:"null",I=="array"||I=="object"&&typeof H.length=="number"){I=g.length||0;const W=H.length||0;g.length=I+W;for(let de=0;de<W;de++)g[I+de]=H[de]}else g.push(H)}}class O{constructor(A,I){this.i=A,this.j=I,this.h=0,this.g=null}get(){let A;return this.h>0?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function k(g){l.setTimeout(()=>{throw g},0)}function Q(){var g=N;let A=null;return g.g&&(A=g.g,g.g=g.g.next,g.g||(g.h=null),A.next=null),A}class j{constructor(){this.h=this.g=null}add(A,I){const b=X.get();b.set(A,I),this.h?this.h.next=b:this.g=b,this.h=b}}var X=new O(()=>new se,g=>g.reset());class se{constructor(){this.next=this.g=this.h=null}set(A,I){this.h=A,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let le,ue=!1,N=new j,D=()=>{const g=Promise.resolve(void 0);le=()=>{g.then(x)}};function x(){for(var g;g=Q();){try{g.h.call(g.g)}catch(I){k(I)}var A=X;A.j(g),A.h<100&&(A.h++,g.next=A.g,A.g=g)}ue=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function V(g,A){this.type=g,this.g=this.target=A,this.defaultPrevented=!1}V.prototype.h=function(){this.defaultPrevented=!0};var F=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,A=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const I=()=>{};l.addEventListener("test",I,A),l.removeEventListener("test",I,A)}catch{}return g})();function M(g){return/^[\s\xa0]*$/.test(g)}function me(g,A){V.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,A)}E(me,V),me.prototype.init=function(g,A){const I=this.type=g.type,b=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=A,A=g.relatedTarget,A||(I=="mouseover"?A=g.fromElement:I=="mouseout"&&(A=g.toElement)),this.relatedTarget=A,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&me.Z.h.call(this)},me.prototype.h=function(){me.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var Te="closure_listenable_"+(Math.random()*1e6|0),Y=0;function oe(g,A,I,b,H){this.listener=g,this.proxy=null,this.src=A,this.type=I,this.capture=!!b,this.ha=H,this.key=++Y,this.da=this.fa=!1}function _e(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Oe(g,A,I){for(const b in g)A.call(I,g[b],b,g)}function Qe(g,A){for(const I in g)A.call(void 0,g[I],I,g)}function q(g){const A={};for(const I in g)A[I]=g[I];return A}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function he(g,A){let I,b;for(let H=1;H<arguments.length;H++){b=arguments[H];for(I in b)g[I]=b[I];for(let W=0;W<re.length;W++)I=re[W],Object.prototype.hasOwnProperty.call(b,I)&&(g[I]=b[I])}}function ge(g){this.src=g,this.g={},this.h=0}ge.prototype.add=function(g,A,I,b,H){const W=g.toString();g=this.g[W],g||(g=this.g[W]=[],this.h++);const de=Ve(g,A,b,H);return de>-1?(A=g[de],I||(A.fa=!1)):(A=new oe(A,this.src,W,!!b,H),A.fa=I,g.push(A)),A};function xe(g,A){const I=A.type;if(I in g.g){var b=g.g[I],H=Array.prototype.indexOf.call(b,A,void 0),W;(W=H>=0)&&Array.prototype.splice.call(b,H,1),W&&(_e(A),g.g[I].length==0&&(delete g.g[I],g.h--))}}function Ve(g,A,I,b){for(let H=0;H<g.length;++H){const W=g[H];if(!W.da&&W.listener==A&&W.capture==!!I&&W.ha==b)return H}return-1}var Ye="closure_lm_"+(Math.random()*1e6|0),Ht={};function gt(g,A,I,b,H){if(Array.isArray(A)){for(let W=0;W<A.length;W++)gt(g,A[W],I,b,H);return null}return I=Jl(I),g&&g[Te]?g.J(A,I,d(b)?!!b.capture:!1,H):Hs(g,A,I,!1,b,H)}function Hs(g,A,I,b,H,W){if(!A)throw Error("Invalid event type");const de=d(H)?!!H.capture:!!H;let Pe=Ks(g);if(Pe||(g[Ye]=Pe=new ge(g)),I=Pe.add(A,I,b,de,W),I.proxy)return I;if(b=jo(),I.proxy=b,b.src=g,b.listener=I,g.addEventListener)F||(H=de),H===void 0&&(H=!1),g.addEventListener(A.toString(),b,H);else if(g.attachEvent)g.attachEvent(wi(A.toString()),b);else if(g.addListener&&g.removeListener)g.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return I}function jo(){function g(I){return A.call(g.src,g.listener,I)}const A=Hl;return g}function ea(g,A,I,b,H){if(Array.isArray(A))for(var W=0;W<A.length;W++)ea(g,A[W],I,b,H);else b=d(b)?!!b.capture:!!b,I=Jl(I),g&&g[Te]?(g=g.i,W=String(A).toString(),W in g.g&&(A=g.g[W],I=Ve(A,I,b,H),I>-1&&(_e(A[I]),Array.prototype.splice.call(A,I,1),A.length==0&&(delete g.g[W],g.h--)))):g&&(g=Ks(g))&&(A=g.g[A.toString()],g=-1,A&&(g=Ve(A,I,b,H)),(I=g>-1?A[g]:null)&&ta(I))}function ta(g){if(typeof g!="number"&&g&&!g.da){var A=g.src;if(A&&A[Te])xe(A.i,g);else{var I=g.type,b=g.proxy;A.removeEventListener?A.removeEventListener(I,b,g.capture):A.detachEvent?A.detachEvent(wi(I),b):A.addListener&&A.removeListener&&A.removeListener(b),(I=Ks(A))?(xe(I,g),I.h==0&&(I.src=null,A[Ye]=null)):_e(g)}}}function wi(g){return g in Ht?Ht[g]:Ht[g]="on"+g}function Hl(g,A){if(g.da)g=!0;else{A=new me(A,this);const I=g.listener,b=g.ha||g.src;g.fa&&ta(g),g=I.call(b,A)}return g}function Ks(g){return g=g[Ye],g instanceof ge?g:null}var Kl="__closure_events_fn_"+(Math.random()*1e9>>>0);function Jl(g){return typeof g=="function"?g:(g[Kl]||(g[Kl]=function(A){return g.handleEvent(A)}),g[Kl])}function Mt(){L.call(this),this.i=new ge(this),this.M=this,this.G=null}E(Mt,L),Mt.prototype[Te]=!0,Mt.prototype.removeEventListener=function(g,A,I,b){ea(this,g,A,I,b)};function Kt(g,A){var I,b=g.G;if(b)for(I=[];b;b=b.G)I.push(b);if(g=g.M,b=A.type||A,typeof A=="string")A=new V(A,g);else if(A instanceof V)A.target=A.target||g;else{var H=A;A=new V(b,g),he(A,H)}H=!0;let W,de;if(I)for(de=I.length-1;de>=0;de--)W=A.g=I[de],H=Or(W,b,!0,A)&&H;if(W=A.g=g,H=Or(W,b,!0,A)&&H,H=Or(W,b,!1,A)&&H,I)for(de=0;de<I.length;de++)W=A.g=I[de],H=Or(W,b,!1,A)&&H}Mt.prototype.N=function(){if(Mt.Z.N.call(this),this.i){var g=this.i;for(const A in g.g){const I=g.g[A];for(let b=0;b<I.length;b++)_e(I[b]);delete g.g[A],g.h--}}this.G=null},Mt.prototype.J=function(g,A,I,b){return this.i.add(String(g),A,!1,I,b)},Mt.prototype.K=function(g,A,I,b){return this.i.add(String(g),A,!0,I,b)};function Or(g,A,I,b){if(A=g.i.g[String(A)],!A)return!0;A=A.concat();let H=!0;for(let W=0;W<A.length;++W){const de=A[W];if(de&&!de.da&&de.capture==I){const Pe=de.listener,wt=de.ha||de.src;de.fa&&xe(g.i,de),H=Pe.call(wt,b)!==!1&&H}}return H&&!b.defaultPrevented}function Sp(g,A){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=p(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(A)>2147483647?-1:l.setTimeout(g,A||0)}function id(g){g.g=Sp(()=>{g.g=null,g.i&&(g.i=!1,id(g))},g.l);const A=g.h;g.h=null,g.m.apply(null,A)}class yn extends L{constructor(A,I){super(),this.m=A,this.l=I,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:id(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Js(g){L.call(this),this.h=g,this.g={}}E(Js,L);var Yl=[];function $l(g){Oe(g.g,function(A,I){this.g.hasOwnProperty(I)&&ta(A)},g),g.g={}}Js.prototype.N=function(){Js.Z.N.call(this),$l(this)},Js.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fr=l.JSON.stringify,Ip=l.JSON.parse,rd=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function sd(){}function od(){}var li={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function tn(){V.call(this,"d")}E(tn,V);function Kn(){V.call(this,"c")}E(Kn,V);var Ct={},ad=null;function na(){return ad=ad||new Mt}Ct.Ia="serverreachability";function ld(g){V.call(this,Ct.Ia,g)}E(ld,V);function Ri(g){const A=na();Kt(A,new ld(A))}Ct.STAT_EVENT="statevent";function Ys(g,A){V.call(this,Ct.STAT_EVENT,g),this.stat=A}E(Ys,V);function Pt(g){const A=na();Kt(A,new Ys(A,g))}Ct.Ja="timingevent";function bi(g,A){V.call(this,Ct.Ja,g),this.size=A}E(bi,V);function xi(g,A){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},A)}function ui(){this.g=!0}ui.prototype.ua=function(){this.g=!1};function Cp(g,A,I,b,H,W){g.info(function(){if(g.g)if(W){var de="",Pe=W.split("&");for(let je=0;je<Pe.length;je++){var wt=Pe[je].split("=");if(wt.length>1){const yt=wt[0];wt=wt[1];const Qn=yt.split("_");de=Qn.length>=2&&Qn[1]=="type"?de+(yt+"="+wt+"&"):de+(yt+"=redacted&")}}}else de=null;else de=W;return"XMLHTTP REQ ("+b+") [attempt "+H+"]: "+A+`
`+I+`
`+de})}function ud(g,A,I,b,H,W,de){g.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+H+"]: "+A+`
`+I+`
`+W+" "+de})}function Ni(g,A,I,b){g.info(function(){return"XMLHTTP TEXT ("+A+"): "+wp(g,I)+(b?" "+b:"")})}function $s(g,A){g.info(function(){return"TIMEOUT: "+A})}ui.prototype.info=function(){};function wp(g,A){if(!g.g)return A;if(!A)return null;try{const W=JSON.parse(A);if(W){for(g=0;g<W.length;g++)if(Array.isArray(W[g])){var I=W[g];if(!(I.length<2)){var b=I[1];if(Array.isArray(b)&&!(b.length<1)){var H=b[0];if(H!="noop"&&H!="stop"&&H!="close")for(let de=1;de<b.length;de++)b[de]=""}}}}return Fr(W)}catch{return A}}var Qs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ql={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Xl;function Xs(){}E(Xs,sd),Xs.prototype.g=function(){return new XMLHttpRequest},Xl=new Xs;function ir(g){return encodeURIComponent(String(g))}function cd(g){var A=1;g=g.split(":");const I=[];for(;A>0&&g.length;)I.push(g.shift()),A--;return g.length&&I.push(g.join(":")),I}function ci(g,A,I,b){this.j=g,this.i=A,this.l=I,this.S=b||1,this.V=new Js(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new di}function di(){this.i=null,this.g="",this.h=!1}var kt={},Xt={};function Di(g,A,I){g.M=1,g.A=Ws(Lt(A)),g.u=I,g.R=!0,ia(g,null)}function ia(g,A){g.F=Date.now(),Mi(g),g.B=Lt(g.A);var I=g.B,b=g.S;Array.isArray(b)||(b=[String(b)]),aa(I.i,"t",b),g.C=0,I=g.j.L,g.h=new di,g.g=Cd(g.j,I?A:null,!g.u),g.P>0&&(g.O=new yn(p(g.Y,g,g.g),g.P)),A=g.V,I=g.g,b=g.ba;var H="readystatechange";Array.isArray(H)||(H&&(Yl[0]=H.toString()),H=Yl);for(let W=0;W<H.length;W++){const de=gt(I,H[W],b||A.handleEvent,!1,A.h||A);if(!de)break;A.g[de.key]=de}A=g.J?q(g.J):{},g.u?(g.v||(g.v="POST"),A["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,A)):(g.v="GET",g.g.ea(g.B,g.v,null,A)),Ri(),Cp(g.i,g.v,g.B,g.l,g.S,g.u)}ci.prototype.ba=function(g){g=g.target;const A=this.O;A&&pi(g)==3?A.j():this.Y(g)},ci.prototype.Y=function(g){try{if(g==this.g)e:{const Pe=pi(this.g),wt=this.g.ya(),je=this.g.ca();if(!(Pe<3)&&(Pe!=3||this.g&&(this.h.h||this.g.la()||nn(this.g)))){this.K||Pe!=4||wt==7||(wt==8||je<=0?Ri(3):Ri(2)),Pi(this);var A=this.g.ca();this.X=A;var I=Rp(this);if(this.o=A==200,ud(this.i,this.v,this.B,this.l,this.S,Pe,A),this.o){if(this.U&&!this.L){t:{if(this.g){var b,H=this.g;if((b=H.g?H.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(b)){var W=b;break t}}W=null}if(g=W)Ni(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ki(this,g);else{this.o=!1,this.m=3,Pt(12),Mn(this),Jn(this);break e}}if(this.R){g=!0;let yt;for(;!this.K&&this.C<I.length;)if(yt=fd(this,I),yt==Xt){Pe==4&&(this.m=4,Pt(14),g=!1),Ni(this.i,this.l,null,"[Incomplete Response]");break}else if(yt==kt){this.m=4,Pt(15),Ni(this.i,this.l,I,"[Invalid Chunk]"),g=!1;break}else Ni(this.i,this.l,yt,null),ki(this,yt);if(dd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pe!=4||I.length!=0||this.h.h||(this.m=1,Pt(16),g=!1),this.o=this.o&&g,!g)Ni(this.i,this.l,I,"[Invalid Chunked Response]"),Mn(this),Jn(this);else if(I.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),du(de),de.P=!0,Pt(11))}}else Ni(this.i,this.l,I,null),ki(this,I);Pe==4&&Mn(this),this.o&&!this.K&&(Pe==4?Td(this.j,this):(this.o=!1,Mi(this)))}else sr(this.g),A==400&&I.indexOf("Unknown SID")>0?(this.m=3,Pt(12)):(this.m=0,Pt(13)),Mn(this),Jn(this)}}}catch{}finally{}};function Rp(g){if(!dd(g))return g.g.la();const A=nn(g.g);if(A==="")return"";let I="";const b=A.length,H=pi(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Mn(g),Jn(g),"";g.h.i=new l.TextDecoder}for(let W=0;W<b;W++)g.h.h=!0,I+=g.h.i.decode(A[W],{stream:!(H&&W==b-1)});return A.length=0,g.h.g+=I,g.C=0,g.h.g}function dd(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function fd(g,A){var I=g.C,b=A.indexOf(`
`,I);return b==-1?Xt:(I=Number(A.substring(I,b)),isNaN(I)?kt:(b+=1,b+I>A.length?Xt:(A=A.slice(b,b+I),g.C=b+I,A)))}ci.prototype.cancel=function(){this.K=!0,Mn(this)};function Mi(g){g.T=Date.now()+g.H,ra(g,g.H)}function ra(g,A){if(g.D!=null)throw Error("WatchDog timer not null");g.D=xi(p(g.aa,g),A)}function Pi(g){g.D&&(l.clearTimeout(g.D),g.D=null)}ci.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?($s(this.i,this.B),this.M!=2&&(Ri(),Pt(17)),Mn(this),this.m=2,Jn(this)):ra(this,this.T-g)};function Jn(g){g.j.I==0||g.K||Td(g.j,g)}function Mn(g){Pi(g);var A=g.O;A&&typeof A.dispose=="function"&&A.dispose(),g.O=null,$l(g.V),g.g&&(A=g.g,g.g=null,A.abort(),A.dispose())}function ki(g,A){try{var I=g.j;if(I.I!=0&&(I.g==g||Li(I.h,g))){if(!g.L&&Li(I.h,g)&&I.I==3){try{var b=I.Ba.g.parse(A)}catch{b=null}if(Array.isArray(b)&&b.length==3){var H=b;if(H[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<g.F)fa(I),Yr(I);else break e;ro(I),Pt(18)}}else I.xa=H[1],0<I.xa-I.K&&H[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=xi(p(I.Va,I),6e3));Vi(I.h)<=1&&I.ta&&(I.ta=void 0)}else Gi(I,11)}else if((g.L||I.g==g)&&fa(I),!M(A))for(H=I.Ba.g.parse(A),A=0;A<H.length;A++){let je=H[A];const yt=je[0];if(!(yt<=I.K))if(I.K=yt,je=je[1],I.I==2)if(je[0]=="c"){I.M=je[1],I.ba=je[2];const Qn=je[3];Qn!=null&&(I.ka=Qn,I.j.info("VER="+I.ka));const zi=je[4];zi!=null&&(I.za=zi,I.j.info("SVER="+I.za));const mi=je[5];mi!=null&&typeof mi=="number"&&mi>0&&(b=1.5*mi,I.O=b,I.j.info("backChannelRequestTimeoutMs_="+b)),b=I;const gi=g.g;if(gi){const so=gi.g?gi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(so){var W=b.h;W.g||so.indexOf("spdy")==-1&&so.indexOf("quic")==-1&&so.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(jl(W,W.h),W.h=null))}if(b.G){const ha=gi.g?gi.g.getResponseHeader("X-HTTP-Session-Id"):null;ha&&(b.wa=ha,nt(b.J,b.G,ha))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-g.F,I.j.info("Handshake RTT: "+I.T+"ms")),b=I;var de=g;if(b.na=Id(b,b.L?b.ba:null,b.W),de.L){eu(b.h,de);var Pe=de,wt=b.O;wt&&(Pe.H=wt),Pe.D&&(Pi(Pe),Mi(Pe)),b.g=de}else vd(b);I.i.length>0&&qi(I)}else je[0]!="stop"&&je[0]!="close"||Gi(I,7);else I.I==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?Gi(I,7):uu(I):je[0]!="noop"&&I.l&&I.l.qa(je),I.A=0)}}Ri(4)}catch{}}var Vt=class{constructor(g,A){this.g=g,this.map=A}};function Wl(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Zl(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Vi(g){return g.h?1:g.g?g.g.size:0}function Li(g,A){return g.h?g.h==A:g.g?g.g.has(A):!1}function jl(g,A){g.g?g.g.add(A):g.h=A}function eu(g,A){g.h&&g.h==A?g.h=null:g.g&&g.g.has(A)&&g.g.delete(A)}Wl.prototype.cancel=function(){if(this.i=tu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function tu(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let A=g.i;for(const I of g.g.values())A=A.concat(I.G);return A}return C(g.i)}var hd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function sa(g,A){if(g){g=g.split("&");for(let I=0;I<g.length;I++){const b=g[I].indexOf("=");let H,W=null;b>=0?(H=g[I].substring(0,b),W=g[I].substring(b+1)):H=g[I],A(H,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function Pn(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let A;g instanceof Pn?(this.l=g.l,Wt(this,g.j),this.o=g.o,this.g=g.g,Br(this,g.u),this.h=g.h,nu(this,yd(g.i)),this.m=g.m):g&&(A=String(g).match(hd))?(this.l=!1,Wt(this,A[1]||"",!0),this.o=Ui(A[2]||""),this.g=Ui(A[3]||"",!0),Br(this,A[4]),this.h=Ui(A[5]||"",!0),nu(this,A[6]||"",!0),this.m=Ui(A[7]||"")):(this.l=!1,this.i=new Gr(null,this.l))}Pn.prototype.toString=function(){const g=[];var A=this.j;A&&g.push(Zs(A,oa,!0),":");var I=this.g;return(I||A=="file")&&(g.push("//"),(A=this.o)&&g.push(Zs(A,oa,!0),"@"),g.push(ir(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&g.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&g.push("/"),g.push(Zs(I,I.charAt(0)=="/"?iu:pd,!0))),(I=this.i.toString())&&g.push("?",I),(I=this.m)&&g.push("#",Zs(I,md)),g.join("")},Pn.prototype.resolve=function(g){const A=Lt(this);let I=!!g.j;I?Wt(A,g.j):I=!!g.o,I?A.o=g.o:I=!!g.g,I?A.g=g.g:I=g.u!=null;var b=g.h;if(I)Br(A,g.u);else if(I=!!g.h){if(b.charAt(0)!="/")if(this.g&&!this.h)b="/"+b;else{var H=A.h.lastIndexOf("/");H!=-1&&(b=A.h.slice(0,H+1)+b)}if(H=b,H==".."||H==".")b="";else if(H.indexOf("./")!=-1||H.indexOf("/.")!=-1){b=H.lastIndexOf("/",0)==0,H=H.split("/");const W=[];for(let de=0;de<H.length;){const Pe=H[de++];Pe=="."?b&&de==H.length&&W.push(""):Pe==".."?((W.length>1||W.length==1&&W[0]!="")&&W.pop(),b&&de==H.length&&W.push("")):(W.push(Pe),b=!0)}b=W.join("/")}else b=H}return I?A.h=b:I=g.i.toString()!=="",I?nu(A,yd(g.i)):I=!!g.m,I&&(A.m=g.m),A};function Lt(g){return new Pn(g)}function Wt(g,A,I){g.j=I?Ui(A,!0):A,g.j&&(g.j=g.j.replace(/:$/,""))}function Br(g,A){if(A){if(A=Number(A),isNaN(A)||A<0)throw Error("Bad port number "+A);g.u=A}else g.u=null}function nu(g,A,I){A instanceof Gr?(g.i=A,la(g.i,g.l)):(I||(A=Zs(A,qr)),g.i=new Gr(A,g.l))}function nt(g,A,I){g.i.set(A,I)}function Ws(g){return nt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Ui(g,A){return g?A?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function Zs(g,A,I){return typeof g=="string"?(g=encodeURI(g).replace(A,Sn),I&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Sn(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var oa=/[#\/\?@]/g,pd=/[#\?:]/g,iu=/[#\?]/g,qr=/[#\?@]/g,md=/#/g;function Gr(g,A){this.h=this.g=null,this.i=g||null,this.j=!!A}function In(g){g.g||(g.g=new Map,g.h=0,g.i&&sa(g.i,function(A,I){g.add(decodeURIComponent(A.replace(/\+/g," ")),I)}))}n=Gr.prototype,n.add=function(g,A){In(this),this.i=null,g=zr(this,g);let I=this.g.get(g);return I||this.g.set(g,I=[]),I.push(A),this.h+=1,this};function gd(g,A){In(g),A=zr(g,A),g.g.has(A)&&(g.i=null,g.h-=g.g.get(A).length,g.g.delete(A))}function ru(g,A){return In(g),A=zr(g,A),g.g.has(A)}n.forEach=function(g,A){In(this),this.g.forEach(function(I,b){I.forEach(function(H){g.call(A,H,b,this)},this)},this)};function su(g,A){In(g);let I=[];if(typeof A=="string")ru(g,A)&&(I=I.concat(g.g.get(zr(g,A))));else for(g=Array.from(g.g.values()),A=0;A<g.length;A++)I=I.concat(g[A]);return I}n.set=function(g,A){return In(this),this.i=null,g=zr(this,g),ru(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[A]),this.h+=1,this},n.get=function(g,A){return g?(g=su(this,g),g.length>0?String(g[0]):A):A};function aa(g,A,I){gd(g,A),I.length>0&&(g.i=null,g.g.set(zr(g,A),C(I)),g.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],A=Array.from(this.g.keys());for(let b=0;b<A.length;b++){var I=A[b];const H=ir(I);I=su(this,I);for(let W=0;W<I.length;W++){let de=H;I[W]!==""&&(de+="="+ir(I[W])),g.push(de)}}return this.i=g.join("&")};function yd(g){const A=new Gr;return A.i=g.i,g.g&&(A.g=new Map(g.g),A.h=g.h),A}function zr(g,A){return A=String(A),g.j&&(A=A.toLowerCase()),A}function la(g,A){A&&!g.j&&(In(g),g.i=null,g.g.forEach(function(I,b){const H=b.toLowerCase();b!=H&&(gd(this,b),aa(this,H,I))},g)),g.j=A}function fi(g,A){const I=new ui;if(l.Image){const b=new Image;b.onload=_(Yn,I,"TestLoadImage: loaded",!0,A,b),b.onerror=_(Yn,I,"TestLoadImage: error",!1,A,b),b.onabort=_(Yn,I,"TestLoadImage: abort",!1,A,b),b.ontimeout=_(Yn,I,"TestLoadImage: timeout",!1,A,b),l.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=g}else A(!1)}function ou(g,A){const I=new ui,b=new AbortController,H=setTimeout(()=>{b.abort(),Yn(I,"TestPingServer: timeout",!1,A)},1e4);fetch(g,{signal:b.signal}).then(W=>{clearTimeout(H),W.ok?Yn(I,"TestPingServer: ok",!0,A):Yn(I,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(H),Yn(I,"TestPingServer: error",!1,A)})}function Yn(g,A,I,b,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),b(I)}catch{}}function Hr(){this.g=new rd}function Oi(g){this.i=g.Sb||null,this.h=g.ab||!1}E(Oi,sd),Oi.prototype.g=function(){return new js(this.i,this.h)};function js(g,A){Mt.call(this),this.H=g,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(js,Mt),n=js.prototype,n.open=function(g,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=A,this.readyState=1,hi(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const A={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(A.body=g),(this.H||l).fetch(new Request(this.D,A)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,hi(this)),this.g&&(this.readyState=3,hi(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ua(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function ua(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var A=g.value?g.value:new Uint8Array(0);(A=this.B.decode(A,{stream:!g.done}))&&(this.response=this.responseText+=A)}g.done?Kr(this):hi(this),this.readyState==3&&ua(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,Kr(this))},n.Na=function(g){this.g&&(this.response=g,Kr(this))},n.ga=function(){this.g&&Kr(this)};function Kr(g){g.readyState=4,g.l=null,g.j=null,g.B=null,hi(g)}n.setRequestHeader=function(g,A){this.A.append(g,A)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],A=this.h.entries();for(var I=A.next();!I.done;)I=I.value,g.push(I[0]+": "+I[1]),I=A.next();return g.join(`\r
`)};function hi(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(js.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function $n(g){let A="";return Oe(g,function(I,b){A+=b,A+=":",A+=I,A+=`\r
`}),A}function eo(g,A,I){e:{for(b in I){var b=!1;break e}b=!0}b||(I=$n(I),typeof g=="string"?I!=null&&ir(I):nt(g,A,I))}function lt(g){Mt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(lt,Mt);var Fi=/^https?$/i,au=["POST","PUT"];n=lt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,A,I,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);A=A?A.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Xl.g(),this.g.onreadystatechange=T(p(this.Ca,this));try{this.B=!0,this.g.open(A,String(g),!0),this.B=!1}catch(W){to(this,W);return}if(g=I||"",I=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var H in b)I.set(H,b[H]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const W of b.keys())I.set(W,b.get(W));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(I.keys()).find(W=>W.toLowerCase()=="content-type"),H=l.FormData&&g instanceof l.FormData,!(Array.prototype.indexOf.call(au,A,void 0)>=0)||b||H||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,de]of I)this.g.setRequestHeader(W,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(W){to(this,W)}};function to(g,A){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=A,g.o=5,lu(g),rr(g)}function lu(g){g.A||(g.A=!0,Kt(g,"complete"),Kt(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Kt(this,"complete"),Kt(this,"abort"),rr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),rr(this,!0)),lt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?no(this):this.Xa())},n.Xa=function(){no(this)};function no(g){if(g.h&&typeof a<"u"){if(g.v&&pi(g)==4)setTimeout(g.Ca.bind(g),0);else if(Kt(g,"readystatechange"),pi(g)==4){g.h=!1;try{const W=g.ca();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var I;if(!(I=A)){var b;if(b=W===0){let de=String(g.D).match(hd)[1]||null;!de&&l.self&&l.self.location&&(de=l.self.location.protocol.slice(0,-1)),b=!Fi.test(de?de.toLowerCase():"")}I=b}if(I)Kt(g,"complete"),Kt(g,"success");else{g.o=6;try{var H=pi(g)>2?g.g.statusText:""}catch{H=""}g.l=H+" ["+g.ca()+"]",lu(g)}}finally{rr(g)}}}}function rr(g,A){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const I=g.g;g.g=null,A||Kt(g,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function pi(g){return g.g?g.g.readyState:0}n.ca=function(){try{return pi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var A=this.g.responseText;return g&&A.indexOf(g)==0&&(A=A.substring(g.length)),Ip(A)}};function nn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function sr(g){const A={};g=(g.g&&pi(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<g.length;b++){if(M(g[b]))continue;var I=cd(g[b]);const H=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const W=A[H]||[];A[H]=W,W.push(I)}Qe(A,function(b){return b.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Bi(g,A,I){return I&&I.internalChannelParams&&I.internalChannelParams[g]||A}function Jr(g){this.za=0,this.i=[],this.j=new ui,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Bi("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Bi("baseRetryDelayMs",5e3,g),this.Za=Bi("retryDelaySeedMs",1e4,g),this.Ta=Bi("forwardChannelMaxRetries",2,g),this.va=Bi("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Wl(g&&g.concurrentRequestLimit),this.Ba=new Hr,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Jr.prototype,n.ka=8,n.I=1,n.connect=function(g,A,I,b){Pt(0),this.W=g,this.H=A||{},I&&b!==void 0&&(this.H.OSID=I,this.H.OAID=b),this.F=this.X,this.J=Id(this,null,this.W),qi(this)};function uu(g){if(ca(g),g.I==3){var A=g.V++,I=Lt(g.J);if(nt(I,"SID",g.M),nt(I,"RID",A),nt(I,"TYPE","terminate"),io(g,I),A=new ci(g,g.j,A),A.M=2,A.A=Ws(Lt(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(A.A.toString(),"")}catch{}!I&&l.Image&&(new Image().src=A.A,I=!0),I||(A.g=Cd(A.j,null),A.g.ea(A.A)),A.F=Date.now(),Mi(A)}Sd(g)}function Yr(g){g.g&&(du(g),g.g.cancel(),g.g=null)}function ca(g){Yr(g),g.v&&(l.clearTimeout(g.v),g.v=null),fa(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&l.clearTimeout(g.m),g.m=null)}function qi(g){if(!Zl(g.h)&&!g.m){g.m=!0;var A=g.Ea;le||D(),ue||(le(),ue=!0),N.add(A,g),g.D=0}}function da(g,A){return Vi(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=A.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=xi(p(g.Ea,g,A),Ad(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const H=new ci(this,this.j,g);let W=this.o;if(this.U&&(W?(W=q(W),he(W,this.U)):W=this.U),this.u!==null||this.R||(H.J=W,W=null),this.S)e:{for(var A=0,I=0;I<this.i.length;I++){t:{var b=this.i[I];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(A+=b,A>4096){A=I;break e}if(A===4096||I===this.i.length-1){A=I+1;break e}}A=1e3}else A=1e3;A=_d(this,H,A),I=Lt(this.J),nt(I,"RID",g),nt(I,"CVER",22),this.G&&nt(I,"X-HTTP-Session-Id",this.G),io(this,I),W&&(this.R?A="headers="+ir($n(W))+"&"+A:this.u&&eo(I,this.u,W)),jl(this.h,H),this.Ra&&nt(I,"TYPE","init"),this.S?(nt(I,"$req",A),nt(I,"SID","null"),H.U=!0,Di(H,I,null)):Di(H,I,A),this.I=2}}else this.I==3&&(g?cu(this,g):this.i.length==0||Zl(this.h)||cu(this))};function cu(g,A){var I;A?I=A.l:I=g.V++;const b=Lt(g.J);nt(b,"SID",g.M),nt(b,"RID",I),nt(b,"AID",g.K),io(g,b),g.u&&g.o&&eo(b,g.u,g.o),I=new ci(g,g.j,I,g.D+1),g.u===null&&(I.J=g.o),A&&(g.i=A.G.concat(g.i)),A=_d(g,I,1e3),I.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),jl(g.h,I),Di(I,b,A)}function io(g,A){g.H&&Oe(g.H,function(I,b){nt(A,b,I)}),g.l&&Oe({},function(I,b){nt(A,b,I)})}function _d(g,A,I){I=Math.min(g.i.length,I);const b=g.l?p(g.l.Ka,g.l,g):null;e:{var H=g.i;let Pe=-1;for(;;){const wt=["count="+I];Pe==-1?I>0?(Pe=H[0].g,wt.push("ofs="+Pe)):Pe=0:wt.push("ofs="+Pe);let je=!0;for(let yt=0;yt<I;yt++){var W=H[yt].g;const Qn=H[yt].map;if(W-=Pe,W<0)Pe=Math.max(0,H[yt].g-100),je=!1;else try{W="req"+W+"_"||"";try{var de=Qn instanceof Map?Qn:Object.entries(Qn);for(const[zi,mi]of de){let gi=mi;d(mi)&&(gi=Fr(mi)),wt.push(W+zi+"="+encodeURIComponent(gi))}}catch(zi){throw wt.push(W+"type="+encodeURIComponent("_badmap")),zi}}catch{b&&b(Qn)}}if(je){de=wt.join("&");break e}}de=void 0}return g=g.i.splice(0,I),A.G=g,de}function vd(g){if(!g.g&&!g.v){g.Y=1;var A=g.Da;le||D(),ue||(le(),ue=!0),N.add(A,g),g.A=0}}function ro(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=xi(p(g.Da,g),Ad(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,Ed(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=xi(p(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Pt(10),Yr(this),Ed(this))};function du(g){g.B!=null&&(l.clearTimeout(g.B),g.B=null)}function Ed(g){g.g=new ci(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var A=Lt(g.na);nt(A,"RID","rpc"),nt(A,"SID",g.M),nt(A,"AID",g.K),nt(A,"CI",g.F?"0":"1"),!g.F&&g.ia&&nt(A,"TO",g.ia),nt(A,"TYPE","xmlhttp"),io(g,A),g.u&&g.o&&eo(A,g.u,g.o),g.O&&(g.g.H=g.O);var I=g.g;g=g.ba,I.M=1,I.A=Ws(Lt(A)),I.u=null,I.R=!0,ia(I,g)}n.Va=function(){this.C!=null&&(this.C=null,Yr(this),ro(this),Pt(19))};function fa(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function Td(g,A){var I=null;if(g.g==A){fa(g),du(g),g.g=null;var b=2}else if(Li(g.h,A))I=A.G,eu(g.h,A),b=1;else return;if(g.I!=0){if(A.o)if(b==1){I=A.u?A.u.length:0,A=Date.now()-A.F;var H=g.D;b=na(),Kt(b,new bi(b,I)),qi(g)}else vd(g);else if(H=A.m,H==3||H==0&&A.X>0||!(b==1&&da(g,A)||b==2&&ro(g)))switch(I&&I.length>0&&(A=g.h,A.i=A.i.concat(I)),H){case 1:Gi(g,5);break;case 4:Gi(g,10);break;case 3:Gi(g,6);break;default:Gi(g,2)}}}function Ad(g,A){let I=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(I*=2),I*A}function Gi(g,A){if(g.j.info("Error code "+A),A==2){var I=p(g.bb,g),b=g.Ua;const H=!b;b=new Pn(b||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Wt(b,"https"),Ws(b),H?fi(b.toString(),I):ou(b.toString(),I)}else Pt(2);g.I=0,g.l&&g.l.pa(A),Sd(g),ca(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function Sd(g){if(g.I=0,g.ja=[],g.l){const A=tu(g.h);(A.length!=0||g.i.length!=0)&&(P(g.ja,A),P(g.ja,g.i),g.h.i.length=0,C(g.i),g.i.length=0),g.l.oa()}}function Id(g,A,I){var b=I instanceof Pn?Lt(I):new Pn(I);if(b.g!="")A&&(b.g=A+"."+b.g),Br(b,b.u);else{var H=l.location;b=H.protocol,A=A?A+"."+H.hostname:H.hostname,H=+H.port;const W=new Pn(null);b&&Wt(W,b),A&&(W.g=A),H&&Br(W,H),I&&(W.h=I),b=W}return I=g.G,A=g.wa,I&&A&&nt(b,I,A),nt(b,"VER",g.ka),io(g,b),b}function Cd(g,A,I){if(A&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return A=g.Aa&&!g.ma?new lt(new Oi({ab:I})):new lt(g.ma),A.Fa(g.L),A}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function wd(){}n=wd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function $r(){}$r.prototype.g=function(g,A){return new _n(g,A)};function _n(g,A){Mt.call(this),this.g=new Jr(A),this.l=g,this.h=A&&A.messageUrlParams||null,g=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(g?g["X-WebChannel-Content-Type"]=A.messageContentType:g={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.sa&&(g?g["X-WebChannel-Client-Profile"]=A.sa:g={"X-WebChannel-Client-Profile":A.sa}),this.g.U=g,(g=A&&A.Qb)&&!M(g)&&(this.g.u=g),this.A=A&&A.supportsCrossDomainXhr||!1,this.v=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!M(A)&&(this.g.G=A,g=this.h,g!==null&&A in g&&(g=this.h,A in g&&delete g[A])),this.j=new or(this)}E(_n,Mt),_n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){uu(this.g)},_n.prototype.o=function(g){var A=this.g;if(typeof g=="string"){var I={};I.__data__=g,g=I}else this.v&&(I={},I.__data__=Fr(g),g=I);A.i.push(new Vt(A.Ya++,g)),A.I==3&&qi(A)},_n.prototype.N=function(){this.g.l=null,delete this.j,uu(this.g),delete this.g,_n.Z.N.call(this)};function Rd(g){tn.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var A=g.__sm__;if(A){e:{for(const I in A){g=I;break e}g=void 0}(this.i=g)&&(g=this.i,A=A!==null&&g in A?A[g]:void 0),this.data=A}else this.data=g}E(Rd,tn);function bd(){Kn.call(this),this.status=1}E(bd,Kn);function or(g){this.g=g}E(or,wd),or.prototype.ra=function(){Kt(this.g,"a")},or.prototype.qa=function(g){Kt(this.g,new Rd(g))},or.prototype.pa=function(g){Kt(this.g,new bd)},or.prototype.oa=function(){Kt(this.g,"b")},$r.prototype.createWebChannel=$r.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,Fw=function(){return new $r},Ow=function(){return na()},Uw=Ct,ny={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Qs.NO_ERROR=0,Qs.TIMEOUT=8,Qs.HTTP_ERROR=6,Zf=Qs,Ql.COMPLETE="complete",Lw=Ql,od.EventType=li,li.OPEN="a",li.CLOSE="b",li.ERROR="c",li.MESSAGE="d",Mt.prototype.listen=Mt.prototype.J,sc=od,lt.prototype.listenOnce=lt.prototype.K,lt.prototype.getLastError=lt.prototype.Ha,lt.prototype.getLastErrorCode=lt.prototype.ya,lt.prototype.getStatus=lt.prototype.ca,lt.prototype.getResponseJson=lt.prototype.La,lt.prototype.getResponseText=lt.prototype.la,lt.prototype.send=lt.prototype.ea,lt.prototype.setWithCredentials=lt.prototype.Fa,Vw=lt}).apply(typeof kf<"u"?kf:typeof self<"u"?self:typeof window<"u"?window:{});const CA="@firebase/firestore",wA="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vl="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=new Ky("@firebase/firestore");function Qa(){return qo.logLevel}function ae(n,...e){if(qo.logLevel<=ze.DEBUG){const t=e.map(n_);qo.debug(`Firestore (${Vl}): ${n}`,...t)}}function Nt(n,...e){if(qo.logLevel<=ze.ERROR){const t=e.map(n_);qo.error(`Firestore (${Vl}): ${n}`,...t)}}function Sc(n,...e){if(qo.logLevel<=ze.WARN){const t=e.map(n_);qo.warn(`Firestore (${Vl}): ${n}`,...t)}}function n_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Bw(n,i,t)}function Bw(n,e,t){let i=`FIRESTORE (${Vl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Nt(i),new Error(i)}function Se(n,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,n||Bw(e,s,i)}function Ee(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends Mr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $k{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(fn.UNAUTHENTICATED)))}shutdown(){}}class Qk{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Se(this.o===void 0,42304);let i=this.i;const s=f=>this.i!==i?(i=this.i,t(f)):Promise.resolve();let a=new wr;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new wr,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},d=f=>{ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new wr)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Se(typeof i.accessToken=="string",31837,{l:i}),new Yk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Se(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class Xk{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Wk{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Xk(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class RA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Zk{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ri(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Se(this.o===void 0,3512);const i=a=>{a.error!=null&&ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,ae("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>i(a)))};const s=a=>{ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new RA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Se(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new RA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=jk(40);for(let a=0;a<s.length;++a)i.length<20&&s[a]<t&&(i+=e.charAt(s[a]%62))}return i}}function Ne(n,e){return n<e?-1:n>e?1:0}function iy(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const s=n.charAt(i),a=e.charAt(i);if(s!==a)return kg(s)===kg(a)?Ne(s,a):kg(s)?1:-1}return Ne(n.length,e.length)}const eV=55296,tV=57343;function kg(n){const e=n.charCodeAt(0);return e>=eV&&e<=tV}function pl(n,e,t){return n.length===e.length&&n.every(((i,s)=>t(i,e[s])))}function qw(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA="__name__";class $i{constructor(e,t,i){t===void 0?t=0:t>e.length&&ye(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ye(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return $i.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof $i?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const a=$i.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return Ne(e.length,t.length)}static compareSegments(e,t){const i=$i.isNumericId(e),s=$i.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?$i.extractNumericId(e).compare($i.extractNumericId(t)):iy(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ns.fromString(e.substring(4,e.length-2))}}class tt extends $i{construct(e,t,i){return new tt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ce(ee.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new tt(t)}static emptyPath(){return new tt([])}}const nV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Et extends $i{construct(e,t,i){return new Et(e,t,i)}static isValidIdentifier(e){return nV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Et.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===bA}static keyField(){return new Et([bA])}static fromServerFormat(e){const t=[];let i="",s=0;const a=()=>{if(i.length===0)throw new ce(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let l=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new ce(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ce(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,s+=2}else d==="`"?(l=!l,s++):d!=="."||l?(i+=d,s++):(a(),s++)}if(a(),l)throw new ce(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Et(t)}static emptyPath(){return new Et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.path=e}static fromPath(e){return new fe(tt.fromString(e))}static fromName(e){return new fe(tt.fromString(e).popFirst(5))}static empty(){return new fe(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return tt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new fe(new tt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(n,e,t){if(!t)throw new ce(ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function iV(n,e,t,i){if(e===!0&&i===!0)throw new ce(ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function xA(n){if(!fe.isDocumentKey(n))throw new ce(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function NA(n){if(fe.isDocumentKey(n))throw new ce(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function zw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Qh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ye(12329,{type:typeof n})}function ml(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ce(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Qh(n);throw new ce(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Kc(n,e){if(!zw(n))throw new ce(ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const s=e[i].typeString,a="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const l=n[i];if(s&&typeof l!==s){t=`JSON field '${i}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${i}' field to equal '${a.value}'`;break}}if(t)throw new ce(ee.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=-62135596800,MA=1e6;class st{static now(){return st.fromMillis(Date.now())}static fromDate(e){return st.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*MA);return new st(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ce(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ce(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<DA)throw new ce(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/MA}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:st._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Kc(e,st._jsonSchema))return new st(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-DA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}st._jsonSchemaVersion="firestore/timestamp/1.0",st._jsonSchema={type:Gt("string",st._jsonSchemaVersion),seconds:Gt("number"),nanoseconds:Gt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{static fromTimestamp(e){return new Ce(e)}static min(){return new Ce(new st(0,0))}static max(){return new Ce(new st(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gl=-1;class Ah{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function ry(n){return n.fields.find((e=>e.kind===2))}function Io(n){return n.fields.filter((e=>e.kind!==2))}Ah.UNKNOWN_ID=-1;class jf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Ic{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Ic(0,Hn.min())}}function Hw(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=Ce.fromTimestamp(i===1e9?new st(t+1,0):new st(t,i));return new Hn(s,fe.empty(),e)}function Kw(n){return new Hn(n.readTime,n.key,gl)}class Hn{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Hn(Ce.min(),fe.empty(),gl)}static max(){return new Hn(Ce.max(),fe.empty(),gl)}}function r_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=fe.comparator(n.documentKey,e.documentKey),t!==0?t:Ne(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Yw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fs(n){if(n.code!==ee.FAILED_PRECONDITION||n.message!==Jw)throw n;ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z(((i,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):z.reject(t)}static resolve(e){return new z(((t,i)=>{t(e)}))}static reject(e){return new z(((t,i)=>{i(e)}))}static waitFor(e){return new z(((t,i)=>{let s=0,a=0,l=!1;e.forEach((d=>{++s,d.next((()=>{++a,l&&a===s&&t()}),(f=>i(f)))})),l=!0,a===s&&t()}))}static or(e){let t=z.resolve(!1);for(const i of e)t=t.next((s=>s?z.resolve(s):i()));return t}static forEach(e,t){const i=[];return e.forEach(((s,a)=>{i.push(t.call(this,s,a))})),this.waitFor(i)}static mapArray(e,t){return new z(((i,s)=>{const a=e.length,l=new Array(a);let d=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next((_=>{l[p]=_,++d,d===a&&i(l)}),(_=>s(_)))}}))}static doWhile(e,t){return new z(((i,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):i()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn="SimpleDb";class Xh{static open(e,t,i,s){try{return new Xh(t,e.transaction(s,i))}catch(a){throw new fc(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new wr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new fc(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const s=s_(i.target.error);this.S.reject(new fc(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ae(qn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new sV(t)}}class Ds{static delete(e){return ae(qn,"Removing database:",e),Ro(BC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!YC())return!1;if(Ds.F())return!0;const e=$t(),t=Ds.M(e),i=0<t&&t<10,s=$w(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Ds.M($t())===12.2&&Nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ae(qn,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{i(new fc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?i(new ce(ee.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?i(new ce(ee.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):i(new fc(e,l))},s.onupgradeneeded=a=>{ae(qn,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,s.transaction,a.oldVersion,this.version).next((()=>{ae(qn,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const d=Xh.open(this.db,e,a?"readonly":"readwrite",i),f=s(d).next((p=>(d.C(),p))).catch((p=>(d.abort(p),z.reject(p)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,p=f.name!=="FirebaseError"&&l<3;if(ae(qn,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function $w(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class rV{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Ro(this.U.delete())}}class fc extends ce{constructor(e,t){super(ee.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Bs(n){return n.name==="IndexedDbTransactionError"}class sV{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ae(qn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ae(qn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),Ro(i)}add(e){return ae(qn,"ADD",this.store.name,e,e),Ro(this.store.add(e))}get(e){return Ro(this.store.get(e)).next((t=>(t===void 0&&(t=null),ae(qn,"GET",this.store.name,e,t),t)))}delete(e){return ae(qn,"DELETE",this.store.name,e),Ro(this.store.delete(e))}count(){return ae(qn,"COUNT",this.store.name),Ro(this.store.count())}J(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(i.range);return new z(((l,d)=>{a.onerror=f=>{d(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(i),l=[];return this.H(a,((d,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new z(((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}}))}Z(e,t){ae(qn,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const s=this.cursor(i);return this.H(s,((a,l,d)=>d.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.H(s,t)}te(e){const t=this.cursor({});return new z(((i,s)=>{t.onerror=a=>{const l=s_(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():i()})):i()}}))}H(e,t){const i=[];return new z(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void s();const f=new rV(d),p=t(d.primaryKey,d.value,f);if(p instanceof z){const _=p.catch((E=>(f.done(),z.reject(E))));i.push(_)}f.isDone?s():f.G===null?d.continue():d.continue(f.G)}})).next((()=>z.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ro(n){return new z(((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=s_(i.target.error);t(s)}}))}let PA=!1;function s_(n){const e=Ds.M($t());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return PA||(PA=!0,setTimeout((()=>{throw i}),0)),i}}return n}const hc="IndexBackfiller";class oV{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ae(hc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ae(hc,`Documents written: ${t}`)}catch(t){Bs(t)?ae(hc,"Ignoring IndexedDB error during index backfill: ",t):await Fs(t)}await this.re(6e4)}))}}class aV{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let s=t,a=!0;return z.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!i.has(l))return ae(hc,`Processing collection: ${l}`),this.oe(e,l,s).next((d=>{s-=d,i.add(l)}));a=!1})))).next((()=>t-s))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(s,a))).next((d=>(ae(hc,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((s,a)=>{const l=Kw(a);r_(l,i)>0&&(i=l)})),new Hn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Nn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=-1;function Wh(n){return n==null}function Cc(n){return n===0&&1/n==-1/0}function Qw(n){return typeof n=="number"&&Number.isInteger(n)&&!Cc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sh="";function gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=kA(e)),e=lV(n.get(t),e);return kA(e)}function lV(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Sh:t+="";break;default:t+=a}}return t}function kA(n){return n+Sh+""}function Xi(n){const e=n.length;if(Se(e>=2,64408,{path:n}),e===2)return Se(n.charAt(0)===Sh&&n.charAt(1)==="",56145,{path:n}),tt.emptyPath();const t=e-2,i=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Sh,a);switch((l<0||l>t)&&ye(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(a,l);let f;s.length===0?f=d:(s+=d,f=s,s=""),i.push(f);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:ye(61167,{path:n})}a=l+2}return new tt(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co="remoteDocuments",Jc="owner",za="owner",wc="mutationQueues",uV="userId",Ei="mutations",VA="batchId",Do="userMutationsIndex",LA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(n,e){return[n,gn(e)]}function Xw(n,e,t){return[n,gn(e),t]}const cV={},yl="documentMutations",Ih="remoteDocumentsV14",dV=["prefixPath","collectionGroup","readTime","documentId"],th="documentKeyIndex",fV=["prefixPath","collectionGroup","documentId"],Ww="collectionGroupIndex",hV=["collectionGroup","readTime","prefixPath","documentId"],Rc="remoteDocumentGlobal",sy="remoteDocumentGlobalKey",_l="targets",Zw="queryTargetsIndex",pV=["canonicalId","targetId"],vl="targetDocuments",mV=["targetId","path"],o_="documentTargetsIndex",gV=["path","targetId"],Ch="targetGlobalKey",ko="targetGlobal",bc="collectionParents",yV=["collectionId","parent"],El="clientMetadata",_V="clientId",Zh="bundles",vV="bundleId",jh="namedQueries",EV="name",a_="indexConfiguration",TV="indexId",oy="collectionGroupIndex",AV="collectionGroup",pc="indexState",SV=["indexId","uid"],jw="sequenceNumberIndex",IV=["uid","sequenceNumber"],mc="indexEntries",CV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],eR="documentKeyIndex",wV=["indexId","uid","orderedDocumentKey"],ep="documentOverlays",RV=["userId","collectionPath","documentId"],ay="collectionPathOverlayIndex",bV=["userId","collectionPath","largestBatchId"],tR="collectionGroupOverlayIndex",xV=["userId","collectionGroup","largestBatchId"],l_="globals",NV="name",nR=[wc,Ei,yl,Co,_l,Jc,ko,vl,El,Rc,bc,Zh,jh],DV=[...nR,ep],iR=[wc,Ei,yl,Ih,_l,Jc,ko,vl,El,Rc,bc,Zh,jh,ep],rR=iR,u_=[...rR,a_,pc,mc],MV=u_,sR=[...u_,l_],PV=sR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly extends Yw{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Qt(n,e){const t=Ee(n);return Ds.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function qs(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function oR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new ht(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vf(this.root,e,this.comparator,!0)}}class Vf{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ln{constructor(e,t,i,s,a){this.key=e,this.value=t,this.color=i??ln.RED,this.left=s??ln.EMPTY,this.right=a??ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,a){return new ln(e??this.key,t??this.value,i??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const a=i(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,i),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return ln.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ye(27949);return e+(this.isRed()?0:1)}}ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw ye(57766)}get value(){throw ye(16141)}get color(){throw ye(16727)}get left(){throw ye(29726)}get right(){throw ye(36894)}copy(e,t,i,s,a){return this}insert(e,t,i){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new OA(this.data.getIterator())}getIteratorFrom(e){return new OA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=i.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new at(this.comparator);return t.data=e,t}}class OA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ha(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new Dn([])}unionWith(e){let t=new at(Et.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Dn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new aR("Invalid base64 string: "+a):a}})(e);return new Dt(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new Dt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dt.EMPTY_BYTE_STRING=new Dt("");const kV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xr(n){if(Se(!!n,39018),typeof n=="string"){let e=0;const t=kV.exec(n);if(Se(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:vt(n.seconds),nanos:vt(n.nanos)}}function vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Nr(n){return typeof n=="string"?Dt.fromBase64String(n):Dt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lR="server_timestamp",uR="__type__",cR="__previous_value__",dR="__local_write_time__";function c_(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[uR])==null?void 0:i.stringValue)===lR}function tp(n){const e=n.mapValue.fields[cR];return c_(e)?tp(e):e}function xc(n){const e=xr(n.mapValue.fields[dR].timestampValue);return new st(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VV{constructor(e,t,i,s,a,l,d,f,p,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_}}const wh="(default)";class Go{constructor(e,t){this.projectId=e,this.database=t||wh}static empty(){return new Go("","")}get isDefaultDatabase(){return this.database===wh}isEqual(e){return e instanceof Go&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_="__type__",fR="__max__",ws={mapValue:{fields:{__type__:{stringValue:fR}}}},f_="__vector__",Tl="value",nh={nullValue:"NULL_VALUE"};function Ps(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?c_(n)?4:hR(n)?9007199254740991:np(n)?10:11:ye(28295,{value:n})}function nr(n,e){if(n===e)return!0;const t=Ps(n);if(t!==Ps(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xc(n).isEqual(xc(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=xr(s.timestampValue),d=xr(a.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return Nr(s.bytesValue).isEqual(Nr(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return vt(s.geoPointValue.latitude)===vt(a.geoPointValue.latitude)&&vt(s.geoPointValue.longitude)===vt(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return vt(s.integerValue)===vt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=vt(s.doubleValue),d=vt(a.doubleValue);return l===d?Cc(l)===Cc(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return pl(n.arrayValue.values||[],e.arrayValue.values||[],nr);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},d=a.mapValue.fields||{};if(UA(l)!==UA(d))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(d[f]===void 0||!nr(l[f],d[f])))return!1;return!0})(n,e);default:return ye(52216,{left:n})}}function Nc(n,e){return(n.values||[]).find((t=>nr(t,e)))!==void 0}function ks(n,e){if(n===e)return 0;const t=Ps(n),i=Ps(e);if(t!==i)return Ne(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ne(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const d=vt(a.integerValue||a.doubleValue),f=vt(l.integerValue||l.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return FA(n.timestampValue,e.timestampValue);case 4:return FA(xc(n),xc(e));case 5:return iy(n.stringValue,e.stringValue);case 6:return(function(a,l){const d=Nr(a),f=Nr(l);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const d=a.split("/"),f=l.split("/");for(let p=0;p<d.length&&p<f.length;p++){const _=Ne(d[p],f[p]);if(_!==0)return _}return Ne(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const d=Ne(vt(a.latitude),vt(l.latitude));return d!==0?d:Ne(vt(a.longitude),vt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return BA(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var T,C,P,O;const d=a.fields||{},f=l.fields||{},p=(T=d[Tl])==null?void 0:T.arrayValue,_=(C=f[Tl])==null?void 0:C.arrayValue,E=Ne(((P=p==null?void 0:p.values)==null?void 0:P.length)||0,((O=_==null?void 0:_.values)==null?void 0:O.length)||0);return E!==0?E:BA(p,_)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===ws.mapValue&&l===ws.mapValue)return 0;if(a===ws.mapValue)return 1;if(l===ws.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),p=l.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let E=0;E<f.length&&E<_.length;++E){const T=iy(f[E],_[E]);if(T!==0)return T;const C=ks(d[f[E]],p[_[E]]);if(C!==0)return C}return Ne(f.length,_.length)})(n.mapValue,e.mapValue);default:throw ye(23264,{he:t})}}function FA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ne(n,e);const t=xr(n),i=xr(e),s=Ne(t.seconds,i.seconds);return s!==0?s:Ne(t.nanos,i.nanos)}function BA(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const a=ks(t[s],i[s]);if(a)return a}return Ne(t.length,i.length)}function Al(n){return uy(n)}function uy(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=xr(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Nr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return fe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",s=!0;for(const a of t.values||[])s?s=!1:i+=",",i+=uy(a);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of i)a?a=!1:s+=",",s+=`${l}:${uy(t.fields[l])}`;return s+"}"})(n.mapValue):ye(61005,{value:n})}function ih(n){switch(Ps(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=tp(n);return e?16+ih(e):16;case 5:return 2*n.stringValue.length;case 6:return Nr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,a)=>s+ih(a)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return qs(i.fields,((a,l)=>{s+=a.length+ih(l)})),s})(n.mapValue);default:throw ye(13486,{value:n})}}function Dc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function cy(n){return!!n&&"integerValue"in n}function Mc(n){return!!n&&"arrayValue"in n}function qA(n){return!!n&&"nullValue"in n}function GA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function rh(n){return!!n&&"mapValue"in n}function np(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[d_])==null?void 0:i.stringValue)===f_}function gc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return qs(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=gc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gc(n.arrayValue.values[t]);return e}return{...n}}function hR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===fR}const pR={mapValue:{fields:{[d_]:{stringValue:f_},[Tl]:{arrayValue:{}}}}};function LV(n){return"nullValue"in n?nh:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Dc(Go.empty(),fe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?np(n)?pR:{mapValue:{}}:ye(35942,{value:n})}function UV(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Dc(Go.empty(),fe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?pR:"mapValue"in n?np(n)?{mapValue:{}}:ws:ye(61959,{value:n})}function zA(n,e){const t=ks(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function HA(n,e){const t=ks(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.value=e}static empty(){return new pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!rh(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gc(t)}setAll(e){let t=Et.emptyPath(),i={},s=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,i,s),i={},s=[],t=d.popLast()}l?i[d.lastSegment()]=gc(l):s.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,i,s)}delete(e){const t=this.field(e.popLast());rh(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];rh(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){qs(t,((s,a)=>e[s]=a));for(const s of i)delete e[s]}clone(){return new pn(gc(this.value))}}function mR(n){const e=[];return qs(n.fields,((t,i)=>{const s=new Et([t]);if(rh(i)){const a=mR(i.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new Dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,t,i,s,a,l,d){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new It(e,0,Ce.min(),Ce.min(),Ce.min(),pn.empty(),0)}static newFoundDocument(e,t,i,s){return new It(e,1,t,Ce.min(),i,s,0)}static newNoDocument(e,t){return new It(e,2,t,Ce.min(),Ce.min(),pn.empty(),0)}static newUnknownDocument(e,t){return new It(e,3,t,Ce.min(),Ce.min(),pn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof It&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new It(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,t){this.position=e,this.inclusive=t}}function KA(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?i=fe.comparator(fe.fromName(l.referenceValue),t.key):i=ks(l,t.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function JA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!nr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,t="asc"){this.field=e,this.dir=t}}function OV(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{}class He extends gR{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new FV(e,t,i):t==="array-contains"?new GV(e,i):t==="in"?new AR(e,i):t==="not-in"?new zV(e,i):t==="array-contains-any"?new HV(e,i):new He(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new BV(e,i):new qV(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ks(t,this.value)):t!==null&&Ps(this.value)===Ps(t)&&this.matchesComparison(ks(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ot extends gR{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ot(e,t)}matches(e){return Il(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Il(n){return n.op==="and"}function dy(n){return n.op==="or"}function h_(n){return yR(n)&&Il(n)}function yR(n){for(const e of n.filters)if(e instanceof ot)return!1;return!0}function fy(n){if(n instanceof He)return n.field.canonicalString()+n.op.toString()+Al(n.value);if(h_(n))return n.filters.map((e=>fy(e))).join(",");{const e=n.filters.map((t=>fy(t))).join(",");return`${n.op}(${e})`}}function _R(n,e){return n instanceof He?(function(i,s){return s instanceof He&&i.op===s.op&&i.field.isEqual(s.field)&&nr(i.value,s.value)})(n,e):n instanceof ot?(function(i,s){return s instanceof ot&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((a,l,d)=>a&&_R(l,s.filters[d])),!0):!1})(n,e):void ye(19439)}function vR(n,e){const t=n.filters.concat(e);return ot.create(t,n.op)}function ER(n){return n instanceof He?(function(t){return`${t.field.canonicalString()} ${t.op} ${Al(t.value)}`})(n):n instanceof ot?(function(t){return t.op.toString()+" {"+t.getFilters().map(ER).join(" ,")+"}"})(n):"Filter"}class FV extends He{constructor(e,t,i){super(e,t,i),this.key=fe.fromName(i.referenceValue)}matches(e){const t=fe.comparator(e.key,this.key);return this.matchesComparison(t)}}class BV extends He{constructor(e,t){super(e,"in",t),this.keys=TR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class qV extends He{constructor(e,t){super(e,"not-in",t),this.keys=TR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function TR(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>fe.fromName(i.referenceValue)))}class GV extends He{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Mc(t)&&Nc(t.arrayValue,this.value)}}class AR extends He{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Nc(this.value.arrayValue,t)}}class zV extends He{constructor(e,t){super(e,"not-in",t)}matches(e){if(Nc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Nc(this.value.arrayValue,t)}}class HV extends He{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Mc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>Nc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e,t=null,i=[],s=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=a,this.startAt=l,this.endAt=d,this.Te=null}}function hy(n,e=null,t=[],i=[],s=null,a=null,l=null){return new KV(n,e,t,i,s,a,l)}function zo(n){const e=Ee(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>fy(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(a){return a.field.canonicalString()+a.dir})(i))).join(","),Wh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Al(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Al(i))).join(",")),e.Te=t}return e.Te}function Yc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!OV(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_R(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!JA(n.startAt,e.startAt)&&JA(n.endAt,e.endAt)}function Rh(n){return fe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function bh(n,e){return n.filters.filter((t=>t instanceof He&&t.field.isEqual(e)))}function YA(n,e,t){let i=nh,s=!0;for(const a of bh(n,e)){let l=nh,d=!0;switch(a.op){case"<":case"<=":l=LV(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=nh}zA({value:i,inclusive:s},{value:l,inclusive:d})<0&&(i=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];zA({value:i,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(i=l,s=t.inclusive);break}}return{value:i,inclusive:s}}function $A(n,e,t){let i=ws,s=!0;for(const a of bh(n,e)){let l=ws,d=!0;switch(a.op){case">=":case">":l=UV(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=ws}HA({value:i,inclusive:s},{value:l,inclusive:d})>0&&(i=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];HA({value:i,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(i=l,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(e,t=null,i=[],s=[],a=null,l="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function SR(n,e,t,i,s,a,l,d){return new Ll(n,e,t,i,s,a,l,d)}function p_(n){return new Ll(n)}function QA(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function IR(n){return n.collectionGroup!==null}function yc(n){const e=Ee(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new at(Et.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Pc(a,i))})),t.has(Et.keyField().canonicalString())||e.Ie.push(new Pc(Et.keyField(),i))}return e.Ie}function zn(n){const e=Ee(n);return e.Ee||(e.Ee=JV(e,yc(n))),e.Ee}function JV(n,e){if(n.limitType==="F")return hy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Pc(s.field,a)}));const t=n.endAt?new Sl(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Sl(n.startAt.position,n.startAt.inclusive):null;return hy(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function py(n,e){const t=n.filters.concat([e]);return new Ll(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function my(n,e,t){return new Ll(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ip(n,e){return Yc(zn(n),zn(e))&&n.limitType===e.limitType}function CR(n){return`${zo(zn(n))}|lt:${n.limitType}`}function Xa(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((s=>ER(s))).join(", ")}]`),Wh(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((s=>Al(s))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((s=>Al(s))).join(",")),`Target(${i})`})(zn(n))}; limitType=${n.limitType})`}function $c(n,e){return e.isFoundDocument()&&(function(i,s){const a=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):fe.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)})(n,e)&&(function(i,s){for(const a of yc(i))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(i,s){for(const a of i.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(i,s){return!(i.startAt&&!(function(l,d,f){const p=KA(l,d,f);return l.inclusive?p<=0:p<0})(i.startAt,yc(i),s)||i.endAt&&!(function(l,d,f){const p=KA(l,d,f);return l.inclusive?p>=0:p>0})(i.endAt,yc(i),s))})(n,e)}function wR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function RR(n){return(e,t)=>{let i=!1;for(const s of yc(n)){const a=YV(s,e,t);if(a!==0)return a;i=i||s.field.isKeyField()}return 0}}function YV(n,e,t){const i=n.field.isKeyField()?fe.comparator(e.key,t.key):(function(a,l,d){const f=l.data.field(a),p=d.data.field(a);return f!==null&&p!==null?ks(f,p):ye(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ye(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,a]of i)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){qs(this.inner,((t,i)=>{for(const[s,a]of i)e(s,a)}))}isEmpty(){return oR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $V=new ht(fe.comparator);function Gn(){return $V}const bR=new ht(fe.comparator);function oc(...n){let e=bR;for(const t of n)e=e.insert(t.key,t);return e}function xR(n){let e=bR;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Wi(){return _c()}function NR(){return _c()}function _c(){return new kr((n=>n.toString()),((n,e)=>n.isEqual(e)))}const QV=new ht(fe.comparator),XV=new at(fe.comparator);function Ue(...n){let e=XV;for(const t of n)e=e.add(t);return e}const WV=new at(Ne);function m_(){return WV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Cc(e)?"-0":e}}function DR(n){return{integerValue:""+n}}function ZV(n,e){return Qw(e)?DR(e):g_(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(){this._=void 0}}function jV(n,e,t){return n instanceof kc?(function(s,a){const l={fields:{[uR]:{stringValue:lR},[dR]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&c_(a)&&(a=tp(a)),a&&(l.fields[cR]=a),{mapValue:l}})(t,e):n instanceof Cl?PR(n,e):n instanceof wl?kR(n,e):(function(s,a){const l=MR(s,a),d=XA(l)+XA(s.Ae);return cy(l)&&cy(s.Ae)?DR(d):g_(s.serializer,d)})(n,e)}function e4(n,e,t){return n instanceof Cl?PR(n,e):n instanceof wl?kR(n,e):t}function MR(n,e){return n instanceof Vc?(function(i){return cy(i)||(function(a){return!!a&&"doubleValue"in a})(i)})(e)?e:{integerValue:0}:null}class kc extends rp{}class Cl extends rp{constructor(e){super(),this.elements=e}}function PR(n,e){const t=VR(e);for(const i of n.elements)t.some((s=>nr(s,i)))||t.push(i);return{arrayValue:{values:t}}}class wl extends rp{constructor(e){super(),this.elements=e}}function kR(n,e){let t=VR(e);for(const i of n.elements)t=t.filter((s=>!nr(s,i)));return{arrayValue:{values:t}}}class Vc extends rp{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function XA(n){return vt(n.integerValue||n.doubleValue)}function VR(n){return Mc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e,t){this.field=e,this.transform=t}}function n4(n,e){return n.field.isEqual(e.field)&&(function(i,s){return i instanceof Cl&&s instanceof Cl||i instanceof wl&&s instanceof wl?pl(i.elements,s.elements,nr):i instanceof Vc&&s instanceof Vc?nr(i.Ae,s.Ae):i instanceof kc&&s instanceof kc})(n.transform,e.transform)}class i4{constructor(e,t){this.version=e,this.transformResults=t}}class un{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new un}static exists(e){return new un(void 0,e)}static updateTime(e){return new un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class sp{}function LR(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Qc(n.key,un.none()):new Ul(n.key,n.data,un.none());{const t=n.data,i=pn.empty();let s=new at(Et.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?i.delete(a):i.set(a,l),s=s.add(a)}return new Vr(n.key,i,new Dn(s.toArray()),un.none())}}function r4(n,e,t){n instanceof Ul?(function(s,a,l){const d=s.value.clone(),f=ZA(s.fieldTransforms,a,l.transformResults);d.setAll(f),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Vr?(function(s,a,l){if(!sh(s.precondition,a))return void a.convertToUnknownDocument(l.version);const d=ZA(s.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(UR(s)),f.setAll(d),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function vc(n,e,t,i){return n instanceof Ul?(function(a,l,d,f){if(!sh(a.precondition,l))return d;const p=a.value.clone(),_=jA(a.fieldTransforms,f,l);return p.setAll(_),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof Vr?(function(a,l,d,f){if(!sh(a.precondition,l))return d;const p=jA(a.fieldTransforms,f,l),_=l.data;return _.setAll(UR(a)),_.setAll(p),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((E=>E.field)))})(n,e,t,i):(function(a,l,d){return sh(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function s4(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),a=MR(i.transform,s||null);a!=null&&(t===null&&(t=pn.empty()),t.set(i.field,a))}return t||null}function WA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&pl(i,s,((a,l)=>n4(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ul extends sp{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Vr extends sp{constructor(e,t,i,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function UR(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function ZA(n,e,t){const i=new Map;Se(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,d=e.data.field(a.field);i.set(a.field,e4(l,d,t[s]))}return i}function jA(n,e,t){const i=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);i.set(s.field,jV(a,l,e))}return i}class Qc extends sp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class OR extends sp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&r4(a,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=vc(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=vc(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=NR();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(s.key)?null:d;const f=LR(l,d);f!==null&&i.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(Ce.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ue())}isEqual(e){return this.batchId===e.batchId&&pl(this.mutations,e.mutations,((t,i)=>WA(t,i)))&&pl(this.baseMutations,e.baseMutations,((t,i)=>WA(t,i)))}}class __{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Se(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let s=(function(){return QV})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,i[l].version);return new __(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v_{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt,$e;function a4(n){switch(n){case ee.OK:return ye(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return ye(15467,{code:n})}}function FR(n){if(n===void 0)return Nt("GRPC error has no .code"),ee.UNKNOWN;switch(n){case qt.OK:return ee.OK;case qt.CANCELLED:return ee.CANCELLED;case qt.UNKNOWN:return ee.UNKNOWN;case qt.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case qt.INTERNAL:return ee.INTERNAL;case qt.UNAVAILABLE:return ee.UNAVAILABLE;case qt.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case qt.NOT_FOUND:return ee.NOT_FOUND;case qt.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case qt.ABORTED:return ee.ABORTED;case qt.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case qt.DATA_LOSS:return ee.DATA_LOSS;default:return ye(39323,{code:n})}}($e=qt||(qt={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u4=new Ns([4294967295,4294967295],0);function eS(n){const e=l4().encode(n),t=new kw;return t.update(e),new Uint8Array(t.digest())}function tS(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ns([t,i],0),new Ns([s,a],0)]}class E_{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new ac(`Invalid padding: ${t}`);if(i<0)throw new ac(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new ac(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new ac(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ns.fromNumber(this.ge)}ye(e,t,i){let s=e.add(t.multiply(Ns.fromNumber(i)));return s.compare(u4)===1&&(s=new Ns([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=eS(e),[i,s]=tS(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(i,s,a);if(!this.we(l))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new E_(a,s,t);return i.forEach((d=>l.insert(d))),l}insert(e){if(this.ge===0)return;const t=eS(e),[i,s]=tS(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(i,s,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class ac extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xc{constructor(e,t,i,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Wc.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Xc(Ce.min(),s,new ht(Ne),Gn(),Ue())}}class Wc{constructor(e,t,i,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Wc(i,t,Ue(),Ue(),Ue())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oh{constructor(e,t,i,s){this.be=e,this.removedTargetIds=t,this.key=i,this.De=s}}class BR{constructor(e,t){this.targetId=e,this.Ce=t}}class qR{constructor(e,t,i=Dt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class nS{constructor(){this.ve=0,this.Fe=iS(),this.Me=Dt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ue(),t=Ue(),i=Ue();return this.Fe.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:ye(38017,{changeType:a})}})),new Wc(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=iS()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Se(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class c4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Gn(),this.Je=Lf(),this.He=Lf(),this.Ye=new ht(Ne)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:ye(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,i=e.Ce.count,s=this.ot(t);if(s){const a=s.target;if(Rh(a))if(i===0){const l=new fe(a.path);this.et(t,l,It.newNoDocument(l,Ce.min()))}else Se(i===1,20013,{expectedCount:i});else{const l=this._t(t);if(l!==i){const d=this.ut(e),f=d?this.ct(d,e,l):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=t;let l,d;try{l=Nr(i).toUint8Array()}catch(f){if(f instanceof aR)return Sc("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new E_(l,s,a)}catch(f){return Sc(f instanceof ac?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let s=0;return i.forEach((a=>{const l=this.Ge.ht(),d=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.et(t,a,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const d=this.ot(l);if(d){if(a.current&&Rh(d.target)){const f=new fe(d.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,It.newNoDocument(f,e))}a.Be&&(t.set(l,a.ke()),a.qe())}}));let i=Ue();this.He.forEach(((a,l)=>{let d=!0;l.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const s=new Xc(e,t,this.Ye,this.je,i);return this.je=Gn(),this.Je=Lf(),this.He=Lf(),this.Ye=new ht(Ne),s}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new nS,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new at(Ne),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new at(Ne),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new nS),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Lf(){return new ht(fe.comparator)}function iS(){return new ht(fe.comparator)}const d4={asc:"ASCENDING",desc:"DESCENDING"},f4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},h4={and:"AND",or:"OR"};class p4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function gy(n,e){return n.useProto3Json||Wh(e)?e:{value:e}}function Rl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function GR(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function m4(n,e){return Rl(n,e.toTimestamp())}function Tn(n){return Se(!!n,49232),Ce.fromTimestamp((function(t){const i=xr(t);return new st(i.seconds,i.nanos)})(n))}function T_(n,e){return yy(n,e).canonicalString()}function yy(n,e){const t=(function(s){return new tt(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function zR(n){const e=tt.fromString(n);return Se(ZR(e),10190,{key:e.toString()}),e}function xh(n,e){return T_(n.databaseId,e.path)}function Vo(n,e){const t=zR(e);if(t.get(1)!==n.databaseId.projectId)throw new ce(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ce(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new fe(JR(t))}function HR(n,e){return T_(n.databaseId,e)}function KR(n){const e=zR(n);return e.length===4?tt.emptyPath():JR(e)}function _y(n){return new tt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function JR(n){return Se(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function rS(n,e,t){return{name:xh(n,e),fields:t.value.mapValue.fields}}function g4(n,e,t){const i=Vo(n,e.name),s=Tn(e.updateTime),a=e.createTime?Tn(e.createTime):Ce.min(),l=new pn({mapValue:{fields:e.fields}}),d=It.newFoundDocument(i,s,a,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function y4(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ye(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(p,_){return p.useProto3Json?(Se(_===void 0||typeof _=="string",58123),Dt.fromBase64String(_||"")):(Se(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Dt.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(p){const _=p.code===void 0?ee.UNKNOWN:FR(p.code);return new ce(_,p.message||"")})(l);t=new qR(i,s,a,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=Vo(n,i.document.name),a=Tn(i.document.updateTime),l=i.document.createTime?Tn(i.document.createTime):Ce.min(),d=new pn({mapValue:{fields:i.document.fields}}),f=It.newFoundDocument(s,a,l,d),p=i.targetIds||[],_=i.removedTargetIds||[];t=new oh(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=Vo(n,i.document),a=i.readTime?Tn(i.readTime):Ce.min(),l=It.newNoDocument(s,a),d=i.removedTargetIds||[];t=new oh([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=Vo(n,i.document),a=i.removedTargetIds||[];t=new oh([],a,s,null)}else{if(!("filter"in e))return ye(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:a}=i,l=new o4(s,a),d=i.targetId;t=new BR(d,l)}}return t}function Nh(n,e){let t;if(e instanceof Ul)t={update:rS(n,e.key,e.value)};else if(e instanceof Qc)t={delete:xh(n,e.key)};else if(e instanceof Vr)t={update:rS(n,e.key,e.data),updateMask:S4(e.fieldMask)};else{if(!(e instanceof OR))return ye(16599,{Vt:e.type});t={verify:xh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(a,l){const d=l.transform;if(d instanceof kc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Cl)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof wl)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Vc)return{fieldPath:l.field.canonicalString(),increment:d.Ae};throw ye(20930,{transform:l.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:m4(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ye(27497)})(n,e.precondition)),t}function vy(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?un.updateTime(Tn(a.updateTime)):a.exists!==void 0?un.exists(a.exists):un.none()})(e.currentDocument):un.none(),i=e.updateTransforms?e.updateTransforms.map((s=>(function(l,d){let f=null;if("setToServerValue"in d)Se(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new kc;else if("appendMissingElements"in d){const _=d.appendMissingElements.values||[];f=new Cl(_)}else if("removeAllFromArray"in d){const _=d.removeAllFromArray.values||[];f=new wl(_)}else"increment"in d?f=new Vc(l,d.increment):ye(16584,{proto:d});const p=Et.fromServerFormat(d.fieldPath);return new t4(p,f)})(n,s))):[];if(e.update){e.update.name;const s=Vo(n,e.update.name),a=new pn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const p=f.fieldPaths||[];return new Dn(p.map((_=>Et.fromServerFormat(_))))})(e.updateMask);return new Vr(s,a,l,t,i)}return new Ul(s,a,t,i)}if(e.delete){const s=Vo(n,e.delete);return new Qc(s,t)}if(e.verify){const s=Vo(n,e.verify);return new OR(s,t)}return ye(1463,{proto:e})}function _4(n,e){return n&&n.length>0?(Se(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?Tn(s.updateTime):Tn(a);return l.isEqual(Ce.min())&&(l=Tn(a)),new i4(l,s.transformResults||[])})(t,e)))):[]}function YR(n,e){return{documents:[HR(n,e.path)]}}function $R(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=HR(n,s);const a=(function(p){if(p.length!==0)return WR(ot.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(p){if(p.length!==0)return p.map((_=>(function(T){return{field:Wa(T.field),direction:E4(T.dir)}})(_)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=gy(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:s}}function QR(n){let e=KR(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Se(i===1,65062);const _=t.from[0];_.allDescendants?s=_.collectionId:e=e.child(_.collectionId)}let a=[];t.where&&(a=(function(E){const T=XR(E);return T instanceof ot&&h_(T)?T.getFilters():[T]})(t.where));let l=[];t.orderBy&&(l=(function(E){return E.map((T=>(function(P){return new Pc(Za(P.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(T)))})(t.orderBy));let d=null;t.limit&&(d=(function(E){let T;return T=typeof E=="object"?E.value:E,Wh(T)?null:T})(t.limit));let f=null;t.startAt&&(f=(function(E){const T=!!E.before,C=E.values||[];return new Sl(C,T)})(t.startAt));let p=null;return t.endAt&&(p=(function(E){const T=!E.before,C=E.values||[];return new Sl(C,T)})(t.endAt)),SR(e,s,l,a,d,"F",f,p)}function v4(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function XR(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Za(t.unaryFilter.field);return He.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=Za(t.unaryFilter.field);return He.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Za(t.unaryFilter.field);return He.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Za(t.unaryFilter.field);return He.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ye(61313);default:return ye(60726)}})(n):n.fieldFilter!==void 0?(function(t){return He.create(Za(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ye(58110);default:return ye(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ot.create(t.compositeFilter.filters.map((i=>XR(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ye(1026)}})(t.compositeFilter.op))})(n):ye(30097,{filter:n})}function E4(n){return d4[n]}function T4(n){return f4[n]}function A4(n){return h4[n]}function Wa(n){return{fieldPath:n.canonicalString()}}function Za(n){return Et.fromServerFormat(n.fieldPath)}function WR(n){return n instanceof He?(function(t){if(t.op==="=="){if(GA(t.value))return{unaryFilter:{field:Wa(t.field),op:"IS_NAN"}};if(qA(t.value))return{unaryFilter:{field:Wa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(GA(t.value))return{unaryFilter:{field:Wa(t.field),op:"IS_NOT_NAN"}};if(qA(t.value))return{unaryFilter:{field:Wa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wa(t.field),op:T4(t.op),value:t.value}}})(n):n instanceof ot?(function(t){const i=t.getFilters().map((s=>WR(s)));return i.length===1?i[0]:{compositeFilter:{op:A4(t.op),filters:i}}})(n):ye(54877,{filter:n})}function S4(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function ZR(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e,t,i,s,a=Ce.min(),l=Ce.min(),d=Dt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new Ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e){this.yt=e}}function I4(n,e){let t;if(e.document)t=g4(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=fe.fromSegments(e.noDocument.path),s=Ko(e.noDocument.readTime);t=It.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ye(56709);{const i=fe.fromSegments(e.unknownDocument.path),s=Ko(e.unknownDocument.version);t=It.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime((function(s){const a=new st(s[0],s[1]);return Ce.fromTimestamp(a)})(e.readTime)),t}function sS(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Dh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(a,l){return{name:xh(a,l.key),fields:l.data.value.mapValue.fields,updateTime:Rl(a,l.version.toTimestamp()),createTime:Rl(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Ho(e.version)};else{if(!e.isUnknownDocument())return ye(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Ho(e.version)}}return i}function Dh(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ho(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ko(n){const e=new st(n.seconds,n.nanoseconds);return Ce.fromTimestamp(e)}function bo(n,e){const t=(e.baseMutations||[]).map((a=>vy(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const i=e.mutations.map((a=>vy(n.yt,a))),s=st.fromMillis(e.localWriteTimeMs);return new y_(e.batchId,s,t,i)}function lc(n){const e=Ko(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ko(n.lastLimboFreeSnapshotVersion):Ce.min();let i;return i=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return Se(l===1,1966,{count:l}),zn(p_(KR(a.documents[0])))})(n.query):(function(a){return zn(QR(a))})(n.query),new Ir(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Dt.fromBase64String(n.resumeToken))}function eb(n,e){const t=Ho(e.snapshotVersion),i=Ho(e.lastLimboFreeSnapshotVersion);let s;s=Rh(e.target)?YR(n.yt,e.target):$R(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:zo(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function tb(n){const e=QR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?my(e,e.limit,"L"):e}function Vg(n,e){return new v_(e.largestBatchId,vy(n.yt,e.overlayMutation))}function oS(n,e){const t=e.path.lastSegment();return[n,gn(e.path.popLast()),t]}function aS(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ho(i.readTime),documentKey:gn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{getBundleMetadata(e,t){return lS(e).get(t).next((i=>{if(i)return(function(a){return{id:a.bundleId,createTime:Ko(a.createTime),version:a.version}})(i)}))}saveBundleMetadata(e,t){return lS(e).put((function(s){return{bundleId:s.id,createTime:Ho(Tn(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return uS(e).get(t).next((i=>{if(i)return(function(a){return{name:a.name,query:tb(a.bundledQuery),readTime:Ko(a.readTime)}})(i)}))}saveNamedQuery(e,t){return uS(e).put((function(s){return{name:s.name,readTime:Ho(Tn(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function lS(n){return Qt(n,Zh)}function uS(n){return Qt(n,jh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new op(e,i)}getOverlay(e,t){return Xu(e).get(oS(this.userId,t)).next((i=>i?Vg(this.serializer,i):null))}getOverlays(e,t){const i=Wi();return z.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&i.set(s,a)})))).next((()=>i))}saveOverlays(e,t,i){const s=[];return i.forEach(((a,l)=>{const d=new v_(t,l);s.push(this.St(e,d))})),z.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach((l=>s.add(gn(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,i+1],!1,!0);a.push(Xu(e).Z(ay,d))})),z.waitFor(a)}getOverlaysForCollection(e,t,i){const s=Wi(),a=gn(t),l=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Xu(e).J(ay,l).next((d=>{for(const f of d){const p=Vg(this.serializer,f);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,i,s){const a=Wi();let l;const d=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xu(e).ee({index:tR,range:d},((f,p,_)=>{const E=Vg(this.serializer,p);a.size()<s||E.largestBatchId===l?(a.set(E.getKey(),E),l=E.largestBatchId):_.done()})).next((()=>a))}St(e,t){return Xu(e).put((function(s,a,l){const[d,f,p]=oS(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:Nh(s.yt,l.mutation)}})(this.serializer,this.userId,t))}}function Xu(n){return Qt(n,ep)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{bt(e){return Qt(e,l_)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?Dt.fromUint8Array(i):Dt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(vt(e.integerValue));else if("doubleValue"in e){const i=vt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Cc(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=xr(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Nr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?hR(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):np(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ye(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const s of Object.keys(i))this.Ot(s,t),this.Ct(i[s],t)}kt(e,t){var l,d;const i=e.fields||{};this.Ft(t,53);const s=Tl,a=((d=(l=i[s].arrayValue)==null?void 0:l.values)==null?void 0:d.length)||0;this.Ft(t,15),t.Mt(vt(a)),this.Ot(s,t),this.Ct(i[s],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const s of i)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),fe.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}xo.Kt=new xo;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka=255;function R4(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function cS(n){const e=64-(function(i){let s=0;for(let a=0;a<8;++a){const l=R4(255&i[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class b4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),i=cS(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),i=cS(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(Ka),this.sn(255)}_n(){this.an(Ka),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ka?(this.sn(Ka),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ka?(this.an(Ka),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class x4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class N4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Wu{constructor(){this.cn=new b4,this.ln=new x4(this.cn),this.hn=new N4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e,t,i,s){this.Tn=e,this.In=t,this.En=i,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new No(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:ah(this.En),directionalValue:ah(this.dn),orderedDocumentKey:ah(t),documentKey:i.path.toArray()}}Vn(e,t,i){const s=this.Rn(e,t,i);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function _s(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=dS(n.En,e.En),t!==0?t:(t=dS(n.dn,e.dn),t!==0?t:fe.comparator(n.In,e.In)))}function dS(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function ah(n){return JC()?(function(t){let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return i})(n):n}function fS(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(n)}class hS{constructor(e){this.mn=new at(((t,i)=>Et.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Se(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=ry(e);if(t!==void 0&&!this.wn(t))return!1;const i=Io(e);let s=new Set,a=0,l=0;for(;a<i.length&&this.wn(i[a]);++a)s=s.add(i[a].fieldPath.canonicalString());if(a===i.length)return!0;if(this.mn.size>0){const d=this.mn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const f=i[a];if(!this.Sn(d,f)||!this.bn(this.fn[l++],f))return!1}++a}for(;a<i.length;++a){const d=i[a];if(l>=this.fn.length||!this.bn(this.fn[l++],d))return!1}return!0}Dn(){if(this.pn)return null;let e=new at(Et.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new jf(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new jf(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new jf(i.field,i.dir==="asc"?0:1)));return new Ah(Ah.UNKNOWN_ID,this.collectionId,t,Ic.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nb(n){var t,i;if(Se(n instanceof He||n instanceof ot,20012),n instanceof He){if(n instanceof AR){const s=((i=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:i.map((a=>He.create(n.field,"==",a))))||[];return ot.create(s,"or")}return n}const e=n.filters.map((s=>nb(s)));return ot.create(e,n.op)}function D4(n){if(n.getFilters().length===0)return[];const e=Ay(nb(n));return Se(ib(e),7391),Ey(e)||Ty(e)?[e]:e.getFilters()}function Ey(n){return n instanceof He}function Ty(n){return n instanceof ot&&h_(n)}function ib(n){return Ey(n)||Ty(n)||(function(t){if(t instanceof ot&&dy(t)){for(const i of t.getFilters())if(!Ey(i)&&!Ty(i))return!1;return!0}return!1})(n)}function Ay(n){if(Se(n instanceof He||n instanceof ot,34018),n instanceof He)return n;if(n.filters.length===1)return Ay(n.filters[0]);const e=n.filters.map((i=>Ay(i)));let t=ot.create(e,n.op);return t=Mh(t),ib(t)?t:(Se(t instanceof ot,64498),Se(Il(t),40251),Se(t.filters.length>1,57927),t.filters.reduce(((i,s)=>A_(i,s))))}function A_(n,e){let t;return Se(n instanceof He||n instanceof ot,38388),Se(e instanceof He||e instanceof ot,25473),t=n instanceof He?e instanceof He?(function(s,a){return ot.create([s,a],"and")})(n,e):pS(n,e):e instanceof He?pS(e,n):(function(s,a){if(Se(s.filters.length>0&&a.filters.length>0,48005),Il(s)&&Il(a))return vR(s,a.getFilters());const l=dy(s)?s:a,d=dy(s)?a:s,f=l.filters.map((p=>A_(p,d)));return ot.create(f,"or")})(n,e),Mh(t)}function pS(n,e){if(Il(e))return vR(e,n.getFilters());{const t=e.filters.map((i=>A_(n,i)));return ot.create(t,"or")}}function Mh(n){if(Se(n instanceof He||n instanceof ot,11850),n instanceof He)return n;const e=n.getFilters();if(e.length===1)return Mh(e[0]);if(yR(n))return n;const t=e.map((s=>Mh(s))),i=[];return t.forEach((s=>{s instanceof He?i.push(s):s instanceof ot&&(s.op===n.op?i.push(...s.filters):i.push(s))})),i.length===1?i[0]:ot.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(){this.Cn=new S_}addToCollectionParentIndex(e,t){return this.Cn.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(Hn.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(Hn.min())}updateCollectionGroup(e,t,i){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class S_{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new at(tt.comparator),a=!s.has(i);return this.index[t]=s.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new at(tt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS="IndexedDbIndexManager",Uf=new Uint8Array(0);class P4{constructor(e,t){this.databaseId=t,this.vn=new S_,this.Fn=new kr((i=>zo(i)),((i,s)=>Yc(i,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:i,parent:gn(s)};return gS(e).put(a)}return z.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[qw(t),""],!1,!0);return gS(e).J(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;i.push(Xi(l.parent))}return i}))}addFieldIndex(e,t){const i=Zu(e),s=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete s.indexId;const a=i.add(s);if(t.indexState){const l=Ya(e);return a.next((d=>{l.put(aS(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const i=Zu(e),s=Ya(e),a=Ja(e);return i.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Zu(e),i=Ja(e),s=Ya(e);return t.Z().next((()=>i.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return z.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((s=>{if(s===0||s===1){const a=new hS(i).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const i=Ja(e);let s=!0;const a=new Map;return z.forEach(this.Mn(t),(l=>this.xn(e,l).next((d=>{s&&(s=!!d),a.set(l,d)})))).next((()=>{if(s){let l=Ue();const d=[];return z.forEach(a,((f,p)=>{ae(mS,`Using index ${(function(X){return`id=${X.indexId}|cg=${X.collectionGroup}|f=${X.fields.map((se=>`${se.fieldPath}:${se.kind}`)).join(",")}`})(f)} to execute ${zo(t)}`);const _=(function(X,se){const le=ry(se);if(le===void 0)return null;for(const ue of bh(X,le.fieldPath))switch(ue.op){case"array-contains-any":return ue.value.arrayValue.values||[];case"array-contains":return[ue.value]}return null})(p,f),E=(function(X,se){const le=new Map;for(const ue of Io(se))for(const N of bh(X,ue.fieldPath))switch(N.op){case"==":case"in":le.set(ue.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return le.set(ue.fieldPath.canonicalString(),N.value),Array.from(le.values())}return null})(p,f),T=(function(X,se){const le=[];let ue=!0;for(const N of Io(se)){const D=N.kind===0?YA(X,N.fieldPath,X.startAt):$A(X,N.fieldPath,X.startAt);le.push(D.value),ue&&(ue=D.inclusive)}return new Sl(le,ue)})(p,f),C=(function(X,se){const le=[];let ue=!0;for(const N of Io(se)){const D=N.kind===0?$A(X,N.fieldPath,X.endAt):YA(X,N.fieldPath,X.endAt);le.push(D.value),ue&&(ue=D.inclusive)}return new Sl(le,ue)})(p,f),P=this.On(f,p,T),O=this.On(f,p,C),k=this.Nn(f,p,E),Q=this.Bn(f.indexId,_,P,T.inclusive,O,C.inclusive,k);return z.forEach(Q,(j=>i.Y(j,t.limit).next((X=>{X.forEach((se=>{const le=fe.fromSegments(se.documentKey);l.has(le)||(l=l.add(le),d.push(le))}))}))))})).next((()=>d))}return z.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=D4(ot.create(e.filters,"and")).map((i=>hy(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,s,a,l,d){const f=(t!=null?t.length:1)*Math.max(i.length,a.length),p=f/(t!=null?t.length:1),_=[];for(let E=0;E<f;++E){const T=t?this.Ln(t[E/p]):Uf,C=this.kn(e,T,i[E%p],s),P=this.qn(e,T,a[E%p],l),O=d.map((k=>this.kn(e,T,k,!0)));_.push(...this.createRange(C,P,O))}return _}kn(e,t,i,s){const a=new No(e,fe.empty(),t,i);return s?a:a.An()}qn(e,t,i,s){const a=new No(e,fe.empty(),t,i);return s?a.An():a}xn(e,t){const i=new hS(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const d of a)i.yn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let i=2;const s=this.Mn(t);return z.forEach(s,(a=>this.xn(e,a).next((l=>{l?i!==0&&l.fields.length<(function(f){let p=new at(Et.comparator),_=!1;for(const E of f.filters)for(const T of E.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?_=!0:p=p.add(T.field));for(const E of f.orderBy)E.field.isKeyField()||(p=p.add(E.field));return p.size+(_?1:0)})(a)&&(i=1):i=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&i===2?1:i))}Qn(e,t){const i=new Wu;for(const s of Io(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=i.Pn(s.kind);xo.Kt.Dt(a,l)}return i.un()}Ln(e){const t=new Wu;return xo.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Wu;return xo.Kt.Dt(Dc(this.databaseId,t),i.Pn((function(a){const l=Io(a);return l.length===0?0:l[l.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let s=[];s.push(new Wu);let a=0;for(const l of Io(e)){const d=i[a++];for(const f of s)if(this.Un(t,l.fieldPath)&&Mc(d))s=this.Kn(s,l,d);else{const p=f.Pn(l.kind);xo.Kt.Dt(d,p)}}return this.Wn(s)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const s=[...e],a=[];for(const l of i.arrayValue.values||[])for(const d of s){const f=new Wu;f.seed(d.un()),xo.Kt.Dt(l,f.Pn(t.kind)),a.push(f)}return a}Un(e,t){return!!e.filters.find((i=>i instanceof He&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Zu(e),s=Ya(e);return(t?i.J(oy,IDBKeyRange.bound(t,t)):i.J()).next((a=>{const l=[];return z.forEach(a,(d=>s.get([d.indexId,this.uid]).next((f=>{l.push((function(_,E){const T=E?new Ic(E.sequenceNumber,new Hn(Ko(E.readTime),new fe(Xi(E.documentKey)),E.largestBatchId)):Ic.empty(),C=_.fields.map((([P,O])=>new jf(Et.fromServerFormat(P),O)));return new Ah(_.indexId,_.collectionGroup,C,T)})(d,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,s)=>{const a=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:Ne(i.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const s=Zu(e),a=Ya(e);return this.Gn(e).next((l=>s.J(oy,IDBKeyRange.bound(t,t)).next((d=>z.forEach(d,(f=>a.put(aS(f.indexId,this.uid,l,i))))))))}updateIndexEntries(e,t){const i=new Map;return z.forEach(t,((s,a)=>{const l=i.get(s.collectionGroup);return(l?z.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((d=>(i.set(s.collectionGroup,d),z.forEach(d,(f=>this.zn(e,s,f).next((p=>{const _=this.jn(a,f);return p.isEqual(_)?z.resolve():this.Jn(e,a,f,p,_)})))))))}))}Hn(e,t,i,s){return Ja(e).put(s.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,s){return Ja(e).delete(s.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const s=Ja(e);let a=new at(_s);return s.ee({index:eR,range:IDBKeyRange.only([i.indexId,this.uid,ah(this.$n(i,t))])},((l,d)=>{a=a.add(new No(i.indexId,t,fS(d.arrayValue),fS(d.directionalValue)))})).next((()=>a))}jn(e,t){let i=new at(_s);const s=this.Qn(t,e);if(s==null)return i;const a=ry(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Mc(l))for(const d of l.arrayValue.values||[])i=i.add(new No(t.indexId,e.key,this.Ln(d),s))}else i=i.add(new No(t.indexId,e.key,Uf,s));return i}Jn(e,t,i,s,a){ae(mS,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,p,_,E,T){const C=f.getIterator(),P=p.getIterator();let O=Ha(C),k=Ha(P);for(;O||k;){let Q=!1,j=!1;if(O&&k){const X=_(O,k);X<0?j=!0:X>0&&(Q=!0)}else O!=null?j=!0:Q=!0;Q?(E(k),k=Ha(P)):j?(T(O),O=Ha(C)):(O=Ha(C),k=Ha(P))}})(s,a,_s,(d=>{l.push(this.Hn(e,t,i,d))}),(d=>{l.push(this.Yn(e,t,i,d))})),z.waitFor(l)}Gn(e){let t=1;return Ya(e).ee({index:jw,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((l,d)=>_s(l,d))).filter(((l,d,f)=>!d||_s(l,f[d-1])!==0));const s=[];s.push(e);for(const l of i){const d=_s(l,e),f=_s(l,t);if(d===0)s[0]=e.An();else if(d>0&&f<0)s.push(l),s.push(l.An());else if(f>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Zn(s[l],s[l+1]))return[];const d=s[l].Vn(this.uid,Uf,fe.empty()),f=s[l+1].Vn(this.uid,Uf,fe.empty());a.push(IDBKeyRange.bound(d,f))}return a}Zn(e,t){return _s(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(yS)}getMinOffset(e,t){return z.mapArray(this.Mn(t),(i=>this.xn(e,i).next((s=>s||ye(44426))))).next(yS)}}function gS(n){return Qt(n,bc)}function Ja(n){return Qt(n,mc)}function Zu(n){return Qt(n,a_)}function Ya(n){return Qt(n,pc)}function yS(n){Se(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;r_(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Hn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rb=41943040;class hn{static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sb(n,e,t){const i=n.store(Ei),s=n.store(yl),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const f=i.ee({range:l},((_,E,T)=>(d++,T.delete())));a.push(f.next((()=>{Se(d===1,47070,{batchId:t.batchId})})));const p=[];for(const _ of t.mutations){const E=Xw(e,_.key.path,t.batchId);a.push(s.delete(E)),p.push(_.key)}return z.waitFor(a).next((()=>p))}function Ph(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ye(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(rb,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);class ap{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.Xn={}}static wt(e,t,i,s){Se(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new ap(a,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vs(e).ee({index:Do,range:i},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,i,s){const a=ja(e),l=vs(e);return l.add({}).next((d=>{Se(typeof d=="number",49019);const f=new y_(d,t,i,s),p=(function(C,P,O){const k=O.baseMutations.map((j=>Nh(C.yt,j))),Q=O.mutations.map((j=>Nh(C.yt,j)));return{userId:P,batchId:O.batchId,localWriteTimeMs:O.localWriteTime.toMillis(),baseMutations:k,mutations:Q}})(this.serializer,this.userId,f),_=[];let E=new at(((T,C)=>Ne(T.canonicalString(),C.canonicalString())));for(const T of s){const C=Xw(this.userId,T.key.path,d);E=E.add(T.key.path.popLast()),_.push(l.put(p)),_.push(a.put(C,cV))}return E.forEach((T=>{_.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Xn[d]=f.keys()})),z.waitFor(_).next((()=>f))}))}lookupMutationBatch(e,t){return vs(e).get(t).next((i=>i?(Se(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),bo(this.serializer,i)):null))}er(e,t){return this.Xn[t]?z.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const s=i.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let a=null;return vs(e).ee({index:Do,range:s},((l,d,f)=>{d.userId===this.userId&&(Se(d.batchId>=i,47524,{tr:i}),a=bo(this.serializer,d)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=Po;return vs(e).ee({index:Do,range:t,reverse:!0},((s,a,l)=>{i=a.batchId,l.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Po],[this.userId,Number.POSITIVE_INFINITY]);return vs(e).J(Do,t).next((i=>i.map((s=>bo(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=eh(this.userId,t.path),s=IDBKeyRange.lowerBound(i),a=[];return ja(e).ee({range:s},((l,d,f)=>{const[p,_,E]=l,T=Xi(_);if(p===this.userId&&t.path.isEqual(T))return vs(e).get(E).next((C=>{if(!C)throw ye(61480,{nr:l,batchId:E});Se(C.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:C.userId,batchId:E}),a.push(bo(this.serializer,C))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new at(Ne);const s=[];return t.forEach((a=>{const l=eh(this.userId,a.path),d=IDBKeyRange.lowerBound(l),f=ja(e).ee({range:d},((p,_,E)=>{const[T,C,P]=p,O=Xi(C);T===this.userId&&a.path.isEqual(O)?i=i.add(P):E.done()}));s.push(f)})),z.waitFor(s).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,a=eh(this.userId,i),l=IDBKeyRange.lowerBound(a);let d=new at(Ne);return ja(e).ee({range:l},((f,p,_)=>{const[E,T,C]=f,P=Xi(T);E===this.userId&&i.isPrefixOf(P)?P.length===s&&(d=d.add(C)):_.done()})).next((()=>this.rr(e,d)))}rr(e,t){const i=[],s=[];return t.forEach((a=>{s.push(vs(e).get(a).next((l=>{if(l===null)throw ye(35274,{batchId:a});Se(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),i.push(bo(this.serializer,l))})))})),z.waitFor(s).next((()=>i))}removeMutationBatch(e,t){return sb(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),z.forEach(i,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return z.resolve();const i=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return ja(e).ee({range:i},((a,l,d)=>{if(a[0]===this.userId){const f=Xi(a[1]);s.push(f)}else d.done()})).next((()=>{Se(s.length===0,56720,{sr:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return ob(e,this.userId,t)}_r(e){return ab(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Po,lastStreamToken:""}))}}function ob(n,e,t){const i=eh(e,t.path),s=i[1],a=IDBKeyRange.lowerBound(i);let l=!1;return ja(n).ee({range:a,X:!0},((d,f,p)=>{const[_,E,T]=d;_===e&&E===s&&(l=!0),p.done()})).next((()=>l))}function vs(n){return Qt(n,Ei)}function ja(n){return Qt(n,yl)}function ab(n){return Qt(n,wc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Jo(0)}static cr(){return new Jo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Jo(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ce.fromTimestamp(new st(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>$a(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Se(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let s=0;const a=[];return $a(e).ee(((l,d)=>{const f=lc(d);f.sequenceNumber<=t&&i.get(f.targetId)===null&&(s++,a.push(this.removeTargetData(e,f)))})).next((()=>z.waitFor(a))).next((()=>s))}forEachTarget(e,t){return $a(e).ee(((i,s)=>{const a=lc(s);t(a)}))}lr(e){return vS(e).get(Ch).next((t=>(Se(t!==null,2888),t)))}hr(e,t){return vS(e).put(Ch,t)}Pr(e,t){return $a(e).put(eb(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=zo(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let a=null;return $a(e).ee({range:s,index:Zw},((l,d,f)=>{const p=lc(d);Yc(t,p.target)&&(a=p,f.done())})).next((()=>a))}addMatchingKeys(e,t,i){const s=[],a=Cs(e);return t.forEach((l=>{const d=gn(l.path);s.push(a.put({targetId:i,path:d})),s.push(this.referenceDelegate.addReference(e,i,l))})),z.waitFor(s)}removeMatchingKeys(e,t,i){const s=Cs(e);return z.forEach(t,(a=>{const l=gn(a.path);return z.waitFor([s.delete([i,l]),this.referenceDelegate.removeReference(e,i,a)])}))}removeMatchingKeysForTargetId(e,t){const i=Cs(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=Cs(e);let a=Ue();return s.ee({range:i,X:!0},((l,d,f)=>{const p=Xi(l[1]),_=new fe(p);a=a.add(_)})).next((()=>a))}containsKey(e,t){const i=gn(t.path),s=IDBKeyRange.bound([i],[qw(i)],!1,!0);let a=0;return Cs(e).ee({index:o_,X:!0,range:s},(([l,d],f,p)=>{l!==0&&(a++,p.done())})).next((()=>a>0))}At(e,t){return $a(e).get(t).next((i=>i?lc(i):null))}}function $a(n){return Qt(n,_l)}function vS(n){return Qt(n,ko)}function Cs(n){return Qt(n,vl)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ES="LruGarbageCollector",lb=1048576;function TS([n,e],[t,i]){const s=Ne(n,t);return s===0?Ne(e,i):s}class V4{constructor(e){this.Ir=e,this.buffer=new at(TS),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();TS(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ub{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ae(ES,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Bs(t)?ae(ES,"Ignoring IndexedDB error during garbage collection: ",t):await Fs(t)}await this.Vr(3e5)}))}}class L4{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return z.resolve(Nn.ce);const i=new V4(t);return this.mr.forEachTarget(e,(s=>i.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>i.Ar(s))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ae("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(_S)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),_S):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,s,a,l,d,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),s=this.params.maximumSequenceNumbersToCollect):s=E,l=Date.now(),this.nthSequenceNumber(e,s)))).next((E=>(i=E,d=Date.now(),this.removeTargets(e,i,t)))).next((E=>(a=E,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(p=Date.now(),Qa()<=ze.DEBUG&&ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-_}ms
	Determined least recently used ${s} in `+(d-l)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${E} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:E}))))}}function cb(n,e){return new L4(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(e,t){this.db=e,this.garbageCollector=cb(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,s)=>t(s)))}addReference(e,t,i){return Of(e,i)}removeReference(e,t,i){return Of(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Of(e,t)}br(e,t){return(function(s,a){let l=!1;return ab(s).te((d=>ob(s,d,a).next((f=>(f&&(l=!0),z.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.Sr(e,((l,d)=>{if(d<=t){const f=this.br(e,l).next((p=>{if(!p)return a++,i.getEntry(e,l).next((()=>(i.removeEntry(l,Ce.min()),Cs(e).delete((function(E){return[0,gn(E.path)]})(l)))))}));s.push(f)}})).next((()=>z.waitFor(s))).next((()=>i.apply(e))).next((()=>a))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Of(e,t)}Sr(e,t){const i=Cs(e);let s,a=Nn.ce;return i.ee({index:o_},(([l,d],{path:f,sequenceNumber:p})=>{l===0?(a!==Nn.ce&&t(new fe(Xi(s)),a),a=p,s=f):a=Nn.ce})).next((()=>{a!==Nn.ce&&t(new fe(Xi(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Of(n,e){return Cs(n).put((function(i,s){return{targetId:0,path:gn(i.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(){this.changes=new kr((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,It.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?z.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return Ao(e).put(i)}removeEntry(e,t,i){return Ao(e).delete((function(a,l){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Dh(l),d[d.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=It.newInvalidDocument(t);return Ao(e).ee({index:th,range:IDBKeyRange.only(ju(t))},((s,a)=>{i=this.Cr(t,a)})).next((()=>i))}vr(e,t){let i={size:0,document:It.newInvalidDocument(t)};return Ao(e).ee({index:th,range:IDBKeyRange.only(ju(t))},((s,a)=>{i={document:this.Cr(t,a),size:Ph(a)}})).next((()=>i))}getEntries(e,t){let i=Gn();return this.Fr(e,t,((s,a)=>{const l=this.Cr(s,a);i=i.insert(s,l)})).next((()=>i))}Mr(e,t){let i=Gn(),s=new ht(fe.comparator);return this.Fr(e,t,((a,l)=>{const d=this.Cr(a,l);i=i.insert(a,d),s=s.insert(a,Ph(l))})).next((()=>({documents:i,Or:s})))}Fr(e,t,i){if(t.isEmpty())return z.resolve();let s=new at(IS);t.forEach((f=>s=s.add(f)));const a=IDBKeyRange.bound(ju(s.first()),ju(s.last())),l=s.getIterator();let d=l.getNext();return Ao(e).ee({index:th,range:a},((f,p,_)=>{const E=fe.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;d&&IS(d,E)<0;)i(d,null),d=l.getNext();d&&d.isEqual(E)&&(i(d,p),d=l.hasNext()?l.getNext():null),d?_.j(ju(d)):_.done()})).next((()=>{for(;d;)i(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,i,s,a){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),Dh(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ao(e).J(IDBKeyRange.bound(d,f,!0)).next((p=>{a==null||a.incrementDocumentReadCount(p.length);let _=Gn();for(const E of p){const T=this.Cr(fe.fromSegments(E.prefixPath.concat(E.collectionGroup,E.documentId)),E);T.isFoundDocument()&&($c(t,T)||s.has(T.key))&&(_=_.insert(T.key,T))}return _}))}getAllFromCollectionGroup(e,t,i,s){let a=Gn();const l=SS(t,i),d=SS(t,Hn.max());return Ao(e).ee({index:Ww,range:IDBKeyRange.bound(l,d,!0)},((f,p,_)=>{const E=this.Cr(fe.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(E.key,E),a.size===s&&_.done()})).next((()=>a))}newChangeBuffer(e){return new F4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return AS(e).get(sy).next((t=>(Se(!!t,20021),t)))}Dr(e,t){return AS(e).put(sy,t)}Cr(e,t){if(t){const i=I4(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ce.min())))return i}return It.newInvalidDocument(e)}}function fb(n){return new O4(n)}class F4 extends db{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new kr((i=>i.toString()),((i,s)=>i.isEqual(s)))}applyChanges(e){const t=[];let i=0,s=new at(((a,l)=>Ne(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const d=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,d.readTime)),l.isValidDocument()){const f=sS(this.Nr.serializer,l);s=s.add(a.path.popLast());const p=Ph(f);i+=p-d.size,t.push(this.Nr.addEntry(e,a,f))}else if(i-=d.size,this.trackRemovals){const f=sS(this.Nr.serializer,l.convertToNoDocument(Ce.min()));t.push(this.Nr.addEntry(e,a,f))}})),s.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,i)),z.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:s})=>(s.forEach(((a,l)=>{this.Br.set(a,{size:l,readTime:i.get(a).readTime})})),i)))}}function AS(n){return Qt(n,Rc)}function Ao(n){return Qt(n,Ih)}function ju(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function SS(n,e){const t=e.documentKey.path.toArray();return[n,Dh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function IS(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<i.length-2;++a)if(s=Ne(t[a],i[a]),s)return s;return s=Ne(t.length,i.length),s||(s=Ne(t[t.length-2],i[i.length-2]),s||Ne(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(i!==null&&vc(i.mutation,s,Dn.empty(),st.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Ue()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Ue()){const s=Wi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,i).next((a=>{let l=oc();return a.forEach(((d,f)=>{l=l.insert(d,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const i=Wi();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Ue())))}populateOverlays(e,t,i){const s=[];return i.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,i,s){let a=Gn();const l=_c(),d=(function(){return _c()})();return t.forEach(((f,p)=>{const _=i.get(p.key);s.has(p.key)&&(_===void 0||_.mutation instanceof Vr)?a=a.insert(p.key,p):_!==void 0?(l.set(p.key,_.mutation.getFieldMask()),vc(_.mutation,p,_.mutation.getFieldMask(),st.now())):l.set(p.key,Dn.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((p,_)=>l.set(p,_))),t.forEach(((p,_)=>d.set(p,new B4(_,l.get(p)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=_c();let s=new ht(((l,d)=>l-d)),a=Ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let _=i.get(f)||Dn.empty();_=d.applyToLocalView(p,_),i.set(f,_);const E=(s.get(d.batchId)||Ue()).add(f);s=s.insert(d.batchId,E)}))})).next((()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,_=f.value,E=NR();_.forEach((T=>{if(!a.has(T)){const C=LR(t.get(T),i.get(T));C!==null&&E.set(T,C),a=a.add(T)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,E))}return z.waitFor(l)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,s){return(function(l){return fe.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):IR(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-a.size):z.resolve(Wi());let d=gl,f=a;return l.next((p=>z.forEach(p,((_,E)=>(d<E.largestBatchId&&(d=E.largestBatchId),a.get(_)?z.resolve():this.remoteDocumentCache.getEntry(e,_).next((T=>{f=f.insert(_,T)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,f,p,Ue()))).next((_=>({batchId:d,changes:xR(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new fe(t)).next((i=>{let s=oc();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const a=t.collectionGroup;let l=oc();return this.indexManager.getCollectionParents(e,a).next((d=>z.forEach(d,(f=>{const p=(function(E,T){return new Ll(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,i,s).next((_=>{_.forEach(((E,T)=>{l=l.insert(E,T)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,i,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,a,s)))).next((l=>{a.forEach(((f,p)=>{const _=p.getKey();l.get(_)===null&&(l=l.insert(_,It.newInvalidDocument(_)))}));let d=oc();return l.forEach(((f,p)=>{const _=a.get(f);_!==void 0&&vc(_.mutation,p,Dn.empty(),st.now()),$c(t,p)&&(d=d.insert(f,p))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return z.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Tn(s.createTime)}})(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:tb(s.bundledQuery),readTime:Tn(s.readTime)}})(t)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(){this.overlays=new ht(fe.comparator),this.qr=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Wi();return z.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&i.set(s,a)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((s,a)=>{this.St(e,t,a)})),z.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(i)),z.resolve()}getOverlaysForCollection(e,t,i){const s=Wi(),a=t.length+1,l=new fe(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>i&&s.set(f.getKey(),f)}return z.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let a=new ht(((p,_)=>p-_));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let _=a.get(p.largestBatchId);_===null&&(_=Wi(),a=a.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const d=Wi(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,_)=>d.set(p,_))),!(d.size()>=s)););return z.resolve(d)}St(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new v_(t,i));let a=this.qr.get(t);a===void 0&&(a=Ue(),this.qr.set(t,a)),this.qr.set(t,a.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(){this.sessionToken=Dt.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(){this.Qr=new at(jt.$r),this.Ur=new at(jt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new jt(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new jt(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new fe(new tt([])),i=new jt(t,e),s=new jt(t,e+1),a=[];return this.Ur.forEachInRange([i,s],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new fe(new tt([])),i=new jt(t,e),s=new jt(t,e+1);let a=Ue();return this.Ur.forEachInRange([i,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new jt(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class jt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return fe.comparator(e.key,t.key)||Ne(e.Yr,t.Yr)}static Kr(e,t){return Ne(e.Yr,t.Yr)||fe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new at(jt.$r)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new y_(a,t,i,s);this.mutationQueue.push(l);for(const d of s)this.Zr=this.Zr.add(new jt(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return z.resolve(l)}lookupMutationBatch(e,t){return z.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.ei(i),a=s<0?0:s;return z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?Po:this.tr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new jt(t,0),s=new jt(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([i,s],(l=>{const d=this.Xr(l.Yr);a.push(d)})),z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new at(Ne);return t.forEach((s=>{const a=new jt(s,0),l=new jt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(d=>{i=i.add(d.Yr)}))})),z.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let a=i;fe.isDocumentKey(a)||(a=a.child(""));const l=new jt(new fe(a),0);let d=new at(Ne);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===s&&(d=d.add(f.Yr)),!0)}),l),z.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((i=>{const s=this.Xr(i);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Se(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return z.forEach(t.mutations,(s=>{const a=new jt(s.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new jt(t,0),s=this.Zr.firstAfterOrEqual(i);return z.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e){this.ri=e,this.docs=(function(){return new ht(fe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),a=s?s.size:0,l=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return z.resolve(i?i.document.mutableCopy():It.newInvalidDocument(t))}getEntries(e,t){let i=Gn();return t.forEach((s=>{const a=this.docs.get(s);i=i.insert(s,a?a.document.mutableCopy():It.newInvalidDocument(s))})),z.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let a=Gn();const l=t.path,d=new fe(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||r_(Kw(_),i)<=0||(s.has(_.key)||$c(t,_))&&(a=a.insert(_.key,_.mutableCopy()))}return z.resolve(a)}getAllFromCollectionGroup(e,t,i,s){ye(9500)}ii(e,t){return z.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new J4(this)}getSize(e){return z.resolve(this.size)}}class J4 extends db{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(i)})),z.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(e){this.persistence=e,this.si=new kr((t=>zo(t)),Yc),this.lastRemoteSnapshotVersion=Ce.min(),this.highestTargetId=0,this.oi=0,this._i=new I_,this.targetCount=0,this.ai=Jo.ur()}forEachTarget(e,t){return this.si.forEach(((i,s)=>t(s))),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),z.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Jo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.Pr(t),z.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,i){let s=0;const a=[];return this.si.forEach(((l,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)})),z.waitFor(a).next((()=>s))}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return z.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),z.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),z.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),z.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return z.resolve(i)}containsKey(e,t){return z.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(e,t){this.ui={},this.overlays={},this.ci=new Nn(0),this.li=!1,this.li=!0,this.hi=new z4,this.referenceDelegate=e(this),this.Pi=new Y4(this),this.indexManager=new M4,this.remoteDocumentCache=(function(s){return new K4(s)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new jR(t),this.Ii=new q4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new G4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new H4(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){ae("MemoryPersistence","Starting transaction:",e);const s=new $4(this.ci.next());return this.referenceDelegate.Ei(),i(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ai(e,t){return z.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class $4 extends Yw{constructor(e){super(),this.currentSequenceNumber=e}}class lp{constructor(e){this.persistence=e,this.Ri=new I_,this.Vi=null}static mi(e){return new lp(e)}get fi(){if(this.Vi)return this.Vi;throw ye(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),z.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),z.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.fi.add(a.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.fi,(i=>{const s=fe.fromPath(i);return this.gi(e,s).next((a=>{a||t.removeEntry(s,Ce.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return z.or([()=>z.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class kh{constructor(e,t){this.persistence=e,this.pi=new kr((i=>gn(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=cb(this,t)}static mi(e,t){return new kh(e,t)}Ei(){}di(e){return z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return z.forEach(this.pi,((i,s)=>this.br(e,i,s).next((a=>a?z.resolve():t(s)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,(l=>this.br(e,l,t).next((d=>{d||(i++,a.removeEntry(l,Ce.min()))})))).next((()=>a.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),z.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),z.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),z.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ih(e.data.value)),t}br(e,t,i){return z.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return z.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q4{constructor(e){this.serializer=e}k(e,t,i,s){const a=new Xh("createOrUpgrade",t);i<1&&s>=1&&((function(f){f.createObjectStore(Jc)})(e),(function(f){f.createObjectStore(wc,{keyPath:uV}),f.createObjectStore(Ei,{keyPath:VA,autoIncrement:!0}).createIndex(Do,LA,{unique:!0}),f.createObjectStore(yl)})(e),CS(e),(function(f){f.createObjectStore(Co)})(e));let l=z.resolve();return i<3&&s>=3&&(i!==0&&((function(f){f.deleteObjectStore(vl),f.deleteObjectStore(_l),f.deleteObjectStore(ko)})(e),CS(e)),l=l.next((()=>(function(f){const p=f.store(ko),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ce.min().toTimestamp(),targetCount:0};return p.put(Ch,_)})(a)))),i<4&&s>=4&&(i!==0&&(l=l.next((()=>(function(f,p){return p.store(Ei).J().next((E=>{f.deleteObjectStore(Ei),f.createObjectStore(Ei,{keyPath:VA,autoIncrement:!0}).createIndex(Do,LA,{unique:!0});const T=p.store(Ei),C=E.map((P=>T.put(P)));return z.waitFor(C)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(El,{keyPath:_V})})(e)}))),i<5&&s>=5&&(l=l.next((()=>this.yi(a)))),i<6&&s>=6&&(l=l.next((()=>((function(f){f.createObjectStore(Rc)})(e),this.wi(a))))),i<7&&s>=7&&(l=l.next((()=>this.Si(a)))),i<8&&s>=8&&(l=l.next((()=>this.bi(e,a)))),i<9&&s>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&s>=10&&(l=l.next((()=>this.Di(a)))),i<11&&s>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(Zh,{keyPath:vV})})(e),(function(f){f.createObjectStore(jh,{keyPath:EV})})(e)}))),i<12&&s>=12&&(l=l.next((()=>{(function(f){const p=f.createObjectStore(ep,{keyPath:RV});p.createIndex(ay,bV,{unique:!1}),p.createIndex(tR,xV,{unique:!1})})(e)}))),i<13&&s>=13&&(l=l.next((()=>(function(f){const p=f.createObjectStore(Ih,{keyPath:dV});p.createIndex(th,fV),p.createIndex(Ww,hV)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(Co)))),i<14&&s>=14&&(l=l.next((()=>this.Fi(e,a)))),i<15&&s>=15&&(l=l.next((()=>(function(f){f.createObjectStore(a_,{keyPath:TV,autoIncrement:!0}).createIndex(oy,AV,{unique:!1}),f.createObjectStore(pc,{keyPath:SV}).createIndex(jw,IV,{unique:!1}),f.createObjectStore(mc,{keyPath:CV}).createIndex(eR,wV,{unique:!1})})(e)))),i<16&&s>=16&&(l=l.next((()=>{t.objectStore(pc).clear()})).next((()=>{t.objectStore(mc).clear()}))),i<17&&s>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(l_,{keyPath:NV})})(e)}))),i<18&&s>=18&&JC()&&(l=l.next((()=>{t.objectStore(pc).clear()})).next((()=>{t.objectStore(mc).clear()}))),l}wi(e){let t=0;return e.store(Co).ee(((i,s)=>{t+=Ph(s)})).next((()=>{const i={byteSize:t};return e.store(Rc).put(sy,i)}))}yi(e){const t=e.store(wc),i=e.store(Ei);return t.J().next((s=>z.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,Po],[a.userId,a.lastAcknowledgedBatchId]);return i.J(Do,l).next((d=>z.forEach(d,(f=>{Se(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=bo(this.serializer,f);return sb(e,a.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(vl),i=e.store(Co);return e.store(ko).get(Ch).next((s=>{const a=[];return i.ee(((l,d)=>{const f=new tt(l),p=(function(E){return[0,gn(E)]})(f);a.push(t.get(p).next((_=>_?z.resolve():(E=>t.put({targetId:0,path:gn(E),sequenceNumber:s.highestListenSequenceNumber}))(f))))})).next((()=>z.waitFor(a)))}))}bi(e,t){e.createObjectStore(bc,{keyPath:yV});const i=t.store(bc),s=new S_,a=l=>{if(s.add(l)){const d=l.lastSegment(),f=l.popLast();return i.put({collectionId:d,parent:gn(f)})}};return t.store(Co).ee({X:!0},((l,d)=>{const f=new tt(l);return a(f.popLast())})).next((()=>t.store(yl).ee({X:!0},(([l,d,f],p)=>{const _=Xi(d);return a(_.popLast())}))))}Di(e){const t=e.store(_l);return t.ee(((i,s)=>{const a=lc(s),l=eb(this.serializer,a);return t.put(l)}))}Ci(e,t){const i=t.store(Co),s=[];return i.ee(((a,l)=>{const d=t.store(Ih),f=(function(E){return E.document?new fe(tt.fromString(E.document.name).popFirst(5)):E.noDocument?fe.fromSegments(E.noDocument.path):E.unknownDocument?fe.fromSegments(E.unknownDocument.path):ye(36783)})(l).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(d.put(p))})).next((()=>z.waitFor(s)))}Fi(e,t){const i=t.store(Ei),s=fb(this.serializer),a=new C_(lp.mi,this.serializer.yt);return i.J().next((l=>{const d=new Map;return l.forEach((f=>{let p=d.get(f.userId)??Ue();bo(this.serializer,f).keys().forEach((_=>p=p.add(_))),d.set(f.userId,p)})),z.forEach(d,((f,p)=>{const _=new fn(p),E=op.wt(this.serializer,_),T=a.getIndexManager(_),C=ap.wt(_,this.serializer,T,a.referenceDelegate);return new hb(s,C,E,T).recalculateAndSaveOverlaysForDocumentKeys(new ly(t,Nn.ce),f).next()}))}))}}function CS(n){n.createObjectStore(vl,{keyPath:mV}).createIndex(o_,gV,{unique:!0}),n.createObjectStore(_l,{keyPath:"targetId"}).createIndex(Zw,pV,{unique:!0}),n.createObjectStore(ko)}const Es="IndexedDbPersistence",Lg=18e5,Ug=5e3,Og="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",X4="main";class w_{constructor(e,t,i,s,a,l,d,f,p,_,E=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=a,this.window=l,this.document=d,this.xi=p,this.Oi=_,this.Ni=E,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=T=>Promise.resolve(),!w_.v())throw new ce(ee.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new U4(this,s),this.$i=t+X4,this.serializer=new jR(f),this.Ui=new Ds(this.$i,this.Ni,new Q4(this.serializer)),this.hi=new w4,this.Pi=new k4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=fb(this.serializer),this.Ii=new C4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,_===!1&&Nt(Es,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ce(ee.FAILED_PRECONDITION,Og);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Nn(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Ff(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(Bs(e))return ae(Es,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ae(Es,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return ec(e).get(za).next((t=>z.resolve(this.es(t))))}ts(e){return Ff(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Lg)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=Qt(t,El);return i.J().next((s=>{const a=this.ss(s,Lg),l=s.filter((d=>a.indexOf(d)===-1));return z.forEach(l,(d=>i.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?z.resolve(!0):ec(e).get(za).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Ug)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ce(ee.FAILED_PRECONDITION,Og);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ff(e).J().next((i=>this.ss(i,Ug).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(a||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ae(Es,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Jc,El],(e=>{const t=new ly(e,Nn.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Ff(e).J().next((t=>this.ss(t,Lg).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ap.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new P4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return op.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){ae(Es,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?PV:f===17?sR:f===16?MV:f===15?u_:f===14?rR:f===13?iR:f===12?DV:f===11?nR:void ye(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,s,a,(d=>(l=new ly(d,this.ci?this.ci.next():Nn.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw Nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ce(ee.FAILED_PRECONDITION,Jw);return i(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>i(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Is(e){return ec(e).get(za).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Ug)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ce(ee.FAILED_PRECONDITION,Og)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ec(e).put(za,t)}static v(){return Ds.v()}Zi(e){const t=ec(e);return t.get(za).next((i=>this.es(i)?(ae(Es,"Releasing primary lease."),t.delete(za)):z.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Nt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;KC()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const i=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return ae(Es,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Nt(Es,"Failed to get zombied client id.",i),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Nt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ec(n){return Qt(n,Jc)}function Ff(n){return Qt(n,El)}function pb(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=s}static As(e,t){let i=Ue(),s=Ue();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new R_(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return KC()?8:$w($t())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,s){const a={result:null};return this.ys(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(e,t,s,i).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new W4;return this.Ss(e,t,l).next((d=>{if(a.result=d,this.Vs)return this.bs(e,t,l,d.size)}))})).next((()=>a.result))}bs(e,t,i,s){return i.documentReadCount<this.fs?(Qa()<=ze.DEBUG&&ae("QueryEngine","SDK will not create cache indexes for query:",Xa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),z.resolve()):(Qa()<=ze.DEBUG&&ae("QueryEngine","Query:",Xa(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?(Qa()<=ze.DEBUG&&ae("QueryEngine","The SDK decides to create cache indexes for query:",Xa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zn(t))):z.resolve())}ys(e,t){if(QA(t))return z.resolve(null);let i=zn(t);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=my(t,null,"F"),i=zn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((a=>{const l=Ue(...a);return this.ps.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,i).next((f=>{const p=this.Ds(t,d);return this.Cs(t,p,l,f.readTime)?this.ys(e,my(t,null,"F")):this.vs(e,p,t,f)}))))})))))}ws(e,t,i,s){return QA(t)||s.isEqual(Ce.min())?z.resolve(null):this.ps.getDocuments(e,i).next((a=>{const l=this.Ds(t,a);return this.Cs(t,l,i,s)?z.resolve(null):(Qa()<=ze.DEBUG&&ae("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xa(t)),this.vs(e,l,t,Hw(s,gl)).next((d=>d)))}))}Ds(e,t){let i=new at(RR(e));return t.forEach(((s,a)=>{$c(e,a)&&(i=i.add(a))})),i}Cs(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,t,i){return Qa()<=ze.DEBUG&&ae("QueryEngine","Using full collection scan to execute query:",Xa(t)),this.ps.getDocumentsMatchingQuery(e,t,Hn.min(),i)}vs(e,t,i,s){return this.ps.getDocumentsMatchingQuery(e,i,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b_="LocalStore",Z4=3e8;class j4{constructor(e,t,i,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ht(Ne),this.xs=new kr((a=>zo(a)),Yc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hb(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function gb(n,e,t,i){return new j4(n,e,t,i)}async function yb(n,e){const t=Ee(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next((a=>(s=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((a=>{const l=[],d=[];let f=Ue();for(const p of s){l.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of a){d.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return t.localDocuments.getDocuments(i,f).next((p=>({Ls:p,removedBatchIds:l,addedBatchIds:d})))}))}))}function eL(n,e){const t=Ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,_){const E=p.batch,T=E.keys();let C=z.resolve();return T.forEach((P=>{C=C.next((()=>_.getEntry(f,P))).next((O=>{const k=p.docVersions.get(P);Se(k!==null,48541),O.version.compareTo(k)<0&&(E.applyToRemoteDocument(O,p),O.isValidDocument()&&(O.setReadTime(p.commitVersion),_.addEntry(O)))}))})),C.next((()=>d.mutationQueue.removeMutationBatch(f,E)))})(t,i,e,a).next((()=>a.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let f=Ue();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(i,s)))}))}function _b(n){const e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function tL(n,e){const t=Ee(n),i=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const d=[];e.targetChanges.forEach(((_,E)=>{const T=s.get(E);if(!T)return;d.push(t.Pi.removeMatchingKeys(a,_.removedDocuments,E).next((()=>t.Pi.addMatchingKeys(a,_.addedDocuments,E))));let C=T.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(E)!==null?C=C.withResumeToken(Dt.EMPTY_BYTE_STRING,Ce.min()).withLastLimboFreeSnapshotVersion(Ce.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,i)),s=s.insert(E,C),(function(O,k,Q){return O.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=Z4?!0:Q.addedDocuments.size+Q.modifiedDocuments.size+Q.removedDocuments.size>0})(T,C,_)&&d.push(t.Pi.updateTargetData(a,C))}));let f=Gn(),p=Ue();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,_))})),d.push(nL(a,l,e.documentUpdates).next((_=>{f=_.ks,p=_.qs}))),!i.isEqual(Ce.min())){const _=t.Pi.getLastRemoteSnapshotVersion(a).next((E=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,i)));d.push(_)}return z.waitFor(d).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,p))).next((()=>f))})).then((a=>(t.Ms=s,a)))}function nL(n,e,t){let i=Ue(),s=Ue();return t.forEach((a=>i=i.add(a))),e.getEntries(n,i).next((a=>{let l=Gn();return t.forEach(((d,f)=>{const p=a.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(d)),f.isNoDocument()&&f.version.isEqual(Ce.min())?(e.removeEntry(d,f.readTime),l=l.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),l=l.insert(d,f)):ae(b_,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{ks:l,qs:s}}))}function iL(n,e){const t=Ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=Po),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function Vh(n,e){const t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return t.Pi.getTargetData(i,e).next((a=>a?(s=a,z.resolve(s)):t.Pi.allocateTargetId(i).next((l=>(s=new Ir(e,l,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=t.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function bl(n,e,t){const i=Ee(n),s=i.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",a,(l=>i.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!Bs(l))throw l;ae(b_,`Failed to update sequence numbers for target ${e}: ${l}`)}i.Ms=i.Ms.remove(e),i.xs.delete(s.target)}function Sy(n,e,t){const i=Ee(n);let s=Ce.min(),a=Ue();return i.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,p,_){const E=Ee(f),T=E.xs.get(_);return T!==void 0?z.resolve(E.Ms.get(T)):E.Pi.getTargetData(p,_)})(i,l,zn(e)).next((d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(l,d.targetId).next((f=>{a=f}))})).next((()=>i.Fs.getDocumentsMatchingQuery(l,e,t?s:Ce.min(),t?a:Ue()))).next((d=>(Tb(i,wR(e),d),{documents:d,Qs:a})))))}function vb(n,e){const t=Ee(n),i=Ee(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(a=>i.At(a,e).next((l=>l?l.target:null))))}function Eb(n,e){const t=Ee(n),i=t.Os.get(e)||Ce.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,Hw(i,gl),Number.MAX_SAFE_INTEGER))).then((s=>(Tb(t,e,s),s)))}function Tb(n,e,t){let i=n.Os.get(e)||Ce.min();t.forEach(((s,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)})),n.Os.set(e,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab="firestore_clients";function wS(n,e){return`${Ab}_${n}_${e}`}const Sb="firestore_mutations";function RS(n,e,t){let i=`${Sb}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const Ib="firestore_targets";function Fg(n,e){return`${Ib}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi="SharedClientState";class Lh{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static Ws(e,t,i){const s=JSON.parse(i);let a,l=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return l&&s.error&&(l=typeof s.error.message=="string"&&typeof s.error.code=="string",l&&(a=new ce(s.error.code,s.error.message))),l?new Lh(e,t,s.state,a):(Nt(Qi,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ec{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Ws(e,t){const i=JSON.parse(t);let s,a=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new ce(i.error.code,i.error.message))),a?new Ec(e,i.state,s):(Nt(Qi,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Uh{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,a=m_();for(let l=0;s&&l<i.activeTargetIds.length;++l)s=Qw(i.activeTargetIds[l]),a=a.add(i.activeTargetIds[l]);return s?new Uh(e,a):(Nt(Qi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class x_{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new x_(t.clientId,t.onlineState):(Nt(Qi,`Failed to parse online state: ${e}`),null)}}class Iy{constructor(){this.activeTargetIds=m_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Bg{constructor(e,t,i,s,a){this.window=e,this.Mi=t,this.persistenceKey=i,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new ht(Ne),this.started=!1,this.Xs=[];const l=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=wS(this.persistenceKey,this.Js),this.no=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Iy),this.ro=new RegExp(`^${Ab}_${l}_([^_]*)$`),this.io=new RegExp(`^${Sb}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${Ib}_${l}_(\\d+)$`),this.oo=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this._o=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const i of e){if(i===this.Js)continue;const s=this.getItem(wS(this.persistenceKey,i));if(s){const a=Uh.Ws(i,s);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const i=this.uo(t);i&&this.co(i)}for(const i of this.Xs)this.Ys(i);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,i){this.ho(e,t,i),this.Po(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Fg(this.persistenceKey,e));if(s){const a=Ec.Ws(e,s);a&&(i=a.state)}}return t&&this.To.zs(e),this.ao(),i}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Fg(this.persistenceKey,e))}updateQueryState(e,t,i){this.Io(e,t,i)}handleUserChange(e,t,i){t.forEach((s=>{this.Po(s)})),this.currentUser=e,i.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ae(Qi,"READ",e,t),t}setItem(e,t){ae(Qi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ae(Qi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(ae(Qi,"EVENT",t.key,t.newValue),t.key===this.eo)return void Nt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const i=this.Ro(t.key);return this.Vo(i,null)}{const i=this.mo(t.key,t.newValue);if(i)return this.Vo(i.clientId,i)}}else if(this.io.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(this.so.test(t.key)){if(t.newValue!==null){const i=this.yo(t.key,t.newValue);if(i)return this.wo(i)}}else if(t.key===this.oo){if(t.newValue!==null){const i=this.uo(t.newValue);if(i)return this.co(i)}}else if(t.key===this.no){const i=(function(a){let l=Nn.ce;if(a!=null)try{const d=JSON.parse(a);Se(typeof d=="number",30636,{So:a}),l=d}catch(d){Nt(Qi,"Failed to read sequence number from WebStorage",d)}return l})(t.newValue);i!==Nn.ce&&this.sequenceNumberHandler(i)}else if(t.key===this._o){const i=this.bo(t.newValue);await Promise.all(i.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,i){const s=new Lh(this.currentUser,e,t,i),a=RS(this.persistenceKey,this.currentUser,e);this.setItem(a,s.Gs())}Po(e){const t=RS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,i){const s=Fg(this.persistenceKey,e),a=new Ec(e,t,i);this.setItem(s,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const i=this.Ro(e);return Uh.Ws(i,t)}fo(e,t){const i=this.io.exec(e),s=Number(i[1]),a=i[2]!==void 0?i[2]:null;return Lh.Ws(new fn(a),s,t)}yo(e,t){const i=this.so.exec(e),s=Number(i[1]);return Ec.Ws(s,t)}uo(e){return x_.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ae(Qi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const i=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),a=this.lo(i),l=[],d=[];return a.forEach((f=>{s.has(f)||l.push(f)})),s.forEach((f=>{a.has(f)||d.push(f)})),this.syncEngine.Fo(l,d).then((()=>{this.Zs=i}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=m_();return e.forEach(((i,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class Cb{constructor(){this.Mo=new Iy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Iy,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS="ConnectivityMonitor";class xS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ae(bS,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ae(bS,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bf=null;function Cy(){return Bf===null?Bf=(function(){return 268435456+Math.round(2147483648*Math.random())})():Bf++,"0x"+Bf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qg="RestConnection",sL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class oL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===wh?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(e,t,i,s,a){const l=Cy(),d=this.zo(e,t.toUriEncodedString());ae(qg,`Sending RPC '${e}' ${l}:`,d,i);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,a);const{host:p}=new URL(d),_=Ml(p);return this.Jo(e,d,f,i,_).then((E=>(ae(qg,`Received RPC '${e}' ${l}: `,E),E)),(E=>{throw Sc(qg,`RPC '${e}' ${l} failed with error: `,E,"url: ",d,"request:",i),E}))}Ho(e,t,i,s,a,l){return this.Go(e,t,i,s,a)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),i&&i.headers.forEach(((s,a)=>e[a]=s))}zo(e,t){const i=sL[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="WebChannelConnection";class lL extends oL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,s,a){const l=Cy();return new Promise(((d,f)=>{const p=new Vw;p.setWithCredentials(!0),p.listenOnce(Lw.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Zf.NO_ERROR:const E=p.getResponseJson();ae(dn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(E)),d(E);break;case Zf.TIMEOUT:ae(dn,`RPC '${e}' ${l} timed out`),f(new ce(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Zf.HTTP_ERROR:const T=p.getStatus();if(ae(dn,`RPC '${e}' ${l} failed with status:`,T,"response text:",p.getResponseText()),T>0){let C=p.getResponseJson();Array.isArray(C)&&(C=C[0]);const P=C==null?void 0:C.error;if(P&&P.status&&P.message){const O=(function(Q){const j=Q.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(j)>=0?j:ee.UNKNOWN})(P.status);f(new ce(O,P.message))}else f(new ce(ee.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new ce(ee.UNAVAILABLE,"Connection failed."));break;default:ye(9055,{l_:e,streamId:l,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{ae(dn,`RPC '${e}' ${l} completed.`)}}));const _=JSON.stringify(s);ae(dn,`RPC '${e}' ${l} sending request:`,s),p.send(t,"POST",_,i,15)}))}T_(e,t,i){const s=Cy(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=Fw(),d=Ow(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,i),f.encodeInitMessageHeaders=!0;const _=a.join("");ae(dn,`Creating RPC '${e}' stream ${s}: ${_}`,f);const E=l.createWebChannel(_,f);this.I_(E);let T=!1,C=!1;const P=new aL({Yo:k=>{C?ae(dn,`Not sending because RPC '${e}' stream ${s} is closed:`,k):(T||(ae(dn,`Opening RPC '${e}' stream ${s} transport.`),E.open(),T=!0),ae(dn,`RPC '${e}' stream ${s} sending:`,k),E.send(k))},Zo:()=>E.close()}),O=(k,Q,j)=>{k.listen(Q,(X=>{try{j(X)}catch(se){setTimeout((()=>{throw se}),0)}}))};return O(E,sc.EventType.OPEN,(()=>{C||(ae(dn,`RPC '${e}' stream ${s} transport opened.`),P.o_())})),O(E,sc.EventType.CLOSE,(()=>{C||(C=!0,ae(dn,`RPC '${e}' stream ${s} transport closed`),P.a_(),this.E_(E))})),O(E,sc.EventType.ERROR,(k=>{C||(C=!0,Sc(dn,`RPC '${e}' stream ${s} transport errored. Name:`,k.name,"Message:",k.message),P.a_(new ce(ee.UNAVAILABLE,"The operation could not be completed")))})),O(E,sc.EventType.MESSAGE,(k=>{var Q;if(!C){const j=k.data[0];Se(!!j,16349);const X=j,se=(X==null?void 0:X.error)||((Q=X[0])==null?void 0:Q.error);if(se){ae(dn,`RPC '${e}' stream ${s} received error:`,se);const le=se.status;let ue=(function(x){const L=qt[x];if(L!==void 0)return FR(L)})(le),N=se.message;ue===void 0&&(ue=ee.INTERNAL,N="Unknown error status: "+le+" with message "+se.message),C=!0,P.a_(new ce(ue,N)),E.close()}else ae(dn,`RPC '${e}' stream ${s} received:`,j),P.u_(j)}})),O(d,Uw.STAT_EVENT,(k=>{k.stat===ny.PROXY?ae(dn,`RPC '${e}' stream ${s} detected buffering proxy`):k.stat===ny.NOPROXY&&ae(dn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{P.__()}),0),P}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(){return typeof window<"u"?window:null}function lh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(n){return new p4(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e,t,i=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-i);s>0&&ae("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NS="PersistentStream";class bb{constructor(e,t,i,s,a,l,d,f){this.Mi=e,this.S_=i,this.b_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Rb(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(Nt(t.toString()),Nt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===t&&this.G_(i,s)}),(i=>{e((()=>{const s=new ce(ee.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ae(NS,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ae(NS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class uL extends bb{constructor(e,t,i,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=y4(this.serializer,e),i=(function(a){if(!("targetChange"in a))return Ce.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Ce.min():l.readTime?Tn(l.readTime):Ce.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=_y(this.serializer),t.addTarget=(function(a,l){let d;const f=l.target;if(d=Rh(f)?{documents:YR(a,f)}:{query:$R(a,f).ft},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=GR(a,l.resumeToken);const p=gy(a,l.expectedCount);p!==null&&(d.expectedCount=p)}else if(l.snapshotVersion.compareTo(Ce.min())>0){d.readTime=Rl(a,l.snapshotVersion.toTimestamp());const p=gy(a,l.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const i=v4(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=_y(this.serializer),t.removeTarget=e,this.q_(t)}}class cL extends bb{constructor(e,t,i,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Se(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Se(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Se(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=_4(e.writeResults,e.commitTime),i=Tn(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=_y(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>Nh(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dL{}class fL extends dL{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ce(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(e,yy(t,i),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ce(ee.UNKNOWN,a.toString())}))}Ho(e,t,i,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Ho(e,yy(t,i),s,l,d,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ce(ee.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class hL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Nt(t),this.aa=!1):ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo="RemoteStore";class pL{constructor(e,t,i,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{i.enqueueAndForget((async()=>{Qo(this)&&(ae(Yo,"Restarting streams for network reachability change."),await(async function(f){const p=Ee(f);p.Ea.add(4),await Zc(p),p.Ra.set("Unknown"),p.Ea.delete(4),await cp(p)})(this))}))})),this.Ra=new hL(i,s)}}async function cp(n){if(Qo(n))for(const e of n.da)await e(!0)}async function Zc(n){for(const e of n.da)await e(!1)}function dp(n,e){const t=Ee(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),M_(t)?D_(t):Fl(t).O_()&&N_(t,e))}function xl(n,e){const t=Ee(n),i=Fl(t);t.Ia.delete(e),i.O_()&&xb(t,e),t.Ia.size===0&&(i.O_()?i.L_():Qo(t)&&t.Ra.set("Unknown"))}function N_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ce.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Fl(n).Y_(e)}function xb(n,e){n.Va.Ue(e),Fl(n).Z_(e)}function D_(n){n.Va=new c4({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Fl(n).start(),n.Ra.ua()}function M_(n){return Qo(n)&&!Fl(n).x_()&&n.Ia.size>0}function Qo(n){return Ee(n).Ea.size===0}function Nb(n){n.Va=void 0}async function mL(n){n.Ra.set("Online")}async function gL(n){n.Ia.forEach(((e,t)=>{N_(n,e)}))}async function yL(n,e){Nb(n),M_(n)?(n.Ra.ha(e),D_(n)):n.Ra.set("Unknown")}async function _L(n,e,t){if(n.Ra.set("Online"),e instanceof qR&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const d of a.targetIds)s.Ia.has(d)&&(await s.remoteSyncer.rejectListen(d,l),s.Ia.delete(d),s.Va.removeTarget(d))})(n,e)}catch(i){ae(Yo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Oh(n,i)}else if(e instanceof oh?n.Va.Ze(e):e instanceof BR?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ce.min()))try{const i=await _b(n.localStore);t.compareTo(i)>=0&&await(function(a,l){const d=a.Va.Tt(l);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=a.Ia.get(p);_&&a.Ia.set(p,_.withResumeToken(f.resumeToken,l))}})),d.targetMismatches.forEach(((f,p)=>{const _=a.Ia.get(f);if(!_)return;a.Ia.set(f,_.withResumeToken(Dt.EMPTY_BYTE_STRING,_.snapshotVersion)),xb(a,f);const E=new Ir(_.target,f,p,_.sequenceNumber);N_(a,E)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){ae(Yo,"Failed to raise snapshot:",i),await Oh(n,i)}}async function Oh(n,e,t){if(!Bs(e))throw e;n.Ea.add(1),await Zc(n),n.Ra.set("Offline"),t||(t=()=>_b(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ae(Yo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await cp(n)}))}function Db(n,e){return e().catch((t=>Oh(n,t,e)))}async function Ol(n){const e=Ee(n),t=Vs(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Po;for(;vL(e);)try{const s=await iL(e.localStore,i);if(s===null){e.Ta.length===0&&t.L_();break}i=s.batchId,EL(e,s)}catch(s){await Oh(e,s)}Mb(e)&&Pb(e)}function vL(n){return Qo(n)&&n.Ta.length<10}function EL(n,e){n.Ta.push(e);const t=Vs(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Mb(n){return Qo(n)&&!Vs(n).x_()&&n.Ta.length>0}function Pb(n){Vs(n).start()}async function TL(n){Vs(n).ra()}async function AL(n){const e=Vs(n);for(const t of n.Ta)e.ea(t.mutations)}async function SL(n,e,t){const i=n.Ta.shift(),s=__.from(i,e,t);await Db(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Ol(n)}async function IL(n,e){e&&Vs(n).X_&&await(async function(i,s){if((function(l){return a4(l)&&l!==ee.ABORTED})(s.code)){const a=i.Ta.shift();Vs(i).B_(),await Db(i,(()=>i.remoteSyncer.rejectFailedWrite(a.batchId,s))),await Ol(i)}})(n,e),Mb(n)&&Pb(n)}async function DS(n,e){const t=Ee(n);t.asyncQueue.verifyOperationInProgress(),ae(Yo,"RemoteStore received new credentials");const i=Qo(t);t.Ea.add(3),await Zc(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await cp(t)}async function wy(n,e){const t=Ee(n);e?(t.Ea.delete(2),await cp(t)):e||(t.Ea.add(2),await Zc(t),t.Ra.set("Unknown"))}function Fl(n){return n.ma||(n.ma=(function(t,i,s){const a=Ee(t);return a.sa(),new uL(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:mL.bind(null,n),t_:gL.bind(null,n),r_:yL.bind(null,n),H_:_L.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),M_(n)?D_(n):n.Ra.set("Unknown")):(await n.ma.stop(),Nb(n))}))),n.ma}function Vs(n){return n.fa||(n.fa=(function(t,i,s){const a=Ee(t);return a.sa(),new cL(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:TL.bind(null,n),r_:IL.bind(null,n),ta:AL.bind(null,n),na:SL.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Ol(n)):(await n.fa.stop(),n.Ta.length>0&&(ae(Yo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,t,i,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=a,this.deferred=new wr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,a){const l=Date.now()+i,d=new P_(e,t,l,s,a);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ce(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function k_(n,e){if(Nt("AsyncQueue",`${e}: ${n}`),Bs(n))return new ce(ee.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{static emptySet(e){return new al(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||fe.comparator(t.key,i.key):(t,i)=>fe.comparator(t.key,i.key),this.keyedMap=oc(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof al)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=i.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new al;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(){this.ga=new ht(fe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ye(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Nl{constructor(e,t,i,s,a,l,d,f,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,s,a){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new Nl(e,t,al.emptySet(t),l,i,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ip(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class wL{constructor(){this.queries=PS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const s=Ee(t),a=s.queries;s.queries=PS(),a.forEach(((l,d)=>{for(const f of d.Sa)f.onError(i)}))})(this,new ce(ee.ABORTED,"Firestore shutting down"))}}function PS(){return new kr((n=>CR(n)),ip)}async function RL(n,e){const t=Ee(n);let i=3;const s=e.query;let a=t.queries.get(s);a?!a.ba()&&e.Da()&&(i=2):(a=new CL,i=e.Da()?0:1);try{switch(i){case 0:a.wa=await t.onListen(s,!0);break;case 1:a.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const d=k_(l,`Initialization of query '${Xa(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&V_(t)}async function bL(n,e){const t=Ee(n),i=e.query;let s=3;const a=t.queries.get(i);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function xL(n,e){const t=Ee(n);let i=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const d of l.Sa)d.Fa(s)&&(i=!0);l.wa=s}}i&&V_(t)}function NL(n,e,t){const i=Ee(n),s=i.queries.get(e);if(s)for(const a of s.Sa)a.onError(t);i.queries.delete(e)}function V_(n){n.Ca.forEach((e=>{e.next()}))}var Ry,kS;(kS=Ry||(Ry={})).Ma="default",kS.Cache="cache";class DL{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new Nl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Nl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ry.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(e){this.key=e}}class Vb{constructor(e){this.key=e}}class ML{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ue(),this.mutatedKeys=Ue(),this.eu=RR(e),this.tu=new al(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new MS,s=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((_,E)=>{const T=s.get(_),C=$c(this.query,E)?E:null,P=!!T&&this.mutatedKeys.has(T.key),O=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let k=!1;T&&C?T.data.isEqual(C.data)?P!==O&&(i.track({type:3,doc:C}),k=!0):this.su(T,C)||(i.track({type:2,doc:C}),k=!0,(f&&this.eu(C,f)>0||p&&this.eu(C,p)<0)&&(d=!0)):!T&&C?(i.track({type:0,doc:C}),k=!0):T&&!C&&(i.track({type:1,doc:T}),k=!0,(f||p)&&(d=!0)),k&&(C?(l=l.add(C),a=O?a.add(_):a.delete(_)):(l=l.delete(_),a=a.delete(_)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),a=a.delete(_.key),i.track({type:1,doc:_})}return{tu:l,iu:i,Cs:d,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((_,E)=>(function(C,P){const O=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye(20277,{Rt:k})}};return O(C)-O(P)})(_.type,E.type)||this.eu(_.doc,E.doc))),this.ou(i),s=s??!1;const d=t&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,p=f!==this.Za;return this.Za=f,l.length!==0||p?{snapshot:new Nl(this.query,e.tu,a,l,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new MS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ue(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new Vb(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new kb(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Ue();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Nl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Bl="SyncEngine";class PL{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class kL{constructor(e){this.key=e,this.hu=!1}}class VL{constructor(e,t,i,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new kr((d=>CR(d)),ip),this.Iu=new Map,this.Eu=new Set,this.du=new ht(fe.comparator),this.Au=new Map,this.Ru=new I_,this.Vu={},this.mu=new Map,this.fu=Jo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function LL(n,e,t=!0){const i=fp(n);let s;const a=i.Tu.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await Lb(i,e,t,!0),s}async function UL(n,e){const t=fp(n);await Lb(t,e,!0,!1)}async function Lb(n,e,t,i){const s=await Vh(n.localStore,zn(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let d;return i&&(d=await L_(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&dp(n.remoteStore,s),d}async function L_(n,e,t,i,s){n.pu=(E,T,C)=>(async function(O,k,Q,j){let X=k.view.ru(Q);X.Cs&&(X=await Sy(O.localStore,k.query,!1).then((({documents:N})=>k.view.ru(N,X))));const se=j&&j.targetChanges.get(k.targetId),le=j&&j.targetMismatches.get(k.targetId)!=null,ue=k.view.applyChanges(X,O.isPrimaryClient,se,le);return by(O,k.targetId,ue.au),ue.snapshot})(n,E,T,C);const a=await Sy(n.localStore,e,!0),l=new ML(e,a.Qs),d=l.ru(a.documents),f=Wc.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),p=l.applyChanges(d,n.isPrimaryClient,f);by(n,t,p.au);const _=new PL(e,t,l);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function OL(n,e,t){const i=Ee(n),s=i.Tu.get(e),a=i.Iu.get(s.targetId);if(a.length>1)return i.Iu.set(s.targetId,a.filter((l=>!ip(l,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await bl(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),t&&xl(i.remoteStore,s.targetId),Dl(i,s.targetId)})).catch(Fs)):(Dl(i,s.targetId),await bl(i.localStore,s.targetId,!0))}async function FL(n,e){const t=Ee(n),i=t.Tu.get(e),s=t.Iu.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),xl(t.remoteStore,i.targetId))}async function BL(n,e,t){const i=B_(n);try{const s=await(function(l,d){const f=Ee(l),p=st.now(),_=d.reduce(((C,P)=>C.add(P.key)),Ue());let E,T;return f.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let P=Gn(),O=Ue();return f.Ns.getEntries(C,_).next((k=>{P=k,P.forEach(((Q,j)=>{j.isValidDocument()||(O=O.add(Q))}))})).next((()=>f.localDocuments.getOverlayedDocuments(C,P))).next((k=>{E=k;const Q=[];for(const j of d){const X=s4(j,E.get(j.key).overlayedDocument);X!=null&&Q.push(new Vr(j.key,X,mR(X.value.mapValue),un.exists(!0)))}return f.mutationQueue.addMutationBatch(C,p,Q,d)})).next((k=>{T=k;const Q=k.applyToLocalDocumentSet(E,O);return f.documentOverlayCache.saveOverlays(C,k.batchId,Q)}))})).then((()=>({batchId:T.batchId,changes:xR(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(l,d,f){let p=l.Vu[l.currentUser.toKey()];p||(p=new ht(Ne)),p=p.insert(d,f),l.Vu[l.currentUser.toKey()]=p})(i,s.batchId,t),await Gs(i,s.changes),await Ol(i.remoteStore)}catch(s){const a=k_(s,"Failed to persist write");t.reject(a)}}async function Ub(n,e){const t=Ee(n);try{const i=await tL(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Au.get(a);l&&(Se(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?Se(l.hu,14607):s.removedDocuments.size>0&&(Se(l.hu,42227),l.hu=!1))})),await Gs(t,i,e)}catch(i){await Fs(i)}}function VS(n,e,t){const i=Ee(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Tu.forEach(((a,l)=>{const d=l.view.va(e);d.snapshot&&s.push(d.snapshot)})),(function(l,d){const f=Ee(l);f.onlineState=d;let p=!1;f.queries.forEach(((_,E)=>{for(const T of E.Sa)T.va(d)&&(p=!0)})),p&&V_(f)})(i.eventManager,e),s.length&&i.Pu.H_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function qL(n,e,t){const i=Ee(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Au.get(e),a=s&&s.key;if(a){let l=new ht(fe.comparator);l=l.insert(a,It.newNoDocument(a,Ce.min()));const d=Ue().add(a),f=new Xc(Ce.min(),new Map,new ht(Ne),l,d);await Ub(i,f),i.du=i.du.remove(a),i.Au.delete(e),F_(i)}else await bl(i.localStore,e,!1).then((()=>Dl(i,e,t))).catch(Fs)}async function GL(n,e){const t=Ee(n),i=e.batch.batchId;try{const s=await eL(t.localStore,e);O_(t,i,null),U_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Gs(t,s)}catch(s){await Fs(s)}}async function zL(n,e,t){const i=Ee(n);try{const s=await(function(l,d){const f=Ee(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return f.mutationQueue.lookupMutationBatch(p,d).next((E=>(Se(E!==null,37113),_=E.keys(),f.mutationQueue.removeMutationBatch(p,E)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>f.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);O_(i,e,t),U_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Gs(i,s)}catch(s){await Fs(s)}}function U_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function O_(n,e,t){const i=Ee(n);let s=i.Vu[i.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),i.Vu[i.currentUser.toKey()]=s}}function Dl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||Ob(n,i)}))}function Ob(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(xl(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),F_(n))}function by(n,e,t){for(const i of t)i instanceof kb?(n.Ru.addReference(i.key,e),HL(n,i)):i instanceof Vb?(ae(Bl,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||Ob(n,i.key)):ye(19791,{wu:i})}function HL(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(ae(Bl,"New document in limbo: "+t),n.Eu.add(i),F_(n))}function F_(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new fe(tt.fromString(e)),i=n.fu.next();n.Au.set(i,new kL(t)),n.du=n.du.insert(t,i),dp(n.remoteStore,new Ir(zn(p_(t.path)),i,"TargetPurposeLimboResolution",Nn.ce))}}async function Gs(n,e,t){const i=Ee(n),s=[],a=[],l=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,f)=>{l.push(i.pu(f,e,t).then((p=>{var _;if((p||t)&&i.isPrimaryClient){const E=p?!p.fromCache:(_=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:_.current;i.sharedClientState.updateQueryState(f.targetId,E?"current":"not-current")}if(p){s.push(p);const E=R_.As(f.targetId,p);a.push(E)}})))})),await Promise.all(l),i.Pu.H_(s),await(async function(f,p){const _=Ee(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>z.forEach(p,(T=>z.forEach(T.Es,(C=>_.persistence.referenceDelegate.addReference(E,T.targetId,C))).next((()=>z.forEach(T.ds,(C=>_.persistence.referenceDelegate.removeReference(E,T.targetId,C)))))))))}catch(E){if(!Bs(E))throw E;ae(b_,"Failed to update sequence numbers: "+E)}for(const E of p){const T=E.targetId;if(!E.fromCache){const C=_.Ms.get(T),P=C.snapshotVersion,O=C.withLastLimboFreeSnapshotVersion(P);_.Ms=_.Ms.insert(T,O)}}})(i.localStore,a))}async function KL(n,e){const t=Ee(n);if(!t.currentUser.isEqual(e)){ae(Bl,"User change. New user:",e.toKey());const i=await yb(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((d=>{d.forEach((f=>{f.reject(new ce(ee.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Gs(t,i.Ls)}}function JL(n,e){const t=Ee(n),i=t.Au.get(e);if(i&&i.hu)return Ue().add(i.key);{let s=Ue();const a=t.Iu.get(e);if(!a)return s;for(const l of a){const d=t.Tu.get(l);s=s.unionWith(d.view.nu)}return s}}async function YL(n,e){const t=Ee(n),i=await Sy(t.localStore,e.query,!0),s=e.view.cu(i);return t.isPrimaryClient&&by(t,e.targetId,s.au),s}async function $L(n,e){const t=Ee(n);return Eb(t.localStore,e).then((i=>Gs(t,i)))}async function QL(n,e,t,i){const s=Ee(n),a=await(function(d,f){const p=Ee(d),_=Ee(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(E=>_.er(E,f).next((T=>T?p.localDocuments.getDocuments(E,T):z.resolve(null)))))})(s.localStore,e);a!==null?(t==="pending"?await Ol(s.remoteStore):t==="acknowledged"||t==="rejected"?(O_(s,e,i||null),U_(s,e),(function(d,f){Ee(Ee(d).mutationQueue).ir(f)})(s.localStore,e)):ye(6720,"Unknown batchState",{Su:t}),await Gs(s,a)):ae(Bl,"Cannot apply mutation batch with id: "+e)}async function XL(n,e){const t=Ee(n);if(fp(t),B_(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await LS(t,i.toArray());t.gu=!0,await wy(t.remoteStore,!0);for(const a of s)dp(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const i=[];let s=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?i.push(l):s=s.then((()=>(Dl(t,l),bl(t.localStore,l,!0)))),xl(t.remoteStore,l)})),await s,await LS(t,i),(function(l){const d=Ee(l);d.Au.forEach(((f,p)=>{xl(d.remoteStore,p)})),d.Ru.Jr(),d.Au=new Map,d.du=new ht(fe.comparator)})(t),t.gu=!1,await wy(t.remoteStore,!1)}}async function LS(n,e,t){const i=Ee(n),s=[],a=[];for(const l of e){let d;const f=i.Iu.get(l);if(f&&f.length!==0){d=await Vh(i.localStore,zn(f[0]));for(const p of f){const _=i.Tu.get(p),E=await YL(i,_);E.snapshot&&a.push(E.snapshot)}}else{const p=await vb(i.localStore,l);d=await Vh(i.localStore,p),await L_(i,Fb(p),l,!1,d.resumeToken)}s.push(d)}return i.Pu.H_(a),s}function Fb(n){return SR(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function WL(n){return(function(t){return Ee(Ee(t).persistence).Ts()})(Ee(n).localStore)}async function ZL(n,e,t,i){const s=Ee(n);if(s.gu)return void ae(Bl,"Ignoring unexpected query state notification.");const a=s.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await Eb(s.localStore,wR(a[0])),d=Xc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Dt.EMPTY_BYTE_STRING);await Gs(s,l,d);break}case"rejected":await bl(s.localStore,e,!0),Dl(s,e,i);break;default:ye(64155,t)}}async function jL(n,e,t){const i=fp(n);if(i.gu){for(const s of e){if(i.Iu.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){ae(Bl,"Adding an already active target "+s);continue}const a=await vb(i.localStore,s),l=await Vh(i.localStore,a);await L_(i,Fb(a),l.targetId,!1,l.resumeToken),dp(i.remoteStore,l)}for(const s of t)i.Iu.has(s)&&await bl(i.localStore,s,!1).then((()=>{xl(i.remoteStore,s),Dl(i,s)})).catch(Fs)}}function fp(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ub.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=JL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=qL.bind(null,e),e.Pu.H_=xL.bind(null,e.eventManager),e.Pu.yu=NL.bind(null,e.eventManager),e}function B_(n){const e=Ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=zL.bind(null,e),e}class Lc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=up(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return gb(this.persistence,new mb,e.initialUser,this.serializer)}Cu(e){return new C_(lp.mi,this.serializer)}Du(e){return new Cb}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Lc.provider={build:()=>new Lc};class eU extends Lc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Se(this.persistence.referenceDelegate instanceof kh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new ub(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new C_((i=>kh.mi(i,t)),this.serializer)}}class Bb extends Lc{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await B_(this.xu.syncEngine),await Ol(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return gb(this.persistence,new mb,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new ub(i,e.asyncQueue,t)}Mu(e,t){const i=new aV(t,this.persistence);return new oV(e.asyncQueue,i)}Cu(e){const t=pb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new w_(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,wb(),lh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Cb}}class tU extends Bb{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Bg&&(this.sharedClientState.syncEngine={Co:QL.bind(null,t),vo:ZL.bind(null,t),Fo:jL.bind(null,t),Ts:WL.bind(null,t),Do:$L.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async i=>{await XL(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=wb();if(!Bg.v(t))throw new ce(ee.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=pb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Bg(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Uc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>VS(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=KL.bind(null,this.syncEngine),await wy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new wL})()}createDatastore(e){const t=up(e.databaseInfo.databaseId),i=(function(a){return new lL(a)})(e.databaseInfo);return(function(a,l,d,f){return new fL(a,l,d,f)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,s,a,l,d){return new pL(i,s,a,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>VS(this.syncEngine,t,0)),(function(){return xS.v()?new xS:new rL})())}createSyncEngine(e,t){return(function(s,a,l,d,f,p,_){const E=new VL(s,a,l,d,f,p);return _&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const a=Ee(s);ae(Yo,"RemoteStore shutting down."),a.Ea.add(5),await Zc(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Uc.provider={build:()=>new Uc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nU{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Nt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls="FirestoreClient";class iU{constructor(e,t,i,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=fn.UNAUTHENTICATED,this.clientId=i_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(i,(async l=>{ae(Ls,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(i,(l=>(ae(Ls,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=k_(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function Gg(n,e){n.asyncQueue.verifyOperationInProgress(),ae(Ls,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await yb(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function US(n,e){n.asyncQueue.verifyOperationInProgress();const t=await rU(n);ae(Ls,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>DS(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>DS(e.remoteStore,s))),n._onlineComponents=e}async function rU(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ae(Ls,"Using user provided OfflineComponentProvider");try{await Gg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===ee.FAILED_PRECONDITION||s.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Sc("Error using user provided cache. Falling back to memory cache: "+t),await Gg(n,new Lc)}}else ae(Ls,"Using default OfflineComponentProvider"),await Gg(n,new eU(void 0));return n._offlineComponents}async function qb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ae(Ls,"Using user provided OnlineComponentProvider"),await US(n,n._uninitializedComponentsProvider._online)):(ae(Ls,"Using default OnlineComponentProvider"),await US(n,new Uc))),n._onlineComponents}function sU(n){return qb(n).then((e=>e.syncEngine))}async function oU(n){const e=await qb(n),t=e.eventManager;return t.onListen=LL.bind(null,e.syncEngine),t.onUnlisten=OL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=UL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=FL.bind(null,e.syncEngine),t}function aU(n,e,t={}){const i=new wr;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,p){const _=new nU({next:T=>{_.Nu(),l.enqueueAndForget((()=>bL(a,E))),T.fromCache&&f.source==="server"?p.reject(new ce(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),E=new DL(d,_,{includeMetadataChanges:!0,qa:!0});return RL(a,E)})(await oU(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lU="firestore.googleapis.com",FS=!0;class BS{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ce(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=lU,this.ssl=FS}else this.host=e.host,this.ssl=e.ssl??FS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=rb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<lb)throw new ce(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Gb(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ce(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ce(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ce(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class q_{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new BS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ce(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new BS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new $k;switch(i.type){case"firstParty":return new Wk(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ce(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=OS.get(t);i&&(ae("ComponentProvider","Removing Datastore"),OS.delete(t),i.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Xo(this.firestore,e,this._query)}}class Yt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ms(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yt(this.firestore,e,this._key)}toJSON(){return{type:Yt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Kc(t,Yt._jsonSchema))return new Yt(e,i||null,new fe(tt.fromString(t.referencePath)))}}Yt._jsonSchemaVersion="firestore/documentReference/1.0",Yt._jsonSchema={type:Gt("string",Yt._jsonSchemaVersion),referencePath:Gt("string")};class Ms extends Xo{constructor(e,t,i){super(e,t,p_(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yt(this.firestore,null,new fe(e))}withConverter(e){return new Ms(this.firestore,e,this._path)}}function uU(n,e,...t){if(n=zt(n),Gw("collection","path",e),n instanceof q_){const i=tt.fromString(e,...t);return NA(i),new Ms(n,null,i)}{if(!(n instanceof Yt||n instanceof Ms))throw new ce(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(tt.fromString(e,...t));return NA(i),new Ms(n.firestore,null,i)}}function hp(n,e,...t){if(n=zt(n),arguments.length===1&&(e=i_.newId()),Gw("doc","path",e),n instanceof q_){const i=tt.fromString(e,...t);return xA(i),new Yt(n,null,new fe(i))}{if(!(n instanceof Yt||n instanceof Ms))throw new ce(ee.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(tt.fromString(e,...t));return xA(i),new Yt(n.firestore,n instanceof Ms?n.converter:null,new fe(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qS="AsyncQueue";class GS{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Rb(this,"async_queue_retry"),this._c=()=>{const i=lh();i&&ae(qS,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=lh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=lh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new wr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Bs(e))throw e;ae(qS,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Nt("INTERNAL UNHANDLED ERROR: ",zS(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=P_.createAndSchedule(this,e,t,i,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&ye(47125,{Pc:zS(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function zS(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class jc extends q_{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new GS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new GS(e),this._firestoreClient=void 0,await e}}}function cU(n,e,t){t||(t=wh);const i=Yy(n,"firestore");if(i.isInitialized(t)){const s=i.getImmediate({identifier:t}),a=i.getOptions(t);if(Uo(a,e))return s;throw new ce(ee.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ce(ee.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<lb)throw new ce(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Ml(e.host)&&zC(e.host),i.initialize({options:e,instanceIdentifier:t})}function G_(n){if(n._terminated)throw new ce(ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||dU(n),n._firestoreClient}function dU(n){var i,s,a;const e=n._freezeSettings(),t=(function(d,f,p,_){return new VV(d,f,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Gb(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new iU(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const f=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(f),_online:f}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this._byteString=e}static fromBase64String(e){try{return new si(Dt.fromBase64String(e))}catch(t){throw new ce(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new si(Dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:si._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Kc(e,si._jsonSchema))return si.fromBase64String(e.bytes)}}si._jsonSchemaVersion="firestore/bytes/1.0",si._jsonSchema={type:Gt("string",si._jsonSchemaVersion),bytes:Gt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ce(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ce(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ce(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:er._jsonSchemaVersion}}static fromJSON(e){if(Kc(e,er._jsonSchema))return new er(e.latitude,e.longitude)}}er._jsonSchemaVersion="firestore/geoPoint/1.0",er._jsonSchema={type:Gt("string",er._jsonSchemaVersion),latitude:Gt("number"),longitude:Gt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let a=0;a<i.length;++a)if(i[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:tr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Kc(e,tr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new tr(e.vectorValues);throw new ce(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}tr._jsonSchemaVersion="firestore/vectorValue/1.0",tr._jsonSchema={type:Gt("string",tr._jsonSchemaVersion),vectorValues:Gt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fU=/^__.*__$/;class hU{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Vr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ul(e,this.data,t,this.fieldTransforms)}}class zb{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Vr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Hb(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye(40011,{Ac:n})}}class H_{constructor(e,t,i,s,a,l){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new H_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Fh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Hb(this.Ac)&&fU.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class pU{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||up(e)}Cc(e,t,i,s=!1){return new H_({Ac:e,methodName:t,Dc:i,path:Et.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function K_(n){const e=n._freezeSettings(),t=up(n._databaseId);return new pU(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Kb(n,e,t,i,s,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,e,t,s);J_("Data must be an object, but it was:",l,i);const d=Jb(i,l);let f,p;if(a.merge)f=new Dn(l.fieldMask),p=l.fieldTransforms;else if(a.mergeFields){const _=[];for(const E of a.mergeFields){const T=xy(e,E,t);if(!l.contains(T))throw new ce(ee.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);$b(_,T)||_.push(T)}f=new Dn(_),p=l.fieldTransforms.filter((E=>f.covers(E.field)))}else f=null,p=l.fieldTransforms;return new hU(new pn(d),f,p)}class mp extends z_{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mp}}function mU(n,e,t,i){const s=n.Cc(1,e,t);J_("Data must be an object, but it was:",s,i);const a=[],l=pn.empty();qs(i,((f,p)=>{const _=Y_(e,f,t);p=zt(p);const E=s.yc(_);if(p instanceof mp)a.push(_);else{const T=ed(p,E);T!=null&&(a.push(_),l.set(_,T))}}));const d=new Dn(a);return new zb(l,d,s.fieldTransforms)}function gU(n,e,t,i,s,a){const l=n.Cc(1,e,t),d=[xy(e,i,t)],f=[s];if(a.length%2!=0)throw new ce(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<a.length;T+=2)d.push(xy(e,a[T])),f.push(a[T+1]);const p=[],_=pn.empty();for(let T=d.length-1;T>=0;--T)if(!$b(p,d[T])){const C=d[T];let P=f[T];P=zt(P);const O=l.yc(C);if(P instanceof mp)p.push(C);else{const k=ed(P,O);k!=null&&(p.push(C),_.set(C,k))}}const E=new Dn(p);return new zb(_,E,l.fieldTransforms)}function yU(n,e,t,i=!1){return ed(t,n.Cc(i?4:3,e))}function ed(n,e){if(Yb(n=zt(n)))return J_("Unsupported field value:",e,n),Jb(n,e);if(n instanceof z_)return(function(i,s){if(!Hb(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,s){const a=[];let l=0;for(const d of i){let f=ed(d,s.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(i,s){if((i=zt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return ZV(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=st.fromDate(i);return{timestampValue:Rl(s.serializer,a)}}if(i instanceof st){const a=new st(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Rl(s.serializer,a)}}if(i instanceof er)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof si)return{bytesValue:GR(s.serializer,i._byteString)};if(i instanceof Yt){const a=s.databaseId,l=i.firestore._databaseId;if(!l.isEqual(a))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:T_(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof tr)return(function(l,d){return{mapValue:{fields:{[d_]:{stringValue:f_},[Tl]:{arrayValue:{values:l.toArray().map((p=>{if(typeof p!="number")throw d.Sc("VectorValues must only contain numeric values.");return g_(d.serializer,p)}))}}}}}})(i,s);throw s.Sc(`Unsupported field value: ${Qh(i)}`)})(n,e)}function Jb(n,e){const t={};return oR(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qs(n,((i,s)=>{const a=ed(s,e.mc(i));a!=null&&(t[i]=a)})),{mapValue:{fields:t}}}function Yb(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof st||n instanceof er||n instanceof si||n instanceof Yt||n instanceof z_||n instanceof tr)}function J_(n,e,t){if(!Yb(t)||!zw(t)){const i=Qh(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function xy(n,e,t){if((e=zt(e))instanceof pp)return e._internalPath;if(typeof e=="string")return Y_(n,e);throw Fh("Field path arguments must be of type string or ",n,!1,void 0,t)}const _U=new RegExp("[~\\*/\\[\\]]");function Y_(n,e,t){if(e.search(_U)>=0)throw Fh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new pp(...e.split("."))._internalPath}catch{throw Fh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fh(n,e,t,i,s){const a=i&&!i.isEmpty(),l=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${i}`),l&&(f+=` in document ${s}`),f+=")"),new ce(ee.INVALID_ARGUMENT,d+n+f)}function $b(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{constructor(e,t,i,s,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field($_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class vU extends Qb{data(){return super.data()}}function $_(n,e){return typeof e=="string"?Y_(n,e):e instanceof pp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EU(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ce(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Q_{}class Xb extends Q_{}function TU(n,e,...t){let i=[];e instanceof Q_&&i.push(e),i=i.concat(t),(function(a){const l=a.filter((f=>f instanceof W_)).length,d=a.filter((f=>f instanceof X_)).length;if(l>1||l>0&&d>0)throw new ce(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class X_ extends Xb{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new X_(e,t,i)}_apply(e){const t=this._parse(e);return Wb(e._query,t),new Xo(e.firestore,e.converter,py(e._query,t))}_parse(e){const t=K_(e.firestore);return(function(a,l,d,f,p,_,E){let T;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new ce(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){KS(E,_);const P=[];for(const O of E)P.push(HS(f,a,O));T={arrayValue:{values:P}}}else T=HS(f,a,E)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||KS(E,_),T=yU(d,l,E,_==="in"||_==="not-in");return He.create(p,_,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class W_ extends Q_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new W_(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ot.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const d=a.getFlattenedFilters();for(const f of d)Wb(l,f),l=py(l,f)})(e._query,t),new Xo(e.firestore,e.converter,py(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Z_ extends Xb{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Z_(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new ce(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ce(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Pc(a,l)})(e._query,this._field,this._direction);return new Xo(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new Ll(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function AU(n,e="asc"){const t=e,i=$_("orderBy",n);return Z_._create(i,t)}function HS(n,e,t){if(typeof(t=zt(t))=="string"){if(t==="")throw new ce(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!IR(e)&&t.indexOf("/")!==-1)throw new ce(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(tt.fromString(t));if(!fe.isDocumentKey(i))throw new ce(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Dc(n,new fe(i))}if(t instanceof Yt)return Dc(n,t._key);throw new ce(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qh(t)}.`)}function KS(n,e){if(!Array.isArray(n)||n.length===0)throw new ce(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Wb(n,e){const t=(function(s,a){for(const l of s)for(const d of l.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ce(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ce(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class SU{convertValue(e,t="none"){switch(Ps(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Nr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return qs(e,((s,a)=>{i[s]=this.convertValue(a,t)})),i}convertVectorValue(e){var i,s,a;const t=(a=(s=(i=e.fields)==null?void 0:i[Tl].arrayValue)==null?void 0:s.values)==null?void 0:a.map((l=>vt(l.doubleValue)));return new tr(t)}convertGeoPoint(e){return new er(vt(e.latitude),vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=tp(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(xc(e));default:return null}}convertTimestamp(e){const t=xr(e);return new st(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=tt.fromString(e);Se(ZR(i),9688,{name:e});const s=new Go(i.get(1),i.get(3)),a=new fe(i.popFirst(5));return s.isEqual(t)||Nt(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class qf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ll extends Qb{constructor(e,t,i,s,a,l){super(e,t,i,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new uh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field($_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=ll._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}ll._jsonSchemaVersion="firestore/documentSnapshot/1.0",ll._jsonSchema={type:Gt("string",ll._jsonSchemaVersion),bundleSource:Gt("string","DocumentSnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class uh extends ll{data(e={}){return super.data(e)}}class ul{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new qf(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new uh(this._firestore,this._userDataWriter,i.key,i,new qf(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ce(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((d=>{const f=new uh(s._firestore,s._userDataWriter,d.doc.key,d.doc,new qf(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new uh(s._firestore,s._userDataWriter,d.doc.key,d.doc,new qf(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,_=-1;return d.type!==0&&(p=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),_=l.indexOf(d.doc.key)),{type:IU(d.type),doc:f,oldIndex:p,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ul._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=i_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),i.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function IU(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye(61501,{type:n})}}ul._jsonSchemaVersion="firestore/querySnapshot/1.0",ul._jsonSchema={type:Gt("string",ul._jsonSchemaVersion),bundleSource:Gt("string","QuerySnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class CU extends SU{constructor(e){super(),this.firestore=e}convertBytes(e){return new si(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yt(this.firestore,null,t)}}function wU(n){n=ml(n,Xo);const e=ml(n.firestore,jc),t=G_(e),i=new CU(e);return EU(n._query),aU(t,n._query).then((s=>new ul(e,i,n,s)))}function RU(n,e,t){n=ml(n,Yt);const i=ml(n.firestore,jc),s=Zb(n.converter,e,t);return j_(i,[Kb(K_(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,un.none())])}function bU(n){return j_(ml(n.firestore,jc),[new Qc(n._key,un.none())])}function j_(n,e){return(function(i,s){const a=new wr;return i.asyncQueue.enqueueAndForget((async()=>BL(await sU(i),s,a))),a.promise})(G_(n),e)}class xU{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=PU(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function NU(n){return new xU(n)}class DU{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Uc.provider,this._offlineComponentProvider={build:t=>new Bb(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class MU{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Uc.provider,this._offlineComponentProvider={build:t=>new tU(t,e==null?void 0:e.cacheSizeBytes)}}}function PU(n){return new DU(n==null?void 0:n.forceOwnership)}function kU(){return new MU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=K_(e)}set(e,t,i){this._verifyNotCommitted();const s=zg(e,this._firestore),a=Zb(s.converter,t,i),l=Kb(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,i);return this._mutations.push(l.toMutation(s._key,un.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const a=zg(e,this._firestore);let l;return l=typeof(t=zt(t))=="string"||t instanceof pp?gU(this._dataReader,"WriteBatch.update",a._key,t,i,s):mU(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,un.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=zg(e,this._firestore);return this._mutations=this._mutations.concat(new Qc(t._key,un.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ce(ee.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zg(n,e){if((n=zt(n)).firestore!==e)throw new ce(ee.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(n){return G_(n=ml(n,jc)),new VU(n,(e=>j_(n,e)))}(function(e,t=!0){(function(s){Vl=s})(Pl),fl(new Oo("firestore",((i,{instanceIdentifier:s,options:a})=>{const l=i.getProvider("app").getImmediate(),d=new jc(new Qk(i.getProvider("auth-internal")),new Zk(l,i.getProvider("app-check-internal")),(function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new ce(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Go(p.options.projectId,_)})(l,s),l);return a={useFetchStreams:t,...a},d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),xs(CA,wA,e),xs(CA,wA,"esm2020")})();const LU={apiKey:"AIzaSyDAbQWI8JJJZxi4u2m3CpXoVXo_tfV9idQ",authDomain:"spanish-reading-7f2f6.firebaseapp.com",projectId:"spanish-reading-7f2f6",storageBucket:"spanish-reading-7f2f6.firebasestorage.app",messagingSenderId:"199552752380",appId:"1:199552752380:web:7f00e4d764d4cefcde5579",measurementId:"G-B41M23QF87"},ex=XC(LU),Lo=Kk(ex),td=cU(ex,{ignoreUndefinedProperties:!0,localCache:NU({tabManager:kU()})}),UU=({currentView:n,onChangeView:e,children:t,theme:i,onToggleTheme:s,isGuest:a,onLogoutGuest:l})=>{var p,_,E;const d=async()=>{if(window.confirm("Mchten Sie sich wirklich abmelden?"))if(a)l==null||l();else try{await kP(Lo)}catch(T){console.error("Logout failed:",T)}},f=a?"Gast":((p=Lo.currentUser)==null?void 0:p.displayName)||((E=(_=Lo.currentUser)==null?void 0:_.email)==null?void 0:E.split("@")[0]);return R.jsxs("div",{className:"min-h-screen flex flex-col bg-[#FDFBF7] dark:bg-[#12100E]",children:[R.jsx("header",{className:"bg-[#FDFBF7]/90 dark:bg-[#12100E]/90 backdrop-blur-xl border-b border-[#EAE2D6] dark:border-[#2C2420] sticky top-0 z-50 transition-colors",children:R.jsxs("div",{className:"max-w-6xl mx-auto px-6 h-20 flex justify-between items-center",children:[R.jsxs("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:()=>e(St.HOME),children:[R.jsx("div",{className:"bg-[#2C2420] dark:bg-[#D4A373] p-2 rounded-xl text-[#FDFBF7] dark:text-[#12100E] shadow-md group-hover:bg-[#B26B4A] dark:group-hover:bg-[#B26B4A] transition-colors duration-500",children:R.jsx(Jg,{className:"w-4 h-4"})}),R.jsxs("div",{className:"hidden sm:block",children:[R.jsx("h1",{className:"text-lg font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] tracking-tight",children:"Leseassistent"}),R.jsx("p",{className:"text-[8px] font-bold text-[#6B705C] dark:text-[#A5A58D] uppercase tracking-[0.2em] -mt-1 opacity-60",children:"Tu compaero"})]})]}),R.jsxs("nav",{className:"flex items-center bg-[#2C2420]/5 dark:bg-white/5 p-1.5 rounded-2xl border border-[#2C2420]/5 dark:border-white/5 mx-2",children:[R.jsxs("button",{onClick:()=>e(St.HOME),className:`flex items-center gap-2 py-2 px-4 rounded-xl transition-all duration-300 ${n===St.HOME?"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm":"text-[#6B705C] dark:text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7]"}`,children:[R.jsx(Jg,{className:"w-4 h-4"}),R.jsx("span",{className:"hidden md:inline text-[10px] font-bold uppercase tracking-wider",children:"Lesen"})]}),R.jsxs("button",{onClick:()=>e(St.ANALYZE),className:`flex items-center gap-2 py-2 px-4 rounded-xl transition-all duration-300 ${n===St.ANALYZE?"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm":"text-[#6B705C] dark:text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7]"}`,children:[R.jsx(NC,{className:"w-4 h-4"}),R.jsx("span",{className:"hidden md:inline text-[10px] font-bold uppercase tracking-wider",children:"Scan"})]}),R.jsxs("button",{onClick:()=>e(St.VOCAB),className:`flex items-center gap-2 py-2 px-4 rounded-xl transition-all duration-300 ${n===St.VOCAB?"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm":"text-[#6B705C] dark:text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7]"}`,children:[R.jsx(xC,{className:"w-4 h-4"}),R.jsx("span",{className:"hidden md:inline text-[10px] font-bold uppercase tracking-wider",children:"Lernen"})]})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsxs("div",{className:"hidden lg:flex items-center gap-2 px-3 py-1.5 bg-[#FDFBF7] dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] rounded-xl mr-2",children:[R.jsx(VC,{className:"w-3.5 h-3.5 text-[#B26B4A] dark:text-[#D4A373]"}),R.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-[#6B705C] dark:text-[#A5A58D]",children:f})]}),R.jsx("button",{onClick:s,className:"p-2.5 rounded-xl bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#6B705C] dark:text-[#A5A58D] hover:text-[#B26B4A] dark:hover:text-[#D4A373] transition-all",title:"Design ndern",children:i==="dark"?R.jsx(qD,{className:"w-4 h-4"}):R.jsx(xD,{className:"w-4 h-4"})}),R.jsx("button",{onClick:()=>e(St.SETTINGS),className:`p-2.5 rounded-xl transition-colors shadow-sm ${n===St.SETTINGS?"bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E]":"bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#6B705C] dark:text-[#A5A58D] hover:text-[#B26B4A] dark:hover:text-[#D4A373]"}`,title:"Einstellungen",children:R.jsx(DC,{className:"w-4 h-4"})}),R.jsx("button",{onClick:d,className:"p-2.5 rounded-xl bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#6B705C] dark:text-[#A5A58D] hover:text-red-500 transition-all",title:"Abmelden",children:R.jsx(CD,{className:"w-4 h-4"})})]})]})}),R.jsx("main",{className:`flex-grow p-6 w-full mx-auto ${n===St.ANALYZE?"max-w-6xl":"max-w-4xl"} transition-colors`,children:t})]})};var OU={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let FU,BU;function qU(){return{geminiUrl:FU,vertexUrl:BU}}function GU(n,e,t,i){var s,a;if(!(n!=null&&n.baseUrl)){const l=qU();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(a=l.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lr{}function pe(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function m(n,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[d])){const f=n[d];if(Array.isArray(t))for(let p=0;p<f.length;p++){const _=f[p];m(_,e.slice(a+1),t[p])}else for(const p of f)m(p,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in n||(n[d]=[{}]);const f=n[d];m(f[0],e.slice(a+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const i=e[e.length-1],s=n[i];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const s=e[i];if(s.endsWith("[]")){const a=s.slice(0,-2);if(a in n){const l=n[a];return Array.isArray(l)?l.map(d=>h(d,e.slice(i+1),t)):t}else return t}else n=n[s]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function zU(n,e){for(const[t,i]of Object.entries(e)){const s=t.split("."),a=i.split("."),l=new Set;let d=-1;for(let f=0;f<s.length;f++)if(s[f]==="*"){d=f;break}if(d!==-1&&a.length>d)for(let f=d;f<a.length;f++){const p=a[f];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&l.add(p)}Ny(n,s,a,0,l)}}function Ny(n,e,t,i,s){if(i>=e.length||typeof n!="object"||n===null)return;const a=e[i];if(a.endsWith("[]")){const l=a.slice(0,-2),d=n;if(l in d&&Array.isArray(d[l]))for(const f of d[l])Ny(f,e,t,i+1,s)}else if(a==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const l=n,d=Object.keys(l).filter(p=>!p.startsWith("_")&&!s.has(p)),f={};for(const p of d)f[p]=l[p];for(const[p,_]of Object.entries(f)){const E=[];for(const T of t.slice(i))T==="*"?E.push(p):E.push(T);m(l,E,_)}for(const p of d)delete l[p]}}else{const l=n;a in l&&Ny(l[a],e,t,i+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ev(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function HU(n){const e={},t=h(n,["operationName"]);t!=null&&m(e,["operationName"],t);const i=h(n,["resourceName"]);return i!=null&&m(e,["_url","resourceName"],i),e}function KU(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],YU(l)),e}function JU(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],$U(l)),e}function YU(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>QU(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const s=h(n,["raiMediaFilteredReasons"]);return s!=null&&m(e,["raiMediaFilteredReasons"],s),e}function $U(n){const e={},t=h(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>XU(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const s=h(n,["raiMediaFilteredReasons"]);return s!=null&&m(e,["raiMediaFilteredReasons"],s),e}function QU(n){const e={},t=h(n,["video"]);return t!=null&&m(e,["video"],nO(t)),e}function XU(n){const e={},t=h(n,["_self"]);return t!=null&&m(e,["video"],iO(t)),e}function WU(n){const e={},t=h(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function ZU(n){const e={},t=h(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function jU(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],eO(l)),e}function eO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const s=h(n,["documentName"]);return s!=null&&m(e,["documentName"],s),e}function tx(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],tO(l)),e}function tO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const s=h(n,["documentName"]);return s!=null&&m(e,["documentName"],s),e}function nO(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["encodedVideo"]);i!=null&&m(e,["videoBytes"],ev(i));const s=h(n,["encoding"]);return s!=null&&m(e,["mimeType"],s),e}function iO(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["videoBytes"],ev(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var JS;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(JS||(JS={}));var YS;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(YS||(YS={}));var $S;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})($S||($S={}));var xt;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(xt||(xt={}));var QS;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(QS||(QS={}));var XS;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(XS||(XS={}));var WS;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(WS||(WS={}));var ZS;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(ZS||(ZS={}));var jS;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(jS||(jS={}));var eI;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(eI||(eI={}));var tI;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(tI||(tI={}));var nI;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(nI||(nI={}));var iI;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(iI||(iI={}));var rI;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(rI||(rI={}));var sI;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(sI||(sI={}));var oI;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(oI||(oI={}));var aI;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(aI||(aI={}));var lI;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(lI||(lI={}));var uI;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(uI||(uI={}));var Oc;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Oc||(Oc={}));var cI;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(cI||(cI={}));var dI;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(dI||(dI={}));var fI;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(fI||(fI={}));var Dy;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Dy||(Dy={}));var hI;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(hI||(hI={}));var pI;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(pI||(pI={}));var mI;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(mI||(mI={}));var gI;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(gI||(gI={}));var yI;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(yI||(yI={}));var _I;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(_I||(_I={}));var vI;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(vI||(vI={}));var EI;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(EI||(EI={}));var TI;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(TI||(TI={}));var AI;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(AI||(AI={}));var SI;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(SI||(SI={}));var II;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(II||(II={}));var CI;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(CI||(CI={}));var wI;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(wI||(wI={}));var RI;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(RI||(RI={}));var bI;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(bI||(bI={}));var xI;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(xI||(xI={}));var NI;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(NI||(NI={}));var DI;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(DI||(DI={}));var MI;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(MI||(MI={}));var PI;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(PI||(PI={}));var kI;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(kI||(kI={}));var VI;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(VI||(VI={}));var LI;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(LI||(LI={}));var UI;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(UI||(UI={}));var OI;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(OI||(OI={}));var FI;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(FI||(FI={}));var BI;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(BI||(BI={}));var qI;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(qI||(qI={}));var GI;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(GI||(GI={}));var zI;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(zI||(zI={}));var nl;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(nl||(nl={}));class My{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class tc{get text(){var e,t,i,s,a,l,d,f;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",_=!1;const E=[];for(const T of(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[C,P]of Object.entries(T))C!=="text"&&C!=="thought"&&C!=="thoughtSignature"&&(P!==null||P!==void 0)&&E.push(C);if(typeof T.text=="string"){if(typeof T.thought=="boolean"&&T.thought)continue;_=!0,p+=T.text}}return E.length>0&&console.warn(`there are non-text parts ${E} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?p:void 0}get data(){var e,t,i,s,a,l,d,f;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const _=[];for(const E of(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[T,C]of Object.entries(E))T!=="inlineData"&&(C!==null||C!==void 0)&&_.push(T);E.inlineData&&typeof E.inlineData.data=="string"&&(p+=atob(E.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,s,a,l,d,f;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,s,a,l,d,f,p;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(E=>E.executableCode).map(E=>E.executableCode).filter(E=>E!==void 0);if((_==null?void 0:_.length)!==0)return(p=_==null?void 0:_[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,s,a,l,d,f,p;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(E=>E.codeExecutionResult).map(E=>E.codeExecutionResult).filter(E=>E!==void 0);if((_==null?void 0:_.length)!==0)return(p=_==null?void 0:_[0])===null||p===void 0?void 0:p.output}}class HI{}class KI{}class rO{}class sO{}class oO{}class aO{}class JI{}class YI{}class $I{}class lO{}class Bh{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Bh;let s;const a=e;return t?s=JU(a):s=KU(a),Object.assign(i,s),i}}class QI{}class XI{}class WI{}class ZI{}class uO{}class cO{}class dO{}class tv{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new tv,a=jU(e);return Object.assign(i,a),i}}class fO{}class hO{}class pO{}class jI{}class mO{get text(){var e,t,i;let s="",a=!1;const l=[];for(const d of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,p]of Object.entries(d))f!=="text"&&f!=="thought"&&p!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;a=!0,s+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,i;let s="";const a=[];for(const l of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&a.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class gO{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class nv{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new nv,a=tx(e);return Object.assign(i,a),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ze(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function nx(n,e){const t=Ze(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function ix(n){return Array.isArray(n)?n.map(e=>qh(e)):[qh(n)]}function qh(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function rx(n){const e=qh(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function sx(n){const e=qh(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function eC(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function ox(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>eC(e)):[eC(n)]}function Py(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function tC(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function nC(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function mn(n){if(n==null)throw new Error("ContentUnion is required");return Py(n)?n:{role:"user",parts:ox(n)}}function iv(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=mn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=mn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>mn(t)):[mn(e)]}function oi(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(tC(n)||nC(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[mn(n)]}const e=[],t=[],i=Py(n[0]);for(const s of n){const a=Py(s);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(s);else{if(tC(s)||nC(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return i||e.push({role:"user",parts:ox(t)}),e}function yO(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(xt).includes(t[0].toUpperCase())?t[0].toUpperCase():xt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(xt).includes(i.toUpperCase())?i.toUpperCase():xt.TYPE_UNSPECIFIED})}}function cl(n){const e={},t=["items"],i=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&yO(n.type,e);for(const[l,d]of Object.entries(n))if(d!=null)if(l=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(xt).includes(d.toUpperCase())?d.toUpperCase():xt.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=cl(d);else if(i.includes(l)){const f=[];for(const p of d){if(p.type=="null"){e.nullable=!0;continue}f.push(cl(p))}e[l]=f}else if(s.includes(l)){const f={};for(const[p,_]of Object.entries(d))f[p]=cl(_);e[l]=f}else{if(l==="additionalProperties")continue;e[l]=d}return e}function rv(n){return cl(n)}function sv(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function ov(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function ql(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=cl(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=cl(e.response));return n}function Gl(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function _O(n,e,t,i=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Ur(n,e){if(typeof e!="string")throw new Error("name must be a string");return _O(n,e,"cachedContents")}function ax(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function zs(n){return ev(n)}function vO(n){return n!=null&&typeof n=="object"&&"name"in n}function EO(n){return n!=null&&typeof n=="object"&&"video"in n}function TO(n){return n!=null&&typeof n=="object"&&"uri"in n}function lx(n){var e;let t;if(vO(n)&&(t=n.name),!(TO(n)&&(t=n.uri,t===void 0))&&!(EO(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function ux(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function cx(n){for(const e of["models","tunedModels","publisherModels"])if(AO(n,e))return n[e];return[]}function AO(n,e){return n!==null&&typeof n=="object"&&e in n}function SO(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function IO(n,e={}){const t=[],i=new Set;for(const s of n){const a=s.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const l=SO(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function dx(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(s>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function CO(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function fx(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return n;let a=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const f=l.response;if(typeof f!="object"||f===null)continue;if(f.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function zl(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function hx(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wO(n){const e={},t=h(n,["responsesFile"]);t!=null&&m(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>o6(l))),m(e,["inlinedResponses"],a)}const s=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["inlinedEmbedContentResponses"],a)}return e}function RO(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&m(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&m(e,["gcsUri"],i);const s=h(n,["bigqueryDestination","outputUri"]);return s!=null&&m(e,["bigqueryUri"],s),e}function bO(n){const e={},t=h(n,["format"]);t!=null&&m(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&m(e,["gcsDestination","outputUriPrefix"],i);const s=h(n,["bigqueryUri"]);if(s!=null&&m(e,["bigqueryDestination","outputUri"],s),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function ch(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&m(e,["displayName"],i);const s=h(n,["metadata","state"]);s!=null&&m(e,["state"],hx(s));const a=h(n,["metadata","createTime"]);a!=null&&m(e,["createTime"],a);const l=h(n,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const d=h(n,["metadata","updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(n,["metadata","model"]);f!=null&&m(e,["model"],f);const p=h(n,["metadata","output"]);return p!=null&&m(e,["dest"],wO(fx(p))),e}function ky(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const s=h(n,["state"]);s!=null&&m(e,["state"],hx(s));const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["createTime"]);l!=null&&m(e,["createTime"],l);const d=h(n,["startTime"]);d!=null&&m(e,["startTime"],d);const f=h(n,["endTime"]);f!=null&&m(e,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(e,["updateTime"],p);const _=h(n,["model"]);_!=null&&m(e,["model"],_);const E=h(n,["inputConfig"]);E!=null&&m(e,["src"],xO(E));const T=h(n,["outputConfig"]);T!=null&&m(e,["dest"],RO(fx(T)));const C=h(n,["completionStats"]);return C!=null&&m(e,["completionStats"],C),e}function xO(n){const e={},t=h(n,["instancesFormat"]);t!=null&&m(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&m(e,["gcsUri"],i);const s=h(n,["bigquerySource","inputUri"]);return s!=null&&m(e,["bigqueryUri"],s),e}function NO(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&m(t,["fileName"],i);const s=h(e,["inlinedRequests"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>s6(n,l))),m(t,["requests","requests"],a)}return t}function DO(n){const e={},t=h(n,["format"]);t!=null&&m(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&m(e,["gcsSource","uris"],i);const s=h(n,["bigqueryUri"]);if(s!=null&&m(e,["bigquerySource","inputUri"],s),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function MO(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function PO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],zl(n,i)),t}function kO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],zl(n,i)),t}function VO(n){const e={},t=h(n,["content"]);t!=null&&m(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&m(e,["citationMetadata"],LO(i));const s=h(n,["tokenCount"]);s!=null&&m(e,["tokenCount"],s);const a=h(n,["finishReason"]);a!=null&&m(e,["finishReason"],a);const l=h(n,["avgLogprobs"]);l!=null&&m(e,["avgLogprobs"],l);const d=h(n,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(n,["index"]);f!=null&&m(e,["index"],f);const p=h(n,["logprobsResult"]);p!=null&&m(e,["logprobsResult"],p);const _=h(n,["safetyRatings"]);if(_!=null){let T=_;Array.isArray(T)&&(T=T.map(C=>C)),m(e,["safetyRatings"],T)}const E=h(n,["urlContextMetadata"]);return E!=null&&m(e,["urlContextMetadata"],E),e}function LO(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),m(e,["citations"],i)}return e}function px(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>h6(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function UO(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&m(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function OO(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const s=h(n,["dest"]);return e!==void 0&&s!=null&&m(e,["outputConfig"],bO(CO(s))),t}function iC(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["src"]);s!=null&&m(t,["batch","inputConfig"],NO(n,dx(n,s)));const a=h(e,["config"]);return a!=null&&UO(a,t),t}function FO(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],Ze(n,i));const s=h(e,["src"]);s!=null&&m(t,["inputConfig"],DO(dx(n,s)));const a=h(e,["config"]);return a!=null&&OO(a,t),t}function BO(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&m(e,["batch","displayName"],i),t}function qO(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["src"]);s!=null&&m(t,["batch","inputConfig"],$O(n,s));const a=h(e,["config"]);return a!=null&&BO(a,t),t}function GO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],zl(n,i)),t}function zO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],zl(n,i)),t}function HO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);return a!=null&&m(e,["error"],a),e}function KO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);return a!=null&&m(e,["error"],a),e}function JO(n,e){const t={},i=h(e,["contents"]);if(i!=null){let a=iv(n,i);Array.isArray(a)&&(a=a.map(l=>l)),m(t,["requests[]","request","content"],a)}const s=h(e,["config"]);return s!=null&&(m(t,["_self"],YO(s,t)),zU(t,{"requests[].*":"requests[].request.*"})),t}function YO(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["requests[]","taskType"],i);const s=h(n,["title"]);e!==void 0&&s!=null&&m(e,["requests[]","title"],s);const a=h(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&m(e,["requests[]","outputDimensionality"],a),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function $O(n,e){const t={},i=h(e,["fileName"]);i!=null&&m(t,["file_name"],i);const s=h(e,["inlinedRequests"]);return s!=null&&m(t,["requests"],JO(n,s)),t}function QO(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function XO(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function WO(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function ZO(n,e,t){const i={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&m(t,["systemInstruction"],px(mn(s)));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&m(i,["topP"],l);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const T=h(e,["logprobs"]);T!=null&&m(i,["logprobs"],T);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&m(i,["frequencyPenalty"],P);const O=h(e,["seed"]);O!=null&&m(i,["seed"],O);const k=h(e,["responseMimeType"]);k!=null&&m(i,["responseMimeType"],k);const Q=h(e,["responseSchema"]);Q!=null&&m(i,["responseSchema"],rv(Q));const j=h(e,["responseJsonSchema"]);if(j!=null&&m(i,["responseJsonSchema"],j),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const X=h(e,["safetySettings"]);if(t!==void 0&&X!=null){let M=X;Array.isArray(M)&&(M=M.map(me=>p6(me))),m(t,["safetySettings"],M)}const se=h(e,["tools"]);if(t!==void 0&&se!=null){let M=Gl(se);Array.isArray(M)&&(M=M.map(me=>g6(ql(me)))),m(t,["tools"],M)}const le=h(e,["toolConfig"]);if(t!==void 0&&le!=null&&m(t,["toolConfig"],m6(le)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ue=h(e,["cachedContent"]);t!==void 0&&ue!=null&&m(t,["cachedContent"],Ur(n,ue));const N=h(e,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const D=h(e,["mediaResolution"]);D!=null&&m(i,["mediaResolution"],D);const x=h(e,["speechConfig"]);if(x!=null&&m(i,["speechConfig"],sv(x)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=h(e,["thinkingConfig"]);L!=null&&m(i,["thinkingConfig"],L);const V=h(e,["imageConfig"]);V!=null&&m(i,["imageConfig"],r6(V));const F=h(e,["enableEnhancedCivicAnswers"]);return F!=null&&m(i,["enableEnhancedCivicAnswers"],F),i}function jO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(p=>VO(p))),m(e,["candidates"],f)}const s=h(n,["modelVersion"]);s!=null&&m(e,["modelVersion"],s);const a=h(n,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const l=h(n,["responseId"]);l!=null&&m(e,["responseId"],l);const d=h(n,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function e6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],zl(n,i)),t}function t6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],zl(n,i)),t}function n6(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function i6(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function r6(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);if(i!=null&&m(e,["imageSize"],i),h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function s6(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["request","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let d=oi(s);Array.isArray(d)&&(d=d.map(f=>px(f))),m(t,["request","contents"],d)}const a=h(e,["metadata"]);a!=null&&m(t,["metadata"],a);const l=h(e,["config"]);return l!=null&&m(t,["request","generationConfig"],ZO(n,l,h(t,["request"],{}))),t}function o6(n){const e={},t=h(n,["response"]);t!=null&&m(e,["response"],jO(t));const i=h(n,["error"]);return i!=null&&m(e,["error"],i),e}function a6(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);if(e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function l6(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);e!==void 0&&s!=null&&m(e,["_query","pageToken"],s);const a=h(n,["filter"]);return e!==void 0&&a!=null&&m(e,["_query","filter"],a),t}function u6(n){const e={},t=h(n,["config"]);return t!=null&&a6(t,e),e}function c6(n){const e={},t=h(n,["config"]);return t!=null&&l6(t,e),e}function d6(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["operations"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>ch(l))),m(e,["batchJobs"],a)}return e}function f6(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["batchPredictionJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>ky(l))),m(e,["batchJobs"],a)}return e}function h6(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],QO(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],XO(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],MO(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function p6(n){const e={},t=h(n,["category"]);if(t!=null&&m(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=h(n,["threshold"]);return i!=null&&m(e,["threshold"],i),e}function m6(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],WO(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function g6(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],n6(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],i6(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Dr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Dr||(Dr={}));class Wo{constructor(e,t,i,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,s)}init(e,t,i){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!i||Object.keys(i).length===0?l={config:{}}:typeof i=="object"?l=Object.assign({},i):l=i,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class y6 extends Lr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wo(Dr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=iC(this.apiClient,e),i=t._url,s=pe("{model}:batchGenerateContent",i),d=t.batch.inputConfig.requests,f=d.requests,p=[];for(const _ of f){const E=Object.assign({},_);if(E.systemInstruction){const T=E.systemInstruction;delete E.systemInstruction;const C=E.request;C.systemInstruction=T,E.request=C}p.push(E)}return d.requests=p,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},s=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${s}`),i.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?i.dest=`${a.slice(0,-6)}/dest`:i.dest=`${a}_dest_${s}`;else if(l)i.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=FO(this.apiClient,e);return d=pe("batchPredictionJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>ky(_))}else{const p=iC(this.apiClient,e);return d=pe("{model}:batchGenerateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>ch(_))}}async createEmbeddingsInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=qO(this.apiClient,e);return a=pe("{model}:asyncBatchEmbedContent",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>ch(f))}}async get(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=t6(this.apiClient,e);return d=pe("batchPredictionJobs/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>ky(_))}else{const p=e6(this.apiClient,e);return d=pe("batches/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>ch(_))}}async cancel(e){var t,i,s,a;let l="",d={};if(this.apiClient.isVertexAI()){const f=kO(this.apiClient,e);l=pe("batchPredictionJobs/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const f=PO(this.apiClient,e);l=pe("batches/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=c6(e);return d=pe("batchPredictionJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=f6(_),T=new jI;return Object.assign(T,E),T})}else{const p=u6(e);return d=pe("batches",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=d6(_),T=new jI;return Object.assign(T,E),T})}}async delete(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=zO(this.apiClient,e);return d=pe("batchPredictionJobs/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>KO(_))}else{const p=GO(this.apiClient,e);return d=pe("batches/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>HO(_))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _6(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function rC(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>q6(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function v6(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const s=h(n,["expireTime"]);e!==void 0&&s!=null&&m(e,["expireTime"],s);const a=h(n,["displayName"]);e!==void 0&&a!=null&&m(e,["displayName"],a);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let _=oi(l);Array.isArray(_)&&(_=_.map(E=>rC(E))),m(e,["contents"],_)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&m(e,["systemInstruction"],rC(mn(d)));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let _=f;Array.isArray(_)&&(_=_.map(E=>z6(E))),m(e,["tools"],_)}const p=h(n,["toolConfig"]);if(e!==void 0&&p!=null&&m(e,["toolConfig"],G6(p)),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function E6(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const s=h(n,["expireTime"]);e!==void 0&&s!=null&&m(e,["expireTime"],s);const a=h(n,["displayName"]);e!==void 0&&a!=null&&m(e,["displayName"],a);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let E=oi(l);Array.isArray(E)&&(E=E.map(T=>T)),m(e,["contents"],E)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&m(e,["systemInstruction"],mn(d));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let E=f;Array.isArray(E)&&(E=E.map(T=>H6(T))),m(e,["tools"],E)}const p=h(n,["toolConfig"]);e!==void 0&&p!=null&&m(e,["toolConfig"],p);const _=h(n,["kmsKeyName"]);return e!==void 0&&_!=null&&m(e,["encryption_spec","kmsKeyName"],_),t}function T6(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],nx(n,i));const s=h(e,["config"]);return s!=null&&v6(s,t),t}function A6(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],nx(n,i));const s=h(e,["config"]);return s!=null&&E6(s,t),t}function S6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Ur(n,i)),t}function I6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Ur(n,i)),t}function C6(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function w6(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function R6(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function b6(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function x6(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function N6(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["parameters"]);s!=null&&m(e,["parameters"],s);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&m(e,["response"],l);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function D6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Ur(n,i)),t}function M6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Ur(n,i)),t}function P6(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function k6(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function V6(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function L6(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function U6(n){const e={},t=h(n,["config"]);return t!=null&&V6(t,e),e}function O6(n){const e={},t=h(n,["config"]);return t!=null&&L6(t,e),e}function F6(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["cachedContents"],a)}return e}function B6(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["cachedContents"],a)}return e}function q6(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],R6(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],b6(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],_6(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function G6(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],x6(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function z6(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],P6(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],k6(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function H6(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(T=>N6(T))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const s=h(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function K6(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const s=h(n,["expireTime"]);return e!==void 0&&s!=null&&m(e,["expireTime"],s),t}function J6(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const s=h(n,["expireTime"]);return e!==void 0&&s!=null&&m(e,["expireTime"],s),t}function Y6(n,e){const t={},i=h(e,["name"]);i!=null&&m(t,["_url","name"],Ur(n,i));const s=h(e,["config"]);return s!=null&&K6(s,t),t}function $6(n,e){const t={},i=h(e,["name"]);i!=null&&m(t,["_url","name"],Ur(n,i));const s=h(e,["config"]);return s!=null&&J6(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Q6 extends Lr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wo(Dr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=A6(this.apiClient,e);return d=pe("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=T6(this.apiClient,e);return d=pe("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async get(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=M6(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=D6(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async delete(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=I6(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=w6(_),T=new WI;return Object.assign(T,E),T})}else{const p=S6(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=C6(_),T=new WI;return Object.assign(T,E),T})}}async update(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=$6(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=Y6(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async listInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=O6(e);return d=pe("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=B6(_),T=new ZI;return Object.assign(T,E),T})}else{const p=U6(e);return d=pe("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=F6(_),T=new ZI;return Object.assign(T,E),T})}}}function Gh(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function sC(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function De(n){return this instanceof De?(this.v=n,this):new De(n)}function Ai(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(C){return function(P){return Promise.resolve(P).then(C,E)}}function d(C,P){i[C]&&(s[C]=function(O){return new Promise(function(k,Q){a.push([C,O,k,Q])>1||f(C,O)})},P&&(s[C]=P(s[C])))}function f(C,P){try{p(i[C](P))}catch(O){T(a[0][3],O)}}function p(C){C.value instanceof De?Promise.resolve(C.value.v).then(_,E):T(a[0][2],C)}function _(C){f("next",C)}function E(C){f("throw",C)}function T(C,P){C(P),a.shift(),a.length&&f(a[0][0],a[0][1])}}function Si(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof sC=="function"?sC(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(l){return new Promise(function(d,f){l=n[a](l),s(d,f,l.done,l.value)})}}function s(a,l,d,f){Promise.resolve(f).then(function(p){a({value:p,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function X6(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:mx(t)}function mx(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function W6(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function oC(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const s=[];let a=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),a&&!mx(n[i])&&(a=!1),i++;a?e.push(...s):e.pop()}return e}class Z6{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new j6(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class j6{constructor(e,t,i,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),W6(a)}async sendMessage(e){var t;await this.sendPromise;const i=mn(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,d;const f=await s,p=(l=(a=f.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,_=f.automaticFunctionCallingHistory,E=this.getHistory(!0).length;let T=[];_!=null&&(T=(d=_.slice(E))!==null&&d!==void 0?d:[]);const C=p?[p]:[];this.recordHistory(i,C,T)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const i=mn(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?oC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Ai(this,arguments,function*(){var s,a,l,d,f,p;const _=[];try{for(var E=!0,T=Si(e),C;C=yield De(T.next()),s=C.done,!s;E=!0){d=C.value,E=!1;const P=d;if(X6(P)){const O=(p=(f=P.candidates)===null||f===void 0?void 0:f[0])===null||p===void 0?void 0:p.content;O!==void 0&&_.push(O)}yield yield De(P)}}catch(P){a={error:P}}finally{try{!E&&!s&&(l=T.return)&&(yield De(l.call(T)))}finally{if(a)throw a.error}}this.recordHistory(t,_)})}recordHistory(e,t,i){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...oC(i)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gp extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,gp.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function e3(n){const e={},t=h(n,["file"]);return t!=null&&m(e,["file"],t),e}function t3(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function n3(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","file"],lx(t)),e}function i3(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function r3(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","file"],lx(t)),e}function s3(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function o3(n){const e={},t=h(n,["config"]);return t!=null&&s3(t,e),e}function a3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class l3 extends Lr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wo(Dr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=o3(e);return a=pe("files",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=a3(f),_=new fO;return Object.assign(_,p),_})}}async createInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=e3(e);return a=pe("upload/v1beta/files",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=t3(f),_=new hO;return Object.assign(_,p),_})}}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=r3(e);return a=pe("files/{file}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=n3(e);return a=pe("files/{file}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=i3(f),_=new pO;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dh(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function u3(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>C3(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function c3(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function d3(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function f3(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["parameters"]);s!=null&&m(e,["parameters"],s);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&m(e,["response"],l);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function h3(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const i=h(n,["responseJsonSchema"]);i!=null&&m(e,["responseJsonSchema"],i);const s=h(n,["audioTimestamp"]);s!=null&&m(e,["audioTimestamp"],s);const a=h(n,["candidateCount"]);a!=null&&m(e,["candidateCount"],a);const l=h(n,["enableAffectiveDialog"]);l!=null&&m(e,["enableAffectiveDialog"],l);const d=h(n,["frequencyPenalty"]);d!=null&&m(e,["frequencyPenalty"],d);const f=h(n,["logprobs"]);f!=null&&m(e,["logprobs"],f);const p=h(n,["maxOutputTokens"]);p!=null&&m(e,["maxOutputTokens"],p);const _=h(n,["mediaResolution"]);_!=null&&m(e,["mediaResolution"],_);const E=h(n,["presencePenalty"]);E!=null&&m(e,["presencePenalty"],E);const T=h(n,["responseLogprobs"]);T!=null&&m(e,["responseLogprobs"],T);const C=h(n,["responseMimeType"]);C!=null&&m(e,["responseMimeType"],C);const P=h(n,["responseModalities"]);P!=null&&m(e,["responseModalities"],P);const O=h(n,["responseSchema"]);O!=null&&m(e,["responseSchema"],O);const k=h(n,["routingConfig"]);k!=null&&m(e,["routingConfig"],k);const Q=h(n,["seed"]);Q!=null&&m(e,["seed"],Q);const j=h(n,["speechConfig"]);j!=null&&m(e,["speechConfig"],j);const X=h(n,["stopSequences"]);X!=null&&m(e,["stopSequences"],X);const se=h(n,["temperature"]);se!=null&&m(e,["temperature"],se);const le=h(n,["thinkingConfig"]);le!=null&&m(e,["thinkingConfig"],le);const ue=h(n,["topK"]);ue!=null&&m(e,["topK"],ue);const N=h(n,["topP"]);if(N!=null&&m(e,["topP"],N),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function p3(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function m3(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function g3(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],i);const s=h(n,["responseModalities"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","responseModalities"],s);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],ov(E));const T=h(n,["thinkingConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","thinkingConfig"],T);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&m(e,["setup","systemInstruction"],u3(mn(P)));const O=h(n,["tools"]);if(e!==void 0&&O!=null){let ue=Gl(O);Array.isArray(ue)&&(ue=ue.map(N=>R3(ql(N)))),m(e,["setup","tools"],ue)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&m(e,["setup","sessionResumption"],w3(k));const Q=h(n,["inputAudioTranscription"]);e!==void 0&&Q!=null&&m(e,["setup","inputAudioTranscription"],Q);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const X=h(n,["realtimeInputConfig"]);e!==void 0&&X!=null&&m(e,["setup","realtimeInputConfig"],X);const se=h(n,["contextWindowCompression"]);e!==void 0&&se!=null&&m(e,["setup","contextWindowCompression"],se);const le=h(n,["proactivity"]);if(e!==void 0&&le!=null&&m(e,["setup","proactivity"],le),h(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function y3(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],h3(i));const s=h(n,["responseModalities"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","responseModalities"],s);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],ov(E));const T=h(n,["thinkingConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","thinkingConfig"],T);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&m(e,["setup","systemInstruction"],mn(P));const O=h(n,["tools"]);if(e!==void 0&&O!=null){let N=Gl(O);Array.isArray(N)&&(N=N.map(D=>b3(ql(D)))),m(e,["setup","tools"],N)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&m(e,["setup","sessionResumption"],k);const Q=h(n,["inputAudioTranscription"]);e!==void 0&&Q!=null&&m(e,["setup","inputAudioTranscription"],Q);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const X=h(n,["realtimeInputConfig"]);e!==void 0&&X!=null&&m(e,["setup","realtimeInputConfig"],X);const se=h(n,["contextWindowCompression"]);e!==void 0&&se!=null&&m(e,["setup","contextWindowCompression"],se);const le=h(n,["proactivity"]);e!==void 0&&le!=null&&m(e,["setup","proactivity"],le);const ue=h(n,["explicitVadSignal"]);return e!==void 0&&ue!=null&&m(e,["setup","explicitVadSignal"],ue),t}function _3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Ze(n,i));const s=h(e,["config"]);return s!=null&&m(t,["config"],g3(s,t)),t}function v3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Ze(n,i));const s=h(e,["config"]);return s!=null&&m(t,["config"],y3(s,t)),t}function E3(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&m(e,["musicGenerationConfig"],t),e}function T3(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),m(e,["weightedPrompts"],i)}return e}function A3(n){const e={},t=h(n,["media"]);if(t!=null){let p=ix(t);Array.isArray(p)&&(p=p.map(_=>dh(_))),m(e,["mediaChunks"],p)}const i=h(n,["audio"]);i!=null&&m(e,["audio"],dh(sx(i)));const s=h(n,["audioStreamEnd"]);s!=null&&m(e,["audioStreamEnd"],s);const a=h(n,["video"]);a!=null&&m(e,["video"],dh(rx(a)));const l=h(n,["text"]);l!=null&&m(e,["text"],l);const d=h(n,["activityStart"]);d!=null&&m(e,["activityStart"],d);const f=h(n,["activityEnd"]);return f!=null&&m(e,["activityEnd"],f),e}function S3(n){const e={},t=h(n,["media"]);if(t!=null){let p=ix(t);Array.isArray(p)&&(p=p.map(_=>_)),m(e,["mediaChunks"],p)}const i=h(n,["audio"]);i!=null&&m(e,["audio"],sx(i));const s=h(n,["audioStreamEnd"]);s!=null&&m(e,["audioStreamEnd"],s);const a=h(n,["video"]);a!=null&&m(e,["video"],rx(a));const l=h(n,["text"]);l!=null&&m(e,["text"],l);const d=h(n,["activityStart"]);d!=null&&m(e,["activityStart"],d);const f=h(n,["activityEnd"]);return f!=null&&m(e,["activityEnd"],f),e}function I3(n){const e={},t=h(n,["setupComplete"]);t!=null&&m(e,["setupComplete"],t);const i=h(n,["serverContent"]);i!=null&&m(e,["serverContent"],i);const s=h(n,["toolCall"]);s!=null&&m(e,["toolCall"],s);const a=h(n,["toolCallCancellation"]);a!=null&&m(e,["toolCallCancellation"],a);const l=h(n,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],x3(l));const d=h(n,["goAway"]);d!=null&&m(e,["goAway"],d);const f=h(n,["sessionResumptionUpdate"]);f!=null&&m(e,["sessionResumptionUpdate"],f);const p=h(n,["voiceActivityDetectionSignal"]);return p!=null&&m(e,["voiceActivityDetectionSignal"],p),e}function C3(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],c3(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],d3(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],dh(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function w3(n){const e={},t=h(n,["handle"]);if(t!=null&&m(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function R3(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],p3(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],m3(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function b3(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(T=>f3(T))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const s=h(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function x3(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&m(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&m(e,["cachedContentTokenCount"],i);const s=h(n,["candidatesTokenCount"]);s!=null&&m(e,["responseTokenCount"],s);const a=h(n,["toolUsePromptTokenCount"]);a!=null&&m(e,["toolUsePromptTokenCount"],a);const l=h(n,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const d=h(n,["totalTokenCount"]);d!=null&&m(e,["totalTokenCount"],d);const f=h(n,["promptTokensDetails"]);if(f!=null){let C=f;Array.isArray(C)&&(C=C.map(P=>P)),m(e,["promptTokensDetails"],C)}const p=h(n,["cacheTokensDetails"]);if(p!=null){let C=p;Array.isArray(C)&&(C=C.map(P=>P)),m(e,["cacheTokensDetails"],C)}const _=h(n,["candidatesTokensDetails"]);if(_!=null){let C=_;Array.isArray(C)&&(C=C.map(P=>P)),m(e,["responseTokensDetails"],C)}const E=h(n,["toolUsePromptTokensDetails"]);if(E!=null){let C=E;Array.isArray(C)&&(C=C.map(P=>P)),m(e,["toolUsePromptTokensDetails"],C)}const T=h(n,["trafficType"]);return T!=null&&m(e,["trafficType"],T),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N3(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function D3(n){const e={},t=h(n,["content"]);t!=null&&m(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&m(e,["citationMetadata"],M3(i));const s=h(n,["tokenCount"]);s!=null&&m(e,["tokenCount"],s);const a=h(n,["finishReason"]);a!=null&&m(e,["finishReason"],a);const l=h(n,["avgLogprobs"]);l!=null&&m(e,["avgLogprobs"],l);const d=h(n,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(n,["index"]);f!=null&&m(e,["index"],f);const p=h(n,["logprobsResult"]);p!=null&&m(e,["logprobsResult"],p);const _=h(n,["safetyRatings"]);if(_!=null){let T=_;Array.isArray(T)&&(T=T.map(C=>C)),m(e,["safetyRatings"],T)}const E=h(n,["urlContextMetadata"]);return E!=null&&m(e,["urlContextMetadata"],E),e}function M3(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),m(e,["citations"],i)}return e}function P3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let a=oi(s);Array.isArray(a)&&(a=a.map(l=>l)),m(t,["contents"],a)}return t}function k3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["tokensInfo"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),m(e,["tokensInfo"],s)}return e}function V3(n){const e={},t=h(n,["values"]);t!=null&&m(e,["values"],t);const i=h(n,["statistics"]);return i!=null&&m(e,["statistics"],L3(i)),e}function L3(n){const e={},t=h(n,["truncated"]);t!=null&&m(e,["truncated"],t);const i=h(n,["token_count"]);return i!=null&&m(e,["tokenCount"],i),e}function yp(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>KF(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function U3(n){const e={},t=h(n,["controlType"]);t!=null&&m(e,["controlType"],t);const i=h(n,["enableControlImageComputation"]);return i!=null&&m(e,["computeControl"],i),e}function O3(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function F3(n,e){const t={},i=h(n,["systemInstruction"]);e!==void 0&&i!=null&&m(e,["systemInstruction"],mn(i));const s=h(n,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(d=>vx(d))),m(e,["tools"],l)}const a=h(n,["generationConfig"]);return e!==void 0&&a!=null&&m(e,["generationConfig"],NF(a)),t}function B3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=oi(s);Array.isArray(l)&&(l=l.map(d=>yp(d))),m(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&O3(a),t}function q3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=oi(s);Array.isArray(l)&&(l=l.map(d=>d)),m(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&F3(a,t),t}function G3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);i!=null&&m(e,["totalTokens"],i);const s=h(n,["cachedContentTokenCount"]);return s!=null&&m(e,["cachedContentTokenCount"],s),e}function z3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);return i!=null&&m(e,["totalTokens"],i),e}function H3(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],Ze(n,i)),t}function K3(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],Ze(n,i)),t}function J3(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function Y3(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function $3(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const s=h(n,["negativePrompt"]);e!==void 0&&s!=null&&m(e,["parameters","negativePrompt"],s);const a=h(n,["numberOfImages"]);e!==void 0&&a!=null&&m(e,["parameters","sampleCount"],a);const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&m(e,["parameters","guidanceScale"],d);const f=h(n,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const p=h(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&m(e,["parameters","safetySetting"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&m(e,["parameters","includeSafetyAttributes"],E);const T=h(n,["includeRaiReason"]);e!==void 0&&T!=null&&m(e,["parameters","includeRaiReason"],T);const C=h(n,["language"]);e!==void 0&&C!=null&&m(e,["parameters","language"],C);const P=h(n,["outputMimeType"]);e!==void 0&&P!=null&&m(e,["parameters","outputOptions","mimeType"],P);const O=h(n,["outputCompressionQuality"]);e!==void 0&&O!=null&&m(e,["parameters","outputOptions","compressionQuality"],O);const k=h(n,["addWatermark"]);e!==void 0&&k!=null&&m(e,["parameters","addWatermark"],k);const Q=h(n,["labels"]);e!==void 0&&Q!=null&&m(e,["labels"],Q);const j=h(n,["editMode"]);e!==void 0&&j!=null&&m(e,["parameters","editMode"],j);const X=h(n,["baseSteps"]);return e!==void 0&&X!=null&&m(e,["parameters","editConfig","baseSteps"],X),t}function Q3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["referenceImages"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(f=>WF(f))),m(t,["instances[0]","referenceImages"],d)}const l=h(e,["config"]);return l!=null&&$3(l,t),t}function X3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>_p(a))),m(e,["generatedImages"],s)}return e}function W3(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["requests[]","taskType"],i);const s=h(n,["title"]);e!==void 0&&s!=null&&m(e,["requests[]","title"],s);const a=h(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&m(e,["requests[]","outputDimensionality"],a),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Z3(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["instances[]","task_type"],i);const s=h(n,["title"]);e!==void 0&&s!=null&&m(e,["instances[]","title"],s);const a=h(n,["outputDimensionality"]);e!==void 0&&a!=null&&m(e,["parameters","outputDimensionality"],a);const l=h(n,["mimeType"]);e!==void 0&&l!=null&&m(e,["instances[]","mimeType"],l);const d=h(n,["autoTruncate"]);return e!==void 0&&d!=null&&m(e,["parameters","autoTruncate"],d),t}function j3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let d=iv(n,s);Array.isArray(d)&&(d=d.map(f=>f)),m(t,["requests[]","content"],d)}const a=h(e,["config"]);a!=null&&W3(a,t);const l=h(e,["model"]);return l!==void 0&&m(t,["requests[]","model"],Ze(n,l)),t}function eF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=iv(n,s);Array.isArray(l)&&(l=l.map(d=>d)),m(t,["instances[]","content"],l)}const a=h(e,["config"]);return a!=null&&Z3(a,t),t}function tF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["embeddings"],a)}const s=h(n,["metadata"]);return s!=null&&m(e,["metadata"],s),e}function nF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions[]","embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>V3(l))),m(e,["embeddings"],a)}const s=h(n,["metadata"]);return s!=null&&m(e,["metadata"],s),e}function iF(n){const e={},t=h(n,["endpoint"]);t!=null&&m(e,["name"],t);const i=h(n,["deployedModelId"]);return i!=null&&m(e,["deployedModelId"],i),e}function rF(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function sF(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function oF(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function aF(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["parameters"]);s!=null&&m(e,["parameters"],s);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&m(e,["response"],l);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function lF(n,e,t){const i={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&m(t,["systemInstruction"],yp(mn(s)));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&m(i,["topP"],l);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const T=h(e,["logprobs"]);T!=null&&m(i,["logprobs"],T);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&m(i,["frequencyPenalty"],P);const O=h(e,["seed"]);O!=null&&m(i,["seed"],O);const k=h(e,["responseMimeType"]);k!=null&&m(i,["responseMimeType"],k);const Q=h(e,["responseSchema"]);Q!=null&&m(i,["responseSchema"],rv(Q));const j=h(e,["responseJsonSchema"]);if(j!=null&&m(i,["responseJsonSchema"],j),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const X=h(e,["safetySettings"]);if(t!==void 0&&X!=null){let M=X;Array.isArray(M)&&(M=M.map(me=>ZF(me))),m(t,["safetySettings"],M)}const se=h(e,["tools"]);if(t!==void 0&&se!=null){let M=Gl(se);Array.isArray(M)&&(M=M.map(me=>s5(ql(me)))),m(t,["tools"],M)}const le=h(e,["toolConfig"]);if(t!==void 0&&le!=null&&m(t,["toolConfig"],r5(le)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ue=h(e,["cachedContent"]);t!==void 0&&ue!=null&&m(t,["cachedContent"],Ur(n,ue));const N=h(e,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const D=h(e,["mediaResolution"]);D!=null&&m(i,["mediaResolution"],D);const x=h(e,["speechConfig"]);if(x!=null&&m(i,["speechConfig"],sv(x)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=h(e,["thinkingConfig"]);L!=null&&m(i,["thinkingConfig"],L);const V=h(e,["imageConfig"]);V!=null&&m(i,["imageConfig"],VF(V));const F=h(e,["enableEnhancedCivicAnswers"]);return F!=null&&m(i,["enableEnhancedCivicAnswers"],F),i}function uF(n,e,t){const i={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&m(t,["systemInstruction"],mn(s));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&m(i,["topP"],l);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const T=h(e,["logprobs"]);T!=null&&m(i,["logprobs"],T);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&m(i,["frequencyPenalty"],P);const O=h(e,["seed"]);O!=null&&m(i,["seed"],O);const k=h(e,["responseMimeType"]);k!=null&&m(i,["responseMimeType"],k);const Q=h(e,["responseSchema"]);Q!=null&&m(i,["responseSchema"],rv(Q));const j=h(e,["responseJsonSchema"]);j!=null&&m(i,["responseJsonSchema"],j);const X=h(e,["routingConfig"]);X!=null&&m(i,["routingConfig"],X);const se=h(e,["modelSelectionConfig"]);se!=null&&m(i,["modelConfig"],se);const le=h(e,["safetySettings"]);if(t!==void 0&&le!=null){let Y=le;Array.isArray(Y)&&(Y=Y.map(oe=>oe)),m(t,["safetySettings"],Y)}const ue=h(e,["tools"]);if(t!==void 0&&ue!=null){let Y=Gl(ue);Array.isArray(Y)&&(Y=Y.map(oe=>vx(ql(oe)))),m(t,["tools"],Y)}const N=h(e,["toolConfig"]);t!==void 0&&N!=null&&m(t,["toolConfig"],N);const D=h(e,["labels"]);t!==void 0&&D!=null&&m(t,["labels"],D);const x=h(e,["cachedContent"]);t!==void 0&&x!=null&&m(t,["cachedContent"],Ur(n,x));const L=h(e,["responseModalities"]);L!=null&&m(i,["responseModalities"],L);const V=h(e,["mediaResolution"]);V!=null&&m(i,["mediaResolution"],V);const F=h(e,["speechConfig"]);F!=null&&m(i,["speechConfig"],sv(F));const M=h(e,["audioTimestamp"]);M!=null&&m(i,["audioTimestamp"],M);const me=h(e,["thinkingConfig"]);me!=null&&m(i,["thinkingConfig"],me);const Te=h(e,["imageConfig"]);if(Te!=null&&m(i,["imageConfig"],LF(Te)),h(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i}function aC(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=oi(s);Array.isArray(l)&&(l=l.map(d=>yp(d))),m(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&m(t,["generationConfig"],lF(n,a,t)),t}function lC(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=oi(s);Array.isArray(l)&&(l=l.map(d=>d)),m(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&m(t,["generationConfig"],uF(n,a,t)),t}function uC(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(p=>D3(p))),m(e,["candidates"],f)}const s=h(n,["modelVersion"]);s!=null&&m(e,["modelVersion"],s);const a=h(n,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const l=h(n,["responseId"]);l!=null&&m(e,["responseId"],l);const d=h(n,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function cC(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(_=>_)),m(e,["candidates"],p)}const s=h(n,["createTime"]);s!=null&&m(e,["createTime"],s);const a=h(n,["modelVersion"]);a!=null&&m(e,["modelVersion"],a);const l=h(n,["promptFeedback"]);l!=null&&m(e,["promptFeedback"],l);const d=h(n,["responseId"]);d!=null&&m(e,["responseId"],d);const f=h(n,["usageMetadata"]);return f!=null&&m(e,["usageMetadata"],f),e}function cF(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const s=h(n,["aspectRatio"]);e!==void 0&&s!=null&&m(e,["parameters","aspectRatio"],s);const a=h(n,["guidanceScale"]);if(e!==void 0&&a!=null&&m(e,["parameters","guidanceScale"],a),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const d=h(n,["personGeneration"]);e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d);const f=h(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&m(e,["parameters","includeSafetyAttributes"],f);const p=h(n,["includeRaiReason"]);e!==void 0&&p!=null&&m(e,["parameters","includeRaiReason"],p);const _=h(n,["language"]);e!==void 0&&_!=null&&m(e,["parameters","language"],_);const E=h(n,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const T=h(n,["outputCompressionQuality"]);if(e!==void 0&&T!=null&&m(e,["parameters","outputOptions","compressionQuality"],T),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const C=h(n,["imageSize"]);if(e!==void 0&&C!=null&&m(e,["parameters","sampleImageSize"],C),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function dF(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const s=h(n,["negativePrompt"]);e!==void 0&&s!=null&&m(e,["parameters","negativePrompt"],s);const a=h(n,["numberOfImages"]);e!==void 0&&a!=null&&m(e,["parameters","sampleCount"],a);const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&m(e,["parameters","guidanceScale"],d);const f=h(n,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const p=h(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&m(e,["parameters","safetySetting"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&m(e,["parameters","includeSafetyAttributes"],E);const T=h(n,["includeRaiReason"]);e!==void 0&&T!=null&&m(e,["parameters","includeRaiReason"],T);const C=h(n,["language"]);e!==void 0&&C!=null&&m(e,["parameters","language"],C);const P=h(n,["outputMimeType"]);e!==void 0&&P!=null&&m(e,["parameters","outputOptions","mimeType"],P);const O=h(n,["outputCompressionQuality"]);e!==void 0&&O!=null&&m(e,["parameters","outputOptions","compressionQuality"],O);const k=h(n,["addWatermark"]);e!==void 0&&k!=null&&m(e,["parameters","addWatermark"],k);const Q=h(n,["labels"]);e!==void 0&&Q!=null&&m(e,["labels"],Q);const j=h(n,["imageSize"]);e!==void 0&&j!=null&&m(e,["parameters","sampleImageSize"],j);const X=h(n,["enhancePrompt"]);return e!==void 0&&X!=null&&m(e,["parameters","enhancePrompt"],X),t}function fF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["config"]);return a!=null&&cF(a,t),t}function hF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["config"]);return a!=null&&dF(a,t),t}function pF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>wF(l))),m(e,["generatedImages"],a)}const s=h(n,["positivePromptSafetyAttributes"]);return s!=null&&m(e,["positivePromptSafetyAttributes"],yx(s)),e}function mF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>_p(l))),m(e,["generatedImages"],a)}const s=h(n,["positivePromptSafetyAttributes"]);return s!=null&&m(e,["positivePromptSafetyAttributes"],_x(s)),e}function gF(n,e){const t={},i=h(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=h(n,["durationSeconds"]);if(e!==void 0&&s!=null&&m(e,["parameters","durationSeconds"],s),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=h(n,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const l=h(n,["resolution"]);e!==void 0&&l!=null&&m(e,["parameters","resolution"],l);const d=h(n,["personGeneration"]);if(e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=h(n,["negativePrompt"]);e!==void 0&&f!=null&&m(e,["parameters","negativePrompt"],f);const p=h(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&m(e,["parameters","enhancePrompt"],p),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const _=h(n,["lastFrame"]);e!==void 0&&_!=null&&m(e,["instances[0]","lastFrame"],vp(_));const E=h(n,["referenceImages"]);if(e!==void 0&&E!=null){let T=E;Array.isArray(T)&&(T=T.map(C=>_5(C))),m(e,["instances[0]","referenceImages"],T)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function yF(n,e){const t={},i=h(n,["numberOfVideos"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const s=h(n,["outputGcsUri"]);e!==void 0&&s!=null&&m(e,["parameters","storageUri"],s);const a=h(n,["fps"]);e!==void 0&&a!=null&&m(e,["parameters","fps"],a);const l=h(n,["durationSeconds"]);e!==void 0&&l!=null&&m(e,["parameters","durationSeconds"],l);const d=h(n,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(n,["aspectRatio"]);e!==void 0&&f!=null&&m(e,["parameters","aspectRatio"],f);const p=h(n,["resolution"]);e!==void 0&&p!=null&&m(e,["parameters","resolution"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["pubsubTopic"]);e!==void 0&&E!=null&&m(e,["parameters","pubsubTopic"],E);const T=h(n,["negativePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","negativePrompt"],T);const C=h(n,["enhancePrompt"]);e!==void 0&&C!=null&&m(e,["parameters","enhancePrompt"],C);const P=h(n,["generateAudio"]);e!==void 0&&P!=null&&m(e,["parameters","generateAudio"],P);const O=h(n,["lastFrame"]);e!==void 0&&O!=null&&m(e,["instances[0]","lastFrame"],Ci(O));const k=h(n,["referenceImages"]);if(e!==void 0&&k!=null){let X=k;Array.isArray(X)&&(X=X.map(se=>v5(se))),m(e,["instances[0]","referenceImages"],X)}const Q=h(n,["mask"]);e!==void 0&&Q!=null&&m(e,["instances[0]","mask"],y5(Q));const j=h(n,["compressionQuality"]);return e!==void 0&&j!=null&&m(e,["parameters","compressionQuality"],j),t}function _F(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],AF(l)),e}function vF(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],SF(l)),e}function EF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["image"]);a!=null&&m(t,["instances[0]","image"],vp(a));const l=h(e,["video"]);l!=null&&m(t,["instances[0]","video"],Ex(l));const d=h(e,["source"]);d!=null&&IF(d,t);const f=h(e,["config"]);return f!=null&&gF(f,t),t}function TF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["image"]);a!=null&&m(t,["instances[0]","image"],Ci(a));const l=h(e,["video"]);l!=null&&m(t,["instances[0]","video"],Tx(l));const d=h(e,["source"]);d!=null&&CF(d,t);const f=h(e,["config"]);return f!=null&&yF(f,t),t}function AF(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>bF(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const s=h(n,["raiMediaFilteredReasons"]);return s!=null&&m(e,["raiMediaFilteredReasons"],s),e}function SF(n){const e={},t=h(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>xF(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const s=h(n,["raiMediaFilteredReasons"]);return s!=null&&m(e,["raiMediaFilteredReasons"],s),e}function IF(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const s=h(n,["image"]);e!==void 0&&s!=null&&m(e,["instances[0]","image"],vp(s));const a=h(n,["video"]);return e!==void 0&&a!=null&&m(e,["instances[0]","video"],Ex(a)),t}function CF(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const s=h(n,["image"]);e!==void 0&&s!=null&&m(e,["instances[0]","image"],Ci(s));const a=h(n,["video"]);return e!==void 0&&a!=null&&m(e,["instances[0]","video"],Tx(a)),t}function wF(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["image"],UF(t));const i=h(n,["raiFilteredReason"]);i!=null&&m(e,["raiFilteredReason"],i);const s=h(n,["_self"]);return s!=null&&m(e,["safetyAttributes"],yx(s)),e}function _p(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["image"],gx(t));const i=h(n,["raiFilteredReason"]);i!=null&&m(e,["raiFilteredReason"],i);const s=h(n,["_self"]);s!=null&&m(e,["safetyAttributes"],_x(s));const a=h(n,["prompt"]);return a!=null&&m(e,["enhancedPrompt"],a),e}function RF(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["mask"],gx(t));const i=h(n,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),m(e,["labels"],s)}return e}function bF(n){const e={},t=h(n,["video"]);return t!=null&&m(e,["video"],m5(t)),e}function xF(n){const e={},t=h(n,["_self"]);return t!=null&&m(e,["video"],g5(t)),e}function NF(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const i=h(n,["responseJsonSchema"]);i!=null&&m(e,["responseJsonSchema"],i);const s=h(n,["audioTimestamp"]);s!=null&&m(e,["audioTimestamp"],s);const a=h(n,["candidateCount"]);a!=null&&m(e,["candidateCount"],a);const l=h(n,["enableAffectiveDialog"]);l!=null&&m(e,["enableAffectiveDialog"],l);const d=h(n,["frequencyPenalty"]);d!=null&&m(e,["frequencyPenalty"],d);const f=h(n,["logprobs"]);f!=null&&m(e,["logprobs"],f);const p=h(n,["maxOutputTokens"]);p!=null&&m(e,["maxOutputTokens"],p);const _=h(n,["mediaResolution"]);_!=null&&m(e,["mediaResolution"],_);const E=h(n,["presencePenalty"]);E!=null&&m(e,["presencePenalty"],E);const T=h(n,["responseLogprobs"]);T!=null&&m(e,["responseLogprobs"],T);const C=h(n,["responseMimeType"]);C!=null&&m(e,["responseMimeType"],C);const P=h(n,["responseModalities"]);P!=null&&m(e,["responseModalities"],P);const O=h(n,["responseSchema"]);O!=null&&m(e,["responseSchema"],O);const k=h(n,["routingConfig"]);k!=null&&m(e,["routingConfig"],k);const Q=h(n,["seed"]);Q!=null&&m(e,["seed"],Q);const j=h(n,["speechConfig"]);j!=null&&m(e,["speechConfig"],j);const X=h(n,["stopSequences"]);X!=null&&m(e,["stopSequences"],X);const se=h(n,["temperature"]);se!=null&&m(e,["temperature"],se);const le=h(n,["thinkingConfig"]);le!=null&&m(e,["thinkingConfig"],le);const ue=h(n,["topK"]);ue!=null&&m(e,["topK"],ue);const N=h(n,["topP"]);if(N!=null&&m(e,["topP"],N),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function DF(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],Ze(n,i)),t}function MF(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],Ze(n,i)),t}function PF(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function kF(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function VF(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);if(i!=null&&m(e,["imageSize"],i),h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function LF(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);i!=null&&m(e,["imageSize"],i);const s=h(n,["outputMimeType"]);s!=null&&m(e,["imageOutputOptions","mimeType"],s);const a=h(n,["outputCompressionQuality"]);return a!=null&&m(e,["imageOutputOptions","compressionQuality"],a),e}function UF(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&m(e,["imageBytes"],zs(t));const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function gx(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["imageBytes"],zs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function vp(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&m(e,["bytesBase64Encoded"],zs(t));const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function Ci(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["imageBytes"]);i!=null&&m(e,["bytesBase64Encoded"],zs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function OF(n,e,t){const i={},s=h(e,["pageSize"]);t!==void 0&&s!=null&&m(t,["_query","pageSize"],s);const a=h(e,["pageToken"]);t!==void 0&&a!=null&&m(t,["_query","pageToken"],a);const l=h(e,["filter"]);t!==void 0&&l!=null&&m(t,["_query","filter"],l);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&m(t,["_url","models_url"],ux(n,d)),i}function FF(n,e,t){const i={},s=h(e,["pageSize"]);t!==void 0&&s!=null&&m(t,["_query","pageSize"],s);const a=h(e,["pageToken"]);t!==void 0&&a!=null&&m(t,["_query","pageToken"],a);const l=h(e,["filter"]);t!==void 0&&l!=null&&m(t,["_query","filter"],l);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&m(t,["_url","models_url"],ux(n,d)),i}function BF(n,e){const t={},i=h(e,["config"]);return i!=null&&OF(n,i,t),t}function qF(n,e){const t={},i=h(e,["config"]);return i!=null&&FF(n,i,t),t}function GF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["_self"]);if(s!=null){let a=cx(s);Array.isArray(a)&&(a=a.map(l=>Vy(l))),m(e,["models"],a)}return e}function zF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["_self"]);if(s!=null){let a=cx(s);Array.isArray(a)&&(a=a.map(l=>Ly(l))),m(e,["models"],a)}return e}function HF(n){const e={},t=h(n,["maskMode"]);t!=null&&m(e,["maskMode"],t);const i=h(n,["segmentationClasses"]);i!=null&&m(e,["maskClasses"],i);const s=h(n,["maskDilation"]);return s!=null&&m(e,["dilation"],s),e}function Vy(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const s=h(n,["description"]);s!=null&&m(e,["description"],s);const a=h(n,["version"]);a!=null&&m(e,["version"],a);const l=h(n,["_self"]);l!=null&&m(e,["tunedModelInfo"],o5(l));const d=h(n,["inputTokenLimit"]);d!=null&&m(e,["inputTokenLimit"],d);const f=h(n,["outputTokenLimit"]);f!=null&&m(e,["outputTokenLimit"],f);const p=h(n,["supportedGenerationMethods"]);p!=null&&m(e,["supportedActions"],p);const _=h(n,["temperature"]);_!=null&&m(e,["temperature"],_);const E=h(n,["maxTemperature"]);E!=null&&m(e,["maxTemperature"],E);const T=h(n,["topP"]);T!=null&&m(e,["topP"],T);const C=h(n,["topK"]);C!=null&&m(e,["topK"],C);const P=h(n,["thinking"]);return P!=null&&m(e,["thinking"],P),e}function Ly(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const s=h(n,["description"]);s!=null&&m(e,["description"],s);const a=h(n,["versionId"]);a!=null&&m(e,["version"],a);const l=h(n,["deployedModels"]);if(l!=null){let E=l;Array.isArray(E)&&(E=E.map(T=>iF(T))),m(e,["endpoints"],E)}const d=h(n,["labels"]);d!=null&&m(e,["labels"],d);const f=h(n,["_self"]);f!=null&&m(e,["tunedModelInfo"],a5(f));const p=h(n,["defaultCheckpointId"]);p!=null&&m(e,["defaultCheckpointId"],p);const _=h(n,["checkpoints"]);if(_!=null){let E=_;Array.isArray(E)&&(E=E.map(T=>T)),m(e,["checkpoints"],E)}return e}function KF(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],rF(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],sF(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],N3(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function JF(n){const e={},t=h(n,["productImage"]);return t!=null&&m(e,["image"],Ci(t)),e}function YF(n,e){const t={},i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const s=h(n,["baseSteps"]);e!==void 0&&s!=null&&m(e,["parameters","baseSteps"],s);const a=h(n,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const l=h(n,["seed"]);e!==void 0&&l!=null&&m(e,["parameters","seed"],l);const d=h(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&m(e,["parameters","safetySetting"],d);const f=h(n,["personGeneration"]);e!==void 0&&f!=null&&m(e,["parameters","personGeneration"],f);const p=h(n,["addWatermark"]);e!==void 0&&p!=null&&m(e,["parameters","addWatermark"],p);const _=h(n,["outputMimeType"]);e!==void 0&&_!=null&&m(e,["parameters","outputOptions","mimeType"],_);const E=h(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","compressionQuality"],E);const T=h(n,["enhancePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","enhancePrompt"],T);const C=h(n,["labels"]);return e!==void 0&&C!=null&&m(e,["labels"],C),t}function $F(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["source"]);s!=null&&XF(s,t);const a=h(e,["config"]);return a!=null&&YF(a,t),t}function QF(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>_p(s))),m(e,["generatedImages"],i)}return e}function XF(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const s=h(n,["personImage"]);e!==void 0&&s!=null&&m(e,["instances[0]","personImage","image"],Ci(s));const a=h(n,["productImages"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(d=>JF(d))),m(e,["instances[0]","productImages"],l)}return t}function WF(n){const e={},t=h(n,["referenceImage"]);t!=null&&m(e,["referenceImage"],Ci(t));const i=h(n,["referenceId"]);i!=null&&m(e,["referenceId"],i);const s=h(n,["referenceType"]);s!=null&&m(e,["referenceType"],s);const a=h(n,["maskImageConfig"]);a!=null&&m(e,["maskImageConfig"],HF(a));const l=h(n,["controlImageConfig"]);l!=null&&m(e,["controlImageConfig"],U3(l));const d=h(n,["styleImageConfig"]);d!=null&&m(e,["styleImageConfig"],d);const f=h(n,["subjectImageConfig"]);return f!=null&&m(e,["subjectImageConfig"],f),e}function yx(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&m(e,["scores"],i);const s=h(n,["contentType"]);return s!=null&&m(e,["contentType"],s),e}function _x(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&m(e,["scores"],i);const s=h(n,["contentType"]);return s!=null&&m(e,["contentType"],s),e}function ZF(n){const e={},t=h(n,["category"]);if(t!=null&&m(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=h(n,["threshold"]);return i!=null&&m(e,["threshold"],i),e}function jF(n){const e={},t=h(n,["image"]);return t!=null&&m(e,["image"],Ci(t)),e}function e5(n,e){const t={},i=h(n,["mode"]);e!==void 0&&i!=null&&m(e,["parameters","mode"],i);const s=h(n,["maxPredictions"]);e!==void 0&&s!=null&&m(e,["parameters","maxPredictions"],s);const a=h(n,["confidenceThreshold"]);e!==void 0&&a!=null&&m(e,["parameters","confidenceThreshold"],a);const l=h(n,["maskDilation"]);e!==void 0&&l!=null&&m(e,["parameters","maskDilation"],l);const d=h(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&m(e,["parameters","binaryColorThreshold"],d);const f=h(n,["labels"]);return e!==void 0&&f!=null&&m(e,["labels"],f),t}function t5(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["source"]);s!=null&&i5(s,t);const a=h(e,["config"]);return a!=null&&e5(a,t),t}function n5(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>RF(s))),m(e,["generatedMasks"],i)}return e}function i5(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const s=h(n,["image"]);e!==void 0&&s!=null&&m(e,["instances[0]","image"],Ci(s));const a=h(n,["scribbleImage"]);return e!==void 0&&a!=null&&m(e,["instances[0]","scribble"],jF(a)),t}function r5(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],oF(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function s5(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],PF(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],kF(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function vx(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(T=>aF(T))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const s=h(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function o5(n){const e={},t=h(n,["baseModel"]);t!=null&&m(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&m(e,["createTime"],i);const s=h(n,["updateTime"]);return s!=null&&m(e,["updateTime"],s),e}function a5(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&m(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&m(e,["createTime"],i);const s=h(n,["updateTime"]);return s!=null&&m(e,["updateTime"],s),e}function l5(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const s=h(n,["description"]);e!==void 0&&s!=null&&m(e,["description"],s);const a=h(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&m(e,["defaultCheckpointId"],a),t}function u5(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const s=h(n,["description"]);e!==void 0&&s!=null&&m(e,["description"],s);const a=h(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&m(e,["defaultCheckpointId"],a),t}function c5(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","name"],Ze(n,i));const s=h(e,["config"]);return s!=null&&l5(s,t),t}function d5(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["config"]);return s!=null&&u5(s,t),t}function f5(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const s=h(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&m(e,["parameters","safetySetting"],s);const a=h(n,["personGeneration"]);e!==void 0&&a!=null&&m(e,["parameters","personGeneration"],a);const l=h(n,["includeRaiReason"]);e!==void 0&&l!=null&&m(e,["parameters","includeRaiReason"],l);const d=h(n,["outputMimeType"]);e!==void 0&&d!=null&&m(e,["parameters","outputOptions","mimeType"],d);const f=h(n,["outputCompressionQuality"]);e!==void 0&&f!=null&&m(e,["parameters","outputOptions","compressionQuality"],f);const p=h(n,["enhanceInputImage"]);e!==void 0&&p!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],p);const _=h(n,["imagePreservationFactor"]);e!==void 0&&_!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],_);const E=h(n,["labels"]);e!==void 0&&E!=null&&m(e,["labels"],E);const T=h(n,["numberOfImages"]);e!==void 0&&T!=null&&m(e,["parameters","sampleCount"],T);const C=h(n,["mode"]);return e!==void 0&&C!=null&&m(e,["parameters","mode"],C),t}function h5(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["image"]);s!=null&&m(t,["instances[0]","image"],Ci(s));const a=h(e,["upscaleFactor"]);a!=null&&m(t,["parameters","upscaleConfig","upscaleFactor"],a);const l=h(e,["config"]);return l!=null&&f5(l,t),t}function p5(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>_p(a))),m(e,["generatedImages"],s)}return e}function m5(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["encodedVideo"]);i!=null&&m(e,["videoBytes"],zs(i));const s=h(n,["encoding"]);return s!=null&&m(e,["mimeType"],s),e}function g5(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["videoBytes"],zs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function y5(n){const e={},t=h(n,["image"]);t!=null&&m(e,["_self"],Ci(t));const i=h(n,["maskMode"]);return i!=null&&m(e,["maskMode"],i),e}function _5(n){const e={},t=h(n,["image"]);t!=null&&m(e,["image"],vp(t));const i=h(n,["referenceType"]);return i!=null&&m(e,["referenceType"],i),e}function v5(n){const e={},t=h(n,["image"]);t!=null&&m(e,["image"],Ci(t));const i=h(n,["referenceType"]);return i!=null&&m(e,["referenceType"],i),e}function Ex(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["videoBytes"]);i!=null&&m(e,["encodedVideo"],zs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["encoding"],s),e}function Tx(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["videoBytes"]);i!=null&&m(e,["bytesBase64Encoded"],zs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function E5(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&m(e,["displayName"],i),t}function T5(n){const e={},t=h(n,["config"]);return t!=null&&E5(t,e),e}function A5(n,e){const t={},i=h(n,["force"]);return e!==void 0&&i!=null&&m(e,["_query","force"],i),t}function S5(n){const e={},t=h(n,["name"]);t!=null&&m(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&A5(i,e),e}function I5(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function C5(n,e){const t={},i=h(n,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["customMetadata"],a)}const s=h(n,["chunkingConfig"]);return e!==void 0&&s!=null&&m(e,["chunkingConfig"],s),t}function w5(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],b5(l)),e}function R5(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const i=h(n,["fileName"]);i!=null&&m(e,["fileName"],i);const s=h(n,["config"]);return s!=null&&C5(s,e),e}function b5(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const s=h(n,["documentName"]);return s!=null&&m(e,["documentName"],s),e}function x5(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function N5(n){const e={},t=h(n,["config"]);return t!=null&&x5(t,e),e}function D5(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["fileSearchStores"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["fileSearchStores"],a)}return e}function Ax(n,e){const t={},i=h(n,["mimeType"]);e!==void 0&&i!=null&&m(e,["mimeType"],i);const s=h(n,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const a=h(n,["customMetadata"]);if(e!==void 0&&a!=null){let d=a;Array.isArray(d)&&(d=d.map(f=>f)),m(e,["customMetadata"],d)}const l=h(n,["chunkingConfig"]);return e!==void 0&&l!=null&&m(e,["chunkingConfig"],l),t}function M5(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const i=h(n,["config"]);return i!=null&&Ax(i,e),e}function P5(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const k5="Content-Type",V5="X-Server-Timeout",L5="User-Agent",Uy="x-goog-api-client",U5="1.34.0",O5=`google-genai-sdk/${U5}`,F5="v1beta1",B5="v1beta";class q5{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:F5,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:B5,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const s=[this.getRequestUrlInternal(t)];return i&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[l,d]of Object.entries(e.queryParams))s.searchParams.append(l,String(d));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,s.toString(),e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?i[s]=Object.assign(Object.assign({},i[s]),a):a!==void 0&&(i[s]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,s.toString(),e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,s){if(t&&t.timeout||s){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const d=setTimeout(()=>a.abort(),t.timeout);d&&typeof d.unref=="function"&&d.unref()}s&&s.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&G5(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await dC(s),new My(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await dC(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return Ai(this,arguments,function*(){var i;const s=(i=e==null?void 0:e.body)===null||i===void 0?void 0:i.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";const d="data:",f=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:p,value:_}=yield De(s.read());if(p){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const E=a.decode(_,{stream:!0});try{const P=JSON.parse(E);if("error"in P){const O=JSON.parse(JSON.stringify(P.error)),k=O.status,Q=O.code,j=`got status: ${k}. ${JSON.stringify(P)}`;if(Q>=400&&Q<600)throw new gp({message:j,status:Q})}}catch(P){if(P.name==="ApiError")throw P}l+=E;let T=-1,C=0;for(;;){T=-1,C=0;for(const k of f){const Q=l.indexOf(k);Q!==-1&&(T===-1||Q<T)&&(T=Q,C=k.length)}if(T===-1)break;const P=l.substring(0,T);l=l.substring(T+C);const O=P.trim();if(O.startsWith(d)){const k=O.substring(d.length).trim();try{const Q=new Response(k,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield De(new My(Q))}catch(Q){throw new Error(`exception parsing stream chunk ${k}. ${Q}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=O5+" "+this.clientOptions.userAgentExtra;return e[L5]=t,e[Uy]=t,e[k5]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[s,a]of Object.entries(e.headers))i.append(s,a);e.timeout&&e.timeout>0&&i.append(V5,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);s.sizeBytes=String(l.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=d;const f={file:s},p=this.getFileName(e),_=pe("upload/v1beta/files",f._url),E=await this.fetchUploadUrl(_,s.sizeBytes,s.mimeType,p,f,t==null?void 0:t.httpOptions);return a.upload(e,E,this)}async uploadFileToFileSearchStore(e,t,i){var s;const a=this.clientOptions.uploader,l=await a.stat(t),d=String(l.size),f=(s=i==null?void 0:i.mimeType)!==null&&s!==void 0?s:l.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,_=this.getFileName(t),E={};i!=null&&Ax(i,E);const T=await this.fetchUploadUrl(p,d,f,_,E,i==null?void 0:i.httpOptions);return a.uploadToFileSearchStore(t,T,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,s,a,l){var d;let f={};l?f=l:f={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},s?{"X-Goog-Upload-File-Name":s}:{})};const p=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:f});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const _=(d=p==null?void 0:p.headers)===null||d===void 0?void 0:d["x-goog-upload-url"];if(_===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return _}}async function dC(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(i);throw t>=400&&t<600?new gp({message:s,status:t}):new Error(s)}}function G5(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,l){const d=Object.assign({},a);for(const f in l)if(Object.prototype.hasOwnProperty.call(l,f)){const p=l[f],_=d[f];p&&typeof p=="object"&&!Array.isArray(p)&&_&&typeof _=="object"&&!Array.isArray(_)?d[f]=i(_,p):(_&&p&&typeof _!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof _}, New type: ${typeof p}. Overwriting.`),d[f]=p)}return d}const s=i(t,e);n.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const z5="mcp_used/unknown";let H5=!1;function Sx(n){for(const e of n)if(K5(e)||typeof e=="object"&&"inputSchema"in e)return!0;return H5}function Ix(n){var e;const t=(e=n[Uy])!==null&&e!==void 0?e:"";n[Uy]=(t+` ${z5}`).trimStart()}function K5(n){return n!==null&&typeof n=="object"&&n instanceof av}function J5(n){return Ai(this,arguments,function*(t,i=100){let s,a=0;for(;a<i;){const l=yield De(t.listTools({cursor:s}));for(const d of l.tools)yield yield De(d),a++;if(!l.nextCursor)break;s=l.nextCursor}})}class av{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new av(e,t)}async initialize(){var e,t,i,s;if(this.mcpTools.length>0)return;const a={},l=[];for(const _ of this.mcpClients)try{for(var d=!0,f=(t=void 0,Si(J5(_))),p;p=await f.next(),e=p.done,!e;d=!0){s=p.value,d=!1;const E=s;l.push(E);const T=E.name;if(a[T])throw new Error(`Duplicate function name ${T} found in MCP tools. Please ensure function names are unique.`);a[T]=_}}catch(E){t={error:E}}finally{try{!d&&!e&&(i=f.return)&&await i.call(f)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),IO(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await s.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Y5(n,e,t){const i=new gO;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(i,s),e(i)}class $5{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=W5(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),f=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${d}`;let p=()=>{};const _=new Promise(X=>{p=X}),E=e.callbacks,T=function(){p({})},C=this.apiClient,P={onopen:T,onmessage:X=>{Y5(C,E.onmessage,X)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(X){},onclose:(i=E==null?void 0:E.onclose)!==null&&i!==void 0?i:function(X){}},O=this.webSocketFactory.create(f,X5(l),P);O.connect(),await _;const j={setup:{model:Ze(this.apiClient,e.model)}};return O.send(JSON.stringify(j)),new Q5(O,this.apiClient)}}class Q5{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=T3(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=E3(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(nl.PLAY)}pause(){this.sendPlaybackControl(nl.PAUSE)}stop(){this.sendPlaybackControl(nl.STOP)}resetContext(){this.sendPlaybackControl(nl.RESET_CONTEXT)}close(){this.conn.close()}}function X5(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function W5(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Z5="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function j5(n,e,t){const i=new mO;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const a=JSON.parse(s);if(n.isVertexAI()){const l=I3(a);Object.assign(i,l)}else Object.assign(i,a);e(i)}class eB{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new $5(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,s,a,l,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let _;const E=this.apiClient.getHeaders();e.config&&e.config.tools&&Sx(e.config.tools)&&Ix(E);const T=rB(E);if(this.apiClient.isVertexAI())_=`${f}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(T,_);else{const x=this.apiClient.getApiKey();let L="BidiGenerateContent",V="key";x!=null&&x.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),L="BidiGenerateContentConstrained",V="access_token"),_=`${f}/ws/google.ai.generativelanguage.${p}.GenerativeService.${L}?${V}=${x}`}let C=()=>{};const P=new Promise(x=>{C=x}),O=e.callbacks,k=function(){var x;(x=O==null?void 0:O.onopen)===null||x===void 0||x.call(O),C({})},Q=this.apiClient,j={onopen:k,onmessage:x=>{j5(Q,O.onmessage,x)},onerror:(t=O==null?void 0:O.onerror)!==null&&t!==void 0?t:function(x){},onclose:(i=O==null?void 0:O.onclose)!==null&&i!==void 0?i:function(x){}},X=this.webSocketFactory.create(_,iB(T),j);X.connect(),await P;let se=Ze(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&se.startsWith("publishers/")){const x=this.apiClient.getProject(),L=this.apiClient.getLocation();se=`projects/${x}/locations/${L}/`+se}let le={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Oc.AUDIO]}:e.config.responseModalities=[Oc.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const ue=(d=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&d!==void 0?d:[],N=[];for(const x of ue)if(this.isCallableTool(x)){const L=x;N.push(await L.tool())}else N.push(x);N.length>0&&(e.config.tools=N);const D={model:se,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?le=v3(this.apiClient,D):le=_3(this.apiClient,D),delete le.config,X.send(JSON.stringify(le)),new nB(X,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const tB={turnComplete:!0};class nB{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=oi(t.turns),e.isVertexAI()||(i=i.map(s=>yp(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(Z5)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},tB),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:S3(e)}:t={realtimeInput:A3(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function iB(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function rB(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fC=10;function hC(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(dl(l)){s=!0;break}if(!s)return!0;const a=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function dl(n){return"callTool"in n&&typeof n.callTool=="function"}function sB(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>dl(s)))!==null&&i!==void 0?i:!1}function pC(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,s)=>{if(dl(i))return;const a=i;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(s)}),t}function mC(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oB extends Lr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,s,a,l,d;const f=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!sB(t)||hC(t.config))return await this.generateContentInternal(f);const p=pC(t);if(p.length>0){const O=p.map(k=>`tools[${k}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${O}.`)}let _,E;const T=oi(f.contents),C=(a=(s=(i=f.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:fC;let P=0;for(;P<C&&(_=await this.generateContentInternal(f),!(!_.functionCalls||_.functionCalls.length===0));){const O=_.candidates[0].content,k=[];for(const Q of(d=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&d!==void 0?d:[])if(dl(Q)){const X=await Q.callTool(_.functionCalls);k.push(...X)}P++,E={role:"user",parts:k},f.contents=oi(f.contents),f.contents.push(O),f.contents.push(E),mC(f.config)&&(T.push(O),T.push(E))}return mC(f.config)&&(_.automaticFunctionCallingHistory=T),_},this.generateContentStream=async t=>{var i,s,a,l,d;if(this.maybeMoveToResponseJsonSchem(t),hC(t.config)){const E=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(E)}const f=pC(t);if(f.length>0){const E=f.map(T=>`tools[${T}]`).join(", ");throw new Error(`Incompatible tools found at ${E}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(a=(s=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,_=(d=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||d===void 0?void 0:d.disable;if(p&&!_)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var s;let a;const l=[];if(i!=null&&i.generatedImages)for(const f of i.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((s=f==null?void 0:f.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=f==null?void 0:f.safetyAttributes:l.push(f);let d;return a?d={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:d={generatedImages:l,sdkHttpResponse:i.sdkHttpResponse},d}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Wo(Dr.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var i,s,a,l,d,f;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((f=(d=t.source)===null||d===void 0?void 0:d.video)===null||f===void 0)&&f.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,s;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async f=>dl(f)?await f.tool():f)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(d.config.tools=l,e.config&&e.config.tools&&Sx(e.config.tools)){const f=(s=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&s!==void 0?s:{};let p=Object.assign({},f);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),Ix(p),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return d}async initAfcToolsMap(e){var t,i,s;const a=new Map;for(const l of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(dl(l)){const d=l,f=await d.tool();for(const p of(s=f.functionDeclarations)!==null&&s!==void 0?s:[]){if(!p.name)throw new Error("Function declaration name is required.");if(a.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);a.set(p.name,d)}}return a}async processAfcStream(e){var t,i,s;const a=(s=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:fC;let l=!1,d=0;const f=await this.initAfcToolsMap(e);return(function(p,_,E){return Ai(this,arguments,function*(){for(var T,C,P,O,k,Q;d<a;){l&&(d++,l=!1);const le=yield De(p.processParamsMaybeAddMcpUsage(E)),ue=yield De(p.generateContentStreamInternal(le)),N=[],D=[];try{for(var j=!0,X=(C=void 0,Si(ue)),se;se=yield De(X.next()),T=se.done,!T;j=!0){O=se.value,j=!1;const x=O;if(yield yield De(x),x.candidates&&(!((k=x.candidates[0])===null||k===void 0)&&k.content)){D.push(x.candidates[0].content);for(const L of(Q=x.candidates[0].content.parts)!==null&&Q!==void 0?Q:[])if(d<a&&L.functionCall){if(!L.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(L.functionCall.name)){const V=yield De(_.get(L.functionCall.name).callTool([L.functionCall]));N.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${L.functionCall.name}`)}}}}catch(x){C={error:x}}finally{try{!j&&!T&&(P=X.return)&&(yield De(P.call(X)))}finally{if(C)throw C.error}}if(N.length>0){l=!0;const x=new tc;x.candidates=[{content:{role:"user",parts:N}}],yield yield De(x);const L=[];L.push(...D),L.push({role:"user",parts:N});const V=oi(E.contents).concat(L);E.contents=V}else break}})})(this,f,e)}async generateContentInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=lC(this.apiClient,e);return d=pe("{model}:generateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=cC(_),T=new tc;return Object.assign(T,E),T})}else{const p=aC(this.apiClient,e);return d=pe("{model}:generateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=uC(_),T=new tc;return Object.assign(T,E),T})}}async generateContentStreamInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=lC(this.apiClient,e);return d=pe("{model}:streamGenerateContent?alt=sse",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(E){return Ai(this,arguments,function*(){var T,C,P,O;try{for(var k=!0,Q=Si(E),j;j=yield De(Q.next()),T=j.done,!T;k=!0){O=j.value,k=!1;const X=O,se=cC(yield De(X.json()));se.sdkHttpResponse={headers:X.headers};const le=new tc;Object.assign(le,se),yield yield De(le)}}catch(X){C={error:X}}finally{try{!k&&!T&&(P=Q.return)&&(yield De(P.call(Q)))}finally{if(C)throw C.error}}})})}else{const p=aC(this.apiClient,e);return d=pe("{model}:streamGenerateContent?alt=sse",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(E){return Ai(this,arguments,function*(){var T,C,P,O;try{for(var k=!0,Q=Si(E),j;j=yield De(Q.next()),T=j.done,!T;k=!0){O=j.value,k=!1;const X=O,se=uC(yield De(X.json()));se.sdkHttpResponse={headers:X.headers};const le=new tc;Object.assign(le,se),yield yield De(le)}}catch(X){C={error:X}}finally{try{!k&&!T&&(P=Q.return)&&(yield De(P.call(Q)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=eF(this.apiClient,e);return d=pe("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=nF(_),T=new HI;return Object.assign(T,E),T})}else{const p=j3(this.apiClient,e);return d=pe("{model}:batchEmbedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=tF(_),T=new HI;return Object.assign(T,E),T})}}async generateImagesInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=hF(this.apiClient,e);return d=pe("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=mF(_),T=new KI;return Object.assign(T,E),T})}else{const p=fF(this.apiClient,e);return d=pe("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=pF(_),T=new KI;return Object.assign(T,E),T})}}async editImageInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=Q3(this.apiClient,e);return a=pe("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=X3(f),_=new rO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=h5(this.apiClient,e);return a=pe("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=p5(f),_=new sO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=$F(this.apiClient,e);return a=pe("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=QF(f),_=new oO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=t5(this.apiClient,e);return a=pe("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=n5(f),_=new aO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=MF(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Ly(_))}else{const p=DF(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Vy(_))}}async listInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=qF(this.apiClient,e);return d=pe("{models_url}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=zF(_),T=new JI;return Object.assign(T,E),T})}else{const p=BF(this.apiClient,e);return d=pe("{models_url}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=GF(_),T=new JI;return Object.assign(T,E),T})}}async update(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=d5(this.apiClient,e);return d=pe("{model}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Ly(_))}else{const p=c5(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>Vy(_))}}async delete(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=K3(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=Y3(_),T=new YI;return Object.assign(T,E),T})}else{const p=H3(this.apiClient,e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=J3(_),T=new YI;return Object.assign(T,E),T})}}async countTokens(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=q3(this.apiClient,e);return d=pe("{model}:countTokens",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=z3(_),T=new $I;return Object.assign(T,E),T})}else{const p=B3(this.apiClient,e);return d=pe("{model}:countTokens",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=G3(_),T=new $I;return Object.assign(T,E),T})}}async computeTokens(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=P3(this.apiClient,e);return a=pe("{model}:computeTokens",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=k3(f),_=new lO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=TF(this.apiClient,e);return d=pe("{model}:predictLongRunning",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>{const E=vF(_),T=new Bh;return Object.assign(T,E),T})}else{const p=EF(this.apiClient,e);return d=pe("{model}:predictLongRunning",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>{const E=_F(_),T=new Bh;return Object.assign(T,E),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class aB extends Lr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=ZU(e);return d=pe("{operationName}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l}else{const p=WU(e);return d=pe("{operationName}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l}}async fetchPredictVideosOperationInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=HU(e);return a=pe("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lB(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function uB(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>_B(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function cB(n,e,t){const i={},s=h(e,["expireTime"]);t!==void 0&&s!=null&&m(t,["expireTime"],s);const a=h(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&m(t,["newSessionExpireTime"],a);const l=h(e,["uses"]);t!==void 0&&l!=null&&m(t,["uses"],l);const d=h(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&m(t,["bidiGenerateContentSetup"],yB(n,d));const f=h(e,["lockAdditionalFields"]);return t!==void 0&&f!=null&&m(t,["fieldMask"],f),i}function dB(n,e){const t={},i=h(e,["config"]);return i!=null&&m(t,["config"],cB(n,i,t)),t}function fB(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function hB(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function pB(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function mB(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function gB(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],i);const s=h(n,["responseModalities"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","responseModalities"],s);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],ov(E));const T=h(n,["thinkingConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","thinkingConfig"],T);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&m(e,["setup","systemInstruction"],uB(mn(P)));const O=h(n,["tools"]);if(e!==void 0&&O!=null){let ue=Gl(O);Array.isArray(ue)&&(ue=ue.map(N=>EB(ql(N)))),m(e,["setup","tools"],ue)}const k=h(n,["sessionResumption"]);e!==void 0&&k!=null&&m(e,["setup","sessionResumption"],vB(k));const Q=h(n,["inputAudioTranscription"]);e!==void 0&&Q!=null&&m(e,["setup","inputAudioTranscription"],Q);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const X=h(n,["realtimeInputConfig"]);e!==void 0&&X!=null&&m(e,["setup","realtimeInputConfig"],X);const se=h(n,["contextWindowCompression"]);e!==void 0&&se!=null&&m(e,["setup","contextWindowCompression"],se);const le=h(n,["proactivity"]);if(e!==void 0&&le!=null&&m(e,["setup","proactivity"],le),h(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function yB(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Ze(n,i));const s=h(e,["config"]);return s!=null&&m(t,["config"],gB(s,t)),t}function _B(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],fB(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],hB(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],lB(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function vB(n){const e={},t=h(n,["handle"]);if(t!=null&&m(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function EB(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],pB(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],mB(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TB(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const s=Object.keys(i).map(a=>`${t}.${a}`);e.push(...s)}else e.push(t)}return e.join(",")}function AB(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const a=TB(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];s.length>0&&(d=s.map(p=>l.includes(p)?`generationConfig.${p}`:p));const f=[];a&&f.push(a),d.length>0&&f.push(...d),f.length>0?n.fieldMask=f.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class SB extends Lr{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=dB(this.apiClient,e);a=pe("auth_tokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query;const f=AB(d,e.config);return s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),s.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IB(n,e){const t={},i=h(n,["force"]);return e!==void 0&&i!=null&&m(e,["_query","force"],i),t}function CB(n){const e={},t=h(n,["name"]);t!=null&&m(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&IB(i,e),e}function wB(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function RB(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function bB(n){const e={},t=h(n,["parent"]);t!=null&&m(e,["_url","parent"],t);const i=h(n,["config"]);return i!=null&&RB(i,e),e}function xB(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["documents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NB extends Lr{constructor(e){super(),this.apiClient=e,this.list=async t=>new Wo(Dr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=wB(e);return a=pe("{name}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var t,i;let s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=CB(e);s=pe("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=bB(e);return a=pe("{parent}/documents",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=xB(f),_=new uO;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DB extends Lr{constructor(e,t=new NB(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new Wo(Dr.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=T5(e);return a=pe("fileSearchStores",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=I5(e);return a=pe("{name}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var t,i;let s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=S5(e);s=pe("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=N5(e);return a=pe("fileSearchStores",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=D5(f),_=new cO;return Object.assign(_,p),_})}}async uploadToFileSearchStoreInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=M5(e);return a=pe("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=P5(f),_=new dO;return Object.assign(_,p),_})}}async importFile(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=R5(e);return a=pe("{file_search_store_name}:importFile",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=w5(f),_=new tv;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Cx=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return Cx=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))};const MB=()=>Cx();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oy(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const Fy=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ai extends Error{}class An extends ai{constructor(e,t,i,s){super(`${An.makeMessage(e,t,i)}`),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,i){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,i,s){if(!e||!s)return new Ep({message:i,cause:Fy(t)});const a=t;return e===400?new Rx(e,a,i,s):e===401?new bx(e,a,i,s):e===403?new xx(e,a,i,s):e===404?new Nx(e,a,i,s):e===409?new Dx(e,a,i,s):e===422?new Mx(e,a,i,s):e===429?new Px(e,a,i,s):e>=500?new kx(e,a,i,s):new An(e,a,i,s)}}class By extends An{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Ep extends An{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class wx extends Ep{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Rx extends An{}class bx extends An{}class xx extends An{}class Nx extends An{}class Dx extends An{}class Mx extends An{}class Px extends An{}class kx extends An{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PB=/^[a-z][a-z0-9+.-]*:/i,kB=n=>PB.test(n);let qy=n=>(qy=Array.isArray,qy(n));const VB=qy;let LB=VB;const gC=LB;function UB(n){if(!n)return!0;for(const e in n)return!1;return!0}function OB(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const FB=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ai(`${n} must be an integer`);if(e<0)throw new ai(`${n} must be a positive integer`);return e},BB=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qB=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const el="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function GB(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const zB=()=>{var n,e,t,i,s;const a=GB();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":_C(Deno.build.os),"X-Stainless-Arch":yC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":_C((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":yC((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const l=HB();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":el,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function HB(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const i=t.exec(navigator.userAgent);if(i){const s=i[1]||0,a=i[2]||0,l=i[3]||0;return{browser:e,version:`${s}.${a}.${l}`}}}return null}const yC=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",_C=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Gf;const KB=()=>Gf??(Gf=zB());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JB(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Vx(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function YB(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return Vx({start(){},async pull(t){const{done:i,value:s}=await e.next();i?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function Lx(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function $B(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const i=n.getReader(),s=i.cancel();i.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const QB=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ux=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Hg(n,e,t){return Ux(),new File(n,e??"unknown_file",t)}function XB(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const WB=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ox=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",ZB=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Ox(n),jB=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function e9(n,e,t){if(Ux(),n=await n,ZB(n))return n instanceof File?n:Hg([await n.arrayBuffer()],n.name);if(jB(n)){const s=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),Hg(await Gy(s),e,t)}const i=await Gy(n);if(e||(e=XB(n)),!(t!=null&&t.type)){const s=i.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof s=="string"&&(t=Object.assign(Object.assign({},t),{type:s}))}return Hg(i,e,t)}async function Gy(n){var e,t,i,s,a;let l=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)l.push(n);else if(Ox(n))l.push(n instanceof Blob?n:await n.arrayBuffer());else if(WB(n))try{for(var d=!0,f=Si(n),p;p=await f.next(),e=p.done,!e;d=!0){s=p.value,d=!1;const _=s;l.push(...await Gy(_))}}catch(_){t={error:_}}finally{try{!d&&!e&&(i=f.return)&&await i.call(f)}finally{if(t)throw t.error}}else{const _=(a=n==null?void 0:n.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof n}${_?`; constructor: ${_}`:""}${t9(n)}`)}return l}function t9(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fx{constructor(e){this._client=e}}Fx._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Bx(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const vC=Object.freeze(Object.create(null)),n9=(n=Bx)=>(function(t,...i){if(t.length===1)return t[0];let s=!1;const a=[],l=t.reduce((_,E,T)=>{var C,P,O;/[?#]/.test(E)&&(s=!0);const k=i[T];let Q=(s?encodeURIComponent:n)(""+k);return T!==i.length&&(k==null||typeof k=="object"&&k.toString===((O=Object.getPrototypeOf((P=Object.getPrototypeOf((C=k.hasOwnProperty)!==null&&C!==void 0?C:vC))!==null&&P!==void 0?P:vC))===null||O===void 0?void 0:O.toString))&&(Q=k+"",a.push({start:_.length+E.length,length:Q.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),_+E+(T===i.length?"":Q)},""),d=l.split(/[?#]/,1)[0],f=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let p;for(;(p=f.exec(d))!==null;)a.push({start:p.index,length:p[0].length,error:`Value "${p[0]}" can't be safely passed as a path parameter`});if(a.sort((_,E)=>_.start-E.start),a.length>0){let _=0;const E=a.reduce((T,C)=>{const P=" ".repeat(C.start-_),O="^".repeat(C.length);return _=C.start+C.length,T+P+O},"");throw new ai(`Path parameters result in path with invalid segments:
${a.map(T=>T.error).join(`
`)}
${l}
${E}`)}return l}),zf=n9(Bx);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qx extends Fx{create(e,t){var i;const{api_version:s=this._client.apiVersion}=e,a=Gh(e,["api_version"]);if("model"in a&&"agent_config"in a)throw new ai("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new ai("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(zf`/${s}/interactions`,Object.assign(Object.assign({body:a},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){const{api_version:s=this._client.apiVersion}=t??{};return this._client.delete(zf`/${s}/interactions/${e}`,i)}cancel(e,t={},i){const{api_version:s=this._client.apiVersion}=t??{};return this._client.post(zf`/${s}/interactions/${e}/cancel`,i)}get(e,t={},i){var s;const a=t??{},{api_version:l=this._client.apiVersion}=a,d=Gh(a,["api_version"]);return this._client.get(zf`/${l}/interactions/${e}`,Object.assign(Object.assign({query:d},i),{stream:(s=t==null?void 0:t.stream)!==null&&s!==void 0?s:!1}))}}qx._key=Object.freeze(["interactions"]);class Gx extends qx{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function i9(n){let e=0;for(const s of n)e+=s.length;const t=new Uint8Array(e);let i=0;for(const s of n)t.set(s,i),i+=s.length;return t}let Hf;function lv(n){let e;return(Hf??(e=new globalThis.TextEncoder,Hf=e.encode.bind(e)))(n)}let Kf;function EC(n){let e;return(Kf??(e=new globalThis.TextDecoder,Kf=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tp{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?lv(e):e;this.buffer=i9([this.buffer,t]);const i=[];let s;for(;(s=r9(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){i.push(EC(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,l=EC(this.buffer.subarray(0,a));i.push(l),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}Tp.NEWLINE_CHARS=new Set([`
`,"\r"]);Tp.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function r9(n,e){for(let s=e??0;s<n.length;s++){if(n[s]===10)return{preceding:s,index:s+1,carriage:!1};if(n[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function s9(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zh={off:0,error:200,warn:300,info:400,debug:500},TC=(n,e,t)=>{if(n){if(OB(zh,n))return n;En(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(zh))}`)}};function uc(){}function Jf(n,e,t){return!e||zh[n]>zh[t]?uc:e[n].bind(e)}const o9={error:uc,warn:uc,info:uc,debug:uc};let AC=new WeakMap;function En(n){var e;const t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return o9;const s=AC.get(t);if(s&&s[0]===i)return s[1];const a={error:Jf("error",t,i),warn:Jf("warn",t,i),info:Jf("info",t,i),debug:Jf("debug",t,i)};return AC.set(t,[i,a]),a}const wo=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class il{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let s=!1;const a=i?En(i):console;function l(){return Ai(this,arguments,function*(){var f,p,_,E;if(s)throw new ai("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let T=!1;try{try{for(var C=!0,P=Si(a9(e,t)),O;O=yield De(P.next()),f=O.done,!f;C=!0){E=O.value,C=!1;const k=E;if(!T)if(k.data.startsWith("[DONE]")){T=!0;continue}else try{yield yield De(JSON.parse(k.data))}catch(Q){throw a.error("Could not parse message into JSON:",k.data),a.error("From chunk:",k.raw),Q}}}catch(k){p={error:k}}finally{try{!C&&!f&&(_=P.return)&&(yield De(_.call(P)))}finally{if(p)throw p.error}}T=!0}catch(k){if(Oy(k))return yield De(void 0);throw k}finally{T||t.abort()}})}return new il(l,t,i)}static fromReadableStream(e,t,i){let s=!1;function a(){return Ai(this,arguments,function*(){var f,p,_,E;const T=new Tp,C=Lx(e);try{for(var P=!0,O=Si(C),k;k=yield De(O.next()),f=k.done,!f;P=!0){E=k.value,P=!1;const Q=E;for(const j of T.decode(Q))yield yield De(j)}}catch(Q){p={error:Q}}finally{try{!P&&!f&&(_=O.return)&&(yield De(_.call(O)))}finally{if(p)throw p.error}}for(const Q of T.flush())yield yield De(Q)})}function l(){return Ai(this,arguments,function*(){var f,p,_,E;if(s)throw new ai("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let T=!1;try{try{for(var C=!0,P=Si(a()),O;O=yield De(P.next()),f=O.done,!f;C=!0){E=O.value,C=!1;const k=E;T||k&&(yield yield De(JSON.parse(k)))}}catch(k){p={error:k}}finally{try{!C&&!f&&(_=P.return)&&(yield De(_.call(P)))}finally{if(p)throw p.error}}T=!0}catch(k){if(Oy(k))return yield De(void 0);throw k}finally{T||t.abort()}})}return new il(l,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],i=this.iterator(),s=a=>({next:()=>{if(a.length===0){const l=i.next();e.push(l),t.push(l)}return a.shift()}});return[new il(()=>s(e),this.controller,this.client),new il(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return Vx({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:a}=await t.next();if(a)return i.close();const l=lv(JSON.stringify(s)+`
`);i.enqueue(l)}catch(s){i.error(s)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}}function a9(n,e){return Ai(this,arguments,function*(){var i,s,a,l;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new ai("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new ai("Attempted to iterate over a response with no body");const d=new u9,f=new Tp,p=Lx(n.body);try{for(var _=!0,E=Si(l9(p)),T;T=yield De(E.next()),i=T.done,!i;_=!0){l=T.value,_=!1;const C=l;for(const P of f.decode(C)){const O=d.decode(P);O&&(yield yield De(O))}}}catch(C){s={error:C}}finally{try{!_&&!i&&(a=E.return)&&(yield De(a.call(E)))}finally{if(s)throw s.error}}for(const C of f.flush()){const P=d.decode(C);P&&(yield yield De(P))}})}function l9(n){return Ai(this,arguments,function*(){var t,i,s,a;let l=new Uint8Array;try{for(var d=!0,f=Si(n),p;p=yield De(f.next()),t=p.done,!t;d=!0){a=p.value,d=!1;const _=a;if(_==null)continue;const E=_ instanceof ArrayBuffer?new Uint8Array(_):typeof _=="string"?lv(_):_;let T=new Uint8Array(l.length+E.length);T.set(l),T.set(E,l.length),l=T;let C;for(;(C=s9(l))!==-1;)yield yield De(l.slice(0,C)),l=l.slice(C)}}catch(_){i={error:_}}finally{try{!d&&!t&&(s=f.return)&&(yield De(s.call(f)))}finally{if(i)throw i.error}}l.length>0&&(yield yield De(l))})}class u9{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,s]=c9(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function c9(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function d9(n,e){const{response:t,requestLogID:i,retryOfRequestLogID:s,startTime:a}=e,l=await(async()=>{var d;if(e.options.stream)return En(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):il.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const f=t.headers.get("content-type"),p=(d=f==null?void 0:f.split(";")[0])===null||d===void 0?void 0:d.trim();return(p==null?void 0:p.includes("application/json"))||(p==null?void 0:p.endsWith("+json"))?await t.json():await t.text()})();return En(n).debug(`[${i}] response parsed`,wo({retryOfRequestLogID:s,url:t.url,status:t.status,body:l,durationMs:Date.now()-a})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uv extends Promise{constructor(e,t,i=d9){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new uv(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zx=Symbol("brand.privateNullableHeaders");function*f9(n){if(!n)return;if(zx in n){const{values:i,nulls:s}=n;yield*i.entries();for(const a of s)yield[a,null];return}let e=!1,t;n instanceof Headers?t=n.entries():gC(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){const s=i[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const a=gC(i[1])?i[1]:[i[1]];let l=!1;for(const d of a)d!==void 0&&(e&&!l&&(l=!0,yield[s,null]),yield[s,d])}}const nc=n=>{const e=new Headers,t=new Set;for(const i of n){const s=new Set;for(const[a,l]of f9(i)){const d=a.toLowerCase();s.has(d)||(e.delete(a),s.add(d)),l===null?(e.delete(a),t.add(d)):(e.append(a,l),t.delete(d))}}return{[zx]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Kg=n=>{var e,t,i,s,a,l;if(typeof globalThis.process<"u")return(i=(t=(e=OU)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(l=(a=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||a===void 0?void 0:a.call(s,n))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hx;class Ap{constructor(e){var t,i,s,a,l,d,f,{baseURL:p=Kg("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:_=(t=Kg("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:E="v1beta"}=e,T=Gh(e,["baseURL","apiKey","apiVersion"]);const C=Object.assign(Object.assign({apiKey:_,apiVersion:E},T),{baseURL:p||"https://generativelanguage.googleapis.com"});this.baseURL=C.baseURL,this.timeout=(i=C.timeout)!==null&&i!==void 0?i:Ap.DEFAULT_TIMEOUT,this.logger=(s=C.logger)!==null&&s!==void 0?s:console;const P="warn";this.logLevel=P,this.logLevel=(l=(a=TC(C.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:TC(Kg("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:P,this.fetchOptions=C.fetchOptions,this.maxRetries=(d=C.maxRetries)!==null&&d!==void 0?d:2,this.fetch=(f=C.fetch)!==null&&f!==void 0?f:JB(),this.encoder=QB,this._options=C,this.apiKey=_,this.apiVersion=E,this.clientAdapter=C.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=nc([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return nc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return nc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,i])=>typeof i<"u").map(([t,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(t)}=`;throw new ai(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${el}`}defaultIdempotencyKey(){return`stainless-node-retry-${MB()}`}makeStatusError(e,t,i,s){return An.generate(e,t,i,s)}buildURL(e,t,i){const s=!this.baseURLOverridden()&&i||this.baseURL,a=kB(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return UB(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:i}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,i){return this.request(Promise.resolve(i).then(s=>Object.assign({method:e,path:t},s)))}request(e,t=null){return new uv(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,i){var s,a,l;const d=await e,f=(s=d.maxRetries)!==null&&s!==void 0?s:this.maxRetries;t==null&&(t=f),await this.prepareOptions(d);const{req:p,url:_,timeout:E}=await this.buildRequest(d,{retryCount:f-t});await this.prepareRequest(p,{url:_,options:d});const T="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),C=i===void 0?"":`, retryOf: ${i}`,P=Date.now();if(En(this).debug(`[${T}] sending request`,wo({retryOfRequestLogID:i,method:d.method,url:_,options:d,headers:p.headers})),!((a=d.signal)===null||a===void 0)&&a.aborted)throw new By;const O=new AbortController,k=await this.fetchWithTimeout(_,p,E,O).catch(Fy),Q=Date.now();if(k instanceof globalThis.Error){const X=`retrying, ${t} attempts remaining`;if(!((l=d.signal)===null||l===void 0)&&l.aborted)throw new By;const se=Oy(k)||/timed? ?out/i.test(String(k)+("cause"in k?String(k.cause):""));if(t)return En(this).info(`[${T}] connection ${se?"timed out":"failed"} - ${X}`),En(this).debug(`[${T}] connection ${se?"timed out":"failed"} (${X})`,wo({retryOfRequestLogID:i,url:_,durationMs:Q-P,message:k.message})),this.retryRequest(d,t,i??T);throw En(this).info(`[${T}] connection ${se?"timed out":"failed"} - error; no more retries left`),En(this).debug(`[${T}] connection ${se?"timed out":"failed"} (error; no more retries left)`,wo({retryOfRequestLogID:i,url:_,durationMs:Q-P,message:k.message})),se?new wx:new Ep({cause:k})}const j=`[${T}${C}] ${p.method} ${_} ${k.ok?"succeeded":"failed"} with status ${k.status} in ${Q-P}ms`;if(!k.ok){const X=await this.shouldRetry(k);if(t&&X){const x=`retrying, ${t} attempts remaining`;return await $B(k.body),En(this).info(`${j} - ${x}`),En(this).debug(`[${T}] response error (${x})`,wo({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:Q-P})),this.retryRequest(d,t,i??T,k.headers)}const se=X?"error; no more retries left":"error; not retryable";En(this).info(`${j} - ${se}`);const le=await k.text().catch(x=>Fy(x).message),ue=BB(le),N=ue?void 0:le;throw En(this).debug(`[${T}] response error (${se})`,wo({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,message:N,durationMs:Date.now()-P})),this.makeStatusError(k.status,ue,N,k.headers)}return En(this).info(j),En(this).debug(`[${T}] response start`,wo({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:Q-P})),{response:k,options:d,controller:O,requestLogID:T,retryOfRequestLogID:i,startTime:P}}async fetchWithTimeout(e,t,i,s){const a=t||{},{signal:l,method:d}=a,f=Gh(a,["signal","method"]);l&&l.addEventListener("abort",()=>s.abort());const p=setTimeout(()=>s.abort(),i),_=globalThis.ReadableStream&&f.body instanceof globalThis.ReadableStream||typeof f.body=="object"&&f.body!==null&&Symbol.asyncIterator in f.body,E=Object.assign(Object.assign(Object.assign({signal:s.signal},_?{duplex:"half"}:{}),{method:"GET"}),f);d&&(E.method=d.toUpperCase());try{return await this.fetch.call(void 0,e,E)}finally{clearTimeout(p)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,i,s){var a;let l;const d=s==null?void 0:s.get("retry-after-ms");if(d){const p=parseFloat(d);Number.isNaN(p)||(l=p)}const f=s==null?void 0:s.get("retry-after");if(f&&!l){const p=parseFloat(f);Number.isNaN(p)?l=Date.parse(f)-Date.now():l=p*1e3}if(!(l&&0<=l&&l<60*1e3)){const p=(a=e.maxRetries)!==null&&a!==void 0?a:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,p)}return await qB(l),this.makeRequest(e,t-1,i)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,l=Math.min(.5*Math.pow(2,a),8),d=1-Math.random()*.25;return l*d*1e3}async buildRequest(e,{retryCount:t=0}={}){var i,s,a;const l=Object.assign({},e),{method:d,path:f,query:p,defaultBaseURL:_}=l,E=this.buildURL(f,p,_);"timeout"in l&&FB("timeout",l.timeout),l.timeout=(i=l.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:T,body:C}=this.buildBody({options:l}),P=await this.buildHeaders({options:e,method:d,bodyHeaders:T,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:d,headers:P},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&C instanceof globalThis.ReadableStream&&{duplex:"half"}),C&&{body:C}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(a=l.fetchOptions)!==null&&a!==void 0?a:{}),url:E,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:i,retryCount:s}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let d=nc([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),KB()),this._options.defaultHeaders,i,e.headers,l]);return this.validateHeaders(d),d.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=nc([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:YB(e)}:this.encoder({body:e,headers:i})}}Ap.DEFAULT_TIMEOUT=6e4;class en extends Ap{constructor(){super(...arguments),this.interactions=new Gx(this)}}Hx=en;en.GeminiNextGenAPIClient=Hx;en.GeminiNextGenAPIClientError=ai;en.APIError=An;en.APIConnectionError=Ep;en.APIConnectionTimeoutError=wx;en.APIUserAbortError=By;en.NotFoundError=Nx;en.ConflictError=Dx;en.RateLimitError=Px;en.BadRequestError=Rx;en.AuthenticationError=bx;en.InternalServerError=kx;en.PermissionDeniedError=xx;en.UnprocessableEntityError=Mx;en.toFile=e9;en.Interactions=Gx;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function h9(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function p9(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function m9(n,e){const t={},i=h(n,["sdkHttpResponse"]);return i!=null&&m(t,["sdkHttpResponse"],i),t}function g9(n,e){const t={},i=h(n,["sdkHttpResponse"]);return i!=null&&m(t,["sdkHttpResponse"],i),t}function y9(n,e,t){const i={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=h(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&m(e,["displayName"],s),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(n,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const l=h(n,["learningRateMultiplier"]);if(l!=null&&m(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=h(n,["batchSize"]);e!==void 0&&d!=null&&m(e,["tuningTask","hyperparameters","batchSize"],d);const f=h(n,["learningRate"]);if(e!==void 0&&f!=null&&m(e,["tuningTask","hyperparameters","learningRate"],f),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(h(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function _9(n,e,t){const i={};let s=h(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const C=h(n,["validationDataset"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec"],SC(C))}else if(s==="PREFERENCE_TUNING"){const C=h(n,["validationDataset"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec"],SC(C))}const a=h(n,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const l=h(n,["description"]);e!==void 0&&l!=null&&m(e,["description"],l);let d=h(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const C=h(n,["epochCount"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],C)}else if(d==="PREFERENCE_TUNING"){const C=h(n,["epochCount"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],C)}let f=h(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const C=h(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],C)}else if(f==="PREFERENCE_TUNING"){const C=h(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],C)}let p=h(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const C=h(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],C)}else if(p==="PREFERENCE_TUNING"){const C=h(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],C)}let _=h(t,["config","method"]);if(_===void 0&&(_="SUPERVISED_FINE_TUNING"),_==="SUPERVISED_FINE_TUNING"){const C=h(n,["adapterSize"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],C)}else if(_==="PREFERENCE_TUNING"){const C=h(n,["adapterSize"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],C)}if(h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const E=h(n,["labels"]);e!==void 0&&E!=null&&m(e,["labels"],E);const T=h(n,["beta"]);return e!==void 0&&T!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","beta"],T),i}function v9(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const s=h(n,["preTunedModel"]);s!=null&&m(t,["preTunedModel"],s);const a=h(n,["trainingDataset"]);a!=null&&N9(a);const l=h(n,["config"]);return l!=null&&y9(l,t),t}function E9(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const s=h(n,["preTunedModel"]);s!=null&&m(t,["preTunedModel"],s);const a=h(n,["trainingDataset"]);a!=null&&D9(a,t,e);const l=h(n,["config"]);return l!=null&&_9(l,t,e),t}function T9(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function A9(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function S9(n,e,t){const i={},s=h(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&m(e,["_query","filter"],l),i}function I9(n,e,t){const i={},s=h(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&m(e,["_query","filter"],l),i}function C9(n,e){const t={},i=h(n,["config"]);return i!=null&&S9(i,t),t}function w9(n,e){const t={},i=h(n,["config"]);return i!=null&&I9(i,t),t}function R9(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["nextPageToken"]);s!=null&&m(t,["nextPageToken"],s);const a=h(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(d=>Kx(d))),m(t,["tuningJobs"],l)}return t}function b9(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["nextPageToken"]);s!=null&&m(t,["nextPageToken"],s);const a=h(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(d=>zy(d))),m(t,["tuningJobs"],l)}return t}function x9(n,e){const t={},i=h(n,["name"]);i!=null&&m(t,["model"],i);const s=h(n,["name"]);return s!=null&&m(t,["endpoint"],s),t}function N9(n,e){const t={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=h(n,["examples"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),m(t,["examples","examples"],s)}return t}function D9(n,e,t){const i={};let s=h(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let a=h(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function Kx(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["name"]);s!=null&&m(t,["name"],s);const a=h(n,["state"]);a!=null&&m(t,["state"],ax(a));const l=h(n,["createTime"]);l!=null&&m(t,["createTime"],l);const d=h(n,["tuningTask","startTime"]);d!=null&&m(t,["startTime"],d);const f=h(n,["tuningTask","completeTime"]);f!=null&&m(t,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(t,["updateTime"],p);const _=h(n,["description"]);_!=null&&m(t,["description"],_);const E=h(n,["baseModel"]);E!=null&&m(t,["baseModel"],E);const T=h(n,["_self"]);return T!=null&&m(t,["tunedModel"],x9(T)),t}function zy(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["name"]);s!=null&&m(t,["name"],s);const a=h(n,["state"]);a!=null&&m(t,["state"],ax(a));const l=h(n,["createTime"]);l!=null&&m(t,["createTime"],l);const d=h(n,["startTime"]);d!=null&&m(t,["startTime"],d);const f=h(n,["endTime"]);f!=null&&m(t,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(t,["updateTime"],p);const _=h(n,["error"]);_!=null&&m(t,["error"],_);const E=h(n,["description"]);E!=null&&m(t,["description"],E);const T=h(n,["baseModel"]);T!=null&&m(t,["baseModel"],T);const C=h(n,["tunedModel"]);C!=null&&m(t,["tunedModel"],C);const P=h(n,["preTunedModel"]);P!=null&&m(t,["preTunedModel"],P);const O=h(n,["supervisedTuningSpec"]);O!=null&&m(t,["supervisedTuningSpec"],O);const k=h(n,["preferenceOptimizationSpec"]);k!=null&&m(t,["preferenceOptimizationSpec"],k);const Q=h(n,["tuningDataStats"]);Q!=null&&m(t,["tuningDataStats"],Q);const j=h(n,["encryptionSpec"]);j!=null&&m(t,["encryptionSpec"],j);const X=h(n,["partnerModelTuningSpec"]);X!=null&&m(t,["partnerModelTuningSpec"],X);const se=h(n,["customBaseModel"]);se!=null&&m(t,["customBaseModel"],se);const le=h(n,["experiment"]);le!=null&&m(t,["experiment"],le);const ue=h(n,["labels"]);ue!=null&&m(t,["labels"],ue);const N=h(n,["outputUri"]);N!=null&&m(t,["outputUri"],N);const D=h(n,["pipelineJob"]);D!=null&&m(t,["pipelineJob"],D);const x=h(n,["serviceAccount"]);x!=null&&m(t,["serviceAccount"],x);const L=h(n,["tunedModelDisplayName"]);L!=null&&m(t,["tunedModelDisplayName"],L);const V=h(n,["veoTuningSpec"]);return V!=null&&m(t,["veoTuningSpec"],V),t}function M9(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["name"]);s!=null&&m(t,["name"],s);const a=h(n,["metadata"]);a!=null&&m(t,["metadata"],a);const l=h(n,["done"]);l!=null&&m(t,["done"],l);const d=h(n,["error"]);return d!=null&&m(t,["error"],d),t}function SC(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&m(t,["validationDatasetUri"],i);const s=h(n,["vertexDatasetResource"]);return s!=null&&m(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class P9 extends Lr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wo(Dr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:s});return a.baseModel=void 0,await this.tuneInternal(a)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),a=await this.tuneMldevInternal(s);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:Dy.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=A9(e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>zy(_))}else{const p=T9(e);return d=pe("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>Kx(_))}}async listInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=w9(e);return d=pe("tuningJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=b9(_),T=new QI;return Object.assign(T,E),T})}else{const p=C9(e);return d=pe("tunedModels",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=R9(_),T=new QI;return Object.assign(T,E),T})}}async cancel(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=p9(e);return d=pe("{name}:cancel",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=g9(_),T=new XI;return Object.assign(T,E),T})}else{const p=h9(e);return d=pe("{name}:cancel",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=m9(_),T=new XI;return Object.assign(T,E),T})}}async tuneInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=E9(e,e);return a=pe("tuningJobs",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>zy(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=v9(e);return a=pe("tunedModels",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>M9(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k9{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const V9=1024*1024*8,L9=3,U9=1e3,O9=2,Hh="x-goog-upload-status";async function F9(n,e,t){var i;const s=await Jx(n,e,t),a=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[Hh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function B9(n,e,t){var i;const s=await Jx(n,e,t),a=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[Hh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=tx(a),d=new nv;return Object.assign(d,l),d}async function Jx(n,e,t){var i,s;let a=0,l=0,d=new My(new Response),f="upload";for(a=n.size;l<a;){const p=Math.min(V9,a-l),_=n.slice(l,l+p);l+p>=a&&(f+=", finalize");let E=0,T=U9;for(;E<L9&&(d=await t.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((i=d==null?void 0:d.headers)===null||i===void 0)&&i[Hh]));)E++,await G9(T),T=T*O9;if(l+=p,((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[Hh])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return d}async function q9(n){return{size:n.size,type:n.type}}function G9(n){return new Promise(e=>setTimeout(e,n))}class z9{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await F9(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await B9(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await q9(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class H9{create(e,t,i){return new K9(e,t,i)}}class K9{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const IC="x-goog-api-key";class J9{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(IC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(IC,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Y9="gl-node/";class $9{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new en({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=GU(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new J9(this.apiKey);this.apiClient=new q5({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:Y9+"web",uploader:new z9,downloader:new k9}),this.models=new oB(this.apiClient),this.live=new eB(this.apiClient,s,new H9),this.batches=new y6(this.apiClient),this.chats=new Z6(this.models,this.apiClient),this.caches=new Q6(this.apiClient),this.files=new l3(this.apiClient),this.operations=new aB(this.apiClient),this.authTokens=new SB(this.apiClient),this.tunings=new P9(this.apiClient),this.fileSearchStores=new DB(this.apiClient)}}const nd="spanish_assistant_vocab",cv="spanish_assistant_last_analysis",Yx="spanish_assistant_history",$x="spanish_assistant_theme",dv="spanish_assistant_session_key";let Zo=null;Sw(Lo,n=>{Zo=n});const fv=n=>{const e={};return Object.keys(n).forEach(t=>{n[t]!==void 0&&(e[t]=n[t])}),e},Qx=n=>{sessionStorage.setItem(dv,n)},hv=()=>sessionStorage.getItem(dv),Q9=()=>{sessionStorage.removeItem(dv)},pv=()=>{const n=Zo;return n?uU(td,"users",n.uid,"vocabulary"):null},Us=async()=>{if(Zo)try{const e=pv();if(!e)return[];const t=TU(e,AU("addedAt","desc"));return(await wU(t)).docs.map(s=>s.data())}catch(e){return console.error("Failed to load vocab from Firestore",e),[]}try{const e=localStorage.getItem(nd);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load vocab from LocalStorage",e),[]}},X9=async n=>{const e=Zo,t=Date.now();let i=0;const s=await Us(),a=new Set(s.map(d=>d.word.toLowerCase()));if(e)try{const d=jb(td),f=pv();if(!f)return 0;for(const p of n){const _=p.word.toLowerCase();if(!a.has(_)){const E=crypto.randomUUID(),T={...p,id:E,addedAt:t,mastered:!1},C=hp(f,E);d.set(C,fv(T)),i++,a.add(_)}}return i>0&&await d.commit(),i}catch(d){return console.error("Batch add failed in Firestore",d),0}const l=[...s];return n.forEach(d=>{const f=d.word.toLowerCase();a.has(f)||(l.unshift({...d,id:crypto.randomUUID(),addedAt:t,mastered:!1}),i++,a.add(f))}),i>0&&localStorage.setItem(nd,JSON.stringify(l)),i},W9=async n=>{const e=Zo;let t=0;if(e)try{const l=jb(td),d=pv();if(!d)return 0;const f=await Us(),p=new Set(f.map(_=>_.word.toLowerCase()));for(const _ of n)if(!p.has(_.word.toLowerCase())){const E=_.id||crypto.randomUUID(),T=hp(d,E),C={..._,id:E};l.set(T,fv(C)),t++,p.add(_.word.toLowerCase())}return await l.commit(),t}catch(l){return console.error("Import failed in Firestore",l),0}const i=await Us(),s=[...i],a=new Set(i.map(l=>l.word.toLowerCase()));return n.forEach(l=>{a.has(l.word.toLowerCase())||(s.unshift({...l,id:l.id||crypto.randomUUID()}),t++,a.add(l.word.toLowerCase()))}),t>0&&localStorage.setItem(nd,JSON.stringify(s)),t},Z9=async n=>{const e=Zo;if(e)try{const s=hp(td,"users",e.uid,"vocabulary",n);await bU(s);return}catch(s){console.error("Failed to delete from Firestore",s)}const i=(await Us()).filter(s=>s.id!==n);localStorage.setItem(nd,JSON.stringify(i))},j9=async n=>{const e=Zo,t=await Us(),i=t.find(l=>l.id===n);if(!i)return;const s={...i,mastered:!i.mastered};if(e)try{const l=hp(td,"users",e.uid,"vocabulary",n);await RU(l,fv(s),{merge:!0});return}catch(l){console.error("Failed to update Firestore",l)}const a=t.map(l=>l.id===n?s:l);localStorage.setItem(nd,JSON.stringify(a))},eq=(n,e)=>{const t={data:n,image:e,timestamp:Date.now()};localStorage.setItem(cv,JSON.stringify(t));const i=tq(),s=[t,...i].slice(0,10);localStorage.setItem(Yx,JSON.stringify(s))},Xx=()=>{const n=localStorage.getItem(cv);return n?JSON.parse(n):null},CC=()=>{localStorage.removeItem(cv)},tq=()=>{const n=localStorage.getItem(Yx);return n?JSON.parse(n):[]},nq=()=>localStorage.getItem($x)||"light",iq=n=>{localStorage.setItem($x,n)};function rq(n){const e=atob(n),t=e.length,i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=e.charCodeAt(s);return i}async function sq(n,e,t,i){const s=new Int16Array(n.buffer),a=s.length/i,l=e.createBuffer(i,a,t);for(let d=0;d<i;d++){const f=l.getChannelData(d);for(let p=0;p<a;p++)f[p]=s[p*i+d]/32768}return l}const oq={type:xt.OBJECT,properties:{sentences:{type:xt.ARRAY,items:{type:xt.OBJECT,properties:{original:{type:xt.STRING,description:"The EXACT verbatim sentence from the image. No omissions."},translation:{type:xt.STRING,description:"Natural German translation of the full sentence."},words:{type:xt.ARRAY,items:{type:xt.OBJECT,properties:{word:{type:xt.STRING,description:"The word, phrase, punctuation, or space."},type:{type:xt.STRING,enum:["word","punctuation"],description:"Use 'word' for lexical units/phrases, 'punctuation' for symbols/spaces."},translation:{type:xt.STRING,description:"German translation (required if type='word')."},explanation:{type:xt.STRING,description:"German Grammar/context explanation (required if type='word')."},category:{type:xt.STRING,enum:["noun","verb","adjective","function"],description:"Grammatical category."},baseForm:{type:xt.STRING,description:"Lemma/Infinitiv."}},required:["word","type"]}}},required:["original","translation","words"]}}},required:["sentences"]},Wx=()=>{const t=hv()||void 0;if(!t)throw new Error("Kein API Key gefunden. Bitte geben Sie einen in den Einstellungen ein.");return new $9({apiKey:t})},aq=async n=>{const e=Wx(),t=`
    Analyze the attached Spanish book page. You are an expert Spanish teacher.
    
    CRITICAL INSTRUCTIONS:
    1. COMPLETE TRANSCRIPTION: You MUST process EVERY SINGLE SENTENCE visible on the page. Do not skip any sentences.
    2. PHRASE BINDING: Combine words that belong together (reflexive verbs like "se levant", idioms like "tener que") into a SINGLE 'word' object.
    3. FULL CHARACTER COVERAGE: Reconstruct the 'original' string perfectly including spaces.
    4. Provide the result in German.
  `;try{const s=(await e.models.generateContent({model:"gemini-3-flash-preview",contents:{parts:[{inlineData:{mimeType:"image/jpeg",data:n}},{text:t}]},config:{responseMimeType:"application/json",responseSchema:oq,systemInstruction:"You are a professional Spanish-to-German translator. Extract all text and provide linguistic analysis for learners."}})).text;if(!s)throw new Error("No response text from Gemini.");return JSON.parse(s)}catch(i){throw console.error("Analysis failed:",i),i}},Zx=async n=>{var t,i,s,a,l,d;const e=Wx();try{const p=(d=(l=(a=(s=(i=(t=(await e.models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:n}]}],config:{responseModalities:[Oc.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Puck"}}}}})).candidates)==null?void 0:t[0])==null?void 0:i.content)==null?void 0:s.parts)==null?void 0:a[0])==null?void 0:l.inlineData)==null?void 0:d.data;if(!p)throw new Error("No audio data returned");const _=new(window.AudioContext||window.webkitAudioContext)({sampleRate:24e3}),E=_.createGain();E.connect(_.destination);const T=await sq(rq(p),_,24e3,1),C=_.createBufferSource();C.buffer=T,C.connect(E),C.start()}catch(f){throw console.error("TTS failed:",f),f}},lq=({onChangeView:n})=>{const[e,t]=we.useState(null),[i,s]=we.useState(!1),[a,l]=we.useState(null),[d,f]=we.useState(0),[p,_]=we.useState("sentence"),[E,T]=we.useState(0),[C,P]=we.useState(null),[O,k]=we.useState(!1),[Q,j]=we.useState(0),[X,se]=we.useState(new Set),le=we.useRef(null);we.useEffect(()=>{const Te=Xx();Te&&!a&&(l(Te.data),t(Te.image))},[]),we.useEffect(()=>{(async()=>{const Y=await Us();se(new Set(Y.map(oe=>oe.word.toLowerCase())))})()},[a]);const ue=async Te=>{s(!0),l(null),k(!1),f(0),_("sentence"),T(0),j(0);try{const Y=await aq(Te);l(Y),eq(Y,Te)}catch(Y){console.error(Y),t(null)}finally{s(!1)}},N=Te=>{var oe;const Y=(oe=Te.target.files)==null?void 0:oe[0];if(Y){const _e=new FileReader;_e.onloadend=()=>{const Qe=_e.result.split(",")[1];t(Qe),ue(Qe)},_e.readAsDataURL(Y)}},D=async(Te,Y)=>{if(!C){P(Y);try{await Zx(Te)}catch(oe){console.error(oe)}finally{P(null)}}},x=a==null?void 0:a.sentences[d],L=(x==null?void 0:x.words.filter(Te=>Te.type==="word"))||[],V=we.useCallback(async()=>{if(!(!a||!x)){if(p==="sentence")L.length>0?(_("words"),T(0)):_("translation");else if(p==="words")E<L.length-1?T(Te=>Te+1):_("translation");else if(p==="translation"){const Te=L.map(oe=>({word:oe.word,translation:oe.translation||"",explanation:oe.explanation||"",category:oe.category,baseForm:oe.baseForm,contextSentence:x.original})),Y=await X9(Te);j(oe=>oe+Y),se(oe=>{const _e=new Set(oe);return Te.forEach(Oe=>_e.add(Oe.word.toLowerCase())),_e}),d<a.sentences.length-1?(f(oe=>oe+1),_("sentence"),T(0)):(k(!0),CC())}}},[a,p,E,d,L,x]),F=()=>{p==="translation"?L.length>0?(_("words"),T(L.length-1)):_("sentence"):p==="words"?E>0?T(Te=>Te-1):_("sentence"):p==="sentence"&&d>0&&(f(Te=>Te-1),_("translation"))},M=()=>{t(null),l(null),k(!1),CC()};if(we.useEffect(()=>{const Te=Y=>{Y.code==="Space"&&a&&!O&&(Y.preventDefault(),V())};return window.addEventListener("keydown",Te),()=>window.removeEventListener("keydown",Te)},[a,O,V]),i)return R.jsxs("div",{className:"fixed inset-0 bg-[#FDFBF7] dark:bg-[#12100E] flex flex-col items-center justify-center text-center p-6 z-50",children:[R.jsx(Mo,{className:"w-12 h-12 animate-spin text-[#6B705C] dark:text-[#D4A373] mb-4"}),R.jsx("h2",{className:"text-xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7]",children:"Verarbeite Seite..."}),R.jsx("p",{className:"text-sm text-[#6B705C] dark:text-[#A5A58D] font-serif italic mt-2",children:"Die KI analysiert Grammatik und Vokabeln."})]});if(!a&&!e)return R.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] gap-6 animate-fade-in text-center px-6",children:[R.jsx(Jg,{className:"w-16 h-16 text-[#6B705C] dark:text-[#A5A58D] opacity-20"}),R.jsxs("div",{children:[R.jsx("h2",{className:"text-2xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2",children:"Bereit zum Lesen?"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Scanne eine Seite deines spanischen Buches."})]}),R.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:le,className:"hidden",onChange:N}),R.jsx("button",{onClick:()=>{var Te;return(Te=le.current)==null?void 0:Te.click()},className:"bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E] py-4 px-10 rounded-2xl shadow-xl font-bold uppercase text-[10px] tracking-widest active:scale-95 transition-transform",children:"Kamera starten"})]});if(O)return R.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-6 animate-fade-in",children:[R.jsx("div",{className:"w-16 h-16 bg-[#E9EDC9] dark:bg-[#2C2420] rounded-2xl flex items-center justify-center text-[#6B705C] dark:text-[#D4A373] mb-6",children:R.jsx(fh,{className:"w-8 h-8"})}),R.jsx("h2",{className:"text-2xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2",children:"Seite beendet!"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] font-serif italic mb-8",children:Q>0?`Du hast ${Q} neue Fundstcke in deine Sammlung aufgenommen.`:"Alle Wrter dieser Seite sind bereits in deiner Sammlung."}),R.jsxs("div",{className:"flex gap-4",children:[R.jsx("button",{onClick:M,className:"bg-[#6B705C] dark:bg-[#2C2420] text-white px-8 py-4 rounded-2xl font-bold uppercase text-[10px] tracking-widest border dark:border-[#2C2420] shadow-md",children:"Nchste Seite"}),R.jsx("button",{onClick:()=>n==null?void 0:n(St.VOCAB),className:"bg-[#B26B4A] dark:bg-[#D4A373] text-white dark:text-[#12100E] px-8 py-4 rounded-2xl font-bold uppercase text-[10px] tracking-widest shadow-md",children:"Zum Lernbereich"})]})]});const me=L[E];return R.jsxs("div",{className:"fixed inset-0 bg-[#FDFBF7] dark:bg-[#12100E] flex flex-col overflow-hidden animate-fade-in transition-colors",children:[R.jsxs("div",{className:"px-6 pt-4 pb-2 flex justify-between items-center bg-[#FDFBF7] dark:bg-[#12100E] z-10 transition-colors",children:[R.jsxs("div",{className:"flex flex-col gap-1 w-full max-w-[150px]",children:[R.jsxs("span",{className:"text-[9px] font-bold text-[#6B705C] dark:text-[#A5A58D] uppercase tracking-widest",children:["Satz ",d+1," / ",a==null?void 0:a.sentences.length]}),R.jsx("div",{className:"h-1 bg-[#EAE2D6] dark:bg-[#2C2420] rounded-full overflow-hidden",children:R.jsx("div",{className:"h-full bg-[#B26B4A] dark:bg-[#D4A373] transition-all duration-500",style:{width:`${(d+1)/((a==null?void 0:a.sentences.length)||1)*100}%`}})})]}),R.jsx("button",{onClick:M,className:"p-2 text-[#A5A58D] dark:text-[#2C2420] hover:text-[#B26B4A] dark:hover:text-[#D4A373]",children:R.jsx(uD,{className:"w-5 h-5"})})]}),R.jsxs("div",{className:"flex-grow flex flex-col px-6 py-4 overflow-hidden relative",children:[p==="sentence"&&R.jsx("div",{className:"flex-grow flex items-center justify-center animate-fade-in",children:R.jsx("p",{className:"text-2xl sm:text-3xl font-serif text-[#2C2420] dark:text-[#FDFBF7] leading-relaxed text-center italic",children:x==null?void 0:x.original})}),p==="words"&&x&&R.jsxs("div",{className:"flex-grow flex flex-col gap-6 animate-fade-in h-full",children:[R.jsx("div",{className:"bg-white dark:bg-[#1C1917] p-4 rounded-2xl border border-[#EAE2D6] dark:border-[#2C2420] shadow-sm shrink-0",children:R.jsx("p",{className:"text-lg font-serif text-[#2C2420] dark:text-[#FDFBF7] leading-relaxed",children:x.words.map((Te,Y)=>{const oe=me&&Te.word===me.word;return R.jsx("span",{className:`transition-colors duration-300 ${oe?"bg-[#FEFAE0] dark:bg-[#2C2420] text-[#B26B4A] dark:text-[#D4A373] font-bold px-1 rounded":"opacity-40"}`,children:Te.word},Y)})})}),R.jsx("div",{className:"flex-grow flex items-center justify-center overflow-hidden",children:me&&R.jsxs("div",{className:"w-full bg-[#2C2420] dark:bg-[#1C1917] text-[#FDFBF7] p-6 rounded-[2rem] shadow-xl border border-transparent dark:border-[#2C2420] flex flex-col animate-fade-in overflow-hidden max-h-full",children:[R.jsxs("div",{className:"overflow-y-auto",children:[R.jsx("span",{className:"text-[8px] font-bold uppercase tracking-[0.2em] text-[#B26B4A] dark:text-[#D4A373] mb-2 block",children:me.category||"Vokabel"}),R.jsx("h3",{className:"text-3xl font-serif font-bold text-[#FEFAE0] dark:text-[#D4A373] mb-2",children:me.word}),R.jsx("p",{className:"text-xl font-serif italic text-[#FDFBF7]/90 mb-4",children:me.translation}),me.explanation&&R.jsx("div",{className:"bg-white/5 dark:bg-black/20 p-4 rounded-xl border border-white/10 dark:border-white/5 mb-4",children:R.jsx("p",{className:"text-sm font-serif italic text-[#FDFBF7]/70 leading-relaxed",children:me.explanation})})]}),R.jsxs("div",{className:"mt-auto pt-4 flex justify-between items-center border-t border-white/10",children:[R.jsx("button",{onClick:()=>D(me.word,`w-${d}-${E}`),className:"w-10 h-10 bg-[#B26B4A] dark:bg-[#D4A373] rounded-xl flex items-center justify-center",children:C===`w-${d}-${E}`?R.jsx(Mo,{className:"w-4 h-4 animate-spin text-white"}):R.jsx(ph,{className:"w-4 h-4 fill-white text-white dark:text-[#12100E] dark:fill-[#12100E]"})}),X.has(me.word.toLowerCase())&&R.jsxs("div",{className:"flex items-center gap-1.5 bg-[#E9EDC9]/20 px-3 py-1.5 rounded-full",children:[R.jsx(fh,{className:"w-3 h-3 text-[#E9EDC9]"}),R.jsx("span",{className:"text-[8px] font-bold uppercase tracking-widest text-[#E9EDC9]",children:"In Sammlung"})]})]})]})})]}),p==="translation"&&x&&R.jsxs("div",{className:"flex-grow flex flex-col justify-center gap-8 animate-fade-in",children:[R.jsxs("div",{className:"text-center",children:[R.jsx("span",{className:"text-[8px] font-bold text-[#6B705C] dark:text-[#A5A58D] uppercase tracking-widest mb-2 block",children:"Original"}),R.jsx("p",{className:"text-2xl font-serif text-[#2C2420] dark:text-[#FDFBF7] leading-relaxed italic",children:x.original})]}),R.jsx("div",{className:"w-12 h-[1px] bg-[#EAE2D6] dark:bg-[#2C2420] mx-auto opacity-50"}),R.jsxs("div",{className:"text-center",children:[R.jsx("span",{className:"text-[8px] font-bold text-[#B26B4A] dark:text-[#D4A373] uppercase tracking-widest mb-2 block",children:"bersetzung"}),R.jsx("p",{className:"text-xl font-serif text-[#6B705C] dark:text-[#A5A58D] leading-relaxed",children:x.translation})]}),R.jsx("button",{onClick:()=>D(x.original,`s-${d}`),className:"mx-auto w-12 h-12 bg-[#FDFBF7] dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] rounded-full flex items-center justify-center text-[#6B705C] dark:text-[#A5A58D] hover:bg-[#FEFAE0] dark:hover:bg-[#2C2420] transition-colors",children:C===`s-${d}`?R.jsx(Mo,{className:"w-4 h-4 animate-spin"}):R.jsx(ph,{className:"w-4 h-4 fill-current"})})]})]}),R.jsx("div",{className:"px-6 py-6 bg-[#FDFBF7] dark:bg-[#12100E] border-t border-[#EAE2D6] dark:border-[#2C2420] shrink-0 pb-[max(1.5rem,env(safe-area-inset-bottom))] transition-colors",children:R.jsxs("div",{className:"flex gap-3 max-w-lg mx-auto",children:[R.jsx("button",{onClick:F,disabled:p==="sentence"&&d===0,className:"w-14 h-14 flex items-center justify-center bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl text-[#6B705C] dark:text-[#A5A58D] disabled:opacity-20 active:scale-95 transition-all shadow-sm",children:R.jsx(tD,{className:"w-6 h-6"})}),R.jsxs("button",{onClick:V,className:`flex-grow h-14 rounded-2xl flex items-center justify-center gap-3 font-bold text-[10px] uppercase tracking-[0.2em] shadow-lg active:scale-95 transition-all ${p==="translation"?"bg-[#B26B4A] dark:bg-[#D4A373] text-white dark:text-[#12100E]":"bg-[#2C2420] dark:bg-white text-white dark:text-[#12100E]"}`,children:[p==="sentence"?"Wrter analysieren":p==="words"&&E<L.length-1?"Nchstes Wort":p==="words"?"bersetzung":"Nchster Satz",R.jsx(jN,{className:"w-4 h-4"})]})]})})]})},uq=()=>{const[n,e]=we.useState([]),[t,i]=we.useState(!0),[s,a]=we.useState("list"),[l,d]=we.useState("all"),[f,p]=we.useState([]),[_,E]=we.useState(0),[T,C]=we.useState(!1),[P,O]=we.useState(!1),k=we.useRef(null);we.useEffect(()=>{Q()},[]);const Q=async()=>{i(!0);const F=await Us();e(F.sort((M,me)=>me.addedAt-M.addedAt)),i(!1)},j=()=>l==="all"?n:n.filter(F=>(F.category||"function")===l),X=async F=>{window.confirm("Dieses Wort aus deiner Sammlung lschen?")&&(await Z9(F),Q())},se=()=>{const F=JSON.stringify(n,null,2),M="data:application/json;charset=utf-8,"+encodeURIComponent(F),me=`spanish-vocab-${new Date().toISOString().split("T")[0]}.json`,Te=document.createElement("a");Te.setAttribute("href",M),Te.setAttribute("download",me),Te.click()},le=()=>{var F;(F=k.current)==null||F.click()},ue=async F=>{var Te;const M=(Te=F.target.files)==null?void 0:Te[0];if(!M)return;O(!0);const me=new FileReader;me.onload=async Y=>{var oe;try{const _e=JSON.parse((oe=Y.target)==null?void 0:oe.result);if(Array.isArray(_e)){const Oe=await W9(_e);alert(`${Oe} neue Vokabeln importiert!`),await Q()}else alert("Ungltiges JSON-Format. Erwartet wird ein Array von Vokabeln.")}catch(_e){console.error("Import failed:",_e),alert("Import fehlgeschlagen. Bitte berprfen Sie die Datei.")}finally{O(!1),k.current&&(k.current.value="")}},me.readAsText(M)},N=()=>{const F=j().filter(me=>!me.mastered);if(F.length===0){alert("Keine offenen Vokabeln in dieser Kategorie!");return}const M=[...F].sort(()=>Math.random()-.5);p(M),E(0),C(!1),a("train")},D=async F=>{const M=f[_];F==="good"?await j9(M.id):p(me=>[...me,M]),C(!1),_<f.length-1?E(me=>me+1):(alert("Sitzung abgeschlossen! Gut gemacht."),a("list"),Q())},x=async()=>{if(s==="train"&&f[_])try{await Zx(f[_].word)}catch(F){console.error(F)}},L=()=>R.jsx("div",{className:"flex overflow-x-auto gap-3 pb-3 mb-6 scrollbar-hide px-1",children:["all","noun","verb","adjective","function"].map(F=>R.jsx("button",{onClick:()=>d(F),className:`px-5 py-2.5 rounded-2xl whitespace-nowrap text-xs font-bold uppercase tracking-widest transition-all duration-300 ${l===F?"bg-[#B26B4A] dark:bg-[#D4A373] text-[#FDFBF7] dark:text-[#12100E] shadow-lg":"bg-white dark:bg-[#1C1917] text-[#6B705C] dark:text-[#A5A58D] border border-[#EAE2D6] dark:border-[#2C2420]"}`,children:F==="all"?"Alle":F==="noun"?"Nomen":F==="verb"?"Verben":F==="adjective"?"Adjektive":"Andere"},F))});if(t)return R.jsx("div",{className:"flex flex-col items-center justify-center h-[50vh] animate-fade-in",children:R.jsx(Mo,{className:"w-10 h-10 animate-spin text-[#B26B4A] dark:text-[#D4A373]"})});if(n.length===0&&!P)return R.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] text-center p-8 animate-fade-in",children:[R.jsx("div",{className:"w-20 h-20 bg-white dark:bg-[#1C1917] rounded-full flex items-center justify-center mb-6 text-[#A5A58D] border border-[#EAE2D6] dark:border-[#2C2420]",children:R.jsx(hD,{className:"w-10 h-10"})}),R.jsx("h3",{className:"text-2xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7]",children:"Deine Sammlung ist leer"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] mt-3 font-serif italic mb-6",children:"Scanne ein Buch, um neue Vokabeln automatisch hierher zu speichern."}),R.jsx("input",{type:"file",accept:".json",ref:k,className:"hidden",onChange:ue}),R.jsxs("button",{onClick:le,className:"bg-white dark:bg-[#1C1917] text-[#6B705C] dark:text-[#A5A58D] border border-[#EAE2D6] dark:border-[#2C2420] px-6 py-3 rounded-2xl flex items-center gap-2 font-bold uppercase text-[10px] tracking-widest shadow-sm hover:bg-[#FDFBF7] transition-all",children:[R.jsx(Y0,{className:"w-4 h-4"}),"JSON Importieren"]})]});if(s==="list"){const F=j(),M=F.filter(me=>!me.mastered).length;return R.jsxs("div",{className:"space-y-6 pb-24 animate-fade-in",children:[R.jsxs("div",{className:"bg-[#2C2420] dark:bg-[#1C1917] rounded-[2.5rem] p-8 text-[#FDFBF7] shadow-2xl mb-8 relative overflow-hidden border border-transparent dark:border-[#2C2420]",children:[R.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#B26B4A]/10 dark:bg-[#D4A373]/5 rounded-full -mr-16 -mt-16"}),R.jsxs("div",{className:"relative z-10",children:[R.jsxs("div",{className:"flex justify-between items-start mb-4",children:[R.jsxs("div",{children:[R.jsx("h2",{className:"text-4xl font-serif font-bold",children:M}),R.jsx("p",{className:"text-[#FDFBF7]/60 text-sm font-serif italic tracking-wide",children:"offene Fundstcke"})]}),R.jsxs("div",{className:"flex gap-2",children:[R.jsx("input",{type:"file",accept:".json",ref:k,className:"hidden",onChange:ue}),R.jsx("button",{onClick:le,disabled:P,className:"p-3 bg-white/10 hover:bg-white/20 rounded-2xl text-[#FDFBF7] transition-all border border-white/10",title:"Vokabeln importieren",children:P?R.jsx(Mo,{className:"w-5 h-5 animate-spin"}):R.jsx(Y0,{className:"w-5 h-5"})}),R.jsx("button",{onClick:se,className:"p-3 bg-white/10 hover:bg-white/20 rounded-2xl text-[#FDFBF7] transition-all border border-white/10",title:"Vokabeln exportieren",children:R.jsx(dD,{className:"w-5 h-5"})}),R.jsx(_D,{className:"w-8 h-8 text-[#B26B4A] dark:text-[#D4A373] ml-2"})]})]}),R.jsx("button",{onClick:N,disabled:M===0,className:"w-full bg-[#B26B4A] dark:bg-[#D4A373] text-white dark:text-[#12100E] font-bold py-4 rounded-2xl shadow-xl hover:bg-[#9E5A3B] transition-all disabled:opacity-30 mt-4 uppercase text-xs tracking-[0.2em]",children:"Sitzung starten"})]})]}),L(),R.jsx("div",{className:"grid gap-4",children:F.length===0?R.jsx("p",{className:"text-center text-[#A5A58D] py-12 font-serif italic",children:"In dieser Kategorie hast du noch keine Wrter gesammelt."}):F.map(me=>R.jsxs("div",{className:"bg-white dark:bg-[#1C1917] p-5 rounded-3xl border border-[#EAE2D6] dark:border-[#2C2420] shadow-sm flex justify-between items-center group transition-all hover:border-[#B26B4A]/30 dark:hover:border-[#D4A373]/30",children:[R.jsxs("div",{className:"flex-grow",children:[R.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[R.jsx("p",{className:"font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] text-xl",children:me.word}),me.mastered&&R.jsx(fh,{className:"w-4 h-4 text-[#6B705C] dark:text-[#D4A373]"}),me.category&&R.jsx("span",{className:"text-[7px] font-bold uppercase tracking-widest text-[#B26B4A] dark:text-[#D4A373] bg-[#B26B4A]/10 px-1.5 py-0.5 rounded",children:me.category})]}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] text-sm italic font-serif",children:me.translation})]}),R.jsx("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:R.jsx("button",{onClick:()=>X(me.id),className:"p-3 text-[#A5A58D] hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10 rounded-2xl transition-all",children:R.jsx(kC,{className:"w-5 h-5"})})})]},me.id))})]})}const V=f[_];return R.jsxs("div",{className:"h-full flex flex-col items-center max-w-md mx-auto animate-fade-in",children:[R.jsxs("div",{className:"w-full flex justify-between items-center mb-8",children:[R.jsx("button",{onClick:()=>a("list"),className:"text-[#6B705C] dark:text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7] text-xs font-bold uppercase tracking-widest bg-white dark:bg-[#1C1917] px-4 py-2 rounded-xl border border-[#EAE2D6] dark:border-[#2C2420]",children:"Abbrechen"}),R.jsxs("span",{className:"text-[#A5A58D] text-xs font-bold tracking-[0.3em]",children:[_+1," / ",f.length]})]}),R.jsx("div",{className:"w-full aspect-[4/5] perspective-1000 cursor-pointer mb-10",onClick:()=>!T&&C(!0),children:R.jsxs("div",{className:"relative w-full h-full bg-white dark:bg-[#1C1917] rounded-[3rem] shadow-2xl border border-[#EAE2D6] dark:border-[#2C2420] overflow-hidden flex flex-col transition-all duration-500",children:[R.jsxs("div",{className:`flex-1 flex flex-col items-center justify-center p-10 text-center ${T?"border-b border-[#FDFBF7] dark:border-[#12100E]":""}`,children:[R.jsx("span",{className:"text-[10px] font-bold text-[#B26B4A] dark:text-[#D4A373] uppercase tracking-[0.3em] mb-6",children:V.category||"Wort"}),R.jsx("h2",{className:"text-5xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-8",children:V.word}),!T&&R.jsxs("div",{className:"flex flex-col items-center gap-4",children:[R.jsx("p",{className:"text-[#A5A58D] text-sm font-serif italic animate-pulse",children:"Karte aufdecken"}),R.jsx("button",{onClick:F=>{F.stopPropagation(),x()},className:"p-4 bg-[#FEFAE0] dark:bg-[#2C2420] text-[#B26B4A] dark:text-[#D4A373] rounded-2xl hover:bg-[#FAEDCD] dark:hover:bg-black/20",children:R.jsx(ph,{className:"w-6 h-6 fill-current"})})]})]}),T&&R.jsxs("div",{className:"flex-1 bg-[#FDFBF7] dark:bg-[#12100E] flex flex-col items-center justify-center p-10 text-center animate-in fade-in slide-in-from-bottom-6 duration-500 overflow-y-auto",children:[R.jsx("h2",{className:"text-3xl font-serif font-bold text-[#B26B4A] dark:text-[#D4A373] mb-3",children:V.translation}),V.baseForm&&V.baseForm.toLowerCase()!==V.word.toLowerCase()&&R.jsxs("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] mb-4 font-bold uppercase tracking-widest opacity-60",children:["Grundform: ",V.baseForm]}),R.jsxs("p",{className:"text-[#6B705C] dark:text-[#A5A58D] italic font-serif text-lg leading-relaxed mb-6",children:['"',V.explanation,'"']}),V.contextSentence&&R.jsxs("div",{className:"mb-6 p-4 bg-white/50 dark:bg-white/5 rounded-2xl border border-[#EAE2D6] dark:border-white/10 relative",children:[R.jsx(MD,{className:"w-3 h-3 text-[#B26B4A] dark:text-[#D4A373] absolute top-2 left-2 opacity-30"}),R.jsx("p",{className:"text-[11px] font-serif italic text-[#6B705C] dark:text-[#A5A58D] px-2",children:V.contextSentence})]}),R.jsx("button",{onClick:F=>{F.stopPropagation(),x()},className:"p-3 bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#6B705C] dark:text-[#A5A58D] rounded-xl hover:bg-[#E9EDC9] dark:hover:bg-[#2C2420]",children:R.jsx(ph,{className:"w-5 h-5 fill-current"})})]})]})}),T?R.jsxs("div",{className:"grid grid-cols-2 gap-6 w-full px-4",children:[R.jsxs("button",{onClick:()=>D("again"),className:"flex flex-col items-center justify-center p-5 bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#B26B4A] dark:text-[#D4A373] rounded-3xl hover:bg-[#FEFAE0] dark:hover:bg-[#2C2420] active:scale-95 transition-all shadow-sm",children:[R.jsx(kD,{className:"w-6 h-6 mb-2"}),R.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Nochmal"})]}),R.jsxs("button",{onClick:()=>D("good"),className:"flex flex-col items-center justify-center p-5 bg-[#6B705C] dark:bg-[#D4A373] text-white dark:text-[#12100E] rounded-3xl hover:bg-[#585E4A] dark:hover:bg-[#B26B4A] active:scale-95 transition-all shadow-xl",children:[R.jsx(fh,{className:"w-6 h-6 mb-2"}),R.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Gelernt"})]})]}):R.jsx("div",{className:"w-full px-4",children:R.jsx("button",{onClick:()=>C(!0),className:"w-full bg-[#2C2420] dark:bg-[#D4A373] text-[#FDFBF7] dark:text-[#12100E] font-bold py-5 rounded-3xl shadow-2xl hover:bg-[#3D332D] dark:hover:bg-[#B26B4A] active:scale-95 transition-all uppercase text-xs tracking-[0.3em]",children:"Antwort zeigen"})})]})},cq=()=>{const[n,e]=we.useState(""),[t,i]=we.useState(!1),[s,a]=we.useState(!1);we.useEffect(()=>{const f=hv();f&&(i(!0),e(f))},[]);const l=()=>{n.trim()&&(Qx(n.trim()),i(!0),a(!0),setTimeout(()=>a(!1),3e3))},d=()=>{Q9(),e(""),i(!1)};return R.jsxs("div",{className:"max-w-2xl mx-auto py-8 animate-fade-in",children:[R.jsxs("div",{className:"mb-10",children:[R.jsx("h2",{className:"text-3xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2",children:"Einstellungen"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Verwalte deinen Zugang zur KI und deine lokalen Daten."})]}),R.jsxs("div",{className:"space-y-6",children:[R.jsxs("section",{className:"bg-white dark:bg-[#1C1917] rounded-[2.5rem] border border-[#EAE2D6] dark:border-[#2C2420] p-8 shadow-sm",children:[R.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[R.jsx("div",{className:"w-12 h-12 bg-[#FEFAE0] dark:bg-[#2C2420] rounded-xl flex items-center justify-center text-[#B26B4A] dark:text-[#D4A373] shadow-sm",children:R.jsx(hh,{className:"w-6 h-6"})}),R.jsxs("div",{children:[R.jsx("h3",{className:"font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] text-xl",children:"API Konfiguration"}),R.jsx("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Dein persnlicher Schlssel fr Google Gemini."})]})]}),R.jsxs("div",{className:"space-y-4",children:[R.jsxs("div",{className:"relative",children:[R.jsx("input",{type:"password",value:n,onChange:f=>e(f.target.value),placeholder:"Geben Sie Ihren API Key ein...",className:"w-full bg-[#FDFBF7] dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-4 pr-12 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm font-mono"}),R.jsx(hh,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D] opacity-40"})]}),R.jsxs("div",{className:"flex flex-wrap gap-3",children:[R.jsxs("button",{onClick:l,disabled:!n.trim(),className:"flex-1 bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E] py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] shadow-lg active:scale-95 transition-all flex items-center justify-center gap-2 disabled:opacity-30",children:[s?R.jsx(J0,{className:"w-4 h-4"}):R.jsx(LD,{className:"w-4 h-4"}),s?"Gespeichert":"Key Speichern"]}),t&&R.jsxs("button",{onClick:d,className:"bg-red-50 dark:bg-red-900/10 text-red-600 dark:text-red-400 border border-red-100 dark:border-red-900/30 px-6 py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] active:scale-95 transition-all flex items-center justify-center gap-2",children:[R.jsx(kC,{className:"w-4 h-4"}),"Lschen"]})]}),R.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-2xl border transition-colors ${t?"bg-[#E9EDC9]/30 border-[#CCD5AE]/30":"bg-[#FEFAE0]/50 border-[#FAEDCD]"}`,children:[t?R.jsx(J0,{className:"w-5 h-5 text-[#6B705C] shrink-0 mt-0.5"}):R.jsx(iD,{className:"w-5 h-5 text-[#B26B4A] shrink-0 mt-0.5"}),R.jsxs("div",{children:[R.jsxs("p",{className:"text-xs font-bold uppercase tracking-widest text-[#2C2420] dark:text-[#FDFBF7] mb-1",children:["Status: ",t?"Persnlicher Key aktiv":"Kein Key konfiguriert"]}),R.jsx("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:t?"Dieser Key wird ausschlielich in deiner aktuellen Browser-Session verwendet und nicht permanent gespeichert.":"Bitte hinterlege einen Key, um die bersetzungs- und Audio-Funktionen nutzen zu knnen."})]})]})]})]}),R.jsxs("section",{className:"bg-[#FEFAE0]/30 dark:bg-[#1C1917]/50 rounded-[2.5rem] border border-[#FAEDCD] dark:border-[#2C2420] p-8",children:[R.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[R.jsx("div",{className:"w-10 h-10 bg-white dark:bg-[#2C2420] rounded-xl flex items-center justify-center text-[#6B705C] dark:text-[#A5A58D] shadow-sm",children:R.jsx(MC,{className:"w-5 h-5"})}),R.jsx("h3",{className:"font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7]",children:"Sicherheit & Lokalitt"})]}),R.jsxs("p",{className:"text-sm text-[#6B705C] dark:text-[#A5A58D] font-serif italic leading-relaxed",children:["Dein Lernfortschritt wird bei Gsten ausschlielich in deinem Browser (Local Storage) gespeichert. API Keys werden aus Sicherheitsgrnden nur im ",R.jsx("strong",{children:"Session Storage"})," gehalten  sie verschwinden, sobald du den Tab schliet."]})]})]})]})},dq=({onGuestLogin:n})=>{const[e,t]=we.useState(!0),[i,s]=we.useState(""),[a,l]=we.useState(""),[d,f]=we.useState(""),[p,_]=we.useState(!1),[E,T]=we.useState(null),C=async P=>{P.preventDefault(),_(!0),T(null);try{if(e)await xP(Lo,i,a);else{const O=await bP(Lo,i,a);await DP(O.user,{displayName:d})}}catch(O){console.error("Auth error:",O),T(O.message||"Authentifizierung fehlgeschlagen.")}finally{_(!1)}};return R.jsx("div",{className:"min-h-screen flex items-center justify-center p-6 bg-[#FDFBF7] dark:bg-[#12100E]",children:R.jsxs("div",{className:"w-full max-w-md animate-fade-in",children:[R.jsxs("div",{className:"text-center mb-8",children:[R.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-[#2C2420] dark:bg-[#D4A373] rounded-2xl text-[#FDFBF7] dark:text-[#12100E] shadow-xl mb-6",children:R.jsx(bC,{className:"w-8 h-8"})}),R.jsx("h1",{className:"text-3xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2 tracking-tight",children:"Spanish Reading Assistant"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Melde dich an, um deine Lesereise zu beginnen."})]}),R.jsxs("div",{className:"bg-white dark:bg-[#1C1917] p-8 rounded-[2.5rem] border border-[#EAE2D6] dark:border-[#2C2420] shadow-2xl",children:[R.jsxs("div",{className:"flex bg-[#FDFBF7] dark:bg-[#12100E] p-1 rounded-2xl border border-[#EAE2D6] dark:border-[#2C2420] mb-8",children:[R.jsx("button",{onClick:()=>t(!0),className:`flex-1 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest transition-all ${e?"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm":"text-[#6B705C] dark:text-[#A5A58D]"}`,children:"Anmelden"}),R.jsx("button",{onClick:()=>t(!1),className:`flex-1 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest transition-all ${e?"text-[#6B705C] dark:text-[#A5A58D]":"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm"}`,children:"Registrieren"})]}),R.jsxs("form",{onSubmit:C,className:"space-y-5",children:[!e&&R.jsxs("div",{className:"space-y-2",children:[R.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-[#6B705C] dark:text-[#A5A58D] ml-1",children:"Name"}),R.jsxs("div",{className:"relative",children:[R.jsx(VC,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D]"}),R.jsx("input",{type:"text",required:!0,value:d,onChange:P=>f(P.target.value),className:"w-full bg-[#FDFBF7] dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm",placeholder:"Dein Name"})]})]}),R.jsxs("div",{className:"space-y-2",children:[R.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-[#6B705C] dark:text-[#A5A58D] ml-1",children:"Email"}),R.jsxs("div",{className:"relative",children:[R.jsx(RD,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D]"}),R.jsx("input",{type:"email",required:!0,value:i,onChange:P=>s(P.target.value),className:"w-full bg-[#FDFBF7] dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm",placeholder:"name@beispiel.de"})]})]}),R.jsxs("div",{className:"space-y-2",children:[R.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-[#6B705C] dark:text-[#A5A58D] ml-1",children:"Passwort"}),R.jsxs("div",{className:"relative",children:[R.jsx(TD,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D]"}),R.jsx("input",{type:"password",required:!0,value:a,onChange:P=>l(P.target.value),className:"w-full bg-[#FDFBF7] dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm",placeholder:""})]})]}),E&&R.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-900/30 rounded-2xl text-red-600 dark:text-red-400 text-xs font-serif italic",children:E}),R.jsx("button",{type:"submit",disabled:p,className:"w-full bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E] py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50",children:p?R.jsx(Mo,{className:"w-4 h-4 animate-spin"}):e?R.jsxs(R.Fragment,{children:[R.jsx(SD,{className:"w-4 h-4"}),"Anmelden"]}):R.jsxs(R.Fragment,{children:[R.jsx(KD,{className:"w-4 h-4"}),"Konto erstellen"]})})]}),R.jsxs("div",{className:"relative my-8",children:[R.jsx("div",{className:"absolute inset-0 flex items-center",children:R.jsx("div",{className:"w-full border-t border-[#EAE2D6] dark:border-[#2C2420]"})}),R.jsx("div",{className:"relative flex justify-center text-[8px] font-bold uppercase tracking-[0.3em]",children:R.jsx("span",{className:"bg-white dark:bg-[#1C1917] px-4 text-[#A5A58D]",children:"Oder"})})]}),R.jsxs("button",{onClick:n,disabled:p,className:"w-full bg-white dark:bg-transparent border border-[#EAE2D6] dark:border-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] shadow-sm active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50 hover:bg-[#FDFBF7] dark:hover:bg-[#2C2420]/30",children:[R.jsx(aD,{className:"w-4 h-4"}),"Als Gast fortfahren"]}),R.jsxs("div",{className:"mt-8 pt-8 border-t border-[#EAE2D6] dark:border-[#2C2420] flex items-center justify-center gap-2 text-[#6B705C] dark:text-[#A5A58D]",children:[R.jsx(PC,{className:"w-4 h-4 opacity-50"}),R.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest opacity-50",children:"App by Spanish Learners"})]})]})]})})},fq=({onClose:n})=>{const[e,t]=we.useState(""),i=()=>{e.trim()&&(Qx(e.trim()),n())};return R.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-6 bg-[#12100E]/80 backdrop-blur-sm animate-fade-in",children:R.jsxs("div",{className:"w-full max-w-md bg-[#FDFBF7] dark:bg-[#1C1917] rounded-[2.5rem] shadow-2xl border border-[#EAE2D6] dark:border-[#2C2420] p-8 relative",children:[R.jsx("button",{onClick:n,className:"absolute top-6 right-6 p-2 text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7] transition-colors",children:R.jsx($D,{className:"w-5 h-5"})}),R.jsxs("div",{className:"mb-6",children:[R.jsx("div",{className:"w-14 h-14 bg-[#FEFAE0] dark:bg-[#2C2420] rounded-2xl flex items-center justify-center text-[#B26B4A] dark:text-[#D4A373] mb-4",children:R.jsx(hh,{className:"w-7 h-7"})}),R.jsx("h2",{className:"text-2xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2",children:"API Key bentigt"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] text-sm font-serif italic",children:"Um die KI-Funktionen nutzen zu knnen, geben Sie bitte Ihren Gemini API Key ein. Dieser wird nur fr diese Sitzung gespeichert."})]}),R.jsxs("div",{className:"space-y-4",children:[R.jsxs("div",{className:"relative",children:[R.jsx(hh,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D]"}),R.jsx("input",{type:"password",value:e,onChange:s=>t(s.target.value),placeholder:"Geben Sie Ihren Key ein...",className:"w-full bg-white dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm font-mono"})]}),R.jsxs("div",{className:"flex items-center gap-2 p-3 bg-[#E9EDC9]/30 dark:bg-[#2C2420]/30 rounded-xl border border-[#CCD5AE]/30 dark:border-[#2C2420]/50",children:[R.jsx(MC,{className:"w-4 h-4 text-[#6B705C] dark:text-[#A5A58D]"}),R.jsx("p",{className:"text-[10px] text-[#6B705C] dark:text-[#A5A58D] font-serif",children:"Sicher: Der Key wird beim Schlieen des Tabs gelscht."})]}),R.jsxs("button",{onClick:i,disabled:!e.trim(),className:"w-full bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E] py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-30",children:["Sitzung starten",R.jsx(Yf,{className:"w-4 h-4"})]}),R.jsx("button",{onClick:n,className:"w-full text-[#A5A58D] text-[10px] font-bold uppercase tracking-widest mt-2 hover:text-[#6B705C] transition-colors",children:"Spter eingeben"})]})]})})};function hq(){const[n,e]=we.useState(St.HOME),[t,i]=we.useState(null),[s,a]=we.useState(0),[l,d]=we.useState(nq()),[f,p]=we.useState(null),[_,E]=we.useState(localStorage.getItem("spanish_assistant_is_guest")==="true"),[T,C]=we.useState(!0),[P,O]=we.useState(!1);we.useEffect(()=>{const le=Sw(Lo,ue=>{p(ue),ue&&(E(!1),localStorage.removeItem("spanish_assistant_is_guest"),k()),C(!1)});return()=>le()},[]),we.useEffect(()=>{i(Xx()),Us().then(le=>a(le.length))},[n,f,_]),we.useEffect(()=>{l==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),iq(l)},[l]);const k=()=>{hv()||O(!0)},Q=()=>d(le=>le==="light"?"dark":"light"),j=()=>{E(!0),localStorage.setItem("spanish_assistant_is_guest","true"),k()},X=()=>{E(!1),localStorage.removeItem("spanish_assistant_is_guest")};if(T)return R.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#FDFBF7] dark:bg-[#12100E]",children:[R.jsx(Mo,{className:"w-12 h-12 animate-spin text-[#B26B4A] dark:text-[#D4A373] mb-4"}),R.jsx("p",{className:"font-serif italic text-[#6B705C] dark:text-[#A5A58D]",children:"Wird geladen..."})]});if(!f&&!_)return R.jsx(dq,{onGuestLogin:j});const se=()=>{switch(n){case St.ANALYZE:return R.jsx(lq,{onChangeView:e});case St.VOCAB:return R.jsx(uq,{});case St.SETTINGS:return R.jsx(cq,{});case St.HOME:default:return R.jsxs("div",{className:"flex flex-col gap-6 py-4 animate-fade-in",children:[R.jsxs("div",{className:"bg-[#2C2420] dark:bg-[#1C1917] rounded-[2.5rem] p-8 text-[#FDFBF7] shadow-xl relative overflow-hidden border border-transparent dark:border-[#2C2420]",children:[R.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#B26B4A]/20 dark:bg-[#D4A373]/10 rounded-full -mr-12 -mt-12 blur-2xl"}),R.jsxs("div",{className:"relative z-10",children:[R.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[R.jsx(PC,{className:"text-[#FEFAE0] dark:text-[#D4A373] w-5 h-5"}),R.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-[#FEFAE0]/80 dark:text-[#D4A373]/80",children:_?"Bienvenido, Invitado":`Bienvenido, ${(f==null?void 0:f.displayName)||"Amigo"}`})]}),R.jsx("h2",{className:"text-4xl font-serif font-bold mb-4 tracking-tight",children:"Hola amigo."}),R.jsx("p",{className:"text-[#FDFBF7]/70 text-md font-serif italic leading-relaxed mb-6 max-w-sm",children:_?"Deine Vokabeln werden lokal im Browser gespeichert. Exportiere sie regelmig!":"Dein Fortschritt wird sicher in der Cloud synchronisiert."}),R.jsxs("div",{className:"flex flex-wrap gap-3",children:[R.jsxs("button",{onClick:()=>e(St.ANALYZE),className:"bg-[#B26B4A] dark:bg-[#D4A373] text-white dark:text-[#12100E] font-bold py-3.5 px-6 rounded-xl shadow-lg hover:bg-[#9E5A3B] transition-all inline-flex items-center gap-3 uppercase text-[10px] tracking-widest",children:[R.jsx(NC,{className:"w-4 h-4"}),"Seite scannen"]}),t&&R.jsxs("button",{onClick:()=>e(St.ANALYZE),className:"bg-white/10 text-white border border-white/20 font-bold py-3.5 px-6 rounded-xl shadow-lg hover:bg-white/20 transition-all inline-flex items-center gap-3 uppercase text-[10px] tracking-widest",children:[R.jsx(mD,{className:"w-4 h-4"}),"Letzte Seite fortsetzen"]})]})]})]}),R.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[R.jsxs("div",{onClick:()=>e(St.ANALYZE),className:"bg-white dark:bg-[#1C1917] p-6 rounded-[2rem] shadow-sm border border-[#EAE2D6] dark:border-[#2C2420] cursor-pointer hover:border-[#B26B4A]/30 dark:hover:border-[#D4A373]/30 hover:shadow-md transition-all group",children:[R.jsx("div",{className:"w-12 h-12 bg-[#FEFAE0] dark:bg-[#2C2420] rounded-xl flex items-center justify-center text-[#B26B4A] dark:text-[#D4A373] mb-4 group-hover:scale-105 transition-transform",children:R.jsx(bC,{className:"w-6 h-6"})}),R.jsxs("div",{className:"flex justify-between items-start",children:[R.jsxs("div",{children:[R.jsx("h3",{className:"text-xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-1",children:"Lesereise"}),R.jsx("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Analysiere Texte und lerne Schtze kennen."})]}),R.jsx(Yf,{className:"w-4 h-4 text-[#EAE2D6] dark:text-[#2C2420] group-hover:text-[#B26B4A] dark:group-hover:text-[#D4A373] transition-colors"})]})]}),R.jsxs("div",{onClick:()=>e(St.VOCAB),className:"bg-white dark:bg-[#1C1917] p-6 rounded-[2rem] shadow-sm border border-[#EAE2D6] dark:border-[#2C2420] cursor-pointer hover:border-[#B26B4A]/30 dark:hover:border-[#D4A373]/30 hover:shadow-md transition-all group",children:[R.jsx("div",{className:"w-12 h-12 bg-[#E9EDC9] dark:bg-[#2C2420] rounded-xl flex items-center justify-center text-[#6B705C] dark:text-[#A5A58D] mb-4 group-hover:scale-105 transition-transform",children:R.jsx(xC,{className:"w-6 h-6"})}),R.jsxs("div",{className:"flex justify-between items-start",children:[R.jsxs("div",{children:[R.jsx("h3",{className:"text-xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-1",children:"Wortschatz"}),R.jsxs("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:[s," Fundstcke in deiner Sammlung."]})]}),R.jsx(Yf,{className:"w-4 h-4 text-[#EAE2D6] dark:text-[#2C2420] group-hover:text-[#6B705C] dark:group-hover:text-[#D4A373] transition-colors"})]})]})]}),R.jsxs("div",{onClick:()=>e(St.SETTINGS),className:"bg-white dark:bg-[#1C1917] p-6 rounded-[2rem] border border-[#EAE2D6] dark:border-[#2C2420] cursor-pointer flex items-center justify-between hover:bg-[#FDFBF7] dark:hover:bg-[#12100E] transition-colors",children:[R.jsxs("div",{className:"flex items-center gap-4",children:[R.jsx("div",{className:"bg-[#2C2420]/5 dark:bg-white/5 p-3 rounded-xl",children:R.jsx(DC,{className:"w-5 h-5 text-[#6B705C] dark:text-[#A5A58D]"})}),R.jsxs("div",{children:[R.jsx("p",{className:"text-sm font-bold text-[#2C2420] dark:text-[#FDFBF7]",children:"Einstellungen"}),R.jsx("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] italic",children:"Verwalte deinen Zugang und lerne mehr."})]})]}),R.jsx(Yf,{className:"w-4 h-4 text-[#EAE2D6] dark:text-[#2C2420]"})]})]})}};return R.jsxs(UU,{currentView:n,onChangeView:e,theme:l,onToggleTheme:Q,isGuest:_,onLogoutGuest:X,children:[se(),P&&R.jsx(fq,{onClose:()=>O(!1)})]})}const jx=document.getElementById("root");if(!jx)throw new Error("Could not find root element to mount to");const pq=qN.createRoot(jx);pq.render(R.jsx(PN.StrictMode,{children:R.jsx(hq,{})}));
