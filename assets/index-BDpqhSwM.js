(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function CC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Eg={exports:{}},Yu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k0;function bN(){if(k0)return Yu;k0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,a){var l=null;if(a!==void 0&&(l=""+a),s.key!==void 0&&(l=""+s.key),"key"in s){a={};for(var d in s)d!=="key"&&(a[d]=s[d])}else a=s;return s=a.ref,{$$typeof:n,type:i,key:l,ref:s!==void 0?s:null,props:a}}return Yu.Fragment=e,Yu.jsx=t,Yu.jsxs=t,Yu}var V0;function xN(){return V0||(V0=1,Eg.exports=bN()),Eg.exports}var R=xN(),Tg={exports:{}},De={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L0;function NN(){if(L0)return De;L0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),T=Symbol.iterator;function C(q){return q===null||typeof q!="object"?null:(q=T&&q[T]||q["@@iterator"],typeof q=="function"?q:null)}var P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},F=Object.assign,V={};function Q(q,re,pe){this.props=q,this.context=re,this.refs=V,this.updater=pe||P}Q.prototype.isReactComponent={},Q.prototype.setState=function(q,re){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,re,"setState")},Q.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function j(){}j.prototype=Q.prototype;function X(q,re,pe){this.props=q,this.context=re,this.refs=V,this.updater=pe||P}var se=X.prototype=new j;se.constructor=X,F(se,Q.prototype),se.isPureReactComponent=!0;var le=Array.isArray;function ue(){}var N={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function x(q,re,pe){var ge=pe.ref;return{$$typeof:n,type:q,key:re,ref:ge!==void 0?ge:null,props:pe}}function L(q,re){return x(q.type,re,q.props)}function k(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function O(q){var re={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(pe){return re[pe]})}var M=/\/+/g;function Ee(q,re){return typeof q=="object"&&q!==null&&q.key!=null?O(""+q.key):re.toString(36)}function Ue(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(ue,ue):(q.status="pending",q.then(function(re){q.status==="pending"&&(q.status="fulfilled",q.value=re)},function(re){q.status==="pending"&&(q.status="rejected",q.reason=re)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function z(q,re,pe,ge,be){var Ve=typeof q;(Ve==="undefined"||Ve==="boolean")&&(q=null);var Ye=!1;if(q===null)Ye=!0;else switch(Ve){case"bigint":case"string":case"number":Ye=!0;break;case"object":switch(q.$$typeof){case n:case e:Ye=!0;break;case _:return Ye=q._init,z(Ye(q._payload),re,pe,ge,be)}}if(Ye)return be=be(q),Ye=ge===""?"."+Ee(q,0):ge,le(be)?(pe="",Ye!=null&&(pe=Ye.replace(M,"$&/")+"/"),z(be,re,pe,"",function(Ks){return Ks})):be!=null&&(k(be)&&(be=L(be,pe+(be.key==null||q&&q.key===be.key?"":(""+be.key).replace(M,"$&/")+"/")+Ye)),re.push(be)),1;Ye=0;var Ht=ge===""?".":ge+":";if(le(q))for(var gt=0;gt<q.length;gt++)ge=q[gt],Ve=Ht+Ee(ge,gt),Ye+=z(ge,re,pe,Ve,be);else if(gt=C(q),typeof gt=="function")for(q=gt.call(q),gt=0;!(ge=q.next()).done;)ge=ge.value,Ve=Ht+Ee(ge,gt++),Ye+=z(ge,re,pe,Ve,be);else if(Ve==="object"){if(typeof q.then=="function")return z(Ue(q),re,pe,ge,be);throw re=String(q),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.")}return Ye}function oe(q,re,pe){if(q==null)return q;var ge=[],be=0;return z(q,ge,"","",function(Ve){return re.call(pe,Ve,be++)}),ge}function fe(q){if(q._status===-1){var re=q._result;re=re(),re.then(function(pe){(q._status===0||q._status===-1)&&(q._status=1,q._result=pe)},function(pe){(q._status===0||q._status===-1)&&(q._status=2,q._result=pe)}),q._status===-1&&(q._status=0,q._result=re)}if(q._status===1)return q._result.default;throw q._result}var Me=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Qe={map:oe,forEach:function(q,re,pe){oe(q,function(){re.apply(this,arguments)},pe)},count:function(q){var re=0;return oe(q,function(){re++}),re},toArray:function(q){return oe(q,function(re){return re})||[]},only:function(q){if(!k(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return De.Activity=E,De.Children=Qe,De.Component=Q,De.Fragment=t,De.Profiler=s,De.PureComponent=X,De.StrictMode=i,De.Suspense=f,De.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,De.__COMPILER_RUNTIME={__proto__:null,c:function(q){return N.H.useMemoCache(q)}},De.cache=function(q){return function(){return q.apply(null,arguments)}},De.cacheSignal=function(){return null},De.cloneElement=function(q,re,pe){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var ge=F({},q.props),be=q.key;if(re!=null)for(Ve in re.key!==void 0&&(be=""+re.key),re)!D.call(re,Ve)||Ve==="key"||Ve==="__self"||Ve==="__source"||Ve==="ref"&&re.ref===void 0||(ge[Ve]=re[Ve]);var Ve=arguments.length-2;if(Ve===1)ge.children=pe;else if(1<Ve){for(var Ye=Array(Ve),Ht=0;Ht<Ve;Ht++)Ye[Ht]=arguments[Ht+2];ge.children=Ye}return x(q.type,be,ge)},De.createContext=function(q){return q={$$typeof:l,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:a,_context:q},q},De.createElement=function(q,re,pe){var ge,be={},Ve=null;if(re!=null)for(ge in re.key!==void 0&&(Ve=""+re.key),re)D.call(re,ge)&&ge!=="key"&&ge!=="__self"&&ge!=="__source"&&(be[ge]=re[ge]);var Ye=arguments.length-2;if(Ye===1)be.children=pe;else if(1<Ye){for(var Ht=Array(Ye),gt=0;gt<Ye;gt++)Ht[gt]=arguments[gt+2];be.children=Ht}if(q&&q.defaultProps)for(ge in Ye=q.defaultProps,Ye)be[ge]===void 0&&(be[ge]=Ye[ge]);return x(q,Ve,be)},De.createRef=function(){return{current:null}},De.forwardRef=function(q){return{$$typeof:d,render:q}},De.isValidElement=k,De.lazy=function(q){return{$$typeof:_,_payload:{_status:-1,_result:q},_init:fe}},De.memo=function(q,re){return{$$typeof:p,type:q,compare:re===void 0?null:re}},De.startTransition=function(q){var re=N.T,pe={};N.T=pe;try{var ge=q(),be=N.S;be!==null&&be(pe,ge),typeof ge=="object"&&ge!==null&&typeof ge.then=="function"&&ge.then(ue,Me)}catch(Ve){Me(Ve)}finally{re!==null&&pe.types!==null&&(re.types=pe.types),N.T=re}},De.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},De.use=function(q){return N.H.use(q)},De.useActionState=function(q,re,pe){return N.H.useActionState(q,re,pe)},De.useCallback=function(q,re){return N.H.useCallback(q,re)},De.useContext=function(q){return N.H.useContext(q)},De.useDebugValue=function(){},De.useDeferredValue=function(q,re){return N.H.useDeferredValue(q,re)},De.useEffect=function(q,re){return N.H.useEffect(q,re)},De.useEffectEvent=function(q){return N.H.useEffectEvent(q)},De.useId=function(){return N.H.useId()},De.useImperativeHandle=function(q,re,pe){return N.H.useImperativeHandle(q,re,pe)},De.useInsertionEffect=function(q,re){return N.H.useInsertionEffect(q,re)},De.useLayoutEffect=function(q,re){return N.H.useLayoutEffect(q,re)},De.useMemo=function(q,re){return N.H.useMemo(q,re)},De.useOptimistic=function(q,re){return N.H.useOptimistic(q,re)},De.useReducer=function(q,re,pe){return N.H.useReducer(q,re,pe)},De.useRef=function(q){return N.H.useRef(q)},De.useState=function(q){return N.H.useState(q)},De.useSyncExternalStore=function(q,re,pe){return N.H.useSyncExternalStore(q,re,pe)},De.useTransition=function(){return N.H.useTransition()},De.version="19.2.3",De}var U0;function zy(){return U0||(U0=1,Tg.exports=NN()),Tg.exports}var Ce=zy();const DN=CC(Ce);var Ag={exports:{}},$u={},Sg={exports:{}},Ig={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O0;function MN(){return O0||(O0=1,(function(n){function e(z,oe){var fe=z.length;z.push(oe);e:for(;0<fe;){var Me=fe-1>>>1,Qe=z[Me];if(0<s(Qe,oe))z[Me]=oe,z[fe]=Qe,fe=Me;else break e}}function t(z){return z.length===0?null:z[0]}function i(z){if(z.length===0)return null;var oe=z[0],fe=z.pop();if(fe!==oe){z[0]=fe;e:for(var Me=0,Qe=z.length,q=Qe>>>1;Me<q;){var re=2*(Me+1)-1,pe=z[re],ge=re+1,be=z[ge];if(0>s(pe,fe))ge<Qe&&0>s(be,pe)?(z[Me]=be,z[ge]=fe,Me=ge):(z[Me]=pe,z[re]=fe,Me=re);else if(ge<Qe&&0>s(be,fe))z[Me]=be,z[ge]=fe,Me=ge;else break e}}return oe}function s(z,oe){var fe=z.sortIndex-oe.sortIndex;return fe!==0?fe:z.id-oe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var f=[],p=[],_=1,E=null,T=3,C=!1,P=!1,F=!1,V=!1,Q=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function se(z){for(var oe=t(p);oe!==null;){if(oe.callback===null)i(p);else if(oe.startTime<=z)i(p),oe.sortIndex=oe.expirationTime,e(f,oe);else break;oe=t(p)}}function le(z){if(F=!1,se(z),!P)if(t(f)!==null)P=!0,ue||(ue=!0,O());else{var oe=t(p);oe!==null&&Ue(le,oe.startTime-z)}}var ue=!1,N=-1,D=5,x=-1;function L(){return V?!0:!(n.unstable_now()-x<D)}function k(){if(V=!1,ue){var z=n.unstable_now();x=z;var oe=!0;try{e:{P=!1,F&&(F=!1,j(N),N=-1),C=!0;var fe=T;try{t:{for(se(z),E=t(f);E!==null&&!(E.expirationTime>z&&L());){var Me=E.callback;if(typeof Me=="function"){E.callback=null,T=E.priorityLevel;var Qe=Me(E.expirationTime<=z);if(z=n.unstable_now(),typeof Qe=="function"){E.callback=Qe,se(z),oe=!0;break t}E===t(f)&&i(f),se(z)}else i(f);E=t(f)}if(E!==null)oe=!0;else{var q=t(p);q!==null&&Ue(le,q.startTime-z),oe=!1}}break e}finally{E=null,T=fe,C=!1}oe=void 0}}finally{oe?O():ue=!1}}}var O;if(typeof X=="function")O=function(){X(k)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,Ee=M.port2;M.port1.onmessage=k,O=function(){Ee.postMessage(null)}}else O=function(){Q(k,0)};function Ue(z,oe){N=Q(function(){z(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(z){z.callback=null},n.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<z?Math.floor(1e3/z):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(z){switch(T){case 1:case 2:case 3:var oe=3;break;default:oe=T}var fe=T;T=oe;try{return z()}finally{T=fe}},n.unstable_requestPaint=function(){V=!0},n.unstable_runWithPriority=function(z,oe){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var fe=T;T=z;try{return oe()}finally{T=fe}},n.unstable_scheduleCallback=function(z,oe,fe){var Me=n.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Me+fe:Me):fe=Me,z){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=fe+Qe,z={id:_++,callback:oe,priorityLevel:z,startTime:fe,expirationTime:Qe,sortIndex:-1},fe>Me?(z.sortIndex=fe,e(p,z),t(f)===null&&z===t(p)&&(F?(j(N),N=-1):F=!0,Ue(le,fe-Me))):(z.sortIndex=Qe,e(f,z),P||C||(P=!0,ue||(ue=!0,O()))),z},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(z){var oe=T;return function(){var fe=T;T=oe;try{return z.apply(this,arguments)}finally{T=fe}}}})(Ig)),Ig}var F0;function PN(){return F0||(F0=1,Sg.exports=MN()),Sg.exports}var Cg={exports:{}},cn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var B0;function kN(){if(B0)return cn;B0=1;var n=zy();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)p+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(f,p,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:E==null?null:""+E,children:f,containerInfo:p,implementation:_}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return cn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,cn.createPortal=function(f,p){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return a(f,p,null,_)},cn.flushSync=function(f){var p=l.T,_=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=p,i.p=_,i.d.f()}},cn.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,i.d.C(f,p))},cn.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},cn.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var _=p.as,E=d(_,p.crossOrigin),T=typeof p.integrity=="string"?p.integrity:void 0,C=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;_==="style"?i.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:E,integrity:T,fetchPriority:C}):_==="script"&&i.d.X(f,{crossOrigin:E,integrity:T,fetchPriority:C,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},cn.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var _=d(p.as,p.crossOrigin);i.d.M(f,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&i.d.M(f)},cn.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var _=p.as,E=d(_,p.crossOrigin);i.d.L(f,_,{crossOrigin:E,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},cn.preloadModule=function(f,p){if(typeof f=="string")if(p){var _=d(p.as,p.crossOrigin);i.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else i.d.m(f)},cn.requestFormReset=function(f){i.d.r(f)},cn.unstable_batchedUpdates=function(f,p){return f(p)},cn.useFormState=function(f,p,_){return l.H.useFormState(f,p,_)},cn.useFormStatus=function(){return l.H.useHostTransitionStatus()},cn.version="19.2.3",cn}var q0;function VN(){if(q0)return Cg.exports;q0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Cg.exports=kN(),Cg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G0;function LN(){if(G0)return $u;G0=1;var n=PN(),e=zy(),t=VN();function i(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function d(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function f(r){if(a(r)!==r)throw Error(i(188))}function p(r){var o=r.alternate;if(!o){if(o=a(r),o===null)throw Error(i(188));return o!==r?null:r}for(var u=r,c=o;;){var y=u.return;if(y===null)break;var v=y.alternate;if(v===null){if(c=y.return,c!==null){u=c;continue}break}if(y.child===v.child){for(v=y.child;v;){if(v===u)return f(y),r;if(v===c)return f(y),o;v=v.sibling}throw Error(i(188))}if(u.return!==c.return)u=y,c=v;else{for(var S=!1,w=y.child;w;){if(w===u){S=!0,u=y,c=v;break}if(w===c){S=!0,c=y,u=v;break}w=w.sibling}if(!S){for(w=v.child;w;){if(w===u){S=!0,u=v,c=y;break}if(w===c){S=!0,c=v,u=y;break}w=w.sibling}if(!S)throw Error(i(189))}}if(u.alternate!==c)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?r:o}function _(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=_(r),o!==null)return o;r=r.sibling}return null}var E=Object.assign,T=Symbol.for("react.element"),C=Symbol.for("react.transitional.element"),P=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),V=Symbol.for("react.strict_mode"),Q=Symbol.for("react.profiler"),j=Symbol.for("react.consumer"),X=Symbol.for("react.context"),se=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function O(r){return r===null||typeof r!="object"?null:(r=k&&r[k]||r["@@iterator"],typeof r=="function"?r:null)}var M=Symbol.for("react.client.reference");function Ee(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===M?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case F:return"Fragment";case Q:return"Profiler";case V:return"StrictMode";case le:return"Suspense";case ue:return"SuspenseList";case x:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case P:return"Portal";case X:return r.displayName||"Context";case j:return(r._context.displayName||"Context")+".Consumer";case se:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case N:return o=r.displayName||null,o!==null?o:Ee(r.type)||"Memo";case D:o=r._payload,r=r._init;try{return Ee(r(o))}catch{}}return null}var Ue=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},Me=[],Qe=-1;function q(r){return{current:r}}function re(r){0>Qe||(r.current=Me[Qe],Me[Qe]=null,Qe--)}function pe(r,o){Qe++,Me[Qe]=r.current,r.current=o}var ge=q(null),be=q(null),Ve=q(null),Ye=q(null);function Ht(r,o){switch(pe(Ve,o),pe(be,r),pe(ge,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?i0(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=i0(o),r=r0(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}re(ge),pe(ge,r)}function gt(){re(ge),re(be),re(Ve)}function Ks(r){r.memoizedState!==null&&pe(Ye,r);var o=ge.current,u=r0(o,r.type);o!==u&&(pe(be,r),pe(ge,u))}function Zo(r){be.current===r&&(re(ge),re(be)),Ye.current===r&&(re(Ye),zu._currentValue=fe)}var jo,ea;function Ri(r){if(jo===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);jo=o&&o[1]||"",ea=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+jo+r+ea}var zl=!1;function Js(r,o){if(!r||zl)return"";zl=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(o){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(Z){var $=Z}Reflect.construct(r,[],ie)}else{try{ie.call()}catch(Z){$=Z}r.call(ie.prototype)}}else{try{throw Error()}catch(Z){$=Z}(ie=r())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(Z){if(Z&&$&&typeof Z.stack=="string")return[Z.stack,$.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=c.DetermineComponentFrameRoot(),S=v[0],w=v[1];if(S&&w){var U=S.split(`
`),Y=w.split(`
`);for(y=c=0;c<U.length&&!U[c].includes("DetermineComponentFrameRoot");)c++;for(;y<Y.length&&!Y[y].includes("DetermineComponentFrameRoot");)y++;if(c===U.length||y===Y.length)for(c=U.length-1,y=Y.length-1;1<=c&&0<=y&&U[c]!==Y[y];)y--;for(;1<=c&&0<=y;c--,y--)if(U[c]!==Y[y]){if(c!==1||y!==1)do if(c--,y--,0>y||U[c]!==Y[y]){var te=`
`+U[c].replace(" at new "," at ");return r.displayName&&te.includes("<anonymous>")&&(te=te.replace("<anonymous>",r.displayName)),te}while(1<=c&&0<=y);break}}}finally{zl=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?Ri(u):""}function Hl(r,o){switch(r.tag){case 26:case 27:case 5:return Ri(r.type);case 16:return Ri("Lazy");case 13:return r.child!==o&&o!==null?Ri("Suspense Fallback"):Ri("Suspense");case 19:return Ri("SuspenseList");case 0:case 15:return Js(r.type,!1);case 11:return Js(r.type.render,!1);case 1:return Js(r.type,!0);case 31:return Ri("Activity");default:return""}}function Kl(r){try{var o="",u=null;do o+=Hl(r,u),u=r,r=r.return;while(r);return o}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Mt=Object.prototype.hasOwnProperty,Kt=n.unstable_scheduleCallback,Fr=n.unstable_cancelCallback,Ap=n.unstable_shouldYield,nd=n.unstable_requestPaint,yn=n.unstable_now,Ys=n.unstable_getCurrentPriorityLevel,Jl=n.unstable_ImmediatePriority,Yl=n.unstable_UserBlockingPriority,Br=n.unstable_NormalPriority,Sp=n.unstable_LowPriority,id=n.unstable_IdlePriority,rd=n.log,sd=n.unstable_setDisableYieldValue,ui=null,tn=null;function Kn(r){if(typeof rd=="function"&&sd(r),tn&&typeof tn.setStrictMode=="function")try{tn.setStrictMode(ui,r)}catch{}}var Ct=Math.clz32?Math.clz32:ad,od=Math.log,ta=Math.LN2;function ad(r){return r>>>=0,r===0?32:31-(od(r)/ta|0)|0}var bi=256,$s=262144,Pt=4194304;function xi(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Ni(r,o,u){var c=r.pendingLanes;if(c===0)return 0;var y=0,v=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var w=c&134217727;return w!==0?(c=w&~v,c!==0?y=xi(c):(S&=w,S!==0?y=xi(S):u||(u=w&~r,u!==0&&(y=xi(u))))):(w=c&~v,w!==0?y=xi(w):S!==0?y=xi(S):u||(u=c&~r,u!==0&&(y=xi(u)))),y===0?0:o!==0&&o!==y&&(o&v)===0&&(v=y&-y,u=o&-o,v>=u||v===32&&(u&4194048)!==0)?o:y}function ci(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function Ip(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ld(){var r=Pt;return Pt<<=1,(Pt&62914560)===0&&(Pt=4194304),r}function Di(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function Qs(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Cp(r,o,u,c,y,v){var S=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var w=r.entanglements,U=r.expirationTimes,Y=r.hiddenUpdates;for(u=S&~u;0<u;){var te=31-Ct(u),ie=1<<te;w[te]=0,U[te]=-1;var $=Y[te];if($!==null)for(Y[te]=null,te=0;te<$.length;te++){var Z=$[te];Z!==null&&(Z.lane&=-536870913)}u&=~ie}c!==0&&Xs(r,c,0),v!==0&&y===0&&r.tag!==0&&(r.suspendedLanes|=v&~(S&~o))}function Xs(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var c=31-Ct(o);r.entangledLanes|=o,r.entanglements[c]=r.entanglements[c]|1073741824|u&261930}function $l(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var c=31-Ct(u),y=1<<c;y&o|r[c]&o&&(r[c]|=o),u&=~y}}function Ql(r,o){var u=o&-o;return u=(u&42)!==0?1:Ws(u),(u&(r.suspendedLanes|o))!==0?0:u}function Ws(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function rr(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function ud(){var r=oe.p;return r!==0?r:(r=window.event,r===void 0?32:R0(r.type))}function di(r,o){var u=oe.p;try{return oe.p=r,o()}finally{oe.p=u}}var fi=Math.random().toString(36).slice(2),kt="__reactFiber$"+fi,Xt="__reactProps$"+fi,Mi="__reactContainer$"+fi,na="__reactEvents$"+fi,wp="__reactListeners$"+fi,cd="__reactHandles$"+fi,dd="__reactResources$"+fi,Pi="__reactMarker$"+fi;function ia(r){delete r[kt],delete r[Xt],delete r[na],delete r[wp],delete r[cd]}function ki(r){var o=r[kt];if(o)return o;for(var u=r.parentNode;u;){if(o=u[Mi]||u[kt]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=d0(r);r!==null;){if(u=r[kt])return u;r=d0(r)}return o}r=u,u=r.parentNode}return null}function Jn(r){if(r=r[kt]||r[Mi]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function Mn(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(i(33))}function Vi(r){var o=r[dd];return o||(o=r[dd]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Vt(r){r[Pi]=!0}var Xl=new Set,Wl={};function Li(r,o){Ui(r,o),Ui(r+"Capture",o)}function Ui(r,o){for(Wl[r]=o,r=0;r<o.length;r++)Xl.add(o[r])}var Zl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),jl={},eu={};function fd(r){return Mt.call(eu,r)?!0:Mt.call(jl,r)?!1:Zl.test(r)?eu[r]=!0:(jl[r]=!0,!1)}function ra(r,o,u){if(fd(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var c=o.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function Pn(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function Lt(r,o,u,c){if(c===null)r.removeAttribute(u);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+c)}}function Wt(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function qr(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function tu(r,o,u){var c=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var y=c.get,v=c.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return y.call(this)},set:function(S){u=""+S,v.call(this,S)}}),Object.defineProperty(r,o,{enumerable:c.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function nt(r){if(!r._valueTracker){var o=qr(r)?"checked":"value";r._valueTracker=tu(r,o,""+r[o])}}function Zs(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),c="";return r&&(c=qr(r)?r.checked?"true":"false":r.value),r=c,r!==u?(o.setValue(r),!0):!1}function Oi(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var js=/[\n"\\]/g;function Sn(r){return r.replace(js,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function sa(r,o,u,c,y,v,S,w){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),o!=null?S==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+Wt(o)):r.value!==""+Wt(o)&&(r.value=""+Wt(o)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),o!=null?nu(r,S,Wt(o)):u!=null?nu(r,S,Wt(u)):c!=null&&r.removeAttribute("value"),y==null&&v!=null&&(r.defaultChecked=!!v),y!=null&&(r.checked=y&&typeof y!="function"&&typeof y!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.name=""+Wt(w):r.removeAttribute("name")}function hd(r,o,u,c,y,v,S,w){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(r.type=v),o!=null||u!=null){if(!(v!=="submit"&&v!=="reset"||o!=null)){nt(r);return}u=u!=null?""+Wt(u):"",o=o!=null?""+Wt(o):u,w||o===r.value||(r.value=o),r.defaultValue=o}c=c??y,c=typeof c!="function"&&typeof c!="symbol"&&!!c,r.checked=w?r.checked:!!c,r.defaultChecked=!!c,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S),nt(r)}function nu(r,o,u){o==="number"&&Oi(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function Gr(r,o,u,c){if(r=r.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<r.length;u++)y=o.hasOwnProperty("$"+r[u].value),r[u].selected!==y&&(r[u].selected=y),y&&c&&(r[u].defaultSelected=!0)}else{for(u=""+Wt(u),o=null,y=0;y<r.length;y++){if(r[y].value===u){r[y].selected=!0,c&&(r[y].defaultSelected=!0);return}o!==null||r[y].disabled||(o=r[y])}o!==null&&(o.selected=!0)}}function pd(r,o,u){if(o!=null&&(o=""+Wt(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+Wt(u):""}function zr(r,o,u,c){if(o==null){if(c!=null){if(u!=null)throw Error(i(92));if(Ue(c)){if(1<c.length)throw Error(i(93));c=c[0]}u=c}u==null&&(u=""),o=u}u=Wt(o),r.defaultValue=u,c=r.textContent,c===u&&c!==""&&c!==null&&(r.value=c),nt(r)}function In(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var md=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function iu(r,o,u){var c=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?c?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":c?r.setProperty(o,u):typeof u!="number"||u===0||md.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function ru(r,o,u){if(o!=null&&typeof o!="object")throw Error(i(62));if(r=r.style,u!=null){for(var c in u)!u.hasOwnProperty(c)||o!=null&&o.hasOwnProperty(c)||(c.indexOf("--")===0?r.setProperty(c,""):c==="float"?r.cssFloat="":r[c]="");for(var y in o)c=o[y],o.hasOwnProperty(y)&&u[y]!==c&&iu(r,y,c)}else for(var v in o)o.hasOwnProperty(v)&&iu(r,v,o[v])}function oa(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function aa(r){return Hr.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function hi(){}var su=null;function Yn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Kr=null,Fi=null;function eo(r){var o=Jn(r);if(o&&(r=o.stateNode)){var u=r[Xt]||null;e:switch(r=o.stateNode,o.type){case"input":if(sa(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Sn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var c=u[o];if(c!==r&&c.form===r.form){var y=c[Xt]||null;if(!y)throw Error(i(90));sa(c,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)c=u[o],c.form===r.form&&Zs(c)}break e;case"textarea":pd(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Gr(r,!!u.multiple,o,!1)}}}var la=!1;function Jr(r,o,u){if(la)return r(o,u);la=!0;try{var c=r(o);return c}finally{if(la=!1,(Kr!==null||Fi!==null)&&(cf(),Kr&&(o=Kr,r=Fi,Fi=Kr=null,eo(o),r)))for(o=0;o<r.length;o++)eo(r[o])}}function pi(r,o){var u=r.stateNode;if(u===null)return null;var c=u[Xt]||null;if(c===null)return null;u=c[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(r=r.type,c=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!c;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(i(231,o,typeof u));return u}var $n=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),to=!1;if($n)try{var lt={};Object.defineProperty(lt,"passive",{get:function(){to=!0}}),window.addEventListener("test",lt,lt),window.removeEventListener("test",lt,lt)}catch{to=!1}var Bi=null,ou=null,no=null;function au(){if(no)return no;var r,o=ou,u=o.length,c,y="value"in Bi?Bi.value:Bi.textContent,v=y.length;for(r=0;r<u&&o[r]===y[r];r++);var S=u-r;for(c=1;c<=S&&o[u-c]===y[v-c];c++);return no=y.slice(r,1<c?1-c:void 0)}function io(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function sr(){return!0}function mi(){return!1}function nn(r){function o(u,c,y,v,S){this._reactName=u,this._targetInst=y,this.type=c,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var w in r)r.hasOwnProperty(w)&&(u=r[w],this[w]=u?u(v):v[w]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?sr:mi,this.isPropagationStopped=mi,this}return E(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=sr)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=sr)},persist:function(){},isPersistent:sr}),o}var or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qi=nn(or),Yr=E({},or,{view:0,detail:0}),lu=nn(Yr),$r,ua,Gi,ca=E({},Yr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qr,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Gi&&(Gi&&r.type==="mousemove"?($r=r.screenX-Gi.screenX,ua=r.screenY-Gi.screenY):ua=$r=0,Gi=r),$r)},movementY:function(r){return"movementY"in r?r.movementY:ua}}),uu=nn(ca),ro=E({},ca,{dataTransfer:0}),yd=nn(ro),_d=E({},Yr,{relatedTarget:0}),so=nn(_d),cu=E({},or,{animationName:0,elapsedTime:0,pseudoElement:0}),vd=nn(cu),da=E({},or,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ed=nn(da),Td=E({},or,{data:0}),zi=nn(Td),Ad={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Id={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cd(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Id[r])?!!o[r]:!1}function Qr(){return Cd}var _n=E({},Yr,{key:function(r){if(r.key){var o=Ad[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=io(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Sd[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qr,charCode:function(r){return r.type==="keypress"?io(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?io(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),wd=nn(_n),Rd=E({},ca,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ar=nn(Rd),g=E({},Yr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qr}),A=nn(g),I=E({},or,{propertyName:0,elapsedTime:0,pseudoElement:0}),b=nn(I),K=E({},ca,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),W=nn(K),de=E({},or,{newState:0,oldState:0}),Pe=nn(de),wt=[9,13,27,32],je=$n&&"CompositionEvent"in window,yt=null;$n&&"documentMode"in document&&(yt=document.documentMode);var Qn=$n&&"TextEvent"in window&&!yt,Hi=$n&&(!je||yt&&8<yt&&11>=yt),gi=" ",yi=!1;function oo(r,o){switch(r){case"keyup":return wt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fa(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var ha=!1;function Zx(r,o){switch(r){case"compositionend":return fa(o);case"keypress":return o.which!==32?null:(yi=!0,gi);case"textInput":return r=o.data,r===gi&&yi?null:r;default:return null}}function jx(r,o){if(ha)return r==="compositionend"||!je&&oo(r,o)?(r=au(),no=ou=Bi=null,ha=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Hi&&o.locale!=="ko"?null:o.data;default:return null}}var e1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function pv(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!e1[r.type]:o==="textarea"}function mv(r,o,u,c){Kr?Fi?Fi.push(c):Fi=[c]:Kr=c,o=yf(o,"onChange"),0<o.length&&(u=new qi("onChange","change",null,u,c),r.push({event:u,listeners:o}))}var du=null,fu=null;function t1(r){WT(r,0)}function bd(r){var o=Mn(r);if(Zs(o))return r}function gv(r,o){if(r==="change")return o}var yv=!1;if($n){var Rp;if($n){var bp="oninput"in document;if(!bp){var _v=document.createElement("div");_v.setAttribute("oninput","return;"),bp=typeof _v.oninput=="function"}Rp=bp}else Rp=!1;yv=Rp&&(!document.documentMode||9<document.documentMode)}function vv(){du&&(du.detachEvent("onpropertychange",Ev),fu=du=null)}function Ev(r){if(r.propertyName==="value"&&bd(fu)){var o=[];mv(o,fu,r,Yn(r)),Jr(t1,o)}}function n1(r,o,u){r==="focusin"?(vv(),du=o,fu=u,du.attachEvent("onpropertychange",Ev)):r==="focusout"&&vv()}function i1(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return bd(fu)}function r1(r,o){if(r==="click")return bd(o)}function s1(r,o){if(r==="input"||r==="change")return bd(o)}function o1(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var kn=typeof Object.is=="function"?Object.is:o1;function hu(r,o){if(kn(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),c=Object.keys(o);if(u.length!==c.length)return!1;for(c=0;c<u.length;c++){var y=u[c];if(!Mt.call(o,y)||!kn(r[y],o[y]))return!1}return!0}function Tv(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Av(r,o){var u=Tv(r);r=0;for(var c;u;){if(u.nodeType===3){if(c=r+u.textContent.length,r<=o&&c>=o)return{node:u,offset:o-r};r=c}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Tv(u)}}function Sv(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Sv(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Iv(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=Oi(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=Oi(r.document)}return o}function xp(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var a1=$n&&"documentMode"in document&&11>=document.documentMode,pa=null,Np=null,pu=null,Dp=!1;function Cv(r,o,u){var c=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Dp||pa==null||pa!==Oi(c)||(c=pa,"selectionStart"in c&&xp(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),pu&&hu(pu,c)||(pu=c,c=yf(Np,"onSelect"),0<c.length&&(o=new qi("onSelect","select",null,o,u),r.push({event:o,listeners:c}),o.target=pa)))}function ao(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var ma={animationend:ao("Animation","AnimationEnd"),animationiteration:ao("Animation","AnimationIteration"),animationstart:ao("Animation","AnimationStart"),transitionrun:ao("Transition","TransitionRun"),transitionstart:ao("Transition","TransitionStart"),transitioncancel:ao("Transition","TransitionCancel"),transitionend:ao("Transition","TransitionEnd")},Mp={},wv={};$n&&(wv=document.createElement("div").style,"AnimationEvent"in window||(delete ma.animationend.animation,delete ma.animationiteration.animation,delete ma.animationstart.animation),"TransitionEvent"in window||delete ma.transitionend.transition);function lo(r){if(Mp[r])return Mp[r];if(!ma[r])return r;var o=ma[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in wv)return Mp[r]=o[u];return r}var Rv=lo("animationend"),bv=lo("animationiteration"),xv=lo("animationstart"),l1=lo("transitionrun"),u1=lo("transitionstart"),c1=lo("transitioncancel"),Nv=lo("transitionend"),Dv=new Map,Pp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pp.push("scrollEnd");function _i(r,o){Dv.set(r,o),Li(o,[r])}var xd=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Xn=[],ga=0,kp=0;function Nd(){for(var r=ga,o=kp=ga=0;o<r;){var u=Xn[o];Xn[o++]=null;var c=Xn[o];Xn[o++]=null;var y=Xn[o];Xn[o++]=null;var v=Xn[o];if(Xn[o++]=null,c!==null&&y!==null){var S=c.pending;S===null?y.next=y:(y.next=S.next,S.next=y),c.pending=y}v!==0&&Mv(u,y,v)}}function Dd(r,o,u,c){Xn[ga++]=r,Xn[ga++]=o,Xn[ga++]=u,Xn[ga++]=c,kp|=c,r.lanes|=c,r=r.alternate,r!==null&&(r.lanes|=c)}function Vp(r,o,u,c){return Dd(r,o,u,c),Md(r)}function uo(r,o){return Dd(r,null,null,o),Md(r)}function Mv(r,o,u){r.lanes|=u;var c=r.alternate;c!==null&&(c.lanes|=u);for(var y=!1,v=r.return;v!==null;)v.childLanes|=u,c=v.alternate,c!==null&&(c.childLanes|=u),v.tag===22&&(r=v.stateNode,r===null||r._visibility&1||(y=!0)),r=v,v=v.return;return r.tag===3?(v=r.stateNode,y&&o!==null&&(y=31-Ct(u),r=v.hiddenUpdates,c=r[y],c===null?r[y]=[o]:c.push(o),o.lane=u|536870912),v):null}function Md(r){if(50<Lu)throw Lu=0,Hm=null,Error(i(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var ya={};function d1(r,o,u,c){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(r,o,u,c){return new d1(r,o,u,c)}function Lp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function lr(r,o){var u=r.alternate;return u===null?(u=Vn(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function Pv(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function Pd(r,o,u,c,y,v){var S=0;if(c=r,typeof r=="function")Lp(r)&&(S=1);else if(typeof r=="string")S=gN(r,u,ge.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case x:return r=Vn(31,u,o,y),r.elementType=x,r.lanes=v,r;case F:return co(u.children,y,v,o);case V:S=8,y|=24;break;case Q:return r=Vn(12,u,o,y|2),r.elementType=Q,r.lanes=v,r;case le:return r=Vn(13,u,o,y),r.elementType=le,r.lanes=v,r;case ue:return r=Vn(19,u,o,y),r.elementType=ue,r.lanes=v,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case X:S=10;break e;case j:S=9;break e;case se:S=11;break e;case N:S=14;break e;case D:S=16,c=null;break e}S=29,u=Error(i(130,r===null?"null":typeof r,"")),c=null}return o=Vn(S,u,o,y),o.elementType=r,o.type=c,o.lanes=v,o}function co(r,o,u,c){return r=Vn(7,r,c,o),r.lanes=u,r}function Up(r,o,u){return r=Vn(6,r,null,o),r.lanes=u,r}function kv(r){var o=Vn(18,null,null,0);return o.stateNode=r,o}function Op(r,o,u){return o=Vn(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var Vv=new WeakMap;function Wn(r,o){if(typeof r=="object"&&r!==null){var u=Vv.get(r);return u!==void 0?u:(o={value:r,source:o,stack:Kl(o)},Vv.set(r,o),o)}return{value:r,source:o,stack:Kl(o)}}var _a=[],va=0,kd=null,mu=0,Zn=[],jn=0,Xr=null,Ki=1,Ji="";function ur(r,o){_a[va++]=mu,_a[va++]=kd,kd=r,mu=o}function Lv(r,o,u){Zn[jn++]=Ki,Zn[jn++]=Ji,Zn[jn++]=Xr,Xr=r;var c=Ki;r=Ji;var y=32-Ct(c)-1;c&=~(1<<y),u+=1;var v=32-Ct(o)+y;if(30<v){var S=y-y%5;v=(c&(1<<S)-1).toString(32),c>>=S,y-=S,Ki=1<<32-Ct(o)+y|u<<y|c,Ji=v+r}else Ki=1<<v|u<<y|c,Ji=r}function Fp(r){r.return!==null&&(ur(r,1),Lv(r,1,0))}function Bp(r){for(;r===kd;)kd=_a[--va],_a[va]=null,mu=_a[--va],_a[va]=null;for(;r===Xr;)Xr=Zn[--jn],Zn[jn]=null,Ji=Zn[--jn],Zn[jn]=null,Ki=Zn[--jn],Zn[jn]=null}function Uv(r,o){Zn[jn++]=Ki,Zn[jn++]=Ji,Zn[jn++]=Xr,Ki=o.id,Ji=o.overflow,Xr=r}var rn=null,pt=null,Je=!1,Wr=null,ei=!1,qp=Error(i(519));function Zr(r){var o=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw gu(Wn(o,r)),qp}function Ov(r){var o=r.stateNode,u=r.type,c=r.memoizedProps;switch(o[kt]=r,o[Xt]=c,u){case"dialog":Be("cancel",o),Be("close",o);break;case"iframe":case"object":case"embed":Be("load",o);break;case"video":case"audio":for(u=0;u<Ou.length;u++)Be(Ou[u],o);break;case"source":Be("error",o);break;case"img":case"image":case"link":Be("error",o),Be("load",o);break;case"details":Be("toggle",o);break;case"input":Be("invalid",o),hd(o,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":Be("invalid",o);break;case"textarea":Be("invalid",o),zr(o,c.value,c.defaultValue,c.children)}u=c.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||c.suppressHydrationWarning===!0||t0(o.textContent,u)?(c.popover!=null&&(Be("beforetoggle",o),Be("toggle",o)),c.onScroll!=null&&Be("scroll",o),c.onScrollEnd!=null&&Be("scrollend",o),c.onClick!=null&&(o.onclick=hi),o=!0):o=!1,o||Zr(r,!0)}function Fv(r){for(rn=r.return;rn;)switch(rn.tag){case 5:case 31:case 13:ei=!1;return;case 27:case 3:ei=!0;return;default:rn=rn.return}}function Ea(r){if(r!==rn)return!1;if(!Je)return Fv(r),Je=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||sg(r.type,r.memoizedProps)),u=!u),u&&pt&&Zr(r),Fv(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));pt=c0(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));pt=c0(r)}else o===27?(o=pt,fs(r.type)?(r=cg,cg=null,pt=r):pt=o):pt=rn?ni(r.stateNode.nextSibling):null;return!0}function fo(){pt=rn=null,Je=!1}function Gp(){var r=Wr;return r!==null&&(bn===null?bn=r:bn.push.apply(bn,r),Wr=null),r}function gu(r){Wr===null?Wr=[r]:Wr.push(r)}var zp=q(null),ho=null,cr=null;function jr(r,o,u){pe(zp,o._currentValue),o._currentValue=u}function dr(r){r._currentValue=zp.current,re(zp)}function Hp(r,o,u){for(;r!==null;){var c=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,c!==null&&(c.childLanes|=o)):c!==null&&(c.childLanes&o)!==o&&(c.childLanes|=o),r===u)break;r=r.return}}function Kp(r,o,u,c){var y=r.child;for(y!==null&&(y.return=r);y!==null;){var v=y.dependencies;if(v!==null){var S=y.child;v=v.firstContext;e:for(;v!==null;){var w=v;v=y;for(var U=0;U<o.length;U++)if(w.context===o[U]){v.lanes|=u,w=v.alternate,w!==null&&(w.lanes|=u),Hp(v.return,u,r),c||(S=null);break e}v=w.next}}else if(y.tag===18){if(S=y.return,S===null)throw Error(i(341));S.lanes|=u,v=S.alternate,v!==null&&(v.lanes|=u),Hp(S,u,r),S=null}else S=y.child;if(S!==null)S.return=y;else for(S=y;S!==null;){if(S===r){S=null;break}if(y=S.sibling,y!==null){y.return=S.return,S=y;break}S=S.return}y=S}}function Ta(r,o,u,c){r=null;for(var y=o,v=!1;y!==null;){if(!v){if((y.flags&524288)!==0)v=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var S=y.alternate;if(S===null)throw Error(i(387));if(S=S.memoizedProps,S!==null){var w=y.type;kn(y.pendingProps.value,S.value)||(r!==null?r.push(w):r=[w])}}else if(y===Ye.current){if(S=y.alternate,S===null)throw Error(i(387));S.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(r!==null?r.push(zu):r=[zu])}y=y.return}r!==null&&Kp(o,r,u,c),o.flags|=262144}function Vd(r){for(r=r.firstContext;r!==null;){if(!kn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function po(r){ho=r,cr=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function sn(r){return Bv(ho,r)}function Ld(r,o){return ho===null&&po(r),Bv(r,o)}function Bv(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},cr===null){if(r===null)throw Error(i(308));cr=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else cr=cr.next=o;return u}var f1=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,c){r.push(c)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},h1=n.unstable_scheduleCallback,p1=n.unstable_NormalPriority,Ut={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Jp(){return{controller:new f1,data:new Map,refCount:0}}function yu(r){r.refCount--,r.refCount===0&&h1(p1,function(){r.controller.abort()})}var _u=null,Yp=0,Aa=0,Sa=null;function m1(r,o){if(_u===null){var u=_u=[];Yp=0,Aa=Xm(),Sa={status:"pending",value:void 0,then:function(c){u.push(c)}}}return Yp++,o.then(qv,qv),o}function qv(){if(--Yp===0&&_u!==null){Sa!==null&&(Sa.status="fulfilled");var r=_u;_u=null,Aa=0,Sa=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function g1(r,o){var u=[],c={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return r.then(function(){c.status="fulfilled",c.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(c.status="rejected",c.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),c}var Gv=z.S;z.S=function(r,o){CT=yn(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&m1(r,o),Gv!==null&&Gv(r,o)};var mo=q(null);function $p(){var r=mo.current;return r!==null?r:ft.pooledCache}function Ud(r,o){o===null?pe(mo,mo.current):pe(mo,o.pool)}function zv(){var r=$p();return r===null?null:{parent:Ut._currentValue,pool:r}}var Ia=Error(i(460)),Qp=Error(i(474)),Od=Error(i(542)),Fd={then:function(){}};function Hv(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Kv(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(hi,hi),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Yv(r),r;default:if(typeof o.status=="string")o.then(hi,hi);else{if(r=ft,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=o,r.status="pending",r.then(function(c){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=c}},function(c){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=c}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,Yv(r),r}throw yo=o,Ia}}function go(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(yo=u,Ia):u}}var yo=null;function Jv(){if(yo===null)throw Error(i(459));var r=yo;return yo=null,r}function Yv(r){if(r===Ia||r===Od)throw Error(i(483))}var Ca=null,vu=0;function Bd(r){var o=vu;return vu+=1,Ca===null&&(Ca=[]),Kv(Ca,r,o)}function Eu(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function qd(r,o){throw o.$$typeof===T?Error(i(525)):(r=Object.prototype.toString.call(o),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function $v(r){function o(G,B){if(r){var J=G.deletions;J===null?(G.deletions=[B],G.flags|=16):J.push(B)}}function u(G,B){if(!r)return null;for(;B!==null;)o(G,B),B=B.sibling;return null}function c(G){for(var B=new Map;G!==null;)G.key!==null?B.set(G.key,G):B.set(G.index,G),G=G.sibling;return B}function y(G,B){return G=lr(G,B),G.index=0,G.sibling=null,G}function v(G,B,J){return G.index=J,r?(J=G.alternate,J!==null?(J=J.index,J<B?(G.flags|=67108866,B):J):(G.flags|=67108866,B)):(G.flags|=1048576,B)}function S(G){return r&&G.alternate===null&&(G.flags|=67108866),G}function w(G,B,J,ne){return B===null||B.tag!==6?(B=Up(J,G.mode,ne),B.return=G,B):(B=y(B,J),B.return=G,B)}function U(G,B,J,ne){var Se=J.type;return Se===F?te(G,B,J.props.children,ne,J.key):B!==null&&(B.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===D&&go(Se)===B.type)?(B=y(B,J.props),Eu(B,J),B.return=G,B):(B=Pd(J.type,J.key,J.props,null,G.mode,ne),Eu(B,J),B.return=G,B)}function Y(G,B,J,ne){return B===null||B.tag!==4||B.stateNode.containerInfo!==J.containerInfo||B.stateNode.implementation!==J.implementation?(B=Op(J,G.mode,ne),B.return=G,B):(B=y(B,J.children||[]),B.return=G,B)}function te(G,B,J,ne,Se){return B===null||B.tag!==7?(B=co(J,G.mode,ne,Se),B.return=G,B):(B=y(B,J),B.return=G,B)}function ie(G,B,J){if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return B=Up(""+B,G.mode,J),B.return=G,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case C:return J=Pd(B.type,B.key,B.props,null,G.mode,J),Eu(J,B),J.return=G,J;case P:return B=Op(B,G.mode,J),B.return=G,B;case D:return B=go(B),ie(G,B,J)}if(Ue(B)||O(B))return B=co(B,G.mode,J,null),B.return=G,B;if(typeof B.then=="function")return ie(G,Bd(B),J);if(B.$$typeof===X)return ie(G,Ld(G,B),J);qd(G,B)}return null}function $(G,B,J,ne){var Se=B!==null?B.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return Se!==null?null:w(G,B,""+J,ne);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case C:return J.key===Se?U(G,B,J,ne):null;case P:return J.key===Se?Y(G,B,J,ne):null;case D:return J=go(J),$(G,B,J,ne)}if(Ue(J)||O(J))return Se!==null?null:te(G,B,J,ne,null);if(typeof J.then=="function")return $(G,B,Bd(J),ne);if(J.$$typeof===X)return $(G,B,Ld(G,J),ne);qd(G,J)}return null}function Z(G,B,J,ne,Se){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return G=G.get(J)||null,w(B,G,""+ne,Se);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case C:return G=G.get(ne.key===null?J:ne.key)||null,U(B,G,ne,Se);case P:return G=G.get(ne.key===null?J:ne.key)||null,Y(B,G,ne,Se);case D:return ne=go(ne),Z(G,B,J,ne,Se)}if(Ue(ne)||O(ne))return G=G.get(J)||null,te(B,G,ne,Se,null);if(typeof ne.then=="function")return Z(G,B,J,Bd(ne),Se);if(ne.$$typeof===X)return Z(G,B,J,Ld(B,ne),Se);qd(B,ne)}return null}function _e(G,B,J,ne){for(var Se=null,Xe=null,Te=B,Le=B=0,Ge=null;Te!==null&&Le<J.length;Le++){Te.index>Le?(Ge=Te,Te=null):Ge=Te.sibling;var We=$(G,Te,J[Le],ne);if(We===null){Te===null&&(Te=Ge);break}r&&Te&&We.alternate===null&&o(G,Te),B=v(We,B,Le),Xe===null?Se=We:Xe.sibling=We,Xe=We,Te=Ge}if(Le===J.length)return u(G,Te),Je&&ur(G,Le),Se;if(Te===null){for(;Le<J.length;Le++)Te=ie(G,J[Le],ne),Te!==null&&(B=v(Te,B,Le),Xe===null?Se=Te:Xe.sibling=Te,Xe=Te);return Je&&ur(G,Le),Se}for(Te=c(Te);Le<J.length;Le++)Ge=Z(Te,G,Le,J[Le],ne),Ge!==null&&(r&&Ge.alternate!==null&&Te.delete(Ge.key===null?Le:Ge.key),B=v(Ge,B,Le),Xe===null?Se=Ge:Xe.sibling=Ge,Xe=Ge);return r&&Te.forEach(function(ys){return o(G,ys)}),Je&&ur(G,Le),Se}function we(G,B,J,ne){if(J==null)throw Error(i(151));for(var Se=null,Xe=null,Te=B,Le=B=0,Ge=null,We=J.next();Te!==null&&!We.done;Le++,We=J.next()){Te.index>Le?(Ge=Te,Te=null):Ge=Te.sibling;var ys=$(G,Te,We.value,ne);if(ys===null){Te===null&&(Te=Ge);break}r&&Te&&ys.alternate===null&&o(G,Te),B=v(ys,B,Le),Xe===null?Se=ys:Xe.sibling=ys,Xe=ys,Te=Ge}if(We.done)return u(G,Te),Je&&ur(G,Le),Se;if(Te===null){for(;!We.done;Le++,We=J.next())We=ie(G,We.value,ne),We!==null&&(B=v(We,B,Le),Xe===null?Se=We:Xe.sibling=We,Xe=We);return Je&&ur(G,Le),Se}for(Te=c(Te);!We.done;Le++,We=J.next())We=Z(Te,G,Le,We.value,ne),We!==null&&(r&&We.alternate!==null&&Te.delete(We.key===null?Le:We.key),B=v(We,B,Le),Xe===null?Se=We:Xe.sibling=We,Xe=We);return r&&Te.forEach(function(RN){return o(G,RN)}),Je&&ur(G,Le),Se}function dt(G,B,J,ne){if(typeof J=="object"&&J!==null&&J.type===F&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case C:e:{for(var Se=J.key;B!==null;){if(B.key===Se){if(Se=J.type,Se===F){if(B.tag===7){u(G,B.sibling),ne=y(B,J.props.children),ne.return=G,G=ne;break e}}else if(B.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===D&&go(Se)===B.type){u(G,B.sibling),ne=y(B,J.props),Eu(ne,J),ne.return=G,G=ne;break e}u(G,B);break}else o(G,B);B=B.sibling}J.type===F?(ne=co(J.props.children,G.mode,ne,J.key),ne.return=G,G=ne):(ne=Pd(J.type,J.key,J.props,null,G.mode,ne),Eu(ne,J),ne.return=G,G=ne)}return S(G);case P:e:{for(Se=J.key;B!==null;){if(B.key===Se)if(B.tag===4&&B.stateNode.containerInfo===J.containerInfo&&B.stateNode.implementation===J.implementation){u(G,B.sibling),ne=y(B,J.children||[]),ne.return=G,G=ne;break e}else{u(G,B);break}else o(G,B);B=B.sibling}ne=Op(J,G.mode,ne),ne.return=G,G=ne}return S(G);case D:return J=go(J),dt(G,B,J,ne)}if(Ue(J))return _e(G,B,J,ne);if(O(J)){if(Se=O(J),typeof Se!="function")throw Error(i(150));return J=Se.call(J),we(G,B,J,ne)}if(typeof J.then=="function")return dt(G,B,Bd(J),ne);if(J.$$typeof===X)return dt(G,B,Ld(G,J),ne);qd(G,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,B!==null&&B.tag===6?(u(G,B.sibling),ne=y(B,J),ne.return=G,G=ne):(u(G,B),ne=Up(J,G.mode,ne),ne.return=G,G=ne),S(G)):u(G,B)}return function(G,B,J,ne){try{vu=0;var Se=dt(G,B,J,ne);return Ca=null,Se}catch(Te){if(Te===Ia||Te===Od)throw Te;var Xe=Vn(29,Te,null,G.mode);return Xe.lanes=ne,Xe.return=G,Xe}finally{}}}var _o=$v(!0),Qv=$v(!1),es=!1;function Xp(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wp(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function ts(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ns(r,o,u){var c=r.updateQueue;if(c===null)return null;if(c=c.shared,(et&2)!==0){var y=c.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),c.pending=o,o=Md(r),Mv(r,null,u),o}return Dd(r,c,o,u),Md(r)}function Tu(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var c=o.lanes;c&=r.pendingLanes,u|=c,o.lanes=u,$l(r,u)}}function Zp(r,o){var u=r.updateQueue,c=r.alternate;if(c!==null&&(c=c.updateQueue,u===c)){var y=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var S={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};v===null?y=v=S:v=v.next=S,u=u.next}while(u!==null);v===null?y=v=o:v=v.next=o}else y=v=o;u={baseState:c.baseState,firstBaseUpdate:y,lastBaseUpdate:v,shared:c.shared,callbacks:c.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var jp=!1;function Au(){if(jp){var r=Sa;if(r!==null)throw r}}function Su(r,o,u,c){jp=!1;var y=r.updateQueue;es=!1;var v=y.firstBaseUpdate,S=y.lastBaseUpdate,w=y.shared.pending;if(w!==null){y.shared.pending=null;var U=w,Y=U.next;U.next=null,S===null?v=Y:S.next=Y,S=U;var te=r.alternate;te!==null&&(te=te.updateQueue,w=te.lastBaseUpdate,w!==S&&(w===null?te.firstBaseUpdate=Y:w.next=Y,te.lastBaseUpdate=U))}if(v!==null){var ie=y.baseState;S=0,te=Y=U=null,w=v;do{var $=w.lane&-536870913,Z=$!==w.lane;if(Z?(qe&$)===$:(c&$)===$){$!==0&&$===Aa&&(jp=!0),te!==null&&(te=te.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var _e=r,we=w;$=o;var dt=u;switch(we.tag){case 1:if(_e=we.payload,typeof _e=="function"){ie=_e.call(dt,ie,$);break e}ie=_e;break e;case 3:_e.flags=_e.flags&-65537|128;case 0:if(_e=we.payload,$=typeof _e=="function"?_e.call(dt,ie,$):_e,$==null)break e;ie=E({},ie,$);break e;case 2:es=!0}}$=w.callback,$!==null&&(r.flags|=64,Z&&(r.flags|=8192),Z=y.callbacks,Z===null?y.callbacks=[$]:Z.push($))}else Z={lane:$,tag:w.tag,payload:w.payload,callback:w.callback,next:null},te===null?(Y=te=Z,U=ie):te=te.next=Z,S|=$;if(w=w.next,w===null){if(w=y.shared.pending,w===null)break;Z=w,w=Z.next,Z.next=null,y.lastBaseUpdate=Z,y.shared.pending=null}}while(!0);te===null&&(U=ie),y.baseState=U,y.firstBaseUpdate=Y,y.lastBaseUpdate=te,v===null&&(y.shared.lanes=0),as|=S,r.lanes=S,r.memoizedState=ie}}function Xv(r,o){if(typeof r!="function")throw Error(i(191,r));r.call(o)}function Wv(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)Xv(u[r],o)}var wa=q(null),Gd=q(0);function Zv(r,o){r=Er,pe(Gd,r),pe(wa,o),Er=r|o.baseLanes}function em(){pe(Gd,Er),pe(wa,wa.current)}function tm(){Er=Gd.current,re(wa),re(Gd)}var Ln=q(null),ti=null;function is(r){var o=r.alternate;pe(Rt,Rt.current&1),pe(Ln,r),ti===null&&(o===null||wa.current!==null||o.memoizedState!==null)&&(ti=r)}function nm(r){pe(Rt,Rt.current),pe(Ln,r),ti===null&&(ti=r)}function jv(r){r.tag===22?(pe(Rt,Rt.current),pe(Ln,r),ti===null&&(ti=r)):rs()}function rs(){pe(Rt,Rt.current),pe(Ln,Ln.current)}function Un(r){re(Ln),ti===r&&(ti=null),re(Rt)}var Rt=q(0);function zd(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||lg(u)||ug(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var fr=0,ke=null,ut=null,Ot=null,Hd=!1,Ra=!1,vo=!1,Kd=0,Iu=0,ba=null,y1=0;function Tt(){throw Error(i(321))}function im(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!kn(r[u],o[u]))return!1;return!0}function rm(r,o,u,c,y,v){return fr=v,ke=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,z.H=r===null||r.memoizedState===null?LE:vm,vo=!1,v=u(c,y),vo=!1,Ra&&(v=tE(o,u,c,y)),eE(r),v}function eE(r){z.H=Ru;var o=ut!==null&&ut.next!==null;if(fr=0,Ot=ut=ke=null,Hd=!1,Iu=0,ba=null,o)throw Error(i(300));r===null||Ft||(r=r.dependencies,r!==null&&Vd(r)&&(Ft=!0))}function tE(r,o,u,c){ke=r;var y=0;do{if(Ra&&(ba=null),Iu=0,Ra=!1,25<=y)throw Error(i(301));if(y+=1,Ot=ut=null,r.updateQueue!=null){var v=r.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}z.H=UE,v=o(u,c)}while(Ra);return v}function _1(){var r=z.H,o=r.useState()[0];return o=typeof o.then=="function"?Cu(o):o,r=r.useState()[0],(ut!==null?ut.memoizedState:null)!==r&&(ke.flags|=1024),o}function sm(){var r=Kd!==0;return Kd=0,r}function om(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function am(r){if(Hd){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Hd=!1}fr=0,Ot=ut=ke=null,Ra=!1,Iu=Kd=0,ba=null}function vn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ot===null?ke.memoizedState=Ot=r:Ot=Ot.next=r,Ot}function bt(){if(ut===null){var r=ke.alternate;r=r!==null?r.memoizedState:null}else r=ut.next;var o=Ot===null?ke.memoizedState:Ot.next;if(o!==null)Ot=o,ut=r;else{if(r===null)throw ke.alternate===null?Error(i(467)):Error(i(310));ut=r,r={memoizedState:ut.memoizedState,baseState:ut.baseState,baseQueue:ut.baseQueue,queue:ut.queue,next:null},Ot===null?ke.memoizedState=Ot=r:Ot=Ot.next=r}return Ot}function Jd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Cu(r){var o=Iu;return Iu+=1,ba===null&&(ba=[]),r=Kv(ba,r,o),o=ke,(Ot===null?o.memoizedState:Ot.next)===null&&(o=o.alternate,z.H=o===null||o.memoizedState===null?LE:vm),r}function Yd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Cu(r);if(r.$$typeof===X)return sn(r)}throw Error(i(438,String(r)))}function lm(r){var o=null,u=ke.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var c=ke.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(o={data:c.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Jd(),ke.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),c=0;c<r;c++)u[c]=L;return o.index++,u}function hr(r,o){return typeof o=="function"?o(r):o}function $d(r){var o=bt();return um(o,ut,r)}function um(r,o,u){var c=r.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=u;var y=r.baseQueue,v=c.pending;if(v!==null){if(y!==null){var S=y.next;y.next=v.next,v.next=S}o.baseQueue=y=v,c.pending=null}if(v=r.baseState,y===null)r.memoizedState=v;else{o=y.next;var w=S=null,U=null,Y=o,te=!1;do{var ie=Y.lane&-536870913;if(ie!==Y.lane?(qe&ie)===ie:(fr&ie)===ie){var $=Y.revertLane;if($===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),ie===Aa&&(te=!0);else if((fr&$)===$){Y=Y.next,$===Aa&&(te=!0);continue}else ie={lane:0,revertLane:Y.revertLane,gesture:null,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},U===null?(w=U=ie,S=v):U=U.next=ie,ke.lanes|=$,as|=$;ie=Y.action,vo&&u(v,ie),v=Y.hasEagerState?Y.eagerState:u(v,ie)}else $={lane:ie,revertLane:Y.revertLane,gesture:Y.gesture,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null},U===null?(w=U=$,S=v):U=U.next=$,ke.lanes|=ie,as|=ie;Y=Y.next}while(Y!==null&&Y!==o);if(U===null?S=v:U.next=w,!kn(v,r.memoizedState)&&(Ft=!0,te&&(u=Sa,u!==null)))throw u;r.memoizedState=v,r.baseState=S,r.baseQueue=U,c.lastRenderedState=v}return y===null&&(c.lanes=0),[r.memoizedState,c.dispatch]}function cm(r){var o=bt(),u=o.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=r;var c=u.dispatch,y=u.pending,v=o.memoizedState;if(y!==null){u.pending=null;var S=y=y.next;do v=r(v,S.action),S=S.next;while(S!==y);kn(v,o.memoizedState)||(Ft=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),u.lastRenderedState=v}return[v,c]}function nE(r,o,u){var c=ke,y=bt(),v=Je;if(v){if(u===void 0)throw Error(i(407));u=u()}else u=o();var S=!kn((ut||y).memoizedState,u);if(S&&(y.memoizedState=u,Ft=!0),y=y.queue,hm(sE.bind(null,c,y,r),[r]),y.getSnapshot!==o||S||Ot!==null&&Ot.memoizedState.tag&1){if(c.flags|=2048,xa(9,{destroy:void 0},rE.bind(null,c,y,u,o),null),ft===null)throw Error(i(349));v||(fr&127)!==0||iE(c,o,u)}return u}function iE(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=ke.updateQueue,o===null?(o=Jd(),ke.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function rE(r,o,u,c){o.value=u,o.getSnapshot=c,oE(o)&&aE(r)}function sE(r,o,u){return u(function(){oE(o)&&aE(r)})}function oE(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!kn(r,u)}catch{return!0}}function aE(r){var o=uo(r,2);o!==null&&xn(o,r,2)}function dm(r){var o=vn();if(typeof r=="function"){var u=r;if(r=u(),vo){Kn(!0);try{u()}finally{Kn(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:r},o}function lE(r,o,u,c){return r.baseState=u,um(r,ut,typeof c=="function"?c:hr)}function v1(r,o,u,c,y){if(Wd(r))throw Error(i(485));if(r=o.action,r!==null){var v={payload:y,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){v.listeners.push(S)}};z.T!==null?u(!0):v.isTransition=!1,c(v),u=o.pending,u===null?(v.next=o.pending=v,uE(o,v)):(v.next=u.next,o.pending=u.next=v)}}function uE(r,o){var u=o.action,c=o.payload,y=r.state;if(o.isTransition){var v=z.T,S={};z.T=S;try{var w=u(y,c),U=z.S;U!==null&&U(S,w),cE(r,o,w)}catch(Y){fm(r,o,Y)}finally{v!==null&&S.types!==null&&(v.types=S.types),z.T=v}}else try{v=u(y,c),cE(r,o,v)}catch(Y){fm(r,o,Y)}}function cE(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(c){dE(r,o,c)},function(c){return fm(r,o,c)}):dE(r,o,u)}function dE(r,o,u){o.status="fulfilled",o.value=u,fE(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,uE(r,u)))}function fm(r,o,u){var c=r.pending;if(r.pending=null,c!==null){c=c.next;do o.status="rejected",o.reason=u,fE(o),o=o.next;while(o!==c)}r.action=null}function fE(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function hE(r,o){return o}function pE(r,o){if(Je){var u=ft.formState;if(u!==null){e:{var c=ke;if(Je){if(pt){t:{for(var y=pt,v=ei;y.nodeType!==8;){if(!v){y=null;break t}if(y=ni(y.nextSibling),y===null){y=null;break t}}v=y.data,y=v==="F!"||v==="F"?y:null}if(y){pt=ni(y.nextSibling),c=y.data==="F!";break e}}Zr(c)}c=!1}c&&(o=u[0])}}return u=vn(),u.memoizedState=u.baseState=o,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hE,lastRenderedState:o},u.queue=c,u=PE.bind(null,ke,c),c.dispatch=u,c=dm(!1),v=_m.bind(null,ke,!1,c.queue),c=vn(),y={state:o,dispatch:null,action:r,pending:null},c.queue=y,u=v1.bind(null,ke,y,v,u),y.dispatch=u,c.memoizedState=r,[o,u,!1]}function mE(r){var o=bt();return gE(o,ut,r)}function gE(r,o,u){if(o=um(r,o,hE)[0],r=$d(hr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var c=Cu(o)}catch(S){throw S===Ia?Od:S}else c=o;o=bt();var y=o.queue,v=y.dispatch;return u!==o.memoizedState&&(ke.flags|=2048,xa(9,{destroy:void 0},E1.bind(null,y,u),null)),[c,v,r]}function E1(r,o){r.action=o}function yE(r){var o=bt(),u=ut;if(u!==null)return gE(o,u,r);bt(),o=o.memoizedState,u=bt();var c=u.queue.dispatch;return u.memoizedState=r,[o,c,!1]}function xa(r,o,u,c){return r={tag:r,create:u,deps:c,inst:o,next:null},o=ke.updateQueue,o===null&&(o=Jd(),ke.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(c=u.next,u.next=r,r.next=c,o.lastEffect=r),r}function _E(){return bt().memoizedState}function Qd(r,o,u,c){var y=vn();ke.flags|=r,y.memoizedState=xa(1|o,{destroy:void 0},u,c===void 0?null:c)}function Xd(r,o,u,c){var y=bt();c=c===void 0?null:c;var v=y.memoizedState.inst;ut!==null&&c!==null&&im(c,ut.memoizedState.deps)?y.memoizedState=xa(o,v,u,c):(ke.flags|=r,y.memoizedState=xa(1|o,v,u,c))}function vE(r,o){Qd(8390656,8,r,o)}function hm(r,o){Xd(2048,8,r,o)}function T1(r){ke.flags|=4;var o=ke.updateQueue;if(o===null)o=Jd(),ke.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function EE(r){var o=bt().memoizedState;return T1({ref:o,nextImpl:r}),function(){if((et&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}function TE(r,o){return Xd(4,2,r,o)}function AE(r,o){return Xd(4,4,r,o)}function SE(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function IE(r,o,u){u=u!=null?u.concat([r]):null,Xd(4,4,SE.bind(null,o,r),u)}function pm(){}function CE(r,o){var u=bt();o=o===void 0?null:o;var c=u.memoizedState;return o!==null&&im(o,c[1])?c[0]:(u.memoizedState=[r,o],r)}function wE(r,o){var u=bt();o=o===void 0?null:o;var c=u.memoizedState;if(o!==null&&im(o,c[1]))return c[0];if(c=r(),vo){Kn(!0);try{r()}finally{Kn(!1)}}return u.memoizedState=[c,o],c}function mm(r,o,u){return u===void 0||(fr&1073741824)!==0&&(qe&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=RT(),ke.lanes|=r,as|=r,u)}function RE(r,o,u,c){return kn(u,o)?u:wa.current!==null?(r=mm(r,u,c),kn(r,o)||(Ft=!0),r):(fr&42)===0||(fr&1073741824)!==0&&(qe&261930)===0?(Ft=!0,r.memoizedState=u):(r=RT(),ke.lanes|=r,as|=r,o)}function bE(r,o,u,c,y){var v=oe.p;oe.p=v!==0&&8>v?v:8;var S=z.T,w={};z.T=w,_m(r,!1,o,u);try{var U=y(),Y=z.S;if(Y!==null&&Y(w,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var te=g1(U,c);wu(r,o,te,Bn(r))}else wu(r,o,c,Bn(r))}catch(ie){wu(r,o,{then:function(){},status:"rejected",reason:ie},Bn())}finally{oe.p=v,S!==null&&w.types!==null&&(S.types=w.types),z.T=S}}function A1(){}function gm(r,o,u,c){if(r.tag!==5)throw Error(i(476));var y=xE(r).queue;bE(r,y,o,fe,u===null?A1:function(){return NE(r),u(c)})}function xE(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:fe},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hr,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function NE(r){var o=xE(r);o.next===null&&(o=r.alternate.memoizedState),wu(r,o.next.queue,{},Bn())}function ym(){return sn(zu)}function DE(){return bt().memoizedState}function ME(){return bt().memoizedState}function S1(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=Bn();r=ts(u);var c=ns(o,r,u);c!==null&&(xn(c,o,u),Tu(c,o,u)),o={cache:Jp()},r.payload=o;return}o=o.return}}function I1(r,o,u){var c=Bn();u={lane:c,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Wd(r)?kE(o,u):(u=Vp(r,o,u,c),u!==null&&(xn(u,r,c),VE(u,o,c)))}function PE(r,o,u){var c=Bn();wu(r,o,u,c)}function wu(r,o,u,c){var y={lane:c,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Wd(r))kE(o,y);else{var v=r.alternate;if(r.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var S=o.lastRenderedState,w=v(S,u);if(y.hasEagerState=!0,y.eagerState=w,kn(w,S))return Dd(r,o,y,0),ft===null&&Nd(),!1}catch{}finally{}if(u=Vp(r,o,y,c),u!==null)return xn(u,r,c),VE(u,o,c),!0}return!1}function _m(r,o,u,c){if(c={lane:2,revertLane:Xm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Wd(r)){if(o)throw Error(i(479))}else o=Vp(r,u,c,2),o!==null&&xn(o,r,2)}function Wd(r){var o=r.alternate;return r===ke||o!==null&&o===ke}function kE(r,o){Ra=Hd=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function VE(r,o,u){if((u&4194048)!==0){var c=o.lanes;c&=r.pendingLanes,u|=c,o.lanes=u,$l(r,u)}}var Ru={readContext:sn,use:Yd,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useLayoutEffect:Tt,useInsertionEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useSyncExternalStore:Tt,useId:Tt,useHostTransitionStatus:Tt,useFormState:Tt,useActionState:Tt,useOptimistic:Tt,useMemoCache:Tt,useCacheRefresh:Tt};Ru.useEffectEvent=Tt;var LE={readContext:sn,use:Yd,useCallback:function(r,o){return vn().memoizedState=[r,o===void 0?null:o],r},useContext:sn,useEffect:vE,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,Qd(4194308,4,SE.bind(null,o,r),u)},useLayoutEffect:function(r,o){return Qd(4194308,4,r,o)},useInsertionEffect:function(r,o){Qd(4,2,r,o)},useMemo:function(r,o){var u=vn();o=o===void 0?null:o;var c=r();if(vo){Kn(!0);try{r()}finally{Kn(!1)}}return u.memoizedState=[c,o],c},useReducer:function(r,o,u){var c=vn();if(u!==void 0){var y=u(o);if(vo){Kn(!0);try{u(o)}finally{Kn(!1)}}}else y=o;return c.memoizedState=c.baseState=y,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:y},c.queue=r,r=r.dispatch=I1.bind(null,ke,r),[c.memoizedState,r]},useRef:function(r){var o=vn();return r={current:r},o.memoizedState=r},useState:function(r){r=dm(r);var o=r.queue,u=PE.bind(null,ke,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:pm,useDeferredValue:function(r,o){var u=vn();return mm(u,r,o)},useTransition:function(){var r=dm(!1);return r=bE.bind(null,ke,r.queue,!0,!1),vn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var c=ke,y=vn();if(Je){if(u===void 0)throw Error(i(407));u=u()}else{if(u=o(),ft===null)throw Error(i(349));(qe&127)!==0||iE(c,o,u)}y.memoizedState=u;var v={value:u,getSnapshot:o};return y.queue=v,vE(sE.bind(null,c,v,r),[r]),c.flags|=2048,xa(9,{destroy:void 0},rE.bind(null,c,v,u,o),null),u},useId:function(){var r=vn(),o=ft.identifierPrefix;if(Je){var u=Ji,c=Ki;u=(c&~(1<<32-Ct(c)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Kd++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=y1++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:ym,useFormState:pE,useActionState:pE,useOptimistic:function(r){var o=vn();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=_m.bind(null,ke,!0,u),u.dispatch=o,[r,o]},useMemoCache:lm,useCacheRefresh:function(){return vn().memoizedState=S1.bind(null,ke)},useEffectEvent:function(r){var o=vn(),u={impl:r};return o.memoizedState=u,function(){if((et&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},vm={readContext:sn,use:Yd,useCallback:CE,useContext:sn,useEffect:hm,useImperativeHandle:IE,useInsertionEffect:TE,useLayoutEffect:AE,useMemo:wE,useReducer:$d,useRef:_E,useState:function(){return $d(hr)},useDebugValue:pm,useDeferredValue:function(r,o){var u=bt();return RE(u,ut.memoizedState,r,o)},useTransition:function(){var r=$d(hr)[0],o=bt().memoizedState;return[typeof r=="boolean"?r:Cu(r),o]},useSyncExternalStore:nE,useId:DE,useHostTransitionStatus:ym,useFormState:mE,useActionState:mE,useOptimistic:function(r,o){var u=bt();return lE(u,ut,r,o)},useMemoCache:lm,useCacheRefresh:ME};vm.useEffectEvent=EE;var UE={readContext:sn,use:Yd,useCallback:CE,useContext:sn,useEffect:hm,useImperativeHandle:IE,useInsertionEffect:TE,useLayoutEffect:AE,useMemo:wE,useReducer:cm,useRef:_E,useState:function(){return cm(hr)},useDebugValue:pm,useDeferredValue:function(r,o){var u=bt();return ut===null?mm(u,r,o):RE(u,ut.memoizedState,r,o)},useTransition:function(){var r=cm(hr)[0],o=bt().memoizedState;return[typeof r=="boolean"?r:Cu(r),o]},useSyncExternalStore:nE,useId:DE,useHostTransitionStatus:ym,useFormState:yE,useActionState:yE,useOptimistic:function(r,o){var u=bt();return ut!==null?lE(u,ut,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:lm,useCacheRefresh:ME};UE.useEffectEvent=EE;function Em(r,o,u,c){o=r.memoizedState,u=u(c,o),u=u==null?o:E({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var Tm={enqueueSetState:function(r,o,u){r=r._reactInternals;var c=Bn(),y=ts(c);y.payload=o,u!=null&&(y.callback=u),o=ns(r,y,c),o!==null&&(xn(o,r,c),Tu(o,r,c))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var c=Bn(),y=ts(c);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=ns(r,y,c),o!==null&&(xn(o,r,c),Tu(o,r,c))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=Bn(),c=ts(u);c.tag=2,o!=null&&(c.callback=o),o=ns(r,c,u),o!==null&&(xn(o,r,u),Tu(o,r,u))}};function OE(r,o,u,c,y,v,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(c,v,S):o.prototype&&o.prototype.isPureReactComponent?!hu(u,c)||!hu(y,v):!0}function FE(r,o,u,c){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,c),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,c),o.state!==r&&Tm.enqueueReplaceState(o,o.state,null)}function Eo(r,o){var u=o;if("ref"in o){u={};for(var c in o)c!=="ref"&&(u[c]=o[c])}if(r=r.defaultProps){u===o&&(u=E({},u));for(var y in r)u[y]===void 0&&(u[y]=r[y])}return u}function BE(r){xd(r)}function qE(r){console.error(r)}function GE(r){xd(r)}function Zd(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(c){setTimeout(function(){throw c})}}function zE(r,o,u){try{var c=r.onCaughtError;c(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Am(r,o,u){return u=ts(u),u.tag=3,u.payload={element:null},u.callback=function(){Zd(r,o)},u}function HE(r){return r=ts(r),r.tag=3,r}function KE(r,o,u,c){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var v=c.value;r.payload=function(){return y(v)},r.callback=function(){zE(o,u,c)}}var S=u.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){zE(o,u,c),typeof y!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var w=c.stack;this.componentDidCatch(c.value,{componentStack:w!==null?w:""})})}function C1(r,o,u,c,y){if(u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(o=u.alternate,o!==null&&Ta(o,u,y,!0),u=Ln.current,u!==null){switch(u.tag){case 31:case 13:return ti===null?df():u.alternate===null&&At===0&&(At=3),u.flags&=-257,u.flags|=65536,u.lanes=y,c===Fd?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([c]):o.add(c),Ym(r,c,y)),!1;case 22:return u.flags|=65536,c===Fd?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([c])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([c]):u.add(c)),Ym(r,c,y)),!1}throw Error(i(435,u.tag))}return Ym(r,c,y),df(),!1}if(Je)return o=Ln.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,c!==qp&&(r=Error(i(422),{cause:c}),gu(Wn(r,u)))):(c!==qp&&(o=Error(i(423),{cause:c}),gu(Wn(o,u))),r=r.current.alternate,r.flags|=65536,y&=-y,r.lanes|=y,c=Wn(c,u),y=Am(r.stateNode,c,y),Zp(r,y),At!==4&&(At=2)),!1;var v=Error(i(520),{cause:c});if(v=Wn(v,u),Vu===null?Vu=[v]:Vu.push(v),At!==4&&(At=2),o===null)return!0;c=Wn(c,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=y&-y,u.lanes|=r,r=Am(u.stateNode,c,r),Zp(u,r),!1;case 1:if(o=u.type,v=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ls===null||!ls.has(v))))return u.flags|=65536,y&=-y,u.lanes|=y,y=HE(y),KE(y,r,u,c),Zp(u,y),!1}u=u.return}while(u!==null);return!1}var Sm=Error(i(461)),Ft=!1;function on(r,o,u,c){o.child=r===null?Qv(o,null,u,c):_o(o,r.child,u,c)}function JE(r,o,u,c,y){u=u.render;var v=o.ref;if("ref"in c){var S={};for(var w in c)w!=="ref"&&(S[w]=c[w])}else S=c;return po(o),c=rm(r,o,u,S,v,y),w=sm(),r!==null&&!Ft?(om(r,o,y),pr(r,o,y)):(Je&&w&&Fp(o),o.flags|=1,on(r,o,c,y),o.child)}function YE(r,o,u,c,y){if(r===null){var v=u.type;return typeof v=="function"&&!Lp(v)&&v.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=v,$E(r,o,v,c,y)):(r=Pd(u.type,null,c,o,o.mode,y),r.ref=o.ref,r.return=o,o.child=r)}if(v=r.child,!Dm(r,y)){var S=v.memoizedProps;if(u=u.compare,u=u!==null?u:hu,u(S,c)&&r.ref===o.ref)return pr(r,o,y)}return o.flags|=1,r=lr(v,c),r.ref=o.ref,r.return=o,o.child=r}function $E(r,o,u,c,y){if(r!==null){var v=r.memoizedProps;if(hu(v,c)&&r.ref===o.ref)if(Ft=!1,o.pendingProps=c=v,Dm(r,y))(r.flags&131072)!==0&&(Ft=!0);else return o.lanes=r.lanes,pr(r,o,y)}return Im(r,o,u,c,y)}function QE(r,o,u,c){var y=c.children,v=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((o.flags&128)!==0){if(v=v!==null?v.baseLanes|u:u,r!==null){for(c=o.child=r.child,y=0;c!==null;)y=y|c.lanes|c.childLanes,c=c.sibling;c=y&~v}else c=0,o.child=null;return XE(r,o,v,u,c)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Ud(o,v!==null?v.cachePool:null),v!==null?Zv(o,v):em(),jv(o);else return c=o.lanes=536870912,XE(r,o,v!==null?v.baseLanes|u:u,u,c)}else v!==null?(Ud(o,v.cachePool),Zv(o,v),rs(),o.memoizedState=null):(r!==null&&Ud(o,null),em(),rs());return on(r,o,y,u),o.child}function bu(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function XE(r,o,u,c,y){var v=$p();return v=v===null?null:{parent:Ut._currentValue,pool:v},o.memoizedState={baseLanes:u,cachePool:v},r!==null&&Ud(o,null),em(),jv(o),r!==null&&Ta(r,o,c,!0),o.childLanes=y,null}function jd(r,o){return o=tf({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function WE(r,o,u){return _o(o,r.child,null,u),r=jd(o,o.pendingProps),r.flags|=2,Un(o),o.memoizedState=null,r}function w1(r,o,u){var c=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Je){if(c.mode==="hidden")return r=jd(o,c),o.lanes=536870912,bu(null,r);if(nm(o),(r=pt)?(r=u0(r,ei),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Xr!==null?{id:Ki,overflow:Ji}:null,retryLane:536870912,hydrationErrors:null},u=kv(r),u.return=o,o.child=u,rn=o,pt=null)):r=null,r===null)throw Zr(o);return o.lanes=536870912,null}return jd(o,c)}var v=r.memoizedState;if(v!==null){var S=v.dehydrated;if(nm(o),y)if(o.flags&256)o.flags&=-257,o=WE(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(i(558));else if(Ft||Ta(r,o,u,!1),y=(u&r.childLanes)!==0,Ft||y){if(c=ft,c!==null&&(S=Ql(c,u),S!==0&&S!==v.retryLane))throw v.retryLane=S,uo(r,S),xn(c,r,S),Sm;df(),o=WE(r,o,u)}else r=v.treeContext,pt=ni(S.nextSibling),rn=o,Je=!0,Wr=null,ei=!1,r!==null&&Uv(o,r),o=jd(o,c),o.flags|=4096;return o}return r=lr(r.child,{mode:c.mode,children:c.children}),r.ref=o.ref,o.child=r,r.return=o,r}function ef(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function Im(r,o,u,c,y){return po(o),u=rm(r,o,u,c,void 0,y),c=sm(),r!==null&&!Ft?(om(r,o,y),pr(r,o,y)):(Je&&c&&Fp(o),o.flags|=1,on(r,o,u,y),o.child)}function ZE(r,o,u,c,y,v){return po(o),o.updateQueue=null,u=tE(o,c,u,y),eE(r),c=sm(),r!==null&&!Ft?(om(r,o,v),pr(r,o,v)):(Je&&c&&Fp(o),o.flags|=1,on(r,o,u,v),o.child)}function jE(r,o,u,c,y){if(po(o),o.stateNode===null){var v=ya,S=u.contextType;typeof S=="object"&&S!==null&&(v=sn(S)),v=new u(c,v),o.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Tm,o.stateNode=v,v._reactInternals=o,v=o.stateNode,v.props=c,v.state=o.memoizedState,v.refs={},Xp(o),S=u.contextType,v.context=typeof S=="object"&&S!==null?sn(S):ya,v.state=o.memoizedState,S=u.getDerivedStateFromProps,typeof S=="function"&&(Em(o,u,S,c),v.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(S=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),S!==v.state&&Tm.enqueueReplaceState(v,v.state,null),Su(o,c,v,y),Au(),v.state=o.memoizedState),typeof v.componentDidMount=="function"&&(o.flags|=4194308),c=!0}else if(r===null){v=o.stateNode;var w=o.memoizedProps,U=Eo(u,w);v.props=U;var Y=v.context,te=u.contextType;S=ya,typeof te=="object"&&te!==null&&(S=sn(te));var ie=u.getDerivedStateFromProps;te=typeof ie=="function"||typeof v.getSnapshotBeforeUpdate=="function",w=o.pendingProps!==w,te||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(w||Y!==S)&&FE(o,v,c,S),es=!1;var $=o.memoizedState;v.state=$,Su(o,c,v,y),Au(),Y=o.memoizedState,w||$!==Y||es?(typeof ie=="function"&&(Em(o,u,ie,c),Y=o.memoizedState),(U=es||OE(o,u,U,c,$,Y,S))?(te||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(o.flags|=4194308)):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=c,o.memoizedState=Y),v.props=c,v.state=Y,v.context=S,c=U):(typeof v.componentDidMount=="function"&&(o.flags|=4194308),c=!1)}else{v=o.stateNode,Wp(r,o),S=o.memoizedProps,te=Eo(u,S),v.props=te,ie=o.pendingProps,$=v.context,Y=u.contextType,U=ya,typeof Y=="object"&&Y!==null&&(U=sn(Y)),w=u.getDerivedStateFromProps,(Y=typeof w=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(S!==ie||$!==U)&&FE(o,v,c,U),es=!1,$=o.memoizedState,v.state=$,Su(o,c,v,y),Au();var Z=o.memoizedState;S!==ie||$!==Z||es||r!==null&&r.dependencies!==null&&Vd(r.dependencies)?(typeof w=="function"&&(Em(o,u,w,c),Z=o.memoizedState),(te=es||OE(o,u,te,c,$,Z,U)||r!==null&&r.dependencies!==null&&Vd(r.dependencies))?(Y||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,Z,U),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,Z,U)),typeof v.componentDidUpdate=="function"&&(o.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof v.componentDidUpdate!="function"||S===r.memoizedProps&&$===r.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&$===r.memoizedState||(o.flags|=1024),o.memoizedProps=c,o.memoizedState=Z),v.props=c,v.state=Z,v.context=U,c=te):(typeof v.componentDidUpdate!="function"||S===r.memoizedProps&&$===r.memoizedState||(o.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&$===r.memoizedState||(o.flags|=1024),c=!1)}return v=c,ef(r,o),c=(o.flags&128)!==0,v||c?(v=o.stateNode,u=c&&typeof u.getDerivedStateFromError!="function"?null:v.render(),o.flags|=1,r!==null&&c?(o.child=_o(o,r.child,null,y),o.child=_o(o,null,u,y)):on(r,o,u,y),o.memoizedState=v.state,r=o.child):r=pr(r,o,y),r}function eT(r,o,u,c){return fo(),o.flags|=256,on(r,o,u,c),o.child}var Cm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wm(r){return{baseLanes:r,cachePool:zv()}}function Rm(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=Fn),r}function tT(r,o,u){var c=o.pendingProps,y=!1,v=(o.flags&128)!==0,S;if((S=v)||(S=r!==null&&r.memoizedState===null?!1:(Rt.current&2)!==0),S&&(y=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,r===null){if(Je){if(y?is(o):rs(),(r=pt)?(r=u0(r,ei),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:Xr!==null?{id:Ki,overflow:Ji}:null,retryLane:536870912,hydrationErrors:null},u=kv(r),u.return=o,o.child=u,rn=o,pt=null)):r=null,r===null)throw Zr(o);return ug(r)?o.lanes=32:o.lanes=536870912,null}var w=c.children;return c=c.fallback,y?(rs(),y=o.mode,w=tf({mode:"hidden",children:w},y),c=co(c,y,u,null),w.return=o,c.return=o,w.sibling=c,o.child=w,c=o.child,c.memoizedState=wm(u),c.childLanes=Rm(r,S,u),o.memoizedState=Cm,bu(null,c)):(is(o),bm(o,w))}var U=r.memoizedState;if(U!==null&&(w=U.dehydrated,w!==null)){if(v)o.flags&256?(is(o),o.flags&=-257,o=xm(r,o,u)):o.memoizedState!==null?(rs(),o.child=r.child,o.flags|=128,o=null):(rs(),w=c.fallback,y=o.mode,c=tf({mode:"visible",children:c.children},y),w=co(w,y,u,null),w.flags|=2,c.return=o,w.return=o,c.sibling=w,o.child=c,_o(o,r.child,null,u),c=o.child,c.memoizedState=wm(u),c.childLanes=Rm(r,S,u),o.memoizedState=Cm,o=bu(null,c));else if(is(o),ug(w)){if(S=w.nextSibling&&w.nextSibling.dataset,S)var Y=S.dgst;S=Y,c=Error(i(419)),c.stack="",c.digest=S,gu({value:c,source:null,stack:null}),o=xm(r,o,u)}else if(Ft||Ta(r,o,u,!1),S=(u&r.childLanes)!==0,Ft||S){if(S=ft,S!==null&&(c=Ql(S,u),c!==0&&c!==U.retryLane))throw U.retryLane=c,uo(r,c),xn(S,r,c),Sm;lg(w)||df(),o=xm(r,o,u)}else lg(w)?(o.flags|=192,o.child=r.child,o=null):(r=U.treeContext,pt=ni(w.nextSibling),rn=o,Je=!0,Wr=null,ei=!1,r!==null&&Uv(o,r),o=bm(o,c.children),o.flags|=4096);return o}return y?(rs(),w=c.fallback,y=o.mode,U=r.child,Y=U.sibling,c=lr(U,{mode:"hidden",children:c.children}),c.subtreeFlags=U.subtreeFlags&65011712,Y!==null?w=lr(Y,w):(w=co(w,y,u,null),w.flags|=2),w.return=o,c.return=o,c.sibling=w,o.child=c,bu(null,c),c=o.child,w=r.child.memoizedState,w===null?w=wm(u):(y=w.cachePool,y!==null?(U=Ut._currentValue,y=y.parent!==U?{parent:U,pool:U}:y):y=zv(),w={baseLanes:w.baseLanes|u,cachePool:y}),c.memoizedState=w,c.childLanes=Rm(r,S,u),o.memoizedState=Cm,bu(r.child,c)):(is(o),u=r.child,r=u.sibling,u=lr(u,{mode:"visible",children:c.children}),u.return=o,u.sibling=null,r!==null&&(S=o.deletions,S===null?(o.deletions=[r],o.flags|=16):S.push(r)),o.child=u,o.memoizedState=null,u)}function bm(r,o){return o=tf({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function tf(r,o){return r=Vn(22,r,null,o),r.lanes=0,r}function xm(r,o,u){return _o(o,r.child,null,u),r=bm(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function nT(r,o,u){r.lanes|=o;var c=r.alternate;c!==null&&(c.lanes|=o),Hp(r.return,o,u)}function Nm(r,o,u,c,y,v){var S=r.memoizedState;S===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:c,tail:u,tailMode:y,treeForkCount:v}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=c,S.tail=u,S.tailMode=y,S.treeForkCount=v)}function iT(r,o,u){var c=o.pendingProps,y=c.revealOrder,v=c.tail;c=c.children;var S=Rt.current,w=(S&2)!==0;if(w?(S=S&1|2,o.flags|=128):S&=1,pe(Rt,S),on(r,o,c,u),c=Je?mu:0,!w&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&nT(r,u,o);else if(r.tag===19)nT(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(y){case"forwards":for(u=o.child,y=null;u!==null;)r=u.alternate,r!==null&&zd(r)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),Nm(o,!1,y,u,v,c);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(r=y.alternate,r!==null&&zd(r)===null){o.child=y;break}r=y.sibling,y.sibling=u,u=y,y=r}Nm(o,!0,u,null,v,c);break;case"together":Nm(o,!1,null,null,void 0,c);break;default:o.memoizedState=null}return o.child}function pr(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),as|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(Ta(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(i(153));if(o.child!==null){for(r=o.child,u=lr(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=lr(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function Dm(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&Vd(r)))}function R1(r,o,u){switch(o.tag){case 3:Ht(o,o.stateNode.containerInfo),jr(o,Ut,r.memoizedState.cache),fo();break;case 27:case 5:Ks(o);break;case 4:Ht(o,o.stateNode.containerInfo);break;case 10:jr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,nm(o),null;break;case 13:var c=o.memoizedState;if(c!==null)return c.dehydrated!==null?(is(o),o.flags|=128,null):(u&o.child.childLanes)!==0?tT(r,o,u):(is(o),r=pr(r,o,u),r!==null?r.sibling:null);is(o);break;case 19:var y=(r.flags&128)!==0;if(c=(u&o.childLanes)!==0,c||(Ta(r,o,u,!1),c=(u&o.childLanes)!==0),y){if(c)return iT(r,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),pe(Rt,Rt.current),c)break;return null;case 22:return o.lanes=0,QE(r,o,u,o.pendingProps);case 24:jr(o,Ut,r.memoizedState.cache)}return pr(r,o,u)}function rT(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)Ft=!0;else{if(!Dm(r,u)&&(o.flags&128)===0)return Ft=!1,R1(r,o,u);Ft=(r.flags&131072)!==0}else Ft=!1,Je&&(o.flags&1048576)!==0&&Lv(o,mu,o.index);switch(o.lanes=0,o.tag){case 16:e:{var c=o.pendingProps;if(r=go(o.elementType),o.type=r,typeof r=="function")Lp(r)?(c=Eo(r,c),o.tag=1,o=jE(null,o,r,c,u)):(o.tag=0,o=Im(null,o,r,c,u));else{if(r!=null){var y=r.$$typeof;if(y===se){o.tag=11,o=JE(null,o,r,c,u);break e}else if(y===N){o.tag=14,o=YE(null,o,r,c,u);break e}}throw o=Ee(r)||r,Error(i(306,o,""))}}return o;case 0:return Im(r,o,o.type,o.pendingProps,u);case 1:return c=o.type,y=Eo(c,o.pendingProps),jE(r,o,c,y,u);case 3:e:{if(Ht(o,o.stateNode.containerInfo),r===null)throw Error(i(387));c=o.pendingProps;var v=o.memoizedState;y=v.element,Wp(r,o),Su(o,c,null,u);var S=o.memoizedState;if(c=S.cache,jr(o,Ut,c),c!==v.cache&&Kp(o,[Ut],u,!0),Au(),c=S.element,v.isDehydrated)if(v={element:c,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=eT(r,o,c,u);break e}else if(c!==y){y=Wn(Error(i(424)),o),gu(y),o=eT(r,o,c,u);break e}else{switch(r=o.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(pt=ni(r.firstChild),rn=o,Je=!0,Wr=null,ei=!0,u=Qv(o,null,c,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(fo(),c===y){o=pr(r,o,u);break e}on(r,o,c,u)}o=o.child}return o;case 26:return ef(r,o),r===null?(u=m0(o.type,null,o.pendingProps,null))?o.memoizedState=u:Je||(u=o.type,r=o.pendingProps,c=_f(Ve.current).createElement(u),c[kt]=o,c[Xt]=r,an(c,u,r),Vt(c),o.stateNode=c):o.memoizedState=m0(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Ks(o),r===null&&Je&&(c=o.stateNode=f0(o.type,o.pendingProps,Ve.current),rn=o,ei=!0,y=pt,fs(o.type)?(cg=y,pt=ni(c.firstChild)):pt=y),on(r,o,o.pendingProps.children,u),ef(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Je&&((y=c=pt)&&(c=iN(c,o.type,o.pendingProps,ei),c!==null?(o.stateNode=c,rn=o,pt=ni(c.firstChild),ei=!1,y=!0):y=!1),y||Zr(o)),Ks(o),y=o.type,v=o.pendingProps,S=r!==null?r.memoizedProps:null,c=v.children,sg(y,v)?c=null:S!==null&&sg(y,S)&&(o.flags|=32),o.memoizedState!==null&&(y=rm(r,o,_1,null,null,u),zu._currentValue=y),ef(r,o),on(r,o,c,u),o.child;case 6:return r===null&&Je&&((r=u=pt)&&(u=rN(u,o.pendingProps,ei),u!==null?(o.stateNode=u,rn=o,pt=null,r=!0):r=!1),r||Zr(o)),null;case 13:return tT(r,o,u);case 4:return Ht(o,o.stateNode.containerInfo),c=o.pendingProps,r===null?o.child=_o(o,null,c,u):on(r,o,c,u),o.child;case 11:return JE(r,o,o.type,o.pendingProps,u);case 7:return on(r,o,o.pendingProps,u),o.child;case 8:return on(r,o,o.pendingProps.children,u),o.child;case 12:return on(r,o,o.pendingProps.children,u),o.child;case 10:return c=o.pendingProps,jr(o,o.type,c.value),on(r,o,c.children,u),o.child;case 9:return y=o.type._context,c=o.pendingProps.children,po(o),y=sn(y),c=c(y),o.flags|=1,on(r,o,c,u),o.child;case 14:return YE(r,o,o.type,o.pendingProps,u);case 15:return $E(r,o,o.type,o.pendingProps,u);case 19:return iT(r,o,u);case 31:return w1(r,o,u);case 22:return QE(r,o,u,o.pendingProps);case 24:return po(o),c=sn(Ut),r===null?(y=$p(),y===null&&(y=ft,v=Jp(),y.pooledCache=v,v.refCount++,v!==null&&(y.pooledCacheLanes|=u),y=v),o.memoizedState={parent:c,cache:y},Xp(o),jr(o,Ut,y)):((r.lanes&u)!==0&&(Wp(r,o),Su(o,null,null,u),Au()),y=r.memoizedState,v=o.memoizedState,y.parent!==c?(y={parent:c,cache:c},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),jr(o,Ut,c)):(c=v.cache,jr(o,Ut,c),c!==y.cache&&Kp(o,[Ut],u,!0))),on(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function mr(r){r.flags|=4}function Mm(r,o,u,c,y){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(y&335544128)===y)if(r.stateNode.complete)r.flags|=8192;else if(DT())r.flags|=8192;else throw yo=Fd,Qp}else r.flags&=-16777217}function sT(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!E0(o))if(DT())r.flags|=8192;else throw yo=Fd,Qp}function nf(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?ld():536870912,r.lanes|=o,Pa|=o)}function xu(r,o){if(!Je)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var c=null;u!==null;)u.alternate!==null&&(c=u),u=u.sibling;c===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:c.sibling=null}}function mt(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,c=0;if(o)for(var y=r.child;y!==null;)u|=y.lanes|y.childLanes,c|=y.subtreeFlags&65011712,c|=y.flags&65011712,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)u|=y.lanes|y.childLanes,c|=y.subtreeFlags,c|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=c,r.childLanes=u,o}function b1(r,o,u){var c=o.pendingProps;switch(Bp(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(o),null;case 1:return mt(o),null;case 3:return u=o.stateNode,c=null,r!==null&&(c=r.memoizedState.cache),o.memoizedState.cache!==c&&(o.flags|=2048),dr(Ut),gt(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(Ea(o)?mr(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Gp())),mt(o),null;case 26:var y=o.type,v=o.memoizedState;return r===null?(mr(o),v!==null?(mt(o),sT(o,v)):(mt(o),Mm(o,y,null,c,u))):v?v!==r.memoizedState?(mr(o),mt(o),sT(o,v)):(mt(o),o.flags&=-16777217):(r=r.memoizedProps,r!==c&&mr(o),mt(o),Mm(o,y,r,c,u)),null;case 27:if(Zo(o),u=Ve.current,y=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==c&&mr(o);else{if(!c){if(o.stateNode===null)throw Error(i(166));return mt(o),null}r=ge.current,Ea(o)?Ov(o):(r=f0(y,c,u),o.stateNode=r,mr(o))}return mt(o),null;case 5:if(Zo(o),y=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==c&&mr(o);else{if(!c){if(o.stateNode===null)throw Error(i(166));return mt(o),null}if(v=ge.current,Ea(o))Ov(o);else{var S=_f(Ve.current);switch(v){case 1:v=S.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:v=S.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":v=S.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":v=S.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":v=S.createElement("div"),v.innerHTML="<script><\/script>",v=v.removeChild(v.firstChild);break;case"select":v=typeof c.is=="string"?S.createElement("select",{is:c.is}):S.createElement("select"),c.multiple?v.multiple=!0:c.size&&(v.size=c.size);break;default:v=typeof c.is=="string"?S.createElement(y,{is:c.is}):S.createElement(y)}}v[kt]=o,v[Xt]=c;e:for(S=o.child;S!==null;){if(S.tag===5||S.tag===6)v.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===o)break e;for(;S.sibling===null;){if(S.return===null||S.return===o)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}o.stateNode=v;e:switch(an(v,y,c),y){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&mr(o)}}return mt(o),Mm(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==c&&mr(o);else{if(typeof c!="string"&&o.stateNode===null)throw Error(i(166));if(r=Ve.current,Ea(o)){if(r=o.stateNode,u=o.memoizedProps,c=null,y=rn,y!==null)switch(y.tag){case 27:case 5:c=y.memoizedProps}r[kt]=o,r=!!(r.nodeValue===u||c!==null&&c.suppressHydrationWarning===!0||t0(r.nodeValue,u)),r||Zr(o,!0)}else r=_f(r).createTextNode(c),r[kt]=o,o.stateNode=r}return mt(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(c=Ea(o),u!==null){if(r===null){if(!c)throw Error(i(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[kt]=o}else fo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;mt(o),r=!1}else u=Gp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(Un(o),o):(Un(o),null);if((o.flags&128)!==0)throw Error(i(558))}return mt(o),null;case 13:if(c=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(y=Ea(o),c!==null&&c.dehydrated!==null){if(r===null){if(!y)throw Error(i(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));y[kt]=o}else fo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;mt(o),y=!1}else y=Gp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(Un(o),o):(Un(o),null)}return Un(o),(o.flags&128)!==0?(o.lanes=u,o):(u=c!==null,r=r!==null&&r.memoizedState!==null,u&&(c=o.child,y=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(y=c.alternate.memoizedState.cachePool.pool),v=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==y&&(c.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),nf(o,o.updateQueue),mt(o),null);case 4:return gt(),r===null&&eg(o.stateNode.containerInfo),mt(o),null;case 10:return dr(o.type),mt(o),null;case 19:if(re(Rt),c=o.memoizedState,c===null)return mt(o),null;if(y=(o.flags&128)!==0,v=c.rendering,v===null)if(y)xu(c,!1);else{if(At!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(v=zd(r),v!==null){for(o.flags|=128,xu(c,!1),r=v.updateQueue,o.updateQueue=r,nf(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)Pv(u,r),u=u.sibling;return pe(Rt,Rt.current&1|2),Je&&ur(o,c.treeForkCount),o.child}r=r.sibling}c.tail!==null&&yn()>lf&&(o.flags|=128,y=!0,xu(c,!1),o.lanes=4194304)}else{if(!y)if(r=zd(v),r!==null){if(o.flags|=128,y=!0,r=r.updateQueue,o.updateQueue=r,nf(o,r),xu(c,!0),c.tail===null&&c.tailMode==="hidden"&&!v.alternate&&!Je)return mt(o),null}else 2*yn()-c.renderingStartTime>lf&&u!==536870912&&(o.flags|=128,y=!0,xu(c,!1),o.lanes=4194304);c.isBackwards?(v.sibling=o.child,o.child=v):(r=c.last,r!==null?r.sibling=v:o.child=v,c.last=v)}return c.tail!==null?(r=c.tail,c.rendering=r,c.tail=r.sibling,c.renderingStartTime=yn(),r.sibling=null,u=Rt.current,pe(Rt,y?u&1|2:u&1),Je&&ur(o,c.treeForkCount),r):(mt(o),null);case 22:case 23:return Un(o),tm(),c=o.memoizedState!==null,r!==null?r.memoizedState!==null!==c&&(o.flags|=8192):c&&(o.flags|=8192),c?(u&536870912)!==0&&(o.flags&128)===0&&(mt(o),o.subtreeFlags&6&&(o.flags|=8192)):mt(o),u=o.updateQueue,u!==null&&nf(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),c=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(c=o.memoizedState.cachePool.pool),c!==u&&(o.flags|=2048),r!==null&&re(mo),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),dr(Ut),mt(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function x1(r,o){switch(Bp(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return dr(Ut),gt(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return Zo(o),null;case 31:if(o.memoizedState!==null){if(Un(o),o.alternate===null)throw Error(i(340));fo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(Un(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(i(340));fo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return re(Rt),null;case 4:return gt(),null;case 10:return dr(o.type),null;case 22:case 23:return Un(o),tm(),r!==null&&re(mo),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return dr(Ut),null;case 25:return null;default:return null}}function oT(r,o){switch(Bp(o),o.tag){case 3:dr(Ut),gt();break;case 26:case 27:case 5:Zo(o);break;case 4:gt();break;case 31:o.memoizedState!==null&&Un(o);break;case 13:Un(o);break;case 19:re(Rt);break;case 10:dr(o.type);break;case 22:case 23:Un(o),tm(),r!==null&&re(mo);break;case 24:dr(Ut)}}function Nu(r,o){try{var u=o.updateQueue,c=u!==null?u.lastEffect:null;if(c!==null){var y=c.next;u=y;do{if((u.tag&r)===r){c=void 0;var v=u.create,S=u.inst;c=v(),S.destroy=c}u=u.next}while(u!==y)}}catch(w){rt(o,o.return,w)}}function ss(r,o,u){try{var c=o.updateQueue,y=c!==null?c.lastEffect:null;if(y!==null){var v=y.next;c=v;do{if((c.tag&r)===r){var S=c.inst,w=S.destroy;if(w!==void 0){S.destroy=void 0,y=o;var U=u,Y=w;try{Y()}catch(te){rt(y,U,te)}}}c=c.next}while(c!==v)}}catch(te){rt(o,o.return,te)}}function aT(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{Wv(o,u)}catch(c){rt(r,r.return,c)}}}function lT(r,o,u){u.props=Eo(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(c){rt(r,o,c)}}function Du(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var c=r.stateNode;break;case 30:c=r.stateNode;break;default:c=r.stateNode}typeof u=="function"?r.refCleanup=u(c):u.current=c}}catch(y){rt(r,o,y)}}function Yi(r,o){var u=r.ref,c=r.refCleanup;if(u!==null)if(typeof c=="function")try{c()}catch(y){rt(r,o,y)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){rt(r,o,y)}else u.current=null}function uT(r){var o=r.type,u=r.memoizedProps,c=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&c.focus();break e;case"img":u.src?c.src=u.src:u.srcSet&&(c.srcset=u.srcSet)}}catch(y){rt(r,r.return,y)}}function Pm(r,o,u){try{var c=r.stateNode;W1(c,r.type,u,o),c[Xt]=o}catch(y){rt(r,r.return,y)}}function cT(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&fs(r.type)||r.tag===4}function km(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||cT(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&fs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Vm(r,o,u){var c=r.tag;if(c===5||c===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=hi));else if(c!==4&&(c===27&&fs(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(Vm(r,o,u),r=r.sibling;r!==null;)Vm(r,o,u),r=r.sibling}function rf(r,o,u){var c=r.tag;if(c===5||c===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(c!==4&&(c===27&&fs(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(rf(r,o,u),r=r.sibling;r!==null;)rf(r,o,u),r=r.sibling}function dT(r){var o=r.stateNode,u=r.memoizedProps;try{for(var c=r.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);an(o,c,u),o[kt]=r,o[Xt]=u}catch(v){rt(r,r.return,v)}}var gr=!1,Bt=!1,Lm=!1,fT=typeof WeakSet=="function"?WeakSet:Set,Zt=null;function N1(r,o){if(r=r.containerInfo,ig=Cf,r=Iv(r),xp(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var c=u.getSelection&&u.getSelection();if(c&&c.rangeCount!==0){u=c.anchorNode;var y=c.anchorOffset,v=c.focusNode;c=c.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var S=0,w=-1,U=-1,Y=0,te=0,ie=r,$=null;t:for(;;){for(var Z;ie!==u||y!==0&&ie.nodeType!==3||(w=S+y),ie!==v||c!==0&&ie.nodeType!==3||(U=S+c),ie.nodeType===3&&(S+=ie.nodeValue.length),(Z=ie.firstChild)!==null;)$=ie,ie=Z;for(;;){if(ie===r)break t;if($===u&&++Y===y&&(w=S),$===v&&++te===c&&(U=S),(Z=ie.nextSibling)!==null)break;ie=$,$=ie.parentNode}ie=Z}u=w===-1||U===-1?null:{start:w,end:U}}else u=null}u=u||{start:0,end:0}}else u=null;for(rg={focusedElem:r,selectionRange:u},Cf=!1,Zt=o;Zt!==null;)if(o=Zt,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Zt=r;else for(;Zt!==null;){switch(o=Zt,v=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)y=r[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&v!==null){r=void 0,u=o,y=v.memoizedProps,v=v.memoizedState,c=u.stateNode;try{var _e=Eo(u.type,y);r=c.getSnapshotBeforeUpdate(_e,v),c.__reactInternalSnapshotBeforeUpdate=r}catch(we){rt(u,u.return,we)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)ag(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":ag(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=o.sibling,r!==null){r.return=o.return,Zt=r;break}Zt=o.return}}function hT(r,o,u){var c=u.flags;switch(u.tag){case 0:case 11:case 15:_r(r,u),c&4&&Nu(5,u);break;case 1:if(_r(r,u),c&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(S){rt(u,u.return,S)}else{var y=Eo(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(y,o,r.__reactInternalSnapshotBeforeUpdate)}catch(S){rt(u,u.return,S)}}c&64&&aT(u),c&512&&Du(u,u.return);break;case 3:if(_r(r,u),c&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Wv(r,o)}catch(S){rt(u,u.return,S)}}break;case 27:o===null&&c&4&&dT(u);case 26:case 5:_r(r,u),o===null&&c&4&&uT(u),c&512&&Du(u,u.return);break;case 12:_r(r,u);break;case 31:_r(r,u),c&4&&gT(r,u);break;case 13:_r(r,u),c&4&&yT(r,u),c&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=F1.bind(null,u),sN(r,u))));break;case 22:if(c=u.memoizedState!==null||gr,!c){o=o!==null&&o.memoizedState!==null||Bt,y=gr;var v=Bt;gr=c,(Bt=o)&&!v?vr(r,u,(u.subtreeFlags&8772)!==0):_r(r,u),gr=y,Bt=v}break;case 30:break;default:_r(r,u)}}function pT(r){var o=r.alternate;o!==null&&(r.alternate=null,pT(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&ia(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var _t=null,Cn=!1;function yr(r,o,u){for(u=u.child;u!==null;)mT(r,o,u),u=u.sibling}function mT(r,o,u){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(ui,u)}catch{}switch(u.tag){case 26:Bt||Yi(u,o),yr(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Bt||Yi(u,o);var c=_t,y=Cn;fs(u.type)&&(_t=u.stateNode,Cn=!1),yr(r,o,u),Bu(u.stateNode),_t=c,Cn=y;break;case 5:Bt||Yi(u,o);case 6:if(c=_t,y=Cn,_t=null,yr(r,o,u),_t=c,Cn=y,_t!==null)if(Cn)try{(_t.nodeType===9?_t.body:_t.nodeName==="HTML"?_t.ownerDocument.body:_t).removeChild(u.stateNode)}catch(v){rt(u,o,v)}else try{_t.removeChild(u.stateNode)}catch(v){rt(u,o,v)}break;case 18:_t!==null&&(Cn?(r=_t,a0(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),qa(r)):a0(_t,u.stateNode));break;case 4:c=_t,y=Cn,_t=u.stateNode.containerInfo,Cn=!0,yr(r,o,u),_t=c,Cn=y;break;case 0:case 11:case 14:case 15:ss(2,u,o),Bt||ss(4,u,o),yr(r,o,u);break;case 1:Bt||(Yi(u,o),c=u.stateNode,typeof c.componentWillUnmount=="function"&&lT(u,o,c)),yr(r,o,u);break;case 21:yr(r,o,u);break;case 22:Bt=(c=Bt)||u.memoizedState!==null,yr(r,o,u),Bt=c;break;default:yr(r,o,u)}}function gT(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{qa(r)}catch(u){rt(o,o.return,u)}}}function yT(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{qa(r)}catch(u){rt(o,o.return,u)}}function D1(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new fT),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new fT),o;default:throw Error(i(435,r.tag))}}function sf(r,o){var u=D1(r);o.forEach(function(c){if(!u.has(c)){u.add(c);var y=B1.bind(null,r,c);c.then(y,y)}})}function wn(r,o){var u=o.deletions;if(u!==null)for(var c=0;c<u.length;c++){var y=u[c],v=r,S=o,w=S;e:for(;w!==null;){switch(w.tag){case 27:if(fs(w.type)){_t=w.stateNode,Cn=!1;break e}break;case 5:_t=w.stateNode,Cn=!1;break e;case 3:case 4:_t=w.stateNode.containerInfo,Cn=!0;break e}w=w.return}if(_t===null)throw Error(i(160));mT(v,S,y),_t=null,Cn=!1,v=y.alternate,v!==null&&(v.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)_T(o,r),o=o.sibling}var vi=null;function _T(r,o){var u=r.alternate,c=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:wn(o,r),Rn(r),c&4&&(ss(3,r,r.return),Nu(3,r),ss(5,r,r.return));break;case 1:wn(o,r),Rn(r),c&512&&(Bt||u===null||Yi(u,u.return)),c&64&&gr&&(r=r.updateQueue,r!==null&&(c=r.callbacks,c!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?c:u.concat(c))));break;case 26:var y=vi;if(wn(o,r),Rn(r),c&512&&(Bt||u===null||Yi(u,u.return)),c&4){var v=u!==null?u.memoizedState:null;if(c=r.memoizedState,u===null)if(c===null)if(r.stateNode===null){e:{c=r.type,u=r.memoizedProps,y=y.ownerDocument||y;t:switch(c){case"title":v=y.getElementsByTagName("title")[0],(!v||v[Pi]||v[kt]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=y.createElement(c),y.head.insertBefore(v,y.querySelector("head > title"))),an(v,c,u),v[kt]=r,Vt(v),c=v;break e;case"link":var S=_0("link","href",y).get(c+(u.href||""));if(S){for(var w=0;w<S.length;w++)if(v=S[w],v.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&v.getAttribute("rel")===(u.rel==null?null:u.rel)&&v.getAttribute("title")===(u.title==null?null:u.title)&&v.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){S.splice(w,1);break t}}v=y.createElement(c),an(v,c,u),y.head.appendChild(v);break;case"meta":if(S=_0("meta","content",y).get(c+(u.content||""))){for(w=0;w<S.length;w++)if(v=S[w],v.getAttribute("content")===(u.content==null?null:""+u.content)&&v.getAttribute("name")===(u.name==null?null:u.name)&&v.getAttribute("property")===(u.property==null?null:u.property)&&v.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&v.getAttribute("charset")===(u.charSet==null?null:u.charSet)){S.splice(w,1);break t}}v=y.createElement(c),an(v,c,u),y.head.appendChild(v);break;default:throw Error(i(468,c))}v[kt]=r,Vt(v),c=v}r.stateNode=c}else v0(y,r.type,r.stateNode);else r.stateNode=y0(y,c,r.memoizedProps);else v!==c?(v===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):v.count--,c===null?v0(y,r.type,r.stateNode):y0(y,c,r.memoizedProps)):c===null&&r.stateNode!==null&&Pm(r,r.memoizedProps,u.memoizedProps)}break;case 27:wn(o,r),Rn(r),c&512&&(Bt||u===null||Yi(u,u.return)),u!==null&&c&4&&Pm(r,r.memoizedProps,u.memoizedProps);break;case 5:if(wn(o,r),Rn(r),c&512&&(Bt||u===null||Yi(u,u.return)),r.flags&32){y=r.stateNode;try{In(y,"")}catch(_e){rt(r,r.return,_e)}}c&4&&r.stateNode!=null&&(y=r.memoizedProps,Pm(r,y,u!==null?u.memoizedProps:y)),c&1024&&(Lm=!0);break;case 6:if(wn(o,r),Rn(r),c&4){if(r.stateNode===null)throw Error(i(162));c=r.memoizedProps,u=r.stateNode;try{u.nodeValue=c}catch(_e){rt(r,r.return,_e)}}break;case 3:if(Tf=null,y=vi,vi=vf(o.containerInfo),wn(o,r),vi=y,Rn(r),c&4&&u!==null&&u.memoizedState.isDehydrated)try{qa(o.containerInfo)}catch(_e){rt(r,r.return,_e)}Lm&&(Lm=!1,vT(r));break;case 4:c=vi,vi=vf(r.stateNode.containerInfo),wn(o,r),Rn(r),vi=c;break;case 12:wn(o,r),Rn(r);break;case 31:wn(o,r),Rn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,sf(r,c)));break;case 13:wn(o,r),Rn(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(af=yn()),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,sf(r,c)));break;case 22:y=r.memoizedState!==null;var U=u!==null&&u.memoizedState!==null,Y=gr,te=Bt;if(gr=Y||y,Bt=te||U,wn(o,r),Bt=te,gr=Y,Rn(r),c&8192)e:for(o=r.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||U||gr||Bt||To(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){U=u=o;try{if(v=U.stateNode,y)S=v.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{w=U.stateNode;var ie=U.memoizedProps.style,$=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;w.style.display=$==null||typeof $=="boolean"?"":(""+$).trim()}}catch(_e){rt(U,U.return,_e)}}}else if(o.tag===6){if(u===null){U=o;try{U.stateNode.nodeValue=y?"":U.memoizedProps}catch(_e){rt(U,U.return,_e)}}}else if(o.tag===18){if(u===null){U=o;try{var Z=U.stateNode;y?l0(Z,!0):l0(U.stateNode,!1)}catch(_e){rt(U,U.return,_e)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}c&4&&(c=r.updateQueue,c!==null&&(u=c.retryQueue,u!==null&&(c.retryQueue=null,sf(r,u))));break;case 19:wn(o,r),Rn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,sf(r,c)));break;case 30:break;case 21:break;default:wn(o,r),Rn(r)}}function Rn(r){var o=r.flags;if(o&2){try{for(var u,c=r.return;c!==null;){if(cT(c)){u=c;break}c=c.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var y=u.stateNode,v=km(r);rf(r,v,y);break;case 5:var S=u.stateNode;u.flags&32&&(In(S,""),u.flags&=-33);var w=km(r);rf(r,w,S);break;case 3:case 4:var U=u.stateNode.containerInfo,Y=km(r);Vm(r,Y,U);break;default:throw Error(i(161))}}catch(te){rt(r,r.return,te)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function vT(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;vT(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function _r(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)hT(r,o.alternate,o),o=o.sibling}function To(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:ss(4,o,o.return),To(o);break;case 1:Yi(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&lT(o,o.return,u),To(o);break;case 27:Bu(o.stateNode);case 26:case 5:Yi(o,o.return),To(o);break;case 22:o.memoizedState===null&&To(o);break;case 30:To(o);break;default:To(o)}r=r.sibling}}function vr(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var c=o.alternate,y=r,v=o,S=v.flags;switch(v.tag){case 0:case 11:case 15:vr(y,v,u),Nu(4,v);break;case 1:if(vr(y,v,u),c=v,y=c.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Y){rt(c,c.return,Y)}if(c=v,y=c.updateQueue,y!==null){var w=c.stateNode;try{var U=y.shared.hiddenCallbacks;if(U!==null)for(y.shared.hiddenCallbacks=null,y=0;y<U.length;y++)Xv(U[y],w)}catch(Y){rt(c,c.return,Y)}}u&&S&64&&aT(v),Du(v,v.return);break;case 27:dT(v);case 26:case 5:vr(y,v,u),u&&c===null&&S&4&&uT(v),Du(v,v.return);break;case 12:vr(y,v,u);break;case 31:vr(y,v,u),u&&S&4&&gT(y,v);break;case 13:vr(y,v,u),u&&S&4&&yT(y,v);break;case 22:v.memoizedState===null&&vr(y,v,u),Du(v,v.return);break;case 30:break;default:vr(y,v,u)}o=o.sibling}}function Um(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&yu(u))}function Om(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&yu(r))}function Ei(r,o,u,c){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)ET(r,o,u,c),o=o.sibling}function ET(r,o,u,c){var y=o.flags;switch(o.tag){case 0:case 11:case 15:Ei(r,o,u,c),y&2048&&Nu(9,o);break;case 1:Ei(r,o,u,c);break;case 3:Ei(r,o,u,c),y&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&yu(r)));break;case 12:if(y&2048){Ei(r,o,u,c),r=o.stateNode;try{var v=o.memoizedProps,S=v.id,w=v.onPostCommit;typeof w=="function"&&w(S,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(U){rt(o,o.return,U)}}else Ei(r,o,u,c);break;case 31:Ei(r,o,u,c);break;case 13:Ei(r,o,u,c);break;case 23:break;case 22:v=o.stateNode,S=o.alternate,o.memoizedState!==null?v._visibility&2?Ei(r,o,u,c):Mu(r,o):v._visibility&2?Ei(r,o,u,c):(v._visibility|=2,Na(r,o,u,c,(o.subtreeFlags&10256)!==0||!1)),y&2048&&Um(S,o);break;case 24:Ei(r,o,u,c),y&2048&&Om(o.alternate,o);break;default:Ei(r,o,u,c)}}function Na(r,o,u,c,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var v=r,S=o,w=u,U=c,Y=S.flags;switch(S.tag){case 0:case 11:case 15:Na(v,S,w,U,y),Nu(8,S);break;case 23:break;case 22:var te=S.stateNode;S.memoizedState!==null?te._visibility&2?Na(v,S,w,U,y):Mu(v,S):(te._visibility|=2,Na(v,S,w,U,y)),y&&Y&2048&&Um(S.alternate,S);break;case 24:Na(v,S,w,U,y),y&&Y&2048&&Om(S.alternate,S);break;default:Na(v,S,w,U,y)}o=o.sibling}}function Mu(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,c=o,y=c.flags;switch(c.tag){case 22:Mu(u,c),y&2048&&Um(c.alternate,c);break;case 24:Mu(u,c),y&2048&&Om(c.alternate,c);break;default:Mu(u,c)}o=o.sibling}}var Pu=8192;function Da(r,o,u){if(r.subtreeFlags&Pu)for(r=r.child;r!==null;)TT(r,o,u),r=r.sibling}function TT(r,o,u){switch(r.tag){case 26:Da(r,o,u),r.flags&Pu&&r.memoizedState!==null&&yN(u,vi,r.memoizedState,r.memoizedProps);break;case 5:Da(r,o,u);break;case 3:case 4:var c=vi;vi=vf(r.stateNode.containerInfo),Da(r,o,u),vi=c;break;case 22:r.memoizedState===null&&(c=r.alternate,c!==null&&c.memoizedState!==null?(c=Pu,Pu=16777216,Da(r,o,u),Pu=c):Da(r,o,u));break;default:Da(r,o,u)}}function AT(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function ku(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var c=o[u];Zt=c,IT(c,r)}AT(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)ST(r),r=r.sibling}function ST(r){switch(r.tag){case 0:case 11:case 15:ku(r),r.flags&2048&&ss(9,r,r.return);break;case 3:ku(r);break;case 12:ku(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,of(r)):ku(r);break;default:ku(r)}}function of(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var c=o[u];Zt=c,IT(c,r)}AT(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:ss(8,o,o.return),of(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,of(o));break;default:of(o)}r=r.sibling}}function IT(r,o){for(;Zt!==null;){var u=Zt;switch(u.tag){case 0:case 11:case 15:ss(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var c=u.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:yu(u.memoizedState.cache)}if(c=u.child,c!==null)c.return=u,Zt=c;else e:for(u=r;Zt!==null;){c=Zt;var y=c.sibling,v=c.return;if(pT(c),c===u){Zt=null;break e}if(y!==null){y.return=v,Zt=y;break e}Zt=v}}}var M1={getCacheForType:function(r){var o=sn(Ut),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return sn(Ut).controller.signal}},P1=typeof WeakMap=="function"?WeakMap:Map,et=0,ft=null,Fe=null,qe=0,it=0,On=null,os=!1,Ma=!1,Fm=!1,Er=0,At=0,as=0,Ao=0,Bm=0,Fn=0,Pa=0,Vu=null,bn=null,qm=!1,af=0,CT=0,lf=1/0,uf=null,ls=null,Jt=0,us=null,ka=null,Tr=0,Gm=0,zm=null,wT=null,Lu=0,Hm=null;function Bn(){return(et&2)!==0&&qe!==0?qe&-qe:z.T!==null?Xm():ud()}function RT(){if(Fn===0)if((qe&536870912)===0||Je){var r=$s;$s<<=1,($s&3932160)===0&&($s=262144),Fn=r}else Fn=536870912;return r=Ln.current,r!==null&&(r.flags|=32),Fn}function xn(r,o,u){(r===ft&&(it===2||it===9)||r.cancelPendingCommit!==null)&&(Va(r,0),cs(r,qe,Fn,!1)),Qs(r,u),((et&2)===0||r!==ft)&&(r===ft&&((et&2)===0&&(Ao|=u),At===4&&cs(r,qe,Fn,!1)),$i(r))}function bT(r,o,u){if((et&6)!==0)throw Error(i(327));var c=!u&&(o&127)===0&&(o&r.expiredLanes)===0||ci(r,o),y=c?L1(r,o):Jm(r,o,!0),v=c;do{if(y===0){Ma&&!c&&cs(r,o,0,!1);break}else{if(u=r.current.alternate,v&&!k1(u)){y=Jm(r,o,!1),v=!1;continue}if(y===2){if(v=o,r.errorRecoveryDisabledLanes&v)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var w=r;y=Vu;var U=w.current.memoizedState.isDehydrated;if(U&&(Va(w,S).flags|=256),S=Jm(w,S,!1),S!==2){if(Fm&&!U){w.errorRecoveryDisabledLanes|=v,Ao|=v,y=4;break e}v=bn,bn=y,v!==null&&(bn===null?bn=v:bn.push.apply(bn,v))}y=S}if(v=!1,y!==2)continue}}if(y===1){Va(r,0),cs(r,o,0,!0);break}e:{switch(c=r,v=y,v){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:cs(c,o,Fn,!os);break e;case 2:bn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(y=af+300-yn(),10<y)){if(cs(c,o,Fn,!os),Ni(c,0,!0)!==0)break e;Tr=o,c.timeoutHandle=s0(xT.bind(null,c,u,bn,uf,qm,o,Fn,Ao,Pa,os,v,"Throttled",-0,0),y);break e}xT(c,u,bn,uf,qm,o,Fn,Ao,Pa,os,v,null,-0,0)}}break}while(!0);$i(r)}function xT(r,o,u,c,y,v,S,w,U,Y,te,ie,$,Z){if(r.timeoutHandle=-1,ie=o.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:hi},TT(o,v,ie);var _e=(v&62914560)===v?af-yn():(v&4194048)===v?CT-yn():0;if(_e=_N(ie,_e),_e!==null){Tr=v,r.cancelPendingCommit=_e(UT.bind(null,r,o,v,u,c,y,S,w,U,te,ie,null,$,Z)),cs(r,v,S,!Y);return}}UT(r,o,v,u,c,y,S,w,U)}function k1(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var c=0;c<u.length;c++){var y=u[c],v=y.getSnapshot;y=y.value;try{if(!kn(v(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function cs(r,o,u,c){o&=~Bm,o&=~Ao,r.suspendedLanes|=o,r.pingedLanes&=~o,c&&(r.warmLanes|=o),c=r.expirationTimes;for(var y=o;0<y;){var v=31-Ct(y),S=1<<v;c[v]=-1,y&=~S}u!==0&&Xs(r,u,o)}function cf(){return(et&6)===0?(Uu(0),!1):!0}function Km(){if(Fe!==null){if(it===0)var r=Fe.return;else r=Fe,cr=ho=null,am(r),Ca=null,vu=0,r=Fe;for(;r!==null;)oT(r.alternate,r),r=r.return;Fe=null}}function Va(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,eN(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Tr=0,Km(),ft=r,Fe=u=lr(r.current,null),qe=o,it=0,On=null,os=!1,Ma=ci(r,o),Fm=!1,Pa=Fn=Bm=Ao=as=At=0,bn=Vu=null,qm=!1,(o&8)!==0&&(o|=o&32);var c=r.entangledLanes;if(c!==0)for(r=r.entanglements,c&=o;0<c;){var y=31-Ct(c),v=1<<y;o|=r[y],c&=~v}return Er=o,Nd(),u}function NT(r,o){ke=null,z.H=Ru,o===Ia||o===Od?(o=Jv(),it=3):o===Qp?(o=Jv(),it=4):it=o===Sm?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,On=o,Fe===null&&(At=1,Zd(r,Wn(o,r.current)))}function DT(){var r=Ln.current;return r===null?!0:(qe&4194048)===qe?ti===null:(qe&62914560)===qe||(qe&536870912)!==0?r===ti:!1}function MT(){var r=z.H;return z.H=Ru,r===null?Ru:r}function PT(){var r=z.A;return z.A=M1,r}function df(){At=4,os||(qe&4194048)!==qe&&Ln.current!==null||(Ma=!0),(as&134217727)===0&&(Ao&134217727)===0||ft===null||cs(ft,qe,Fn,!1)}function Jm(r,o,u){var c=et;et|=2;var y=MT(),v=PT();(ft!==r||qe!==o)&&(uf=null,Va(r,o)),o=!1;var S=At;e:do try{if(it!==0&&Fe!==null){var w=Fe,U=On;switch(it){case 8:Km(),S=6;break e;case 3:case 2:case 9:case 6:Ln.current===null&&(o=!0);var Y=it;if(it=0,On=null,La(r,w,U,Y),u&&Ma){S=0;break e}break;default:Y=it,it=0,On=null,La(r,w,U,Y)}}V1(),S=At;break}catch(te){NT(r,te)}while(!0);return o&&r.shellSuspendCounter++,cr=ho=null,et=c,z.H=y,z.A=v,Fe===null&&(ft=null,qe=0,Nd()),S}function V1(){for(;Fe!==null;)kT(Fe)}function L1(r,o){var u=et;et|=2;var c=MT(),y=PT();ft!==r||qe!==o?(uf=null,lf=yn()+500,Va(r,o)):Ma=ci(r,o);e:do try{if(it!==0&&Fe!==null){o=Fe;var v=On;t:switch(it){case 1:it=0,On=null,La(r,o,v,1);break;case 2:case 9:if(Hv(v)){it=0,On=null,VT(o);break}o=function(){it!==2&&it!==9||ft!==r||(it=7),$i(r)},v.then(o,o);break e;case 3:it=7;break e;case 4:it=5;break e;case 7:Hv(v)?(it=0,On=null,VT(o)):(it=0,On=null,La(r,o,v,7));break;case 5:var S=null;switch(Fe.tag){case 26:S=Fe.memoizedState;case 5:case 27:var w=Fe;if(S?E0(S):w.stateNode.complete){it=0,On=null;var U=w.sibling;if(U!==null)Fe=U;else{var Y=w.return;Y!==null?(Fe=Y,ff(Y)):Fe=null}break t}}it=0,On=null,La(r,o,v,5);break;case 6:it=0,On=null,La(r,o,v,6);break;case 8:Km(),At=6;break e;default:throw Error(i(462))}}U1();break}catch(te){NT(r,te)}while(!0);return cr=ho=null,z.H=c,z.A=y,et=u,Fe!==null?0:(ft=null,qe=0,Nd(),At)}function U1(){for(;Fe!==null&&!Ap();)kT(Fe)}function kT(r){var o=rT(r.alternate,r,Er);r.memoizedProps=r.pendingProps,o===null?ff(r):Fe=o}function VT(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=ZE(u,o,o.pendingProps,o.type,void 0,qe);break;case 11:o=ZE(u,o,o.pendingProps,o.type.render,o.ref,qe);break;case 5:am(o);default:oT(u,o),o=Fe=Pv(o,Er),o=rT(u,o,Er)}r.memoizedProps=r.pendingProps,o===null?ff(r):Fe=o}function La(r,o,u,c){cr=ho=null,am(o),Ca=null,vu=0;var y=o.return;try{if(C1(r,y,o,u,qe)){At=1,Zd(r,Wn(u,r.current)),Fe=null;return}}catch(v){if(y!==null)throw Fe=y,v;At=1,Zd(r,Wn(u,r.current)),Fe=null;return}o.flags&32768?(Je||c===1?r=!0:Ma||(qe&536870912)!==0?r=!1:(os=r=!0,(c===2||c===9||c===3||c===6)&&(c=Ln.current,c!==null&&c.tag===13&&(c.flags|=16384))),LT(o,r)):ff(o)}function ff(r){var o=r;do{if((o.flags&32768)!==0){LT(o,os);return}r=o.return;var u=b1(o.alternate,o,Er);if(u!==null){Fe=u;return}if(o=o.sibling,o!==null){Fe=o;return}Fe=o=r}while(o!==null);At===0&&(At=5)}function LT(r,o){do{var u=x1(r.alternate,r);if(u!==null){u.flags&=32767,Fe=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){Fe=r;return}Fe=r=u}while(r!==null);At=6,Fe=null}function UT(r,o,u,c,y,v,S,w,U){r.cancelPendingCommit=null;do hf();while(Jt!==0);if((et&6)!==0)throw Error(i(327));if(o!==null){if(o===r.current)throw Error(i(177));if(v=o.lanes|o.childLanes,v|=kp,Cp(r,u,v,S,w,U),r===ft&&(Fe=ft=null,qe=0),ka=o,us=r,Tr=u,Gm=v,zm=y,wT=c,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,q1(Br,function(){return GT(),null})):(r.callbackNode=null,r.callbackPriority=0),c=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||c){c=z.T,z.T=null,y=oe.p,oe.p=2,S=et,et|=4;try{N1(r,o,u)}finally{et=S,oe.p=y,z.T=c}}Jt=1,OT(),FT(),BT()}}function OT(){if(Jt===1){Jt=0;var r=us,o=ka,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=z.T,z.T=null;var c=oe.p;oe.p=2;var y=et;et|=4;try{_T(o,r);var v=rg,S=Iv(r.containerInfo),w=v.focusedElem,U=v.selectionRange;if(S!==w&&w&&w.ownerDocument&&Sv(w.ownerDocument.documentElement,w)){if(U!==null&&xp(w)){var Y=U.start,te=U.end;if(te===void 0&&(te=Y),"selectionStart"in w)w.selectionStart=Y,w.selectionEnd=Math.min(te,w.value.length);else{var ie=w.ownerDocument||document,$=ie&&ie.defaultView||window;if($.getSelection){var Z=$.getSelection(),_e=w.textContent.length,we=Math.min(U.start,_e),dt=U.end===void 0?we:Math.min(U.end,_e);!Z.extend&&we>dt&&(S=dt,dt=we,we=S);var G=Av(w,we),B=Av(w,dt);if(G&&B&&(Z.rangeCount!==1||Z.anchorNode!==G.node||Z.anchorOffset!==G.offset||Z.focusNode!==B.node||Z.focusOffset!==B.offset)){var J=ie.createRange();J.setStart(G.node,G.offset),Z.removeAllRanges(),we>dt?(Z.addRange(J),Z.extend(B.node,B.offset)):(J.setEnd(B.node,B.offset),Z.addRange(J))}}}}for(ie=[],Z=w;Z=Z.parentNode;)Z.nodeType===1&&ie.push({element:Z,left:Z.scrollLeft,top:Z.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<ie.length;w++){var ne=ie[w];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}Cf=!!ig,rg=ig=null}finally{et=y,oe.p=c,z.T=u}}r.current=o,Jt=2}}function FT(){if(Jt===2){Jt=0;var r=us,o=ka,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=z.T,z.T=null;var c=oe.p;oe.p=2;var y=et;et|=4;try{hT(r,o.alternate,o)}finally{et=y,oe.p=c,z.T=u}}Jt=3}}function BT(){if(Jt===4||Jt===3){Jt=0,nd();var r=us,o=ka,u=Tr,c=wT;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Jt=5:(Jt=0,ka=us=null,qT(r,r.pendingLanes));var y=r.pendingLanes;if(y===0&&(ls=null),rr(u),o=o.stateNode,tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(ui,o,void 0,(o.current.flags&128)===128)}catch{}if(c!==null){o=z.T,y=oe.p,oe.p=2,z.T=null;try{for(var v=r.onRecoverableError,S=0;S<c.length;S++){var w=c[S];v(w.value,{componentStack:w.stack})}}finally{z.T=o,oe.p=y}}(Tr&3)!==0&&hf(),$i(r),y=r.pendingLanes,(u&261930)!==0&&(y&42)!==0?r===Hm?Lu++:(Lu=0,Hm=r):Lu=0,Uu(0)}}function qT(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,yu(o)))}function hf(){return OT(),FT(),BT(),GT()}function GT(){if(Jt!==5)return!1;var r=us,o=Gm;Gm=0;var u=rr(Tr),c=z.T,y=oe.p;try{oe.p=32>u?32:u,z.T=null,u=zm,zm=null;var v=us,S=Tr;if(Jt=0,ka=us=null,Tr=0,(et&6)!==0)throw Error(i(331));var w=et;if(et|=4,ST(v.current),ET(v,v.current,S,u),et=w,Uu(0,!1),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(ui,v)}catch{}return!0}finally{oe.p=y,z.T=c,qT(r,o)}}function zT(r,o,u){o=Wn(u,o),o=Am(r.stateNode,o,2),r=ns(r,o,2),r!==null&&(Qs(r,2),$i(r))}function rt(r,o,u){if(r.tag===3)zT(r,r,u);else for(;o!==null;){if(o.tag===3){zT(o,r,u);break}else if(o.tag===1){var c=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ls===null||!ls.has(c))){r=Wn(u,r),u=HE(2),c=ns(o,u,2),c!==null&&(KE(u,c,o,r),Qs(c,2),$i(c));break}}o=o.return}}function Ym(r,o,u){var c=r.pingCache;if(c===null){c=r.pingCache=new P1;var y=new Set;c.set(o,y)}else y=c.get(o),y===void 0&&(y=new Set,c.set(o,y));y.has(u)||(Fm=!0,y.add(u),r=O1.bind(null,r,o,u),o.then(r,r))}function O1(r,o,u){var c=r.pingCache;c!==null&&c.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,ft===r&&(qe&u)===u&&(At===4||At===3&&(qe&62914560)===qe&&300>yn()-af?(et&2)===0&&Va(r,0):Bm|=u,Pa===qe&&(Pa=0)),$i(r)}function HT(r,o){o===0&&(o=ld()),r=uo(r,o),r!==null&&(Qs(r,o),$i(r))}function F1(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),HT(r,u)}function B1(r,o){var u=0;switch(r.tag){case 31:case 13:var c=r.stateNode,y=r.memoizedState;y!==null&&(u=y.retryLane);break;case 19:c=r.stateNode;break;case 22:c=r.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(o),HT(r,u)}function q1(r,o){return Kt(r,o)}var pf=null,Ua=null,$m=!1,mf=!1,Qm=!1,ds=0;function $i(r){r!==Ua&&r.next===null&&(Ua===null?pf=Ua=r:Ua=Ua.next=r),mf=!0,$m||($m=!0,z1())}function Uu(r,o){if(!Qm&&mf){Qm=!0;do for(var u=!1,c=pf;c!==null;){if(r!==0){var y=c.pendingLanes;if(y===0)var v=0;else{var S=c.suspendedLanes,w=c.pingedLanes;v=(1<<31-Ct(42|r)+1)-1,v&=y&~(S&~w),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(u=!0,$T(c,v))}else v=qe,v=Ni(c,c===ft?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(v&3)===0||ci(c,v)||(u=!0,$T(c,v));c=c.next}while(u);Qm=!1}}function G1(){KT()}function KT(){mf=$m=!1;var r=0;ds!==0&&j1()&&(r=ds);for(var o=yn(),u=null,c=pf;c!==null;){var y=c.next,v=JT(c,o);v===0?(c.next=null,u===null?pf=y:u.next=y,y===null&&(Ua=u)):(u=c,(r!==0||(v&3)!==0)&&(mf=!0)),c=y}Jt!==0&&Jt!==5||Uu(r),ds!==0&&(ds=0)}function JT(r,o){for(var u=r.suspendedLanes,c=r.pingedLanes,y=r.expirationTimes,v=r.pendingLanes&-62914561;0<v;){var S=31-Ct(v),w=1<<S,U=y[S];U===-1?((w&u)===0||(w&c)!==0)&&(y[S]=Ip(w,o)):U<=o&&(r.expiredLanes|=w),v&=~w}if(o=ft,u=qe,u=Ni(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c=r.callbackNode,u===0||r===o&&(it===2||it===9)||r.cancelPendingCommit!==null)return c!==null&&c!==null&&Fr(c),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||ci(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(c!==null&&Fr(c),rr(u)){case 2:case 8:u=Yl;break;case 32:u=Br;break;case 268435456:u=id;break;default:u=Br}return c=YT.bind(null,r),u=Kt(u,c),r.callbackPriority=o,r.callbackNode=u,o}return c!==null&&c!==null&&Fr(c),r.callbackPriority=2,r.callbackNode=null,2}function YT(r,o){if(Jt!==0&&Jt!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(hf()&&r.callbackNode!==u)return null;var c=qe;return c=Ni(r,r===ft?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c===0?null:(bT(r,c,o),JT(r,yn()),r.callbackNode!=null&&r.callbackNode===u?YT.bind(null,r):null)}function $T(r,o){if(hf())return null;bT(r,o,!0)}function z1(){tN(function(){(et&6)!==0?Kt(Jl,G1):KT()})}function Xm(){if(ds===0){var r=Aa;r===0&&(r=bi,bi<<=1,(bi&261888)===0&&(bi=256)),ds=r}return ds}function QT(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:aa(""+r)}function XT(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function H1(r,o,u,c,y){if(o==="submit"&&u&&u.stateNode===y){var v=QT((y[Xt]||null).action),S=c.submitter;S&&(o=(o=S[Xt]||null)?QT(o.formAction):S.getAttribute("formAction"),o!==null&&(v=o,S=null));var w=new qi("action","action",null,c,y);r.push({event:w,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ds!==0){var U=S?XT(y,S):new FormData(y);gm(u,{pending:!0,data:U,method:y.method,action:v},null,U)}}else typeof v=="function"&&(w.preventDefault(),U=S?XT(y,S):new FormData(y),gm(u,{pending:!0,data:U,method:y.method,action:v},v,U))},currentTarget:y}]})}}for(var Wm=0;Wm<Pp.length;Wm++){var Zm=Pp[Wm],K1=Zm.toLowerCase(),J1=Zm[0].toUpperCase()+Zm.slice(1);_i(K1,"on"+J1)}_i(Rv,"onAnimationEnd"),_i(bv,"onAnimationIteration"),_i(xv,"onAnimationStart"),_i("dblclick","onDoubleClick"),_i("focusin","onFocus"),_i("focusout","onBlur"),_i(l1,"onTransitionRun"),_i(u1,"onTransitionStart"),_i(c1,"onTransitionCancel"),_i(Nv,"onTransitionEnd"),Ui("onMouseEnter",["mouseout","mouseover"]),Ui("onMouseLeave",["mouseout","mouseover"]),Ui("onPointerEnter",["pointerout","pointerover"]),Ui("onPointerLeave",["pointerout","pointerover"]),Li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Li("onBeforeInput",["compositionend","keypress","textInput","paste"]),Li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Y1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ou));function WT(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var c=r[u],y=c.event;c=c.listeners;e:{var v=void 0;if(o)for(var S=c.length-1;0<=S;S--){var w=c[S],U=w.instance,Y=w.currentTarget;if(w=w.listener,U!==v&&y.isPropagationStopped())break e;v=w,y.currentTarget=Y;try{v(y)}catch(te){xd(te)}y.currentTarget=null,v=U}else for(S=0;S<c.length;S++){if(w=c[S],U=w.instance,Y=w.currentTarget,w=w.listener,U!==v&&y.isPropagationStopped())break e;v=w,y.currentTarget=Y;try{v(y)}catch(te){xd(te)}y.currentTarget=null,v=U}}}}function Be(r,o){var u=o[na];u===void 0&&(u=o[na]=new Set);var c=r+"__bubble";u.has(c)||(ZT(o,r,2,!1),u.add(c))}function jm(r,o,u){var c=0;o&&(c|=4),ZT(u,r,c,o)}var gf="_reactListening"+Math.random().toString(36).slice(2);function eg(r){if(!r[gf]){r[gf]=!0,Xl.forEach(function(u){u!=="selectionchange"&&(Y1.has(u)||jm(u,!1,r),jm(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[gf]||(o[gf]=!0,jm("selectionchange",!1,o))}}function ZT(r,o,u,c){switch(R0(o)){case 2:var y=TN;break;case 8:y=AN;break;default:y=mg}u=y.bind(null,o,u,r),y=void 0,!to||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),c?y!==void 0?r.addEventListener(o,u,{capture:!0,passive:y}):r.addEventListener(o,u,!0):y!==void 0?r.addEventListener(o,u,{passive:y}):r.addEventListener(o,u,!1)}function tg(r,o,u,c,y){var v=c;if((o&1)===0&&(o&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var w=c.stateNode.containerInfo;if(w===y)break;if(S===4)for(S=c.return;S!==null;){var U=S.tag;if((U===3||U===4)&&S.stateNode.containerInfo===y)return;S=S.return}for(;w!==null;){if(S=ki(w),S===null)return;if(U=S.tag,U===5||U===6||U===26||U===27){c=v=S;continue e}w=w.parentNode}}c=c.return}Jr(function(){var Y=v,te=Yn(u),ie=[];e:{var $=Dv.get(r);if($!==void 0){var Z=qi,_e=r;switch(r){case"keypress":if(io(u)===0)break e;case"keydown":case"keyup":Z=wd;break;case"focusin":_e="focus",Z=so;break;case"focusout":_e="blur",Z=so;break;case"beforeblur":case"afterblur":Z=so;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Z=uu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Z=yd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Z=A;break;case Rv:case bv:case xv:Z=vd;break;case Nv:Z=b;break;case"scroll":case"scrollend":Z=lu;break;case"wheel":Z=W;break;case"copy":case"cut":case"paste":Z=Ed;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Z=ar;break;case"toggle":case"beforetoggle":Z=Pe}var we=(o&4)!==0,dt=!we&&(r==="scroll"||r==="scrollend"),G=we?$!==null?$+"Capture":null:$;we=[];for(var B=Y,J;B!==null;){var ne=B;if(J=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||J===null||G===null||(ne=pi(B,G),ne!=null&&we.push(Fu(B,ne,J))),dt)break;B=B.return}0<we.length&&($=new Z($,_e,null,u,te),ie.push({event:$,listeners:we}))}}if((o&7)===0){e:{if($=r==="mouseover"||r==="pointerover",Z=r==="mouseout"||r==="pointerout",$&&u!==su&&(_e=u.relatedTarget||u.fromElement)&&(ki(_e)||_e[Mi]))break e;if((Z||$)&&($=te.window===te?te:($=te.ownerDocument)?$.defaultView||$.parentWindow:window,Z?(_e=u.relatedTarget||u.toElement,Z=Y,_e=_e?ki(_e):null,_e!==null&&(dt=a(_e),we=_e.tag,_e!==dt||we!==5&&we!==27&&we!==6)&&(_e=null)):(Z=null,_e=Y),Z!==_e)){if(we=uu,ne="onMouseLeave",G="onMouseEnter",B="mouse",(r==="pointerout"||r==="pointerover")&&(we=ar,ne="onPointerLeave",G="onPointerEnter",B="pointer"),dt=Z==null?$:Mn(Z),J=_e==null?$:Mn(_e),$=new we(ne,B+"leave",Z,u,te),$.target=dt,$.relatedTarget=J,ne=null,ki(te)===Y&&(we=new we(G,B+"enter",_e,u,te),we.target=J,we.relatedTarget=dt,ne=we),dt=ne,Z&&_e)t:{for(we=$1,G=Z,B=_e,J=0,ne=G;ne;ne=we(ne))J++;ne=0;for(var Se=B;Se;Se=we(Se))ne++;for(;0<J-ne;)G=we(G),J--;for(;0<ne-J;)B=we(B),ne--;for(;J--;){if(G===B||B!==null&&G===B.alternate){we=G;break t}G=we(G),B=we(B)}we=null}else we=null;Z!==null&&jT(ie,$,Z,we,!1),_e!==null&&dt!==null&&jT(ie,dt,_e,we,!0)}}e:{if($=Y?Mn(Y):window,Z=$.nodeName&&$.nodeName.toLowerCase(),Z==="select"||Z==="input"&&$.type==="file")var Xe=gv;else if(pv($))if(yv)Xe=s1;else{Xe=i1;var Te=n1}else Z=$.nodeName,!Z||Z.toLowerCase()!=="input"||$.type!=="checkbox"&&$.type!=="radio"?Y&&oa(Y.elementType)&&(Xe=gv):Xe=r1;if(Xe&&(Xe=Xe(r,Y))){mv(ie,Xe,u,te);break e}Te&&Te(r,$,Y),r==="focusout"&&Y&&$.type==="number"&&Y.memoizedProps.value!=null&&nu($,"number",$.value)}switch(Te=Y?Mn(Y):window,r){case"focusin":(pv(Te)||Te.contentEditable==="true")&&(pa=Te,Np=Y,pu=null);break;case"focusout":pu=Np=pa=null;break;case"mousedown":Dp=!0;break;case"contextmenu":case"mouseup":case"dragend":Dp=!1,Cv(ie,u,te);break;case"selectionchange":if(a1)break;case"keydown":case"keyup":Cv(ie,u,te)}var Le;if(je)e:{switch(r){case"compositionstart":var Ge="onCompositionStart";break e;case"compositionend":Ge="onCompositionEnd";break e;case"compositionupdate":Ge="onCompositionUpdate";break e}Ge=void 0}else ha?oo(r,u)&&(Ge="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Ge="onCompositionStart");Ge&&(Hi&&u.locale!=="ko"&&(ha||Ge!=="onCompositionStart"?Ge==="onCompositionEnd"&&ha&&(Le=au()):(Bi=te,ou="value"in Bi?Bi.value:Bi.textContent,ha=!0)),Te=yf(Y,Ge),0<Te.length&&(Ge=new zi(Ge,r,null,u,te),ie.push({event:Ge,listeners:Te}),Le?Ge.data=Le:(Le=fa(u),Le!==null&&(Ge.data=Le)))),(Le=Qn?Zx(r,u):jx(r,u))&&(Ge=yf(Y,"onBeforeInput"),0<Ge.length&&(Te=new zi("onBeforeInput","beforeinput",null,u,te),ie.push({event:Te,listeners:Ge}),Te.data=Le)),H1(ie,r,Y,u,te)}WT(ie,o)})}function Fu(r,o,u){return{instance:r,listener:o,currentTarget:u}}function yf(r,o){for(var u=o+"Capture",c=[];r!==null;){var y=r,v=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||v===null||(y=pi(r,u),y!=null&&c.unshift(Fu(r,y,v)),y=pi(r,o),y!=null&&c.push(Fu(r,y,v))),r.tag===3)return c;r=r.return}return[]}function $1(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function jT(r,o,u,c,y){for(var v=o._reactName,S=[];u!==null&&u!==c;){var w=u,U=w.alternate,Y=w.stateNode;if(w=w.tag,U!==null&&U===c)break;w!==5&&w!==26&&w!==27||Y===null||(U=Y,y?(Y=pi(u,v),Y!=null&&S.unshift(Fu(u,Y,U))):y||(Y=pi(u,v),Y!=null&&S.push(Fu(u,Y,U)))),u=u.return}S.length!==0&&r.push({event:o,listeners:S})}var Q1=/\r\n?/g,X1=/\u0000|\uFFFD/g;function e0(r){return(typeof r=="string"?r:""+r).replace(Q1,`
`).replace(X1,"")}function t0(r,o){return o=e0(o),e0(r)===o}function ct(r,o,u,c,y,v){switch(u){case"children":typeof c=="string"?o==="body"||o==="textarea"&&c===""||In(r,c):(typeof c=="number"||typeof c=="bigint")&&o!=="body"&&In(r,""+c);break;case"className":Pn(r,"class",c);break;case"tabIndex":Pn(r,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":Pn(r,u,c);break;case"style":ru(r,c,v);break;case"data":if(o!=="object"){Pn(r,"data",c);break}case"src":case"href":if(c===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(u);break}c=aa(""+c),r.setAttribute(u,c);break;case"action":case"formAction":if(typeof c=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(u==="formAction"?(o!=="input"&&ct(r,o,"name",y.name,y,null),ct(r,o,"formEncType",y.formEncType,y,null),ct(r,o,"formMethod",y.formMethod,y,null),ct(r,o,"formTarget",y.formTarget,y,null)):(ct(r,o,"encType",y.encType,y,null),ct(r,o,"method",y.method,y,null),ct(r,o,"target",y.target,y,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(u);break}c=aa(""+c),r.setAttribute(u,c);break;case"onClick":c!=null&&(r.onclick=hi);break;case"onScroll":c!=null&&Be("scroll",r);break;case"onScrollEnd":c!=null&&Be("scrollend",r);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(u=c.__html,u!=null){if(y.children!=null)throw Error(i(60));r.innerHTML=u}}break;case"multiple":r.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":r.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){r.removeAttribute("xlink:href");break}u=aa(""+c),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(u,""+c):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":c===!0?r.setAttribute(u,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(u,c):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?r.setAttribute(u,c):r.removeAttribute(u);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?r.removeAttribute(u):r.setAttribute(u,c);break;case"popover":Be("beforetoggle",r),Be("toggle",r),ra(r,"popover",c);break;case"xlinkActuate":Lt(r,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":Lt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":Lt(r,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":Lt(r,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":Lt(r,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":Lt(r,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":Lt(r,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":ra(r,"is",c);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=gd.get(u)||u,ra(r,u,c))}}function ng(r,o,u,c,y,v){switch(u){case"style":ru(r,c,v);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(u=c.__html,u!=null){if(y.children!=null)throw Error(i(60));r.innerHTML=u}}break;case"children":typeof c=="string"?In(r,c):(typeof c=="number"||typeof c=="bigint")&&In(r,""+c);break;case"onScroll":c!=null&&Be("scroll",r);break;case"onScrollEnd":c!=null&&Be("scrollend",r);break;case"onClick":c!=null&&(r.onclick=hi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Wl.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),v=r[Xt]||null,v=v!=null?v[u]:null,typeof v=="function"&&r.removeEventListener(o,v,y),typeof c=="function")){typeof v!="function"&&v!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,c,y);break e}u in r?r[u]=c:c===!0?r.setAttribute(u,""):ra(r,u,c)}}}function an(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Be("error",r),Be("load",r);var c=!1,y=!1,v;for(v in u)if(u.hasOwnProperty(v)){var S=u[v];if(S!=null)switch(v){case"src":c=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ct(r,o,v,S,u,null)}}y&&ct(r,o,"srcSet",u.srcSet,u,null),c&&ct(r,o,"src",u.src,u,null);return;case"input":Be("invalid",r);var w=v=S=y=null,U=null,Y=null;for(c in u)if(u.hasOwnProperty(c)){var te=u[c];if(te!=null)switch(c){case"name":y=te;break;case"type":S=te;break;case"checked":U=te;break;case"defaultChecked":Y=te;break;case"value":v=te;break;case"defaultValue":w=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(i(137,o));break;default:ct(r,o,c,te,u,null)}}hd(r,v,w,U,Y,S,y,!1);return;case"select":Be("invalid",r),c=S=v=null;for(y in u)if(u.hasOwnProperty(y)&&(w=u[y],w!=null))switch(y){case"value":v=w;break;case"defaultValue":S=w;break;case"multiple":c=w;default:ct(r,o,y,w,u,null)}o=v,u=S,r.multiple=!!c,o!=null?Gr(r,!!c,o,!1):u!=null&&Gr(r,!!c,u,!0);return;case"textarea":Be("invalid",r),v=y=c=null;for(S in u)if(u.hasOwnProperty(S)&&(w=u[S],w!=null))switch(S){case"value":c=w;break;case"defaultValue":y=w;break;case"children":v=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(i(91));break;default:ct(r,o,S,w,u,null)}zr(r,c,y,v);return;case"option":for(U in u)if(u.hasOwnProperty(U)&&(c=u[U],c!=null))switch(U){case"selected":r.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:ct(r,o,U,c,u,null)}return;case"dialog":Be("beforetoggle",r),Be("toggle",r),Be("cancel",r),Be("close",r);break;case"iframe":case"object":Be("load",r);break;case"video":case"audio":for(c=0;c<Ou.length;c++)Be(Ou[c],r);break;case"image":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"embed":case"source":case"link":Be("error",r),Be("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Y in u)if(u.hasOwnProperty(Y)&&(c=u[Y],c!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:ct(r,o,Y,c,u,null)}return;default:if(oa(o)){for(te in u)u.hasOwnProperty(te)&&(c=u[te],c!==void 0&&ng(r,o,te,c,u,void 0));return}}for(w in u)u.hasOwnProperty(w)&&(c=u[w],c!=null&&ct(r,o,w,c,u,null))}function W1(r,o,u,c){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,v=null,S=null,w=null,U=null,Y=null,te=null;for(Z in u){var ie=u[Z];if(u.hasOwnProperty(Z)&&ie!=null)switch(Z){case"checked":break;case"value":break;case"defaultValue":U=ie;default:c.hasOwnProperty(Z)||ct(r,o,Z,null,c,ie)}}for(var $ in c){var Z=c[$];if(ie=u[$],c.hasOwnProperty($)&&(Z!=null||ie!=null))switch($){case"type":v=Z;break;case"name":y=Z;break;case"checked":Y=Z;break;case"defaultChecked":te=Z;break;case"value":S=Z;break;case"defaultValue":w=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(i(137,o));break;default:Z!==ie&&ct(r,o,$,Z,c,ie)}}sa(r,S,w,U,Y,te,v,y);return;case"select":Z=S=w=$=null;for(v in u)if(U=u[v],u.hasOwnProperty(v)&&U!=null)switch(v){case"value":break;case"multiple":Z=U;default:c.hasOwnProperty(v)||ct(r,o,v,null,c,U)}for(y in c)if(v=c[y],U=u[y],c.hasOwnProperty(y)&&(v!=null||U!=null))switch(y){case"value":$=v;break;case"defaultValue":w=v;break;case"multiple":S=v;default:v!==U&&ct(r,o,y,v,c,U)}o=w,u=S,c=Z,$!=null?Gr(r,!!u,$,!1):!!c!=!!u&&(o!=null?Gr(r,!!u,o,!0):Gr(r,!!u,u?[]:"",!1));return;case"textarea":Z=$=null;for(w in u)if(y=u[w],u.hasOwnProperty(w)&&y!=null&&!c.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:ct(r,o,w,null,c,y)}for(S in c)if(y=c[S],v=u[S],c.hasOwnProperty(S)&&(y!=null||v!=null))switch(S){case"value":$=y;break;case"defaultValue":Z=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(i(91));break;default:y!==v&&ct(r,o,S,y,c,v)}pd(r,$,Z);return;case"option":for(var _e in u)if($=u[_e],u.hasOwnProperty(_e)&&$!=null&&!c.hasOwnProperty(_e))switch(_e){case"selected":r.selected=!1;break;default:ct(r,o,_e,null,c,$)}for(U in c)if($=c[U],Z=u[U],c.hasOwnProperty(U)&&$!==Z&&($!=null||Z!=null))switch(U){case"selected":r.selected=$&&typeof $!="function"&&typeof $!="symbol";break;default:ct(r,o,U,$,c,Z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var we in u)$=u[we],u.hasOwnProperty(we)&&$!=null&&!c.hasOwnProperty(we)&&ct(r,o,we,null,c,$);for(Y in c)if($=c[Y],Z=u[Y],c.hasOwnProperty(Y)&&$!==Z&&($!=null||Z!=null))switch(Y){case"children":case"dangerouslySetInnerHTML":if($!=null)throw Error(i(137,o));break;default:ct(r,o,Y,$,c,Z)}return;default:if(oa(o)){for(var dt in u)$=u[dt],u.hasOwnProperty(dt)&&$!==void 0&&!c.hasOwnProperty(dt)&&ng(r,o,dt,void 0,c,$);for(te in c)$=c[te],Z=u[te],!c.hasOwnProperty(te)||$===Z||$===void 0&&Z===void 0||ng(r,o,te,$,c,Z);return}}for(var G in u)$=u[G],u.hasOwnProperty(G)&&$!=null&&!c.hasOwnProperty(G)&&ct(r,o,G,null,c,$);for(ie in c)$=c[ie],Z=u[ie],!c.hasOwnProperty(ie)||$===Z||$==null&&Z==null||ct(r,o,ie,$,c,Z)}function n0(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Z1(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),c=0;c<u.length;c++){var y=u[c],v=y.transferSize,S=y.initiatorType,w=y.duration;if(v&&w&&n0(S)){for(S=0,w=y.responseEnd,c+=1;c<u.length;c++){var U=u[c],Y=U.startTime;if(Y>w)break;var te=U.transferSize,ie=U.initiatorType;te&&n0(ie)&&(U=U.responseEnd,S+=te*(U<w?1:(w-Y)/(U-Y)))}if(--c,o+=8*(v+S)/(y.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var ig=null,rg=null;function _f(r){return r.nodeType===9?r:r.ownerDocument}function i0(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function r0(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function sg(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var og=null;function j1(){var r=window.event;return r&&r.type==="popstate"?r===og?!1:(og=r,!0):(og=null,!1)}var s0=typeof setTimeout=="function"?setTimeout:void 0,eN=typeof clearTimeout=="function"?clearTimeout:void 0,o0=typeof Promise=="function"?Promise:void 0,tN=typeof queueMicrotask=="function"?queueMicrotask:typeof o0<"u"?function(r){return o0.resolve(null).then(r).catch(nN)}:s0;function nN(r){setTimeout(function(){throw r})}function fs(r){return r==="head"}function a0(r,o){var u=o,c=0;do{var y=u.nextSibling;if(r.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(c===0){r.removeChild(y),qa(o);return}c--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")c++;else if(u==="html")Bu(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,Bu(u);for(var v=u.firstChild;v;){var S=v.nextSibling,w=v.nodeName;v[Pi]||w==="SCRIPT"||w==="STYLE"||w==="LINK"&&v.rel.toLowerCase()==="stylesheet"||u.removeChild(v),v=S}}else u==="body"&&Bu(r.ownerDocument.body);u=y}while(u);qa(o)}function l0(r,o){var u=r;r=0;do{var c=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),c&&c.nodeType===8)if(u=c.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=c}while(u)}function ag(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":ag(u),ia(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function iN(r,o,u,c){for(;r.nodeType===1;){var y=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!c&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(c){if(!r[Pi])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(v=r.getAttribute("rel"),v==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(v!==y.rel||r.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||r.getAttribute("title")!==(y.title==null?null:y.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(v=r.getAttribute("src"),(v!==(y.src==null?null:y.src)||r.getAttribute("type")!==(y.type==null?null:y.type)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&v&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var v=y.name==null?null:""+y.name;if(y.type==="hidden"&&r.getAttribute("name")===v)return r}else return r;if(r=ni(r.nextSibling),r===null)break}return null}function rN(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=ni(r.nextSibling),r===null))return null;return r}function u0(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=ni(r.nextSibling),r===null))return null;return r}function lg(r){return r.data==="$?"||r.data==="$~"}function ug(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function sN(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var c=function(){o(),u.removeEventListener("DOMContentLoaded",c)};u.addEventListener("DOMContentLoaded",c),r._reactRetry=c}}function ni(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var cg=null;function c0(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return ni(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function d0(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function f0(r,o,u){switch(o=_f(u),r){case"html":if(r=o.documentElement,!r)throw Error(i(452));return r;case"head":if(r=o.head,!r)throw Error(i(453));return r;case"body":if(r=o.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Bu(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);ia(r)}var ii=new Map,h0=new Set;function vf(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ar=oe.d;oe.d={f:oN,r:aN,D:lN,C:uN,L:cN,m:dN,X:hN,S:fN,M:pN};function oN(){var r=Ar.f(),o=cf();return r||o}function aN(r){var o=Jn(r);o!==null&&o.tag===5&&o.type==="form"?NE(o):Ar.r(r)}var Oa=typeof document>"u"?null:document;function p0(r,o,u){var c=Oa;if(c&&typeof o=="string"&&o){var y=Sn(o);y='link[rel="'+r+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),h0.has(y)||(h0.add(y),r={rel:r,crossOrigin:u,href:o},c.querySelector(y)===null&&(o=c.createElement("link"),an(o,"link",r),Vt(o),c.head.appendChild(o)))}}function lN(r){Ar.D(r),p0("dns-prefetch",r,null)}function uN(r,o){Ar.C(r,o),p0("preconnect",r,o)}function cN(r,o,u){Ar.L(r,o,u);var c=Oa;if(c&&r&&o){var y='link[rel="preload"][as="'+Sn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+Sn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+Sn(u.imageSizes)+'"]')):y+='[href="'+Sn(r)+'"]';var v=y;switch(o){case"style":v=Fa(r);break;case"script":v=Ba(r)}ii.has(v)||(r=E({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),ii.set(v,r),c.querySelector(y)!==null||o==="style"&&c.querySelector(qu(v))||o==="script"&&c.querySelector(Gu(v))||(o=c.createElement("link"),an(o,"link",r),Vt(o),c.head.appendChild(o)))}}function dN(r,o){Ar.m(r,o);var u=Oa;if(u&&r){var c=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+Sn(c)+'"][href="'+Sn(r)+'"]',v=y;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Ba(r)}if(!ii.has(v)&&(r=E({rel:"modulepreload",href:r},o),ii.set(v,r),u.querySelector(y)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Gu(v)))return}c=u.createElement("link"),an(c,"link",r),Vt(c),u.head.appendChild(c)}}}function fN(r,o,u){Ar.S(r,o,u);var c=Oa;if(c&&r){var y=Vi(c).hoistableStyles,v=Fa(r);o=o||"default";var S=y.get(v);if(!S){var w={loading:0,preload:null};if(S=c.querySelector(qu(v)))w.loading=5;else{r=E({rel:"stylesheet",href:r,"data-precedence":o},u),(u=ii.get(v))&&dg(r,u);var U=S=c.createElement("link");Vt(U),an(U,"link",r),U._p=new Promise(function(Y,te){U.onload=Y,U.onerror=te}),U.addEventListener("load",function(){w.loading|=1}),U.addEventListener("error",function(){w.loading|=2}),w.loading|=4,Ef(S,o,c)}S={type:"stylesheet",instance:S,count:1,state:w},y.set(v,S)}}}function hN(r,o){Ar.X(r,o);var u=Oa;if(u&&r){var c=Vi(u).hoistableScripts,y=Ba(r),v=c.get(y);v||(v=u.querySelector(Gu(y)),v||(r=E({src:r,async:!0},o),(o=ii.get(y))&&fg(r,o),v=u.createElement("script"),Vt(v),an(v,"link",r),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(y,v))}}function pN(r,o){Ar.M(r,o);var u=Oa;if(u&&r){var c=Vi(u).hoistableScripts,y=Ba(r),v=c.get(y);v||(v=u.querySelector(Gu(y)),v||(r=E({src:r,async:!0,type:"module"},o),(o=ii.get(y))&&fg(r,o),v=u.createElement("script"),Vt(v),an(v,"link",r),u.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(y,v))}}function m0(r,o,u,c){var y=(y=Ve.current)?vf(y):null;if(!y)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Fa(u.href),u=Vi(y).hoistableStyles,c=u.get(o),c||(c={type:"style",instance:null,count:0,state:null},u.set(o,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Fa(u.href);var v=Vi(y).hoistableStyles,S=v.get(r);if(S||(y=y.ownerDocument||y,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(r,S),(v=y.querySelector(qu(r)))&&!v._p&&(S.instance=v,S.state.loading=5),ii.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},ii.set(r,u),v||mN(y,r,u,S.state))),o&&c===null)throw Error(i(528,""));return S}if(o&&c!==null)throw Error(i(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Ba(u),u=Vi(y).hoistableScripts,c=u.get(o),c||(c={type:"script",instance:null,count:0,state:null},u.set(o,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Fa(r){return'href="'+Sn(r)+'"'}function qu(r){return'link[rel="stylesheet"]['+r+"]"}function g0(r){return E({},r,{"data-precedence":r.precedence,precedence:null})}function mN(r,o,u,c){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?c.loading=1:(o=r.createElement("link"),c.preload=o,o.addEventListener("load",function(){return c.loading|=1}),o.addEventListener("error",function(){return c.loading|=2}),an(o,"link",u),Vt(o),r.head.appendChild(o))}function Ba(r){return'[src="'+Sn(r)+'"]'}function Gu(r){return"script[async]"+r}function y0(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var c=r.querySelector('style[data-href~="'+Sn(u.href)+'"]');if(c)return o.instance=c,Vt(c),c;var y=E({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return c=(r.ownerDocument||r).createElement("style"),Vt(c),an(c,"style",y),Ef(c,u.precedence,r),o.instance=c;case"stylesheet":y=Fa(u.href);var v=r.querySelector(qu(y));if(v)return o.state.loading|=4,o.instance=v,Vt(v),v;c=g0(u),(y=ii.get(y))&&dg(c,y),v=(r.ownerDocument||r).createElement("link"),Vt(v);var S=v;return S._p=new Promise(function(w,U){S.onload=w,S.onerror=U}),an(v,"link",c),o.state.loading|=4,Ef(v,u.precedence,r),o.instance=v;case"script":return v=Ba(u.src),(y=r.querySelector(Gu(v)))?(o.instance=y,Vt(y),y):(c=u,(y=ii.get(v))&&(c=E({},u),fg(c,y)),r=r.ownerDocument||r,y=r.createElement("script"),Vt(y),an(y,"link",c),r.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(c=o.instance,o.state.loading|=4,Ef(c,u.precedence,r));return o.instance}function Ef(r,o,u){for(var c=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=c.length?c[c.length-1]:null,v=y,S=0;S<c.length;S++){var w=c[S];if(w.dataset.precedence===o)v=w;else if(v!==y)break}v?v.parentNode.insertBefore(r,v.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function dg(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function fg(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var Tf=null;function _0(r,o,u){if(Tf===null){var c=new Map,y=Tf=new Map;y.set(u,c)}else y=Tf,c=y.get(u),c||(c=new Map,y.set(u,c));if(c.has(r))return c;for(c.set(r,null),u=u.getElementsByTagName(r),y=0;y<u.length;y++){var v=u[y];if(!(v[Pi]||v[kt]||r==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var S=v.getAttribute(o)||"";S=r+S;var w=c.get(S);w?w.push(v):c.set(S,[v])}}return c}function v0(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function gN(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return r=o.disabled,typeof o.precedence=="string"&&r==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function E0(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function yN(r,o,u,c){if(u.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Fa(c.href),v=o.querySelector(qu(y));if(v){o=v._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=Af.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=v,Vt(v);return}v=o.ownerDocument||o,c=g0(c),(y=ii.get(y))&&dg(c,y),v=v.createElement("link"),Vt(v);var S=v;S._p=new Promise(function(w,U){S.onload=w,S.onerror=U}),an(v,"link",c),u.instance=v}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=Af.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var hg=0;function _N(r,o){return r.stylesheets&&r.count===0&&If(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var c=setTimeout(function(){if(r.stylesheets&&If(r,r.stylesheets),r.unsuspend){var v=r.unsuspend;r.unsuspend=null,v()}},6e4+o);0<r.imgBytes&&hg===0&&(hg=62500*Z1());var y=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&If(r,r.stylesheets),r.unsuspend)){var v=r.unsuspend;r.unsuspend=null,v()}},(r.imgBytes>hg?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(c),clearTimeout(y)}}:null}function Af(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)If(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Sf=null;function If(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Sf=new Map,o.forEach(vN,r),Sf=null,Af.call(r))}function vN(r,o){if(!(o.state.loading&4)){var u=Sf.get(r);if(u)var c=u.get(null);else{u=new Map,Sf.set(r,u);for(var y=r.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<y.length;v++){var S=y[v];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(u.set(S.dataset.precedence,S),c=S)}c&&u.set(null,c)}y=o.instance,S=y.getAttribute("data-precedence"),v=u.get(S)||c,v===c&&u.set(null,y),u.set(S,y),this.count++,c=Af.bind(this),y.addEventListener("load",c),y.addEventListener("error",c),v?v.parentNode.insertBefore(y,v.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(y,r.firstChild)),o.state.loading|=4}}var zu={$$typeof:X,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function EN(r,o,u,c,y,v,S,w,U){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Di(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Di(0),this.hiddenUpdates=Di(null),this.identifierPrefix=c,this.onUncaughtError=y,this.onCaughtError=v,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function T0(r,o,u,c,y,v,S,w,U,Y,te,ie){return r=new EN(r,o,u,S,U,Y,te,ie,w),o=1,v===!0&&(o|=24),v=Vn(3,null,null,o),r.current=v,v.stateNode=r,o=Jp(),o.refCount++,r.pooledCache=o,o.refCount++,v.memoizedState={element:c,isDehydrated:u,cache:o},Xp(v),r}function A0(r){return r?(r=ya,r):ya}function S0(r,o,u,c,y,v){y=A0(y),c.context===null?c.context=y:c.pendingContext=y,c=ts(o),c.payload={element:u},v=v===void 0?null:v,v!==null&&(c.callback=v),u=ns(r,c,o),u!==null&&(xn(u,r,o),Tu(u,r,o))}function I0(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function pg(r,o){I0(r,o),(r=r.alternate)&&I0(r,o)}function C0(r){if(r.tag===13||r.tag===31){var o=uo(r,67108864);o!==null&&xn(o,r,67108864),pg(r,67108864)}}function w0(r){if(r.tag===13||r.tag===31){var o=Bn();o=Ws(o);var u=uo(r,o);u!==null&&xn(u,r,o),pg(r,o)}}var Cf=!0;function TN(r,o,u,c){var y=z.T;z.T=null;var v=oe.p;try{oe.p=2,mg(r,o,u,c)}finally{oe.p=v,z.T=y}}function AN(r,o,u,c){var y=z.T;z.T=null;var v=oe.p;try{oe.p=8,mg(r,o,u,c)}finally{oe.p=v,z.T=y}}function mg(r,o,u,c){if(Cf){var y=gg(c);if(y===null)tg(r,o,c,wf,u),b0(r,c);else if(IN(y,r,o,u,c))c.stopPropagation();else if(b0(r,c),o&4&&-1<SN.indexOf(r)){for(;y!==null;){var v=Jn(y);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var S=xi(v.pendingLanes);if(S!==0){var w=v;for(w.pendingLanes|=2,w.entangledLanes|=2;S;){var U=1<<31-Ct(S);w.entanglements[1]|=U,S&=~U}$i(v),(et&6)===0&&(lf=yn()+500,Uu(0))}}break;case 31:case 13:w=uo(v,2),w!==null&&xn(w,v,2),cf(),pg(v,2)}if(v=gg(c),v===null&&tg(r,o,c,wf,u),v===y)break;y=v}y!==null&&c.stopPropagation()}else tg(r,o,c,null,u)}}function gg(r){return r=Yn(r),yg(r)}var wf=null;function yg(r){if(wf=null,r=ki(r),r!==null){var o=a(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=l(o),r!==null)return r;r=null}else if(u===31){if(r=d(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return wf=r,null}function R0(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ys()){case Jl:return 2;case Yl:return 8;case Br:case Sp:return 32;case id:return 268435456;default:return 32}default:return 32}}var _g=!1,hs=null,ps=null,ms=null,Hu=new Map,Ku=new Map,gs=[],SN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function b0(r,o){switch(r){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":Hu.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ku.delete(o.pointerId)}}function Ju(r,o,u,c,y,v){return r===null||r.nativeEvent!==v?(r={blockedOn:o,domEventName:u,eventSystemFlags:c,nativeEvent:v,targetContainers:[y]},o!==null&&(o=Jn(o),o!==null&&C0(o)),r):(r.eventSystemFlags|=c,o=r.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),r)}function IN(r,o,u,c,y){switch(o){case"focusin":return hs=Ju(hs,r,o,u,c,y),!0;case"dragenter":return ps=Ju(ps,r,o,u,c,y),!0;case"mouseover":return ms=Ju(ms,r,o,u,c,y),!0;case"pointerover":var v=y.pointerId;return Hu.set(v,Ju(Hu.get(v)||null,r,o,u,c,y)),!0;case"gotpointercapture":return v=y.pointerId,Ku.set(v,Ju(Ku.get(v)||null,r,o,u,c,y)),!0}return!1}function x0(r){var o=ki(r.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){r.blockedOn=o,di(r.priority,function(){w0(u)});return}}else if(o===31){if(o=d(u),o!==null){r.blockedOn=o,di(r.priority,function(){w0(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Rf(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=gg(r.nativeEvent);if(u===null){u=r.nativeEvent;var c=new u.constructor(u.type,u);su=c,u.target.dispatchEvent(c),su=null}else return o=Jn(u),o!==null&&C0(o),r.blockedOn=u,!1;o.shift()}return!0}function N0(r,o,u){Rf(r)&&u.delete(o)}function CN(){_g=!1,hs!==null&&Rf(hs)&&(hs=null),ps!==null&&Rf(ps)&&(ps=null),ms!==null&&Rf(ms)&&(ms=null),Hu.forEach(N0),Ku.forEach(N0)}function bf(r,o){r.blockedOn===o&&(r.blockedOn=null,_g||(_g=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,CN)))}var xf=null;function D0(r){xf!==r&&(xf=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){xf===r&&(xf=null);for(var o=0;o<r.length;o+=3){var u=r[o],c=r[o+1],y=r[o+2];if(typeof c!="function"){if(yg(c||u)===null)continue;break}var v=Jn(u);v!==null&&(r.splice(o,3),o-=3,gm(v,{pending:!0,data:y,method:u.method,action:c},c,y))}}))}function qa(r){function o(U){return bf(U,r)}hs!==null&&bf(hs,r),ps!==null&&bf(ps,r),ms!==null&&bf(ms,r),Hu.forEach(o),Ku.forEach(o);for(var u=0;u<gs.length;u++){var c=gs[u];c.blockedOn===r&&(c.blockedOn=null)}for(;0<gs.length&&(u=gs[0],u.blockedOn===null);)x0(u),u.blockedOn===null&&gs.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(c=0;c<u.length;c+=3){var y=u[c],v=u[c+1],S=y[Xt]||null;if(typeof v=="function")S||D0(u);else if(S){var w=null;if(v&&v.hasAttribute("formAction")){if(y=v,S=v[Xt]||null)w=S.formAction;else if(yg(y)!==null)continue}else w=S.action;typeof w=="function"?u[c+1]=w:(u.splice(c,3),c-=3),D0(u)}}}function M0(){function r(v){v.canIntercept&&v.info==="react-transition"&&v.intercept({handler:function(){return new Promise(function(S){return y=S})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),c||setTimeout(u,20)}function u(){if(!c&&!navigation.transition){var v=navigation.currentEntry;v&&v.url!=null&&navigation.navigate(v.url,{state:v.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,y=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){c=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function vg(r){this._internalRoot=r}Nf.prototype.render=vg.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(i(409));var u=o.current,c=Bn();S0(u,c,r,o,null,null)},Nf.prototype.unmount=vg.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;S0(r.current,2,null,r,null,null),cf(),o[Mi]=null}};function Nf(r){this._internalRoot=r}Nf.prototype.unstable_scheduleHydration=function(r){if(r){var o=ud();r={blockedOn:null,target:r,priority:o};for(var u=0;u<gs.length&&o!==0&&o<gs[u].priority;u++);gs.splice(u,0,r),u===0&&x0(r)}};var P0=e.version;if(P0!=="19.2.3")throw Error(i(527,P0,"19.2.3"));oe.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=p(o),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var wN={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Df.isDisabled&&Df.supportsFiber)try{ui=Df.inject(wN),tn=Df}catch{}}return $u.createRoot=function(r,o){if(!s(r))throw Error(i(299));var u=!1,c="",y=BE,v=qE,S=GE;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(c=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(v=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError)),o=T0(r,1,!1,null,null,u,c,null,y,v,S,M0),r[Mi]=o.current,eg(r),new vg(o)},$u.hydrateRoot=function(r,o,u){if(!s(r))throw Error(i(299));var c=!1,y="",v=BE,S=qE,w=GE,U=null;return u!=null&&(u.unstable_strictMode===!0&&(c=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(v=u.onUncaughtError),u.onCaughtError!==void 0&&(S=u.onCaughtError),u.onRecoverableError!==void 0&&(w=u.onRecoverableError),u.formState!==void 0&&(U=u.formState)),o=T0(r,1,!0,o,u??null,c,y,U,v,S,w,M0),o.context=A0(null),u=o.current,c=Bn(),c=Ws(c),y=ts(c),y.callback=null,ns(u,y,c),u=c,o.current.lanes=u,Qs(o,u),$i(o),r[Mi]=o.current,eg(r),new Nf(o)},$u.version="19.2.3",$u}var z0;function UN(){if(z0)return Ag.exports;z0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Ag.exports=LN(),Ag.exports}var ON=UN();const FN=CC(ON);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qN=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),H0=n=>{const e=qN(n);return e.charAt(0).toUpperCase()+e.slice(1)},wC=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),GN=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=Ce.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:s="",children:a,iconNode:l,...d},f)=>Ce.createElement("svg",{ref:f,...zN,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:wC("lucide",s),...!a&&!GN(d)&&{"aria-hidden":"true"},...d},[...l.map(([p,_])=>Ce.createElement(p,_)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=(n,e)=>{const t=Ce.forwardRef(({className:i,...s},a)=>Ce.createElement(HN,{ref:a,iconNode:e,className:wC(`lucide-${BN(H0(n))}`,`lucide-${n}`,i),...s}));return t.displayName=H0(n),t};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Jf=Ke("arrow-right",KN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],RC=Ke("book-open",JN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],Kg=Ke("book",YN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],bC=Ke("bookmark",$N);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],xC=Ke("camera",QN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],WN=Ke("chevron-right",XN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],jN=Ke("chevron-left",ZN);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],tD=Ke("circle-alert",eD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nD=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],dh=Ke("circle-check-big",nD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],K0=Ke("circle-check",iD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],sD=Ke("circle-user",rD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oD=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],aD=Ke("circle-x",oD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],uD=Ke("download",lD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cD=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],dD=Ke("graduation-cap",cD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fD=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],hD=Ke("history",fD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pD=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],fh=Ke("key",pD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mD=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],gD=Ke("layers",mD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yD=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Po=Ke("loader-circle",yD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _D=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],vD=Ke("lock",_D);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ED=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],TD=Ke("log-in",ED);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AD=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],SD=Ke("log-out",AD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ID=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],CD=Ke("mail",ID);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wD=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],RD=Ke("moon",wD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bD=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],hh=Ke("play",bD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xD=[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]],ND=Ke("quote",xD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DD=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],MD=Ke("refresh-cw",DD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PD=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],kD=Ke("save",PD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],NC=Ke("settings",VD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LD=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],DC=Ke("shield-check",LD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],MC=Ke("sparkles",UD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],FD=Ke("sun",OD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],PC=Ke("trash-2",BD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],J0=Ke("upload",qD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],zD=Ke("user-plus",GD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],kC=Ke("user",HD);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],JD=Ke("x",KD);var St=(n=>(n.HOME="HOME",n.ANALYZE="ANALYZE",n.VOCAB="VOCAB",n.HISTORY="HISTORY",n.SETTINGS="SETTINGS",n))(St||{});const YD=()=>{};var Y0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VC=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},$D=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const s=n[t++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[i++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],d=n[t++],f=((s&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(f>>10)),e[i++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[i++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},LC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,d=l?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,_=a>>2,E=(a&3)<<4|d>>4;let T=(d&15)<<2|p>>6,C=p&63;f||(C=64,l||(T=64)),i.push(t[_],t[E],t[T],t[C])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(VC(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):$D(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const E=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||d==null||p==null||E==null)throw new QD;const T=a<<2|d>>4;if(i.push(T),p!==64){const C=d<<4&240|p>>2;if(i.push(C),E!==64){const P=p<<6&192|E;i.push(P)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class QD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const XD=function(n){const e=VC(n);return LC.encodeByteArray(e,!0)},UC=function(n){return XD(n).replace(/\./g,"")},OC=function(n){try{return LC.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WD=()=>FC().__FIREBASE_DEFAULTS__,ZD=()=>{if(typeof process>"u"||typeof Y0>"u")return;const n=Y0.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},jD=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&OC(n[1]);return e&&JSON.parse(e)},Hh=()=>{try{return YD()||WD()||ZD()||jD()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},e2=n=>{var e,t;return(t=(e=Hh())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},BC=()=>{var n;return(n=Hh())==null?void 0:n.config},qC=n=>{var e;return(e=Hh())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dl(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function GC(n){return(await fetch(n,{credentials:"include"})).ok}const uc={};function n2(){const n={prod:[],emulator:[]};for(const e of Object.keys(uc))uc[e]?n.emulator.push(e):n.prod.push(e);return n}function i2(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let $0=!1;function r2(n,e){if(typeof window>"u"||typeof document>"u"||!Dl(window.location.host)||uc[n]===e||uc[n]||$0)return;uc[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",a=n2().prod.length>0;function l(){const T=document.getElementById(i);T&&T.remove()}function d(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function f(T,C){T.setAttribute("width","24"),T.setAttribute("id",C),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function p(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{$0=!0,l()},T}function _(T,C){T.setAttribute("id",C),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function E(){const T=i2(i),C=t("text"),P=document.getElementById(C)||document.createElement("span"),F=t("learnmore"),V=document.getElementById(F)||document.createElement("a"),Q=t("preprendIcon"),j=document.getElementById(Q)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const X=T.element;d(X),_(V,F);const se=p();f(j,Q),X.append(j,P,V,se),document.body.appendChild(X)}a?(P.innerText="Preview backend disconnected.",j.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(j.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,P.innerText="Preview backend running in this workspace."),P.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function s2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($t())}function zC(){var e;const n=(e=Hh())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function o2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function a2(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function l2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function u2(){const n=$t();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function HC(){return!zC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function KC(){return!zC()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function JC(){try{return typeof indexedDB=="object"}catch{return!1}}function c2(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var a;e(((a=s.error)==null?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2="FirebaseError";class Pr extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=d2,Object.setPrototypeOf(this,Pr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Oc.prototype.create)}}class Oc{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?f2(a,i):"Error",d=`${this.serviceName}: ${l} (${s}).`;return new Pr(s,d,i)}}function f2(n,e){return n.replace(h2,(t,i)=>{const s=e[i];return s!=null?String(s):`<${i}?>`})}const h2=/\{\$([^}]+)}/g;function p2(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Uo(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const s of t){if(!i.includes(s))return!1;const a=n[s],l=e[s];if(Q0(a)&&Q0(l)){if(!Uo(a,l))return!1}else if(a!==l)return!1}for(const s of i)if(!t.includes(s))return!1;return!0}function Q0(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fc(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function nc(n){const e={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,a]=i.split("=");e[decodeURIComponent(s)]=decodeURIComponent(a)}}),e}function ic(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function m2(n,e){const t=new g2(n,e);return t.subscribe.bind(t)}class g2{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let s;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");y2(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:i},s.next===void 0&&(s.next=wg),s.error===void 0&&(s.error=wg),s.complete===void 0&&(s.complete=wg);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function y2(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function wg(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(n){return n&&n._delegate?n._delegate:n}class Oo{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Io="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new t2;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(E2(e))try{this.getOrInitializeService({instanceIdentifier:Io})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});i.resolve(a)}catch{}}}}clearInstance(e=Io){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Io){return this.instances.has(e)}getOptions(e=Io){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);i===d&&l.resolve(s)}return s}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(i)??new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const s of i)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:v2(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Io){return this.component?this.component.multipleInstances?e:Io:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function v2(n){return n===Io?void 0:n}function E2(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new _2(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ze||(ze={}));const A2={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},S2=ze.INFO,I2={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},C2=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),s=I2[e];if(s)console[s](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Hy{constructor(e){this.name=e,this._logLevel=S2,this._logHandler=C2,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?A2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}}const w2=(n,e)=>e.some(t=>n instanceof t);let X0,W0;function R2(){return X0||(X0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function b2(){return W0||(W0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const YC=new WeakMap,Jg=new WeakMap,$C=new WeakMap,Rg=new WeakMap,Ky=new WeakMap;function x2(n){const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(bs(n.result)),s()},l=()=>{i(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&YC.set(t,n)}).catch(()=>{}),Ky.set(e,n),e}function N2(n){if(Jg.has(n))return;const e=new Promise((t,i)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});Jg.set(n,e)}let Yg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Jg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$C.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return bs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function D2(n){Yg=n(Yg)}function M2(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(bg(this),e,...t);return $C.set(i,e.sort?e.sort():[e]),bs(i)}:b2().includes(n)?function(...e){return n.apply(bg(this),e),bs(YC.get(this))}:function(...e){return bs(n.apply(bg(this),e))}}function P2(n){return typeof n=="function"?M2(n):(n instanceof IDBTransaction&&N2(n),w2(n,R2())?new Proxy(n,Yg):n)}function bs(n){if(n instanceof IDBRequest)return x2(n);if(Rg.has(n))return Rg.get(n);const e=P2(n);return e!==n&&(Rg.set(n,e),Ky.set(e,n)),e}const bg=n=>Ky.get(n);function k2(n,e,{blocked:t,upgrade:i,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),d=bs(l);return i&&l.addEventListener("upgradeneeded",f=>{i(bs(l.result),f.oldVersion,f.newVersion,bs(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const V2=["get","getKey","getAll","getAllKeys","count"],L2=["put","add","delete","clear"],xg=new Map;function Z0(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(xg.get(e))return xg.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,s=L2.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(s||V2.includes(t)))return;const a=async function(l,...d){const f=this.transaction(l,s?"readwrite":"readonly");let p=f.store;return i&&(p=p.index(d.shift())),(await Promise.all([p[t](...d),s&&f.done]))[0]};return xg.set(e,a),a}D2(n=>({...n,get:(e,t,i)=>Z0(e,t)||n.get(e,t,i),has:(e,t)=>!!Z0(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(O2(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function O2(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $g="@firebase/app",j0="0.14.6";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const br=new Hy("@firebase/app"),F2="@firebase/app-compat",B2="@firebase/analytics-compat",q2="@firebase/analytics",G2="@firebase/app-check-compat",z2="@firebase/app-check",H2="@firebase/auth",K2="@firebase/auth-compat",J2="@firebase/database",Y2="@firebase/data-connect",$2="@firebase/database-compat",Q2="@firebase/functions",X2="@firebase/functions-compat",W2="@firebase/installations",Z2="@firebase/installations-compat",j2="@firebase/messaging",eM="@firebase/messaging-compat",tM="@firebase/performance",nM="@firebase/performance-compat",iM="@firebase/remote-config",rM="@firebase/remote-config-compat",sM="@firebase/storage",oM="@firebase/storage-compat",aM="@firebase/firestore",lM="@firebase/ai",uM="@firebase/firestore-compat",cM="firebase",dM="12.6.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qg="[DEFAULT]",fM={[$g]:"fire-core",[F2]:"fire-core-compat",[q2]:"fire-analytics",[B2]:"fire-analytics-compat",[z2]:"fire-app-check",[G2]:"fire-app-check-compat",[H2]:"fire-auth",[K2]:"fire-auth-compat",[J2]:"fire-rtdb",[Y2]:"fire-data-connect",[$2]:"fire-rtdb-compat",[Q2]:"fire-fn",[X2]:"fire-fn-compat",[W2]:"fire-iid",[Z2]:"fire-iid-compat",[j2]:"fire-fcm",[eM]:"fire-fcm-compat",[tM]:"fire-perf",[nM]:"fire-perf-compat",[iM]:"fire-rc",[rM]:"fire-rc-compat",[sM]:"fire-gcs",[oM]:"fire-gcs-compat",[aM]:"fire-fst",[uM]:"fire-fst-compat",[lM]:"fire-vertex","fire-js":"fire-js",[cM]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph=new Map,hM=new Map,Xg=new Map;function eA(n,e){try{n.container.addComponent(e)}catch(t){br.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function dl(n){const e=n.name;if(Xg.has(e))return br.debug(`There were multiple attempts to register component ${e}.`),!1;Xg.set(e,n);for(const t of ph.values())eA(t,n);for(const t of hM.values())eA(t,n);return!0}function Jy(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ri(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pM={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xs=new Oc("app","Firebase",pM);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Oo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ml=dM;function QC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Qg,automaticDataCollectionEnabled:!0,...e},s=i.name;if(typeof s!="string"||!s)throw xs.create("bad-app-name",{appName:String(s)});if(t||(t=BC()),!t)throw xs.create("no-options");const a=ph.get(s);if(a){if(Uo(t,a.options)&&Uo(i,a.config))return a;throw xs.create("duplicate-app",{appName:s})}const l=new T2(s);for(const f of Xg.values())l.addComponent(f);const d=new mM(t,i,l);return ph.set(s,d),d}function gM(n=Qg){const e=ph.get(n);if(!e&&n===Qg&&BC())return QC();if(!e)throw xs.create("no-app",{appName:n});return e}function Ns(n,e,t){let i=fM[n]??n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&l.push("and"),a&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),br.warn(l.join(" "));return}dl(new Oo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM="firebase-heartbeat-database",_M=1,Ec="firebase-heartbeat-store";let Ng=null;function XC(){return Ng||(Ng=k2(yM,_M,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Ec)}catch(t){console.warn(t)}}}}).catch(n=>{throw xs.create("idb-open",{originalErrorMessage:n.message})})),Ng}async function vM(n){try{const t=(await XC()).transaction(Ec),i=await t.objectStore(Ec).get(WC(n));return await t.done,i}catch(e){if(e instanceof Pr)br.warn(e.message);else{const t=xs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});br.warn(t.message)}}}async function tA(n,e){try{const i=(await XC()).transaction(Ec,"readwrite");await i.objectStore(Ec).put(e,WC(n)),await i.done}catch(t){if(t instanceof Pr)br.warn(t.message);else{const i=xs.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});br.warn(i.message)}}}function WC(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM=1024,TM=30;class AM{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new IM(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=nA();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>TM){const l=CM(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){br.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=nA(),{heartbeatsToSend:i,unsentEntries:s}=SM(this._heartbeatsCache.heartbeats),a=UC(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return br.warn(t),""}}}function nA(){return new Date().toISOString().substring(0,10)}function SM(n,e=EM){const t=[];let i=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),iA(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),iA(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class IM{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return JC()?c2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await vM(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return tA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return tA(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function iA(n){return UC(JSON.stringify({version:2,heartbeats:n})).length}function CM(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wM(n){dl(new Oo("platform-logger",e=>new U2(e),"PRIVATE")),dl(new Oo("heartbeat",e=>new AM(e),"PRIVATE")),Ns($g,j0,n),Ns($g,j0,"esm2020"),Ns("fire-js","")}wM("");var RM="firebase",bM="12.7.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ns(RM,bM,"app");function ZC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const xM=ZC,jC=new Oc("auth","Firebase",ZC());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=new Hy("@firebase/auth");function NM(n,...e){mh.logLevel<=ze.WARN&&mh.warn(`Auth (${Ml}): ${n}`,...e)}function Yf(n,...e){mh.logLevel<=ze.ERROR&&mh.error(`Auth (${Ml}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(n,...e){throw Yy(n,...e)}function ji(n,...e){return Yy(n,...e)}function ew(n,e,t){const i={...xM(),[e]:t};return new Oc("auth","Firebase",i).create(e,{appName:n.name})}function wr(n){return ew(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Yy(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return jC.create(n,...e)}function Re(n,e,...t){if(!n)throw Yy(e,...t)}function Sr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Yf(e),new Error(e)}function xr(n,e){n||Sr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function DM(){return rA()==="http:"||rA()==="https:"}function rA(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MM(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(DM()||a2()||"connection"in navigator)?navigator.onLine:!0}function PM(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bc{constructor(e,t){this.shortDelay=e,this.longDelay=t,xr(t>e,"Short delay should be less than long delay!"),this.isMobile=s2()||l2()}get(){return MM()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $y(n,e){xr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Sr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Sr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Sr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kM={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],LM=new Bc(3e4,6e4);function Fs(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function kr(n,e,t,i,s={}){return nw(n,s,async()=>{let a={},l={};i&&(e==="GET"?l=i:a={body:JSON.stringify(i)});const d=Fc({key:n.config.apiKey,...l}).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p={method:e,headers:f,...a};return o2()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(p.credentials="include"),tw.fetch()(await iw(n,n.config.apiHost,t,d),p)})}async function nw(n,e,t){n._canInitEmulator=!1;const i={...kM,...e};try{const s=new OM(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Mf(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mf(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Mf(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw Mf(n,"user-disabled",l);const _=i[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw ew(n,_,p);Ci(n,_)}}catch(s){if(s instanceof Pr)throw s;Ci(n,"network-request-failed",{message:String(s)})}}async function qc(n,e,t,i,s={}){const a=await kr(n,e,t,i,s);return"mfaPendingCredential"in a&&Ci(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function iw(n,e,t,i){const s=`${e}${t}?${i}`,a=n,l=a.config.emulator?$y(n.config,s):`${n.config.apiScheme}://${s}`;return VM.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}function UM(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class OM{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ji(this.auth,"network-request-failed")),LM.get())})}}function Mf(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const s=ji(n,e,i);return s.customData._tokenResponse=t,s}function sA(n){return n!==void 0&&n.enterprise!==void 0}class FM{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return UM(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function BM(n,e){return kr(n,"GET","/v2/recaptchaConfig",Fs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qM(n,e){return kr(n,"POST","/v1/accounts:delete",e)}async function gh(n,e){return kr(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function GM(n,e=!1){const t=zt(n),i=await t.getIdToken(e),s=Qy(i);Re(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:s,token:i,authTime:cc(Dg(s.auth_time)),issuedAtTime:cc(Dg(s.iat)),expirationTime:cc(Dg(s.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Dg(n){return Number(n)*1e3}function Qy(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return Yf("JWT malformed, contained fewer than 3 sections"),null;try{const s=OC(t);return s?JSON.parse(s):(Yf("Failed to decode base64 JWT payload"),null)}catch(s){return Yf("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function oA(n){const e=Qy(n);return Re(e,"internal-error"),Re(typeof e.exp<"u","internal-error"),Re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fl(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof Pr&&zM(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function zM({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=cc(this.lastLoginAt),this.creationTime=cc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yh(n){var E;const e=n.auth,t=await n.getIdToken(),i=await fl(n,gh(e,{idToken:t}));Re(i==null?void 0:i.users.length,e,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const a=(E=s.providerUserInfo)!=null&&E.length?rw(s.providerUserInfo):[],l=JM(n.providerData,a),d=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),p=d?f:!1,_={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new Zg(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,_)}async function KM(n){const e=zt(n);await yh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function JM(n,e){return[...n.filter(i=>!e.some(s=>s.providerId===i.providerId)),...e]}function rw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YM(n,e){const t=await nw(n,{},async()=>{const i=Fc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await iw(n,s,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:i};return n.emulatorConfig&&Dl(n.emulatorConfig.host)&&(f.credentials="include"),tw.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function $M(n,e){return kr(n,"POST","/v2/accounts:revokeToken",Fs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Re(e.idToken,"internal-error"),Re(typeof e.idToken<"u","internal-error"),Re(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Re(e.length!==0,"internal-error");const t=oA(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:s,expiresIn:a}=await YM(e,t);this.updateTokensAndExpiration(i,s,Number(a))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:s,expirationTime:a}=t,l=new il;return i&&(Re(typeof i=="string","internal-error",{appName:e}),l.refreshToken=i),s&&(Re(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(Re(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new il,this.toJSON())}_performRefresh(){return Sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(n,e){Re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ai{constructor({uid:e,auth:t,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new HM(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Zg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await fl(this,this.stsTokenManager.getToken(this.auth,e));return Re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return GM(this,e)}reload(){return KM(this)}_assign(e){this!==e&&(Re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ai({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await yh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ri(this.auth.app))return Promise.reject(wr(this.auth));const e=await this.getIdToken();return await fl(this,qM(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,s=t.email??void 0,a=t.phoneNumber??void 0,l=t.photoURL??void 0,d=t.tenantId??void 0,f=t._redirectEventId??void 0,p=t.createdAt??void 0,_=t.lastLoginAt??void 0,{uid:E,emailVerified:T,isAnonymous:C,providerData:P,stsTokenManager:F}=t;Re(E&&F,e,"internal-error");const V=il.fromJSON(this.name,F);Re(typeof E=="string",e,"internal-error"),_s(i,e.name),_s(s,e.name),Re(typeof T=="boolean",e,"internal-error"),Re(typeof C=="boolean",e,"internal-error"),_s(a,e.name),_s(l,e.name),_s(d,e.name),_s(f,e.name),_s(p,e.name),_s(_,e.name);const Q=new Ai({uid:E,auth:e,email:s,emailVerified:T,displayName:i,isAnonymous:C,photoURL:l,phoneNumber:a,tenantId:d,stsTokenManager:V,createdAt:p,lastLoginAt:_});return P&&Array.isArray(P)&&(Q.providerData=P.map(j=>({...j}))),f&&(Q._redirectEventId=f),Q}static async _fromIdTokenResponse(e,t,i=!1){const s=new il;s.updateFromServerResponse(t);const a=new Ai({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:i});return await yh(a),a}static async _fromGetAccountInfoResponse(e,t,i){const s=t.users[0];Re(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?rw(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),d=new il;d.updateFromIdToken(i);const f=new Ai({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Zg(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aA=new Map;function Ir(n){xr(n instanceof Function,"Expected a class definition");let e=aA.get(n);return e?(xr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,aA.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}sw.type="NONE";const lA=sw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $f(n,e,t){return`firebase:${n}:${e}:${t}`}class rl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:s,name:a}=this.auth;this.fullUserKey=$f(this.userKey,s.apiKey,a),this.fullPersistenceKey=$f("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await gh(this.auth,{idToken:e}).catch(()=>{});return t?Ai._fromGetAccountInfoResponse(this.auth,t,e):null}return Ai._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new rl(Ir(lA),e,i);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||Ir(lA);const l=$f(i,e.config.apiKey,e.name);let d=null;for(const p of t)try{const _=await p._get(l);if(_){let E;if(typeof _=="string"){const T=await gh(e,{idToken:_}).catch(()=>{});if(!T)break;E=await Ai._fromGetAccountInfoResponse(e,T,_)}else E=Ai._fromJSON(e,_);p!==a&&(d=E),a=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new rl(a,e,i):(a=f[0],d&&await a._set(l,d.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new rl(a,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(uw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ow(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(dw(e))return"Blackberry";if(fw(e))return"Webos";if(aw(e))return"Safari";if((e.includes("chrome/")||lw(e))&&!e.includes("edge/"))return"Chrome";if(cw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function ow(n=$t()){return/firefox\//i.test(n)}function aw(n=$t()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function lw(n=$t()){return/crios\//i.test(n)}function uw(n=$t()){return/iemobile/i.test(n)}function cw(n=$t()){return/android/i.test(n)}function dw(n=$t()){return/blackberry/i.test(n)}function fw(n=$t()){return/webos/i.test(n)}function Xy(n=$t()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function QM(n=$t()){var e;return Xy(n)&&!!((e=window.navigator)!=null&&e.standalone)}function XM(){return u2()&&document.documentMode===10}function hw(n=$t()){return Xy(n)||cw(n)||fw(n)||dw(n)||/windows phone/i.test(n)||uw(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(n,e=[]){let t;switch(n){case"Browser":t=uA($t());break;case"Worker":t=`${uA($t())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ml}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WM{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=a=>new Promise((l,d)=>{try{const f=e(a);l(f)}catch(f){d(f)}});i.onAbort=t,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZM(n,e={}){return kr(n,"GET","/v2/passwordPolicy",Fs(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM=6;class eP{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??jM,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let s=0;s<e.length;s++)i=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,t,i,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new cA(this),this.idTokenSubscription=new cA(this),this.beforeStateQueue=new WM(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ir(t)),this._initializationPromise=this.queue(async()=>{var i,s,a;if(!this._deleted&&(this.persistenceManager=await rl.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)==null?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await gh(this,{idToken:e}),i=await Ai._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var a;if(ri(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(a=this.redirectUser)==null?void 0:a._redirectEventId,d=i==null?void 0:i._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===d)&&(f!=null&&f.user)&&(i=f.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Re(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await yh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PM()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ri(this.app))return Promise.reject(wr(this));const t=e?zt(e):null;return t&&Re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ri(this.app)?Promise.reject(wr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ri(this.app)?Promise.reject(wr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ir(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ZM(this),t=new eP(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Oc("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await $M(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ir(e)||this._popupRedirectResolver;Re(t,this,"argument-error"),this.redirectPersistenceManager=await rl.create(this,[Ir(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Re(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,i,s);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(ri(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&NM(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function $o(n){return zt(n)}class cA{constructor(e){this.auth=e,this.observer=null,this.addObserver=m2(t=>this.observer=t)}get next(){return Re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function nP(n){Kh=n}function mw(n){return Kh.loadJS(n)}function iP(){return Kh.recaptchaEnterpriseScript}function rP(){return Kh.gapiScript}function sP(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class oP{constructor(){this.enterprise=new aP}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class aP{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const lP="recaptcha-enterprise",gw="NO_RECAPTCHA";class uP{constructor(e){this.type=lP,this.auth=$o(e)}async verify(e="verify",t=!1){async function i(a){if(!t){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(l,d)=>{BM(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const p=new FM(f);return a.tenantId==null?a._agentRecaptchaConfig=p:a._tenantRecaptchaConfigs[a.tenantId]=p,l(p.siteKey)}}).catch(f=>{d(f)})})}function s(a,l,d){const f=window.grecaptcha;sA(f)?f.enterprise.ready(()=>{f.enterprise.execute(a,{action:e}).then(p=>{l(p)}).catch(()=>{l(gw)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new oP().execute("siteKey",{action:"verify"}):new Promise((a,l)=>{i(this.auth).then(d=>{if(!t&&sA(window.grecaptcha))s(d,a,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let f=iP();f.length!==0&&(f+=d),mw(f).then(()=>{s(d,a,l)}).catch(p=>{l(p)})}}).catch(d=>{l(d)})})}}async function dA(n,e,t,i=!1,s=!1){const a=new uP(n);let l;if(s)l=gw;else try{l=await a.verify(t)}catch{l=await a.verify(t,!0)}const d={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in d){const f=d.phoneEnrollmentInfo.phoneNumber,p=d.phoneEnrollmentInfo.recaptchaToken;Object.assign(d,{phoneEnrollmentInfo:{phoneNumber:f,recaptchaToken:p,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in d){const f=d.phoneSignInInfo.recaptchaToken;Object.assign(d,{phoneSignInInfo:{recaptchaToken:f,captchaResponse:l,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return d}return i?Object.assign(d,{captchaResp:l}):Object.assign(d,{captchaResponse:l}),Object.assign(d,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(d,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),d}async function jg(n,e,t,i,s){var a;if((a=n._getRecaptchaConfig())!=null&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await dA(n,e,t,t==="getOobCode");return i(n,l)}else return i(n,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const d=await dA(n,e,t,t==="getOobCode");return i(n,d)}else return Promise.reject(l)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(n,e){const t=Jy(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),a=t.getOptions();if(Uo(a,e??{}))return s;Ci(s,"already-initialized")}return t.initialize({options:e})}function dP(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Ir);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function fP(n,e,t){const i=$o(n);Re(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!1,a=yw(e),{host:l,port:d}=hP(e),f=d===null?"":`:${d}`,p={url:`${a}//${l}${f}/`},_=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){Re(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Re(Uo(p,i.config.emulator)&&Uo(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=p,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,Dl(l)?(GC(`${a}//${l}${f}`),r2("Auth",!0)):pP()}function yw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function hP(n){const e=yw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const a=s[1];return{host:a,port:fA(i.substr(a.length+1))}}else{const[a,l]=i.split(":");return{host:a,port:fA(l)}}}function fA(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function pP(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Sr("not implemented")}_getIdTokenResponse(e){return Sr("not implemented")}_linkToIdToken(e,t){return Sr("not implemented")}_getReauthenticationResolver(e){return Sr("not implemented")}}async function mP(n,e){return kr(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gP(n,e){return qc(n,"POST","/v1/accounts:signInWithPassword",Fs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yP(n,e){return qc(n,"POST","/v1/accounts:signInWithEmailLink",Fs(n,e))}async function _P(n,e){return qc(n,"POST","/v1/accounts:signInWithEmailLink",Fs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc extends Wy{constructor(e,t,i,s=null){super("password",i),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Tc(e,t,"password")}static _fromEmailAndCode(e,t,i=null){return new Tc(e,t,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jg(e,t,"signInWithPassword",gP);case"emailLink":return yP(e,{email:this._email,oobCode:this._password});default:Ci(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const i={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return jg(e,i,"signUpPassword",mP);case"emailLink":return _P(e,{idToken:t,email:this._email,oobCode:this._password});default:Ci(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sl(n,e){return qc(n,"POST","/v1/accounts:signInWithIdp",Fs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vP="http://localhost";class Fo extends Wy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Fo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ci("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:s,...a}=t;if(!i||!s)return null;const l=new Fo(i,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return sl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,sl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,sl(e,t)}buildRequest(){const e={requestUri:vP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Fc(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TP(n){const e=nc(ic(n)).link,t=e?nc(ic(e)).deep_link_id:null,i=nc(ic(n)).deep_link_id;return(i?nc(ic(i)).link:null)||i||t||e||n}class Zy{constructor(e){const t=nc(ic(e)),i=t.apiKey??null,s=t.oobCode??null,a=EP(t.mode??null);Re(i&&s&&a,"argument-error"),this.apiKey=i,this.operation=a,this.code=s,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=TP(e);try{return new Zy(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pl{constructor(){this.providerId=Pl.PROVIDER_ID}static credential(e,t){return Tc._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const i=Zy.parseLink(t);return Re(i,"argument-error"),Tc._fromEmailAndCode(e,i.code,i.tenantId)}}Pl.PROVIDER_ID="password";Pl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc extends _w{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends Gc{constructor(){super("facebook.com")}static credential(e){return Fo._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return As.credential(e.oauthAccessToken)}catch{return null}}}As.FACEBOOK_SIGN_IN_METHOD="facebook.com";As.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss extends Gc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Fo._fromParams({providerId:Ss.PROVIDER_ID,signInMethod:Ss.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ss.credentialFromTaggedObject(e)}static credentialFromError(e){return Ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ss.credential(t,i)}catch{return null}}}Ss.GOOGLE_SIGN_IN_METHOD="google.com";Ss.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Is extends Gc{constructor(){super("github.com")}static credential(e){return Fo._fromParams({providerId:Is.PROVIDER_ID,signInMethod:Is.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Is.credentialFromTaggedObject(e)}static credentialFromError(e){return Is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Is.credential(e.oauthAccessToken)}catch{return null}}}Is.GITHUB_SIGN_IN_METHOD="github.com";Is.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs extends Gc{constructor(){super("twitter.com")}static credential(e,t){return Fo._fromParams({providerId:Cs.PROVIDER_ID,signInMethod:Cs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Cs.credentialFromTaggedObject(e)}static credentialFromError(e){return Cs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Cs.credential(t,i)}catch{return null}}}Cs.TWITTER_SIGN_IN_METHOD="twitter.com";Cs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AP(n,e){return qc(n,"POST","/v1/accounts:signUp",Fs(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,s=!1){const a=await Ai._fromIdTokenResponse(e,i,s),l=hA(i);return new Bo({user:a,providerId:l,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const s=hA(i);return new Bo({user:e,providerId:s,_tokenResponse:i,operationType:t})}}function hA(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _h extends Pr{constructor(e,t,i,s){super(t.code,t.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,_h.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,s){return new _h(e,t,i,s)}}function vw(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?_h._fromErrorAndOperation(n,a,e,i):a})}async function SP(n,e,t=!1){const i=await fl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Bo._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IP(n,e,t=!1){const{auth:i}=n;if(ri(i.app))return Promise.reject(wr(i));const s="reauthenticate";try{const a=await fl(n,vw(i,s,e,n),t);Re(a.idToken,i,"internal-error");const l=Qy(a.idToken);Re(l,i,"internal-error");const{sub:d}=l;return Re(n.uid===d,i,"user-mismatch"),Bo._forOperation(n,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Ci(i,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ew(n,e,t=!1){if(ri(n.app))return Promise.reject(wr(n));const i="signIn",s=await vw(n,i,e),a=await Bo._fromIdTokenResponse(n,i,s);return t||await n._updateCurrentUser(a.user),a}async function CP(n,e){return Ew($o(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tw(n){const e=$o(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function wP(n,e,t){if(ri(n.app))return Promise.reject(wr(n));const i=$o(n),l=await jg(i,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",AP).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&Tw(n),f}),d=await Bo._fromIdTokenResponse(i,"signIn",l);return await i._updateCurrentUser(d.user),d}function RP(n,e,t){return ri(n.app)?Promise.reject(wr(n)):CP(zt(n),Pl.credential(e,t)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Tw(n),i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bP(n,e){return kr(n,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xP(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const i=zt(n),a={idToken:await i.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=await fl(i,bP(i.auth,a));i.displayName=l.displayName||null,i.photoURL=l.photoUrl||null;const d=i.providerData.find(({providerId:f})=>f==="password");d&&(d.displayName=i.displayName,d.photoURL=i.photoURL),await i._updateTokensIfNecessary(l)}function NP(n,e,t,i){return zt(n).onIdTokenChanged(e,t,i)}function DP(n,e,t){return zt(n).beforeAuthStateChanged(e,t)}function MP(n,e,t,i){return zt(n).onAuthStateChanged(e,t,i)}function PP(n){return zt(n).signOut()}const vh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vh,"1"),this.storage.removeItem(vh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP=1e3,VP=10;class Sw extends Aw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),s=this.localCache[t];i!==s&&e(t,s,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,f)=>{this.notifyListeners(l,f)});return}const i=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(i);!t&&this.localCache[i]===l||this.notifyListeners(i,l)},a=this.storage.getItem(i);XM()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,VP):s()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},kP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Sw.type="LOCAL";const LP=Sw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw extends Aw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Iw.type="SESSION";const Cw=Iw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UP(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const i=new Jh(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const d=Array.from(l).map(async p=>p(t.origin,a)),f=await UP(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Jh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((d,f)=>{const p=jy("",20);s.port1.start();const _=setTimeout(()=>{f(new Error("unsupported_event"))},i);l={messageChannel:s,onMessage(E){const T=E;if(T.data.eventId===p)switch(T.data.status){case"ack":clearTimeout(_),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(T.data.response);break;default:clearTimeout(_),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function er(){return window}function FP(n){er().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(){return typeof er().WorkerGlobalScope<"u"&&typeof er().importScripts=="function"}async function BP(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qP(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function GP(){return ww()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="firebaseLocalStorageDb",zP=1,Eh="firebaseLocalStorage",bw="fbase_key";class zc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Yh(n,e){return n.transaction([Eh],e?"readwrite":"readonly").objectStore(Eh)}function HP(){const n=indexedDB.deleteDatabase(Rw);return new zc(n).toPromise()}function ey(){const n=indexedDB.open(Rw,zP);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Eh,{keyPath:bw})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Eh)?e(i):(i.close(),await HP(),e(await ey()))})})}async function pA(n,e,t){const i=Yh(n,!0).put({[bw]:e,value:t});return new zc(i).toPromise()}async function KP(n,e){const t=Yh(n,!1).get(e),i=await new zc(t).toPromise();return i===void 0?null:i.value}function mA(n,e){const t=Yh(n,!0).delete(e);return new zc(t).toPromise()}const JP=800,YP=3;class xw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ey(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>YP)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ww()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jh._getInstance(GP()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await BP(),!this.activeServiceWorker)return;this.sender=new OP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ey();return await pA(e,vh,"1"),await mA(e,vh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>pA(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>KP(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>mA(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=Yh(s,!1).getAll();return new zc(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const s of Array.from(i))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xw.type="LOCAL";const $P=xw;new Bc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP(n,e){return e?Ir(e):(Re(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_ extends Wy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return sl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return sl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return sl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function XP(n){return Ew(n.auth,new e_(n),n.bypassAuthState)}function WP(n){const{auth:e,user:t}=n;return Re(t,e,"internal-error"),IP(t,new e_(n),n.bypassAuthState)}async function ZP(n){const{auth:e,user:t}=n;return Re(t,e,"internal-error"),SP(t,new e_(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,t,i,s,a=!1){this.auth=e,this.resolver=i,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:s,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:i,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return XP;case"linkViaPopup":case"linkViaRedirect":return ZP;case"reauthViaPopup":case"reauthViaRedirect":return WP;default:Ci(this.auth,"internal-error")}}resolve(e){xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP=new Bc(2e3,1e4);class el extends Nw{constructor(e,t,i,s,a){super(e,t,s,a),this.provider=i,this.authWindow=null,this.pollId=null,el.currentPopupAction&&el.currentPopupAction.cancel(),el.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Re(e,this.auth,"internal-error"),e}async onExecution(){xr(this.filter.length===1,"Popup operations only handle one event");const e=jy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ji(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(ji(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,el.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ji(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,jP.get())};e()}}el.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ek="pendingRedirect",Qf=new Map;class tk extends Nw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Qf.get(this.auth._key());if(!e){try{const i=await nk(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Qf.set(this.auth._key(),e)}return this.bypassAuthState||Qf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nk(n,e){const t=sk(e),i=rk(n);if(!await i._isAvailable())return!1;const s=await i._get(t)==="true";return await i._remove(t),s}function ik(n,e){Qf.set(n._key(),e)}function rk(n){return Ir(n._redirectPersistence)}function sk(n){return $f(ek,n.config.apiKey,n.name)}async function ok(n,e,t=!1){if(ri(n.app))return Promise.reject(wr(n));const i=$o(n),s=QP(i,e),l=await new tk(i,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await i._persistUserIfCurrent(l.user),await i._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak=600*1e3;class lk{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!uk(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!Dw(e)){const s=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(ji(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ak&&this.cachedEventUids.clear(),this.cachedEventUids.has(gA(e))}saveEventToCache(e){this.cachedEventUids.add(gA(e)),this.lastProcessedEventTime=Date.now()}}function gA(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Dw({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function uk(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Dw(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ck(n,e={}){return kr(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fk=/^https?/;async function hk(n){if(n.config.emulator)return;const{authorizedDomains:e}=await ck(n);for(const t of e)try{if(pk(t))return}catch{}Ci(n,"unauthorized-domain")}function pk(n){const e=Wg(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===i}if(!fk.test(t))return!1;if(dk.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk=new Bc(3e4,6e4);function yA(){const n=er().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function gk(n){return new Promise((e,t)=>{var s,a,l;function i(){yA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{yA(),t(ji(n,"network-request-failed"))},timeout:mk.get()})}if((a=(s=er().gapi)==null?void 0:s.iframes)!=null&&a.Iframe)e(gapi.iframes.getContext());else if((l=er().gapi)!=null&&l.load)i();else{const d=sP("iframefcb");return er()[d]=()=>{gapi.load?i():t(ji(n,"network-request-failed"))},mw(`${rP()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw Xf=null,e})}let Xf=null;function yk(n){return Xf=Xf||gk(n),Xf}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=new Bc(5e3,15e3),vk="__/auth/iframe",Ek="emulator/auth/iframe",Tk={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ak=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Sk(n){const e=n.config;Re(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?$y(e,Ek):`https://${n.config.authDomain}/${vk}`,i={apiKey:e.apiKey,appName:n.name,v:Ml},s=Ak.get(n.config.apiHost);s&&(i.eid=s);const a=n._getFrameworks();return a.length&&(i.fw=a.join(",")),`${t}?${Fc(i).slice(1)}`}async function Ik(n){const e=await yk(n),t=er().gapi;return Re(t,n,"internal-error"),e.open({where:document.body,url:Sk(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Tk,dontclear:!0},i=>new Promise(async(s,a)=>{await i.restyle({setHideOnLeave:!1});const l=ji(n,"network-request-failed"),d=er().setTimeout(()=>{a(l)},_k.get());function f(){er().clearTimeout(d),s(i)}i.ping(f).then(f,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wk=500,Rk=600,bk="_blank",xk="http://localhost";class _A{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Nk(n,e,t,i=wk,s=Rk){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const f={...Ck,width:i.toString(),height:s.toString(),top:a,left:l},p=$t().toLowerCase();t&&(d=lw(p)?bk:t),ow(p)&&(e=e||xk,f.scrollbars="yes");const _=Object.entries(f).reduce((T,[C,P])=>`${T}${C}=${P},`,"");if(QM(p)&&d!=="_self")return Dk(e||"",d),new _A(null);const E=window.open(e||"",d,_);Re(E,n,"popup-blocked");try{E.focus()}catch{}return new _A(E)}function Dk(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mk="__/auth/handler",Pk="emulator/auth/handler",kk=encodeURIComponent("fac");async function vA(n,e,t,i,s,a){Re(n.config.authDomain,n,"auth-domain-config-required"),Re(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Ml,eventId:s};if(e instanceof _w){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",p2(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,E]of Object.entries({}))l[_]=E}if(e instanceof Gc){const _=e.getScopes().filter(E=>E!=="");_.length>0&&(l.scopes=_.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const _ of Object.keys(d))d[_]===void 0&&delete d[_];const f=await n._getAppCheckToken(),p=f?`#${kk}=${encodeURIComponent(f)}`:"";return`${Vk(n)}?${Fc(d).slice(1)}${p}`}function Vk({config:n}){return n.emulator?$y(n,Pk):`https://${n.authDomain}/${Mk}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg="webStorageSupport";class Lk{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Cw,this._completeRedirectFn=ok,this._overrideRedirectResult=ik}async _openPopup(e,t,i,s){var l;xr((l=this.eventManagers[e._key()])==null?void 0:l.manager,"_initialize() not called before _openPopup()");const a=await vA(e,t,i,Wg(),s);return Nk(e,a,jy())}async _openRedirect(e,t,i,s){await this._originValidation(e);const a=await vA(e,t,i,Wg(),s);return FP(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(xr(a,"If manager is not set, promise should be"),a)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await Ik(e),i=new lk(e);return t.register("authEvent",s=>(Re(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Mg,{type:Mg},s=>{var l;const a=(l=s==null?void 0:s[0])==null?void 0:l[Mg];a!==void 0&&t(!!a),Ci(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=hk(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return hw()||aw()||Xy()}}const Uk=Lk;var EA="@firebase/auth",TA="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ok{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fk(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Bk(n){dl(new Oo("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=i.options;Re(l&&!l.includes(":"),"invalid-api-key",{appName:i.name});const f={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pw(n)},p=new tP(i,s,a,f);return dP(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),dl(new Oo("auth-internal",e=>{const t=$o(e.getProvider("auth").getImmediate());return(i=>new Ok(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ns(EA,TA,Fk(n)),Ns(EA,TA,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qk=300,Gk=qC("authIdTokenMaxAge")||qk;let AA=null;const zk=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Gk)return;const s=t==null?void 0:t.token;AA!==s&&(AA=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Hk(n=gM()){const e=Jy(n,"auth");if(e.isInitialized())return e.getImmediate();const t=cP(n,{popupRedirectResolver:Uk,persistence:[$P,LP,Cw]}),i=qC("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(i,location.origin);if(location.origin===a.origin){const l=zk(a.toString());DP(t,l,()=>l(t.currentUser)),NP(t,d=>l(d))}}const s=e2("auth");return s&&fP(t,`http://${s}`),t}function Kk(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}nP({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=s=>{const a=ji("internal-error");a.customData=s,t(a)},i.type="text/javascript",i.charset="UTF-8",Kk().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Bk("Browser");var SA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ds,Mw;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,D){function x(){}x.prototype=D.prototype,N.F=D.prototype,N.prototype=new x,N.prototype.constructor=N,N.D=function(L,k,O){for(var M=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)M[Ee-2]=arguments[Ee];return D.prototype[k].apply(L,M)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,D,x){x||(x=0);const L=Array(16);if(typeof D=="string")for(var k=0;k<16;++k)L[k]=D.charCodeAt(x++)|D.charCodeAt(x++)<<8|D.charCodeAt(x++)<<16|D.charCodeAt(x++)<<24;else for(k=0;k<16;++k)L[k]=D[x++]|D[x++]<<8|D[x++]<<16|D[x++]<<24;D=N.g[0],x=N.g[1],k=N.g[2];let O=N.g[3],M;M=D+(O^x&(k^O))+L[0]+3614090360&4294967295,D=x+(M<<7&4294967295|M>>>25),M=O+(k^D&(x^k))+L[1]+3905402710&4294967295,O=D+(M<<12&4294967295|M>>>20),M=k+(x^O&(D^x))+L[2]+606105819&4294967295,k=O+(M<<17&4294967295|M>>>15),M=x+(D^k&(O^D))+L[3]+3250441966&4294967295,x=k+(M<<22&4294967295|M>>>10),M=D+(O^x&(k^O))+L[4]+4118548399&4294967295,D=x+(M<<7&4294967295|M>>>25),M=O+(k^D&(x^k))+L[5]+1200080426&4294967295,O=D+(M<<12&4294967295|M>>>20),M=k+(x^O&(D^x))+L[6]+2821735955&4294967295,k=O+(M<<17&4294967295|M>>>15),M=x+(D^k&(O^D))+L[7]+4249261313&4294967295,x=k+(M<<22&4294967295|M>>>10),M=D+(O^x&(k^O))+L[8]+1770035416&4294967295,D=x+(M<<7&4294967295|M>>>25),M=O+(k^D&(x^k))+L[9]+2336552879&4294967295,O=D+(M<<12&4294967295|M>>>20),M=k+(x^O&(D^x))+L[10]+4294925233&4294967295,k=O+(M<<17&4294967295|M>>>15),M=x+(D^k&(O^D))+L[11]+2304563134&4294967295,x=k+(M<<22&4294967295|M>>>10),M=D+(O^x&(k^O))+L[12]+1804603682&4294967295,D=x+(M<<7&4294967295|M>>>25),M=O+(k^D&(x^k))+L[13]+4254626195&4294967295,O=D+(M<<12&4294967295|M>>>20),M=k+(x^O&(D^x))+L[14]+2792965006&4294967295,k=O+(M<<17&4294967295|M>>>15),M=x+(D^k&(O^D))+L[15]+1236535329&4294967295,x=k+(M<<22&4294967295|M>>>10),M=D+(k^O&(x^k))+L[1]+4129170786&4294967295,D=x+(M<<5&4294967295|M>>>27),M=O+(x^k&(D^x))+L[6]+3225465664&4294967295,O=D+(M<<9&4294967295|M>>>23),M=k+(D^x&(O^D))+L[11]+643717713&4294967295,k=O+(M<<14&4294967295|M>>>18),M=x+(O^D&(k^O))+L[0]+3921069994&4294967295,x=k+(M<<20&4294967295|M>>>12),M=D+(k^O&(x^k))+L[5]+3593408605&4294967295,D=x+(M<<5&4294967295|M>>>27),M=O+(x^k&(D^x))+L[10]+38016083&4294967295,O=D+(M<<9&4294967295|M>>>23),M=k+(D^x&(O^D))+L[15]+3634488961&4294967295,k=O+(M<<14&4294967295|M>>>18),M=x+(O^D&(k^O))+L[4]+3889429448&4294967295,x=k+(M<<20&4294967295|M>>>12),M=D+(k^O&(x^k))+L[9]+568446438&4294967295,D=x+(M<<5&4294967295|M>>>27),M=O+(x^k&(D^x))+L[14]+3275163606&4294967295,O=D+(M<<9&4294967295|M>>>23),M=k+(D^x&(O^D))+L[3]+4107603335&4294967295,k=O+(M<<14&4294967295|M>>>18),M=x+(O^D&(k^O))+L[8]+1163531501&4294967295,x=k+(M<<20&4294967295|M>>>12),M=D+(k^O&(x^k))+L[13]+2850285829&4294967295,D=x+(M<<5&4294967295|M>>>27),M=O+(x^k&(D^x))+L[2]+4243563512&4294967295,O=D+(M<<9&4294967295|M>>>23),M=k+(D^x&(O^D))+L[7]+1735328473&4294967295,k=O+(M<<14&4294967295|M>>>18),M=x+(O^D&(k^O))+L[12]+2368359562&4294967295,x=k+(M<<20&4294967295|M>>>12),M=D+(x^k^O)+L[5]+4294588738&4294967295,D=x+(M<<4&4294967295|M>>>28),M=O+(D^x^k)+L[8]+2272392833&4294967295,O=D+(M<<11&4294967295|M>>>21),M=k+(O^D^x)+L[11]+1839030562&4294967295,k=O+(M<<16&4294967295|M>>>16),M=x+(k^O^D)+L[14]+4259657740&4294967295,x=k+(M<<23&4294967295|M>>>9),M=D+(x^k^O)+L[1]+2763975236&4294967295,D=x+(M<<4&4294967295|M>>>28),M=O+(D^x^k)+L[4]+1272893353&4294967295,O=D+(M<<11&4294967295|M>>>21),M=k+(O^D^x)+L[7]+4139469664&4294967295,k=O+(M<<16&4294967295|M>>>16),M=x+(k^O^D)+L[10]+3200236656&4294967295,x=k+(M<<23&4294967295|M>>>9),M=D+(x^k^O)+L[13]+681279174&4294967295,D=x+(M<<4&4294967295|M>>>28),M=O+(D^x^k)+L[0]+3936430074&4294967295,O=D+(M<<11&4294967295|M>>>21),M=k+(O^D^x)+L[3]+3572445317&4294967295,k=O+(M<<16&4294967295|M>>>16),M=x+(k^O^D)+L[6]+76029189&4294967295,x=k+(M<<23&4294967295|M>>>9),M=D+(x^k^O)+L[9]+3654602809&4294967295,D=x+(M<<4&4294967295|M>>>28),M=O+(D^x^k)+L[12]+3873151461&4294967295,O=D+(M<<11&4294967295|M>>>21),M=k+(O^D^x)+L[15]+530742520&4294967295,k=O+(M<<16&4294967295|M>>>16),M=x+(k^O^D)+L[2]+3299628645&4294967295,x=k+(M<<23&4294967295|M>>>9),M=D+(k^(x|~O))+L[0]+4096336452&4294967295,D=x+(M<<6&4294967295|M>>>26),M=O+(x^(D|~k))+L[7]+1126891415&4294967295,O=D+(M<<10&4294967295|M>>>22),M=k+(D^(O|~x))+L[14]+2878612391&4294967295,k=O+(M<<15&4294967295|M>>>17),M=x+(O^(k|~D))+L[5]+4237533241&4294967295,x=k+(M<<21&4294967295|M>>>11),M=D+(k^(x|~O))+L[12]+1700485571&4294967295,D=x+(M<<6&4294967295|M>>>26),M=O+(x^(D|~k))+L[3]+2399980690&4294967295,O=D+(M<<10&4294967295|M>>>22),M=k+(D^(O|~x))+L[10]+4293915773&4294967295,k=O+(M<<15&4294967295|M>>>17),M=x+(O^(k|~D))+L[1]+2240044497&4294967295,x=k+(M<<21&4294967295|M>>>11),M=D+(k^(x|~O))+L[8]+1873313359&4294967295,D=x+(M<<6&4294967295|M>>>26),M=O+(x^(D|~k))+L[15]+4264355552&4294967295,O=D+(M<<10&4294967295|M>>>22),M=k+(D^(O|~x))+L[6]+2734768916&4294967295,k=O+(M<<15&4294967295|M>>>17),M=x+(O^(k|~D))+L[13]+1309151649&4294967295,x=k+(M<<21&4294967295|M>>>11),M=D+(k^(x|~O))+L[4]+4149444226&4294967295,D=x+(M<<6&4294967295|M>>>26),M=O+(x^(D|~k))+L[11]+3174756917&4294967295,O=D+(M<<10&4294967295|M>>>22),M=k+(D^(O|~x))+L[2]+718787259&4294967295,k=O+(M<<15&4294967295|M>>>17),M=x+(O^(k|~D))+L[9]+3951481745&4294967295,N.g[0]=N.g[0]+D&4294967295,N.g[1]=N.g[1]+(k+(M<<21&4294967295|M>>>11))&4294967295,N.g[2]=N.g[2]+k&4294967295,N.g[3]=N.g[3]+O&4294967295}i.prototype.v=function(N,D){D===void 0&&(D=N.length);const x=D-this.blockSize,L=this.C;let k=this.h,O=0;for(;O<D;){if(k==0)for(;O<=x;)s(this,N,O),O+=this.blockSize;if(typeof N=="string"){for(;O<D;)if(L[k++]=N.charCodeAt(O++),k==this.blockSize){s(this,L),k=0;break}}else for(;O<D;)if(L[k++]=N[O++],k==this.blockSize){s(this,L),k=0;break}}this.h=k,this.o+=D},i.prototype.A=function(){var N=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);N[0]=128;for(var D=1;D<N.length-8;++D)N[D]=0;D=this.o*8;for(var x=N.length-8;x<N.length;++x)N[x]=D&255,D/=256;for(this.v(N),N=Array(16),D=0,x=0;x<4;++x)for(let L=0;L<32;L+=8)N[D++]=this.g[x]>>>L&255;return N};function a(N,D){var x=d;return Object.prototype.hasOwnProperty.call(x,N)?x[N]:x[N]=D(N)}function l(N,D){this.h=D;const x=[];let L=!0;for(let k=N.length-1;k>=0;k--){const O=N[k]|0;L&&O==D||(x[k]=O,L=!1)}this.g=x}var d={};function f(N){return-128<=N&&N<128?a(N,function(D){return new l([D|0],D<0?-1:0)}):new l([N|0],N<0?-1:0)}function p(N){if(isNaN(N)||!isFinite(N))return E;if(N<0)return V(p(-N));const D=[];let x=1;for(let L=0;N>=x;L++)D[L]=N/x|0,x*=4294967296;return new l(D,0)}function _(N,D){if(N.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(N.charAt(0)=="-")return V(_(N.substring(1),D));if(N.indexOf("-")>=0)throw Error('number format error: interior "-" character');const x=p(Math.pow(D,8));let L=E;for(let O=0;O<N.length;O+=8){var k=Math.min(8,N.length-O);const M=parseInt(N.substring(O,O+k),D);k<8?(k=p(Math.pow(D,k)),L=L.j(k).add(p(M))):(L=L.j(x),L=L.add(p(M)))}return L}var E=f(0),T=f(1),C=f(16777216);n=l.prototype,n.m=function(){if(F(this))return-V(this).m();let N=0,D=1;for(let x=0;x<this.g.length;x++){const L=this.i(x);N+=(L>=0?L:4294967296+L)*D,D*=4294967296}return N},n.toString=function(N){if(N=N||10,N<2||36<N)throw Error("radix out of range: "+N);if(P(this))return"0";if(F(this))return"-"+V(this).toString(N);const D=p(Math.pow(N,6));var x=this;let L="";for(;;){const k=se(x,D).g;x=Q(x,k.j(D));let O=((x.g.length>0?x.g[0]:x.h)>>>0).toString(N);if(x=k,P(x))return O+L;for(;O.length<6;)O="0"+O;L=O+L}},n.i=function(N){return N<0?0:N<this.g.length?this.g[N]:this.h};function P(N){if(N.h!=0)return!1;for(let D=0;D<N.g.length;D++)if(N.g[D]!=0)return!1;return!0}function F(N){return N.h==-1}n.l=function(N){return N=Q(this,N),F(N)?-1:P(N)?0:1};function V(N){const D=N.g.length,x=[];for(let L=0;L<D;L++)x[L]=~N.g[L];return new l(x,~N.h).add(T)}n.abs=function(){return F(this)?V(this):this},n.add=function(N){const D=Math.max(this.g.length,N.g.length),x=[];let L=0;for(let k=0;k<=D;k++){let O=L+(this.i(k)&65535)+(N.i(k)&65535),M=(O>>>16)+(this.i(k)>>>16)+(N.i(k)>>>16);L=M>>>16,O&=65535,M&=65535,x[k]=M<<16|O}return new l(x,x[x.length-1]&-2147483648?-1:0)};function Q(N,D){return N.add(V(D))}n.j=function(N){if(P(this)||P(N))return E;if(F(this))return F(N)?V(this).j(V(N)):V(V(this).j(N));if(F(N))return V(this.j(V(N)));if(this.l(C)<0&&N.l(C)<0)return p(this.m()*N.m());const D=this.g.length+N.g.length,x=[];for(var L=0;L<2*D;L++)x[L]=0;for(L=0;L<this.g.length;L++)for(let k=0;k<N.g.length;k++){const O=this.i(L)>>>16,M=this.i(L)&65535,Ee=N.i(k)>>>16,Ue=N.i(k)&65535;x[2*L+2*k]+=M*Ue,j(x,2*L+2*k),x[2*L+2*k+1]+=O*Ue,j(x,2*L+2*k+1),x[2*L+2*k+1]+=M*Ee,j(x,2*L+2*k+1),x[2*L+2*k+2]+=O*Ee,j(x,2*L+2*k+2)}for(N=0;N<D;N++)x[N]=x[2*N+1]<<16|x[2*N];for(N=D;N<2*D;N++)x[N]=0;return new l(x,0)};function j(N,D){for(;(N[D]&65535)!=N[D];)N[D+1]+=N[D]>>>16,N[D]&=65535,D++}function X(N,D){this.g=N,this.h=D}function se(N,D){if(P(D))throw Error("division by zero");if(P(N))return new X(E,E);if(F(N))return D=se(V(N),D),new X(V(D.g),V(D.h));if(F(D))return D=se(N,V(D)),new X(V(D.g),D.h);if(N.g.length>30){if(F(N)||F(D))throw Error("slowDivide_ only works with positive integers.");for(var x=T,L=D;L.l(N)<=0;)x=le(x),L=le(L);var k=ue(x,1),O=ue(L,1);for(L=ue(L,2),x=ue(x,2);!P(L);){var M=O.add(L);M.l(N)<=0&&(k=k.add(x),O=M),L=ue(L,1),x=ue(x,1)}return D=Q(N,k.j(D)),new X(k,D)}for(k=E;N.l(D)>=0;){for(x=Math.max(1,Math.floor(N.m()/D.m())),L=Math.ceil(Math.log(x)/Math.LN2),L=L<=48?1:Math.pow(2,L-48),O=p(x),M=O.j(D);F(M)||M.l(N)>0;)x-=L,O=p(x),M=O.j(D);P(O)&&(O=T),k=k.add(O),N=Q(N,M)}return new X(k,N)}n.B=function(N){return se(this,N).h},n.and=function(N){const D=Math.max(this.g.length,N.g.length),x=[];for(let L=0;L<D;L++)x[L]=this.i(L)&N.i(L);return new l(x,this.h&N.h)},n.or=function(N){const D=Math.max(this.g.length,N.g.length),x=[];for(let L=0;L<D;L++)x[L]=this.i(L)|N.i(L);return new l(x,this.h|N.h)},n.xor=function(N){const D=Math.max(this.g.length,N.g.length),x=[];for(let L=0;L<D;L++)x[L]=this.i(L)^N.i(L);return new l(x,this.h^N.h)};function le(N){const D=N.g.length+1,x=[];for(let L=0;L<D;L++)x[L]=N.i(L)<<1|N.i(L-1)>>>31;return new l(x,N.h)}function ue(N,D){const x=D>>5;D%=32;const L=N.g.length-x,k=[];for(let O=0;O<L;O++)k[O]=D>0?N.i(O+x)>>>D|N.i(O+x+1)<<32-D:N.i(O+x);return new l(k,N.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Mw=i,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.B,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=_,Ds=l}).apply(typeof SA<"u"?SA:typeof self<"u"?self:typeof window<"u"?window:{});var Pf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pw,rc,kw,Wf,ty,Vw,Lw,Uw;(function(){var n,e=Object.defineProperty;function t(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pf=="object"&&Pf];for(var A=0;A<g.length;++A){var I=g[A];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var i=t(this);function s(g,A){if(A)e:{var I=i;g=g.split(".");for(var b=0;b<g.length-1;b++){var K=g[b];if(!(K in I))break e;I=I[K]}g=g[g.length-1],b=I[g],A=A(b),A!=b&&A!=null&&e(I,g,{configurable:!0,writable:!0,value:A})}}s("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(g){return g||function(A){var I=[],b;for(b in A)Object.prototype.hasOwnProperty.call(A,b)&&I.push([b,A[b]]);return I}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},l=this||self;function d(g){var A=typeof g;return A=="object"&&g!=null||A=="function"}function f(g,A,I){return g.call.apply(g.bind,arguments)}function p(g,A,I){return p=f,p.apply(null,arguments)}function _(g,A){var I=Array.prototype.slice.call(arguments,1);return function(){var b=I.slice();return b.push.apply(b,arguments),g.apply(this,b)}}function E(g,A){function I(){}I.prototype=A.prototype,g.Z=A.prototype,g.prototype=new I,g.prototype.constructor=g,g.Ob=function(b,K,W){for(var de=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)de[Pe-2]=arguments[Pe];return A.prototype[K].apply(b,de)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function C(g){const A=g.length;if(A>0){const I=Array(A);for(let b=0;b<A;b++)I[b]=g[b];return I}return[]}function P(g,A){for(let b=1;b<arguments.length;b++){const K=arguments[b];var I=typeof K;if(I=I!="object"?I:K?Array.isArray(K)?"array":I:"null",I=="array"||I=="object"&&typeof K.length=="number"){I=g.length||0;const W=K.length||0;g.length=I+W;for(let de=0;de<W;de++)g[I+de]=K[de]}else g.push(K)}}class F{constructor(A,I){this.i=A,this.j=I,this.h=0,this.g=null}get(){let A;return this.h>0?(this.h--,A=this.g,this.g=A.next,A.next=null):A=this.i(),A}}function V(g){l.setTimeout(()=>{throw g},0)}function Q(){var g=N;let A=null;return g.g&&(A=g.g,g.g=g.g.next,g.g||(g.h=null),A.next=null),A}class j{constructor(){this.h=this.g=null}add(A,I){const b=X.get();b.set(A,I),this.h?this.h.next=b:this.g=b,this.h=b}}var X=new F(()=>new se,g=>g.reset());class se{constructor(){this.next=this.g=this.h=null}set(A,I){this.h=A,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let le,ue=!1,N=new j,D=()=>{const g=Promise.resolve(void 0);le=()=>{g.then(x)}};function x(){for(var g;g=Q();){try{g.h.call(g.g)}catch(I){V(I)}var A=X;A.j(g),A.h<100&&(A.h++,g.next=A.g,A.g=g)}ue=!1}function L(){this.u=this.u,this.C=this.C}L.prototype.u=!1,L.prototype.dispose=function(){this.u||(this.u=!0,this.N())},L.prototype[Symbol.dispose]=function(){this.dispose()},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function k(g,A){this.type=g,this.g=this.target=A,this.defaultPrevented=!1}k.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!l.addEventListener||!Object.defineProperty)return!1;var g=!1,A=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const I=()=>{};l.addEventListener("test",I,A),l.removeEventListener("test",I,A)}catch{}return g})();function M(g){return/^[\s\xa0]*$/.test(g)}function Ee(g,A){k.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,A)}E(Ee,k),Ee.prototype.init=function(g,A){const I=this.type=g.type,b=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=A,A=g.relatedTarget,A||(I=="mouseover"?A=g.fromElement:I=="mouseout"&&(A=g.toElement)),this.relatedTarget=A,b?(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&Ee.Z.h.call(this)},Ee.prototype.h=function(){Ee.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var Ue="closure_listenable_"+(Math.random()*1e6|0),z=0;function oe(g,A,I,b,K){this.listener=g,this.proxy=null,this.src=A,this.type=I,this.capture=!!b,this.ha=K,this.key=++z,this.da=this.fa=!1}function fe(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function Me(g,A,I){for(const b in g)A.call(I,g[b],b,g)}function Qe(g,A){for(const I in g)A.call(void 0,g[I],I,g)}function q(g){const A={};for(const I in g)A[I]=g[I];return A}const re="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pe(g,A){let I,b;for(let K=1;K<arguments.length;K++){b=arguments[K];for(I in b)g[I]=b[I];for(let W=0;W<re.length;W++)I=re[W],Object.prototype.hasOwnProperty.call(b,I)&&(g[I]=b[I])}}function ge(g){this.src=g,this.g={},this.h=0}ge.prototype.add=function(g,A,I,b,K){const W=g.toString();g=this.g[W],g||(g=this.g[W]=[],this.h++);const de=Ve(g,A,b,K);return de>-1?(A=g[de],I||(A.fa=!1)):(A=new oe(A,this.src,W,!!b,K),A.fa=I,g.push(A)),A};function be(g,A){const I=A.type;if(I in g.g){var b=g.g[I],K=Array.prototype.indexOf.call(b,A,void 0),W;(W=K>=0)&&Array.prototype.splice.call(b,K,1),W&&(fe(A),g.g[I].length==0&&(delete g.g[I],g.h--))}}function Ve(g,A,I,b){for(let K=0;K<g.length;++K){const W=g[K];if(!W.da&&W.listener==A&&W.capture==!!I&&W.ha==b)return K}return-1}var Ye="closure_lm_"+(Math.random()*1e6|0),Ht={};function gt(g,A,I,b,K){if(Array.isArray(A)){for(let W=0;W<A.length;W++)gt(g,A[W],I,b,K);return null}return I=Kl(I),g&&g[Ue]?g.J(A,I,d(b)?!!b.capture:!1,K):Ks(g,A,I,!1,b,K)}function Ks(g,A,I,b,K,W){if(!A)throw Error("Invalid event type");const de=d(K)?!!K.capture:!!K;let Pe=Js(g);if(Pe||(g[Ye]=Pe=new ge(g)),I=Pe.add(A,I,b,de,W),I.proxy)return I;if(b=Zo(),I.proxy=b,b.src=g,b.listener=I,g.addEventListener)O||(K=de),K===void 0&&(K=!1),g.addEventListener(A.toString(),b,K);else if(g.attachEvent)g.attachEvent(Ri(A.toString()),b);else if(g.addListener&&g.removeListener)g.addListener(b);else throw Error("addEventListener and attachEvent are unavailable.");return I}function Zo(){function g(I){return A.call(g.src,g.listener,I)}const A=zl;return g}function jo(g,A,I,b,K){if(Array.isArray(A))for(var W=0;W<A.length;W++)jo(g,A[W],I,b,K);else b=d(b)?!!b.capture:!!b,I=Kl(I),g&&g[Ue]?(g=g.i,W=String(A).toString(),W in g.g&&(A=g.g[W],I=Ve(A,I,b,K),I>-1&&(fe(A[I]),Array.prototype.splice.call(A,I,1),A.length==0&&(delete g.g[W],g.h--)))):g&&(g=Js(g))&&(A=g.g[A.toString()],g=-1,A&&(g=Ve(A,I,b,K)),(I=g>-1?A[g]:null)&&ea(I))}function ea(g){if(typeof g!="number"&&g&&!g.da){var A=g.src;if(A&&A[Ue])be(A.i,g);else{var I=g.type,b=g.proxy;A.removeEventListener?A.removeEventListener(I,b,g.capture):A.detachEvent?A.detachEvent(Ri(I),b):A.addListener&&A.removeListener&&A.removeListener(b),(I=Js(A))?(be(I,g),I.h==0&&(I.src=null,A[Ye]=null)):fe(g)}}}function Ri(g){return g in Ht?Ht[g]:Ht[g]="on"+g}function zl(g,A){if(g.da)g=!0;else{A=new Ee(A,this);const I=g.listener,b=g.ha||g.src;g.fa&&ea(g),g=I.call(b,A)}return g}function Js(g){return g=g[Ye],g instanceof ge?g:null}var Hl="__closure_events_fn_"+(Math.random()*1e9>>>0);function Kl(g){return typeof g=="function"?g:(g[Hl]||(g[Hl]=function(A){return g.handleEvent(A)}),g[Hl])}function Mt(){L.call(this),this.i=new ge(this),this.M=this,this.G=null}E(Mt,L),Mt.prototype[Ue]=!0,Mt.prototype.removeEventListener=function(g,A,I,b){jo(this,g,A,I,b)};function Kt(g,A){var I,b=g.G;if(b)for(I=[];b;b=b.G)I.push(b);if(g=g.M,b=A.type||A,typeof A=="string")A=new k(A,g);else if(A instanceof k)A.target=A.target||g;else{var K=A;A=new k(b,g),pe(A,K)}K=!0;let W,de;if(I)for(de=I.length-1;de>=0;de--)W=A.g=I[de],K=Fr(W,b,!0,A)&&K;if(W=A.g=g,K=Fr(W,b,!0,A)&&K,K=Fr(W,b,!1,A)&&K,I)for(de=0;de<I.length;de++)W=A.g=I[de],K=Fr(W,b,!1,A)&&K}Mt.prototype.N=function(){if(Mt.Z.N.call(this),this.i){var g=this.i;for(const A in g.g){const I=g.g[A];for(let b=0;b<I.length;b++)fe(I[b]);delete g.g[A],g.h--}}this.G=null},Mt.prototype.J=function(g,A,I,b){return this.i.add(String(g),A,!1,I,b)},Mt.prototype.K=function(g,A,I,b){return this.i.add(String(g),A,!0,I,b)};function Fr(g,A,I,b){if(A=g.i.g[String(A)],!A)return!0;A=A.concat();let K=!0;for(let W=0;W<A.length;++W){const de=A[W];if(de&&!de.da&&de.capture==I){const Pe=de.listener,wt=de.ha||de.src;de.fa&&be(g.i,de),K=Pe.call(wt,b)!==!1&&K}}return K&&!b.defaultPrevented}function Ap(g,A){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=p(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(A)>2147483647?-1:l.setTimeout(g,A||0)}function nd(g){g.g=Ap(()=>{g.g=null,g.i&&(g.i=!1,nd(g))},g.l);const A=g.h;g.h=null,g.m.apply(null,A)}class yn extends L{constructor(A,I){super(),this.m=A,this.l=I,this.h=null,this.i=!1,this.g=null}j(A){this.h=arguments,this.g?this.i=!0:nd(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ys(g){L.call(this),this.h=g,this.g={}}E(Ys,L);var Jl=[];function Yl(g){Me(g.g,function(A,I){this.g.hasOwnProperty(I)&&ea(A)},g),g.g={}}Ys.prototype.N=function(){Ys.Z.N.call(this),Yl(this)},Ys.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Br=l.JSON.stringify,Sp=l.JSON.parse,id=class{stringify(g){return l.JSON.stringify(g,void 0)}parse(g){return l.JSON.parse(g,void 0)}};function rd(){}function sd(){}var ui={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function tn(){k.call(this,"d")}E(tn,k);function Kn(){k.call(this,"c")}E(Kn,k);var Ct={},od=null;function ta(){return od=od||new Mt}Ct.Ia="serverreachability";function ad(g){k.call(this,Ct.Ia,g)}E(ad,k);function bi(g){const A=ta();Kt(A,new ad(A))}Ct.STAT_EVENT="statevent";function $s(g,A){k.call(this,Ct.STAT_EVENT,g),this.stat=A}E($s,k);function Pt(g){const A=ta();Kt(A,new $s(A,g))}Ct.Ja="timingevent";function xi(g,A){k.call(this,Ct.Ja,g),this.size=A}E(xi,k);function Ni(g,A){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){g()},A)}function ci(){this.g=!0}ci.prototype.ua=function(){this.g=!1};function Ip(g,A,I,b,K,W){g.info(function(){if(g.g)if(W){var de="",Pe=W.split("&");for(let je=0;je<Pe.length;je++){var wt=Pe[je].split("=");if(wt.length>1){const yt=wt[0];wt=wt[1];const Qn=yt.split("_");de=Qn.length>=2&&Qn[1]=="type"?de+(yt+"="+wt+"&"):de+(yt+"=redacted&")}}}else de=null;else de=W;return"XMLHTTP REQ ("+b+") [attempt "+K+"]: "+A+`
`+I+`
`+de})}function ld(g,A,I,b,K,W,de){g.info(function(){return"XMLHTTP RESP ("+b+") [ attempt "+K+"]: "+A+`
`+I+`
`+W+" "+de})}function Di(g,A,I,b){g.info(function(){return"XMLHTTP TEXT ("+A+"): "+Cp(g,I)+(b?" "+b:"")})}function Qs(g,A){g.info(function(){return"TIMEOUT: "+A})}ci.prototype.info=function(){};function Cp(g,A){if(!g.g)return A;if(!A)return null;try{const W=JSON.parse(A);if(W){for(g=0;g<W.length;g++)if(Array.isArray(W[g])){var I=W[g];if(!(I.length<2)){var b=I[1];if(Array.isArray(b)&&!(b.length<1)){var K=b[0];if(K!="noop"&&K!="stop"&&K!="close")for(let de=1;de<b.length;de++)b[de]=""}}}}return Br(W)}catch{return A}}var Xs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},$l={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Ql;function Ws(){}E(Ws,rd),Ws.prototype.g=function(){return new XMLHttpRequest},Ql=new Ws;function rr(g){return encodeURIComponent(String(g))}function ud(g){var A=1;g=g.split(":");const I=[];for(;A>0&&g.length;)I.push(g.shift()),A--;return g.length&&I.push(g.join(":")),I}function di(g,A,I,b){this.j=g,this.i=A,this.l=I,this.S=b||1,this.V=new Ys(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new fi}function fi(){this.i=null,this.g="",this.h=!1}var kt={},Xt={};function Mi(g,A,I){g.M=1,g.A=Zs(Lt(A)),g.u=I,g.R=!0,na(g,null)}function na(g,A){g.F=Date.now(),Pi(g),g.B=Lt(g.A);var I=g.B,b=g.S;Array.isArray(b)||(b=[String(b)]),oa(I.i,"t",b),g.C=0,I=g.j.L,g.h=new fi,g.g=Id(g.j,I?A:null,!g.u),g.P>0&&(g.O=new yn(p(g.Y,g,g.g),g.P)),A=g.V,I=g.g,b=g.ba;var K="readystatechange";Array.isArray(K)||(K&&(Jl[0]=K.toString()),K=Jl);for(let W=0;W<K.length;W++){const de=gt(I,K[W],b||A.handleEvent,!1,A.h||A);if(!de)break;A.g[de.key]=de}A=g.J?q(g.J):{},g.u?(g.v||(g.v="POST"),A["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,A)):(g.v="GET",g.g.ea(g.B,g.v,null,A)),bi(),Ip(g.i,g.v,g.B,g.l,g.S,g.u)}di.prototype.ba=function(g){g=g.target;const A=this.O;A&&mi(g)==3?A.j():this.Y(g)},di.prototype.Y=function(g){try{if(g==this.g)e:{const Pe=mi(this.g),wt=this.g.ya(),je=this.g.ca();if(!(Pe<3)&&(Pe!=3||this.g&&(this.h.h||this.g.la()||nn(this.g)))){this.K||Pe!=4||wt==7||(wt==8||je<=0?bi(3):bi(2)),ki(this);var A=this.g.ca();this.X=A;var I=wp(this);if(this.o=A==200,ld(this.i,this.v,this.B,this.l,this.S,Pe,A),this.o){if(this.U&&!this.L){t:{if(this.g){var b,K=this.g;if((b=K.g?K.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(b)){var W=b;break t}}W=null}if(g=W)Di(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Vi(this,g);else{this.o=!1,this.m=3,Pt(12),Mn(this),Jn(this);break e}}if(this.R){g=!0;let yt;for(;!this.K&&this.C<I.length;)if(yt=dd(this,I),yt==Xt){Pe==4&&(this.m=4,Pt(14),g=!1),Di(this.i,this.l,null,"[Incomplete Response]");break}else if(yt==kt){this.m=4,Pt(15),Di(this.i,this.l,I,"[Invalid Chunk]"),g=!1;break}else Di(this.i,this.l,yt,null),Vi(this,yt);if(cd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pe!=4||I.length!=0||this.h.h||(this.m=1,Pt(16),g=!1),this.o=this.o&&g,!g)Di(this.i,this.l,I,"[Invalid Chunked Response]"),Mn(this),Jn(this);else if(I.length>0&&!this.W){this.W=!0;var de=this.j;de.g==this&&de.aa&&!de.P&&(de.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),cu(de),de.P=!0,Pt(11))}}else Di(this.i,this.l,I,null),Vi(this,I);Pe==4&&Mn(this),this.o&&!this.K&&(Pe==4?Ed(this.j,this):(this.o=!1,Pi(this)))}else or(this.g),A==400&&I.indexOf("Unknown SID")>0?(this.m=3,Pt(12)):(this.m=0,Pt(13)),Mn(this),Jn(this)}}}catch{}finally{}};function wp(g){if(!cd(g))return g.g.la();const A=nn(g.g);if(A==="")return"";let I="";const b=A.length,K=mi(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Mn(g),Jn(g),"";g.h.i=new l.TextDecoder}for(let W=0;W<b;W++)g.h.h=!0,I+=g.h.i.decode(A[W],{stream:!(K&&W==b-1)});return A.length=0,g.h.g+=I,g.C=0,g.h.g}function cd(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function dd(g,A){var I=g.C,b=A.indexOf(`
`,I);return b==-1?Xt:(I=Number(A.substring(I,b)),isNaN(I)?kt:(b+=1,b+I>A.length?Xt:(A=A.slice(b,b+I),g.C=b+I,A)))}di.prototype.cancel=function(){this.K=!0,Mn(this)};function Pi(g){g.T=Date.now()+g.H,ia(g,g.H)}function ia(g,A){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Ni(p(g.aa,g),A)}function ki(g){g.D&&(l.clearTimeout(g.D),g.D=null)}di.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(Qs(this.i,this.B),this.M!=2&&(bi(),Pt(17)),Mn(this),this.m=2,Jn(this)):ia(this,this.T-g)};function Jn(g){g.j.I==0||g.K||Ed(g.j,g)}function Mn(g){ki(g);var A=g.O;A&&typeof A.dispose=="function"&&A.dispose(),g.O=null,Yl(g.V),g.g&&(A=g.g,g.g=null,A.abort(),A.dispose())}function Vi(g,A){try{var I=g.j;if(I.I!=0&&(I.g==g||Ui(I.h,g))){if(!g.L&&Ui(I.h,g)&&I.I==3){try{var b=I.Ba.g.parse(A)}catch{b=null}if(Array.isArray(b)&&b.length==3){var K=b;if(K[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<g.F)da(I),$r(I);else break e;so(I),Pt(18)}}else I.xa=K[1],0<I.xa-I.K&&K[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=Ni(p(I.Va,I),6e3));Li(I.h)<=1&&I.ta&&(I.ta=void 0)}else zi(I,11)}else if((g.L||I.g==g)&&da(I),!M(A))for(K=I.Ba.g.parse(A),A=0;A<K.length;A++){let je=K[A];const yt=je[0];if(!(yt<=I.K))if(I.K=yt,je=je[1],I.I==2)if(je[0]=="c"){I.M=je[1],I.ba=je[2];const Qn=je[3];Qn!=null&&(I.ka=Qn,I.j.info("VER="+I.ka));const Hi=je[4];Hi!=null&&(I.za=Hi,I.j.info("SVER="+I.za));const gi=je[5];gi!=null&&typeof gi=="number"&&gi>0&&(b=1.5*gi,I.O=b,I.j.info("backChannelRequestTimeoutMs_="+b)),b=I;const yi=g.g;if(yi){const oo=yi.g?yi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(oo){var W=b.h;W.g||oo.indexOf("spdy")==-1&&oo.indexOf("quic")==-1&&oo.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(Zl(W,W.h),W.h=null))}if(b.G){const fa=yi.g?yi.g.getResponseHeader("X-HTTP-Session-Id"):null;fa&&(b.wa=fa,nt(b.J,b.G,fa))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-g.F,I.j.info("Handshake RTT: "+I.T+"ms")),b=I;var de=g;if(b.na=Sd(b,b.L?b.ba:null,b.W),de.L){jl(b.h,de);var Pe=de,wt=b.O;wt&&(Pe.H=wt),Pe.D&&(ki(Pe),Pi(Pe)),b.g=de}else _d(b);I.i.length>0&&Gi(I)}else je[0]!="stop"&&je[0]!="close"||zi(I,7);else I.I==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?zi(I,7):lu(I):je[0]!="noop"&&I.l&&I.l.qa(je),I.A=0)}}bi(4)}catch{}}var Vt=class{constructor(g,A){this.g=g,this.map=A}};function Xl(g){this.l=g||10,l.PerformanceNavigationTiming?(g=l.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Wl(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function Li(g){return g.h?1:g.g?g.g.size:0}function Ui(g,A){return g.h?g.h==A:g.g?g.g.has(A):!1}function Zl(g,A){g.g?g.g.add(A):g.h=A}function jl(g,A){g.h&&g.h==A?g.h=null:g.g&&g.g.has(A)&&g.g.delete(A)}Xl.prototype.cancel=function(){if(this.i=eu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function eu(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let A=g.i;for(const I of g.g.values())A=A.concat(I.G);return A}return C(g.i)}var fd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ra(g,A){if(g){g=g.split("&");for(let I=0;I<g.length;I++){const b=g[I].indexOf("=");let K,W=null;b>=0?(K=g[I].substring(0,b),W=g[I].substring(b+1)):K=g[I],A(K,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function Pn(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let A;g instanceof Pn?(this.l=g.l,Wt(this,g.j),this.o=g.o,this.g=g.g,qr(this,g.u),this.h=g.h,tu(this,gd(g.i)),this.m=g.m):g&&(A=String(g).match(fd))?(this.l=!1,Wt(this,A[1]||"",!0),this.o=Oi(A[2]||""),this.g=Oi(A[3]||"",!0),qr(this,A[4]),this.h=Oi(A[5]||"",!0),tu(this,A[6]||"",!0),this.m=Oi(A[7]||"")):(this.l=!1,this.i=new zr(null,this.l))}Pn.prototype.toString=function(){const g=[];var A=this.j;A&&g.push(js(A,sa,!0),":");var I=this.g;return(I||A=="file")&&(g.push("//"),(A=this.o)&&g.push(js(A,sa,!0),"@"),g.push(rr(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&g.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&g.push("/"),g.push(js(I,I.charAt(0)=="/"?nu:hd,!0))),(I=this.i.toString())&&g.push("?",I),(I=this.m)&&g.push("#",js(I,pd)),g.join("")},Pn.prototype.resolve=function(g){const A=Lt(this);let I=!!g.j;I?Wt(A,g.j):I=!!g.o,I?A.o=g.o:I=!!g.g,I?A.g=g.g:I=g.u!=null;var b=g.h;if(I)qr(A,g.u);else if(I=!!g.h){if(b.charAt(0)!="/")if(this.g&&!this.h)b="/"+b;else{var K=A.h.lastIndexOf("/");K!=-1&&(b=A.h.slice(0,K+1)+b)}if(K=b,K==".."||K==".")b="";else if(K.indexOf("./")!=-1||K.indexOf("/.")!=-1){b=K.lastIndexOf("/",0)==0,K=K.split("/");const W=[];for(let de=0;de<K.length;){const Pe=K[de++];Pe=="."?b&&de==K.length&&W.push(""):Pe==".."?((W.length>1||W.length==1&&W[0]!="")&&W.pop(),b&&de==K.length&&W.push("")):(W.push(Pe),b=!0)}b=W.join("/")}else b=K}return I?A.h=b:I=g.i.toString()!=="",I?tu(A,gd(g.i)):I=!!g.m,I&&(A.m=g.m),A};function Lt(g){return new Pn(g)}function Wt(g,A,I){g.j=I?Oi(A,!0):A,g.j&&(g.j=g.j.replace(/:$/,""))}function qr(g,A){if(A){if(A=Number(A),isNaN(A)||A<0)throw Error("Bad port number "+A);g.u=A}else g.u=null}function tu(g,A,I){A instanceof zr?(g.i=A,aa(g.i,g.l)):(I||(A=js(A,Gr)),g.i=new zr(A,g.l))}function nt(g,A,I){g.i.set(A,I)}function Zs(g){return nt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Oi(g,A){return g?A?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function js(g,A,I){return typeof g=="string"?(g=encodeURI(g).replace(A,Sn),I&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Sn(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var sa=/[#\/\?@]/g,hd=/[#\?:]/g,nu=/[#\?]/g,Gr=/[#\?@]/g,pd=/#/g;function zr(g,A){this.h=this.g=null,this.i=g||null,this.j=!!A}function In(g){g.g||(g.g=new Map,g.h=0,g.i&&ra(g.i,function(A,I){g.add(decodeURIComponent(A.replace(/\+/g," ")),I)}))}n=zr.prototype,n.add=function(g,A){In(this),this.i=null,g=Hr(this,g);let I=this.g.get(g);return I||this.g.set(g,I=[]),I.push(A),this.h+=1,this};function md(g,A){In(g),A=Hr(g,A),g.g.has(A)&&(g.i=null,g.h-=g.g.get(A).length,g.g.delete(A))}function iu(g,A){return In(g),A=Hr(g,A),g.g.has(A)}n.forEach=function(g,A){In(this),this.g.forEach(function(I,b){I.forEach(function(K){g.call(A,K,b,this)},this)},this)};function ru(g,A){In(g);let I=[];if(typeof A=="string")iu(g,A)&&(I=I.concat(g.g.get(Hr(g,A))));else for(g=Array.from(g.g.values()),A=0;A<g.length;A++)I=I.concat(g[A]);return I}n.set=function(g,A){return In(this),this.i=null,g=Hr(this,g),iu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[A]),this.h+=1,this},n.get=function(g,A){return g?(g=ru(this,g),g.length>0?String(g[0]):A):A};function oa(g,A,I){md(g,A),I.length>0&&(g.i=null,g.g.set(Hr(g,A),C(I)),g.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],A=Array.from(this.g.keys());for(let b=0;b<A.length;b++){var I=A[b];const K=rr(I);I=ru(this,I);for(let W=0;W<I.length;W++){let de=K;I[W]!==""&&(de+="="+rr(I[W])),g.push(de)}}return this.i=g.join("&")};function gd(g){const A=new zr;return A.i=g.i,g.g&&(A.g=new Map(g.g),A.h=g.h),A}function Hr(g,A){return A=String(A),g.j&&(A=A.toLowerCase()),A}function aa(g,A){A&&!g.j&&(In(g),g.i=null,g.g.forEach(function(I,b){const K=b.toLowerCase();b!=K&&(md(this,b),oa(this,K,I))},g)),g.j=A}function hi(g,A){const I=new ci;if(l.Image){const b=new Image;b.onload=_(Yn,I,"TestLoadImage: loaded",!0,A,b),b.onerror=_(Yn,I,"TestLoadImage: error",!1,A,b),b.onabort=_(Yn,I,"TestLoadImage: abort",!1,A,b),b.ontimeout=_(Yn,I,"TestLoadImage: timeout",!1,A,b),l.setTimeout(function(){b.ontimeout&&b.ontimeout()},1e4),b.src=g}else A(!1)}function su(g,A){const I=new ci,b=new AbortController,K=setTimeout(()=>{b.abort(),Yn(I,"TestPingServer: timeout",!1,A)},1e4);fetch(g,{signal:b.signal}).then(W=>{clearTimeout(K),W.ok?Yn(I,"TestPingServer: ok",!0,A):Yn(I,"TestPingServer: server error",!1,A)}).catch(()=>{clearTimeout(K),Yn(I,"TestPingServer: error",!1,A)})}function Yn(g,A,I,b,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),b(I)}catch{}}function Kr(){this.g=new id}function Fi(g){this.i=g.Sb||null,this.h=g.ab||!1}E(Fi,rd),Fi.prototype.g=function(){return new eo(this.i,this.h)};function eo(g,A){Mt.call(this),this.H=g,this.o=A,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}E(eo,Mt),n=eo.prototype,n.open=function(g,A){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=A,this.readyState=1,pi(this)},n.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const A={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(A.body=g),(this.H||l).fetch(new Request(this.D,A)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Jr(this)),this.readyState=0},n.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,pi(this)),this.g&&(this.readyState=3,pi(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;la(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function la(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}n.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var A=g.value?g.value:new Uint8Array(0);(A=this.B.decode(A,{stream:!g.done}))&&(this.response=this.responseText+=A)}g.done?Jr(this):pi(this),this.readyState==3&&la(this)}},n.Oa=function(g){this.g&&(this.response=this.responseText=g,Jr(this))},n.Na=function(g){this.g&&(this.response=g,Jr(this))},n.ga=function(){this.g&&Jr(this)};function Jr(g){g.readyState=4,g.l=null,g.j=null,g.B=null,pi(g)}n.setRequestHeader=function(g,A){this.A.append(g,A)},n.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],A=this.h.entries();for(var I=A.next();!I.done;)I=I.value,g.push(I[0]+": "+I[1]),I=A.next();return g.join(`\r
`)};function pi(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(eo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function $n(g){let A="";return Me(g,function(I,b){A+=b,A+=":",A+=I,A+=`\r
`}),A}function to(g,A,I){e:{for(b in I){var b=!1;break e}b=!0}b||(I=$n(I),typeof g=="string"?I!=null&&rr(I):nt(g,A,I))}function lt(g){Mt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}E(lt,Mt);var Bi=/^https?$/i,ou=["POST","PUT"];n=lt.prototype,n.Fa=function(g){this.H=g},n.ea=function(g,A,I,b){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);A=A?A.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ql.g(),this.g.onreadystatechange=T(p(this.Ca,this));try{this.B=!0,this.g.open(A,String(g),!0),this.B=!1}catch(W){no(this,W);return}if(g=I||"",I=new Map(this.headers),b)if(Object.getPrototypeOf(b)===Object.prototype)for(var K in b)I.set(K,b[K]);else if(typeof b.keys=="function"&&typeof b.get=="function")for(const W of b.keys())I.set(W,b.get(W));else throw Error("Unknown input type for opt_headers: "+String(b));b=Array.from(I.keys()).find(W=>W.toLowerCase()=="content-type"),K=l.FormData&&g instanceof l.FormData,!(Array.prototype.indexOf.call(ou,A,void 0)>=0)||b||K||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,de]of I)this.g.setRequestHeader(W,de);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(W){no(this,W)}};function no(g,A){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=A,g.o=5,au(g),sr(g)}function au(g){g.A||(g.A=!0,Kt(g,"complete"),Kt(g,"error"))}n.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Kt(this,"complete"),Kt(this,"abort"),sr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),sr(this,!0)),lt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?io(this):this.Xa())},n.Xa=function(){io(this)};function io(g){if(g.h&&typeof a<"u"){if(g.v&&mi(g)==4)setTimeout(g.Ca.bind(g),0);else if(Kt(g,"readystatechange"),mi(g)==4){g.h=!1;try{const W=g.ca();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var A=!0;break e;default:A=!1}var I;if(!(I=A)){var b;if(b=W===0){let de=String(g.D).match(fd)[1]||null;!de&&l.self&&l.self.location&&(de=l.self.location.protocol.slice(0,-1)),b=!Bi.test(de?de.toLowerCase():"")}I=b}if(I)Kt(g,"complete"),Kt(g,"success");else{g.o=6;try{var K=mi(g)>2?g.g.statusText:""}catch{K=""}g.l=K+" ["+g.ca()+"]",au(g)}}finally{sr(g)}}}}function sr(g,A){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const I=g.g;g.g=null,A||Kt(g,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function mi(g){return g.g?g.g.readyState:0}n.ca=function(){try{return mi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(g){if(this.g){var A=this.g.responseText;return g&&A.indexOf(g)==0&&(A=A.substring(g.length)),Sp(A)}};function nn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function or(g){const A={};g=(g.g&&mi(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let b=0;b<g.length;b++){if(M(g[b]))continue;var I=ud(g[b]);const K=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const W=A[K]||[];A[K]=W,W.push(I)}Qe(A,function(b){return b.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function qi(g,A,I){return I&&I.internalChannelParams&&I.internalChannelParams[g]||A}function Yr(g){this.za=0,this.i=[],this.j=new ci,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=qi("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=qi("baseRetryDelayMs",5e3,g),this.Za=qi("retryDelaySeedMs",1e4,g),this.Ta=qi("forwardChannelMaxRetries",2,g),this.va=qi("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Xl(g&&g.concurrentRequestLimit),this.Ba=new Kr,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Yr.prototype,n.ka=8,n.I=1,n.connect=function(g,A,I,b){Pt(0),this.W=g,this.H=A||{},I&&b!==void 0&&(this.H.OSID=I,this.H.OAID=b),this.F=this.X,this.J=Sd(this,null,this.W),Gi(this)};function lu(g){if(ua(g),g.I==3){var A=g.V++,I=Lt(g.J);if(nt(I,"SID",g.M),nt(I,"RID",A),nt(I,"TYPE","terminate"),ro(g,I),A=new di(g,g.j,A),A.M=2,A.A=Zs(Lt(I)),I=!1,l.navigator&&l.navigator.sendBeacon)try{I=l.navigator.sendBeacon(A.A.toString(),"")}catch{}!I&&l.Image&&(new Image().src=A.A,I=!0),I||(A.g=Id(A.j,null),A.g.ea(A.A)),A.F=Date.now(),Pi(A)}Ad(g)}function $r(g){g.g&&(cu(g),g.g.cancel(),g.g=null)}function ua(g){$r(g),g.v&&(l.clearTimeout(g.v),g.v=null),da(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&l.clearTimeout(g.m),g.m=null)}function Gi(g){if(!Wl(g.h)&&!g.m){g.m=!0;var A=g.Ea;le||D(),ue||(le(),ue=!0),N.add(A,g),g.D=0}}function ca(g,A){return Li(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=A.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Ni(p(g.Ea,g,A),Td(g,g.D)),g.D++,!0)}n.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const K=new di(this,this.j,g);let W=this.o;if(this.U&&(W?(W=q(W),pe(W,this.U)):W=this.U),this.u!==null||this.R||(K.J=W,W=null),this.S)e:{for(var A=0,I=0;I<this.i.length;I++){t:{var b=this.i[I];if("__data__"in b.map&&(b=b.map.__data__,typeof b=="string")){b=b.length;break t}b=void 0}if(b===void 0)break;if(A+=b,A>4096){A=I;break e}if(A===4096||I===this.i.length-1){A=I+1;break e}}A=1e3}else A=1e3;A=yd(this,K,A),I=Lt(this.J),nt(I,"RID",g),nt(I,"CVER",22),this.G&&nt(I,"X-HTTP-Session-Id",this.G),ro(this,I),W&&(this.R?A="headers="+rr($n(W))+"&"+A:this.u&&to(I,this.u,W)),Zl(this.h,K),this.Ra&&nt(I,"TYPE","init"),this.S?(nt(I,"$req",A),nt(I,"SID","null"),K.U=!0,Mi(K,I,null)):Mi(K,I,A),this.I=2}}else this.I==3&&(g?uu(this,g):this.i.length==0||Wl(this.h)||uu(this))};function uu(g,A){var I;A?I=A.l:I=g.V++;const b=Lt(g.J);nt(b,"SID",g.M),nt(b,"RID",I),nt(b,"AID",g.K),ro(g,b),g.u&&g.o&&to(b,g.u,g.o),I=new di(g,g.j,I,g.D+1),g.u===null&&(I.J=g.o),A&&(g.i=A.G.concat(g.i)),A=yd(g,I,1e3),I.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),Zl(g.h,I),Mi(I,b,A)}function ro(g,A){g.H&&Me(g.H,function(I,b){nt(A,b,I)}),g.l&&Me({},function(I,b){nt(A,b,I)})}function yd(g,A,I){I=Math.min(g.i.length,I);const b=g.l?p(g.l.Ka,g.l,g):null;e:{var K=g.i;let Pe=-1;for(;;){const wt=["count="+I];Pe==-1?I>0?(Pe=K[0].g,wt.push("ofs="+Pe)):Pe=0:wt.push("ofs="+Pe);let je=!0;for(let yt=0;yt<I;yt++){var W=K[yt].g;const Qn=K[yt].map;if(W-=Pe,W<0)Pe=Math.max(0,K[yt].g-100),je=!1;else try{W="req"+W+"_"||"";try{var de=Qn instanceof Map?Qn:Object.entries(Qn);for(const[Hi,gi]of de){let yi=gi;d(gi)&&(yi=Br(gi)),wt.push(W+Hi+"="+encodeURIComponent(yi))}}catch(Hi){throw wt.push(W+"type="+encodeURIComponent("_badmap")),Hi}}catch{b&&b(Qn)}}if(je){de=wt.join("&");break e}}de=void 0}return g=g.i.splice(0,I),A.G=g,de}function _d(g){if(!g.g&&!g.v){g.Y=1;var A=g.Da;le||D(),ue||(le(),ue=!0),N.add(A,g),g.A=0}}function so(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Ni(p(g.Da,g),Td(g,g.A)),g.A++,!0)}n.Da=function(){if(this.v=null,vd(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Ni(p(this.Wa,this),g)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Pt(10),$r(this),vd(this))};function cu(g){g.B!=null&&(l.clearTimeout(g.B),g.B=null)}function vd(g){g.g=new di(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var A=Lt(g.na);nt(A,"RID","rpc"),nt(A,"SID",g.M),nt(A,"AID",g.K),nt(A,"CI",g.F?"0":"1"),!g.F&&g.ia&&nt(A,"TO",g.ia),nt(A,"TYPE","xmlhttp"),ro(g,A),g.u&&g.o&&to(A,g.u,g.o),g.O&&(g.g.H=g.O);var I=g.g;g=g.ba,I.M=1,I.A=Zs(Lt(A)),I.u=null,I.R=!0,na(I,g)}n.Va=function(){this.C!=null&&(this.C=null,$r(this),so(this),Pt(19))};function da(g){g.C!=null&&(l.clearTimeout(g.C),g.C=null)}function Ed(g,A){var I=null;if(g.g==A){da(g),cu(g),g.g=null;var b=2}else if(Ui(g.h,A))I=A.G,jl(g.h,A),b=1;else return;if(g.I!=0){if(A.o)if(b==1){I=A.u?A.u.length:0,A=Date.now()-A.F;var K=g.D;b=ta(),Kt(b,new xi(b,I)),Gi(g)}else _d(g);else if(K=A.m,K==3||K==0&&A.X>0||!(b==1&&ca(g,A)||b==2&&so(g)))switch(I&&I.length>0&&(A=g.h,A.i=A.i.concat(I)),K){case 1:zi(g,5);break;case 4:zi(g,10);break;case 3:zi(g,6);break;default:zi(g,2)}}}function Td(g,A){let I=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(I*=2),I*A}function zi(g,A){if(g.j.info("Error code "+A),A==2){var I=p(g.bb,g),b=g.Ua;const K=!b;b=new Pn(b||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Wt(b,"https"),Zs(b),K?hi(b.toString(),I):su(b.toString(),I)}else Pt(2);g.I=0,g.l&&g.l.pa(A),Ad(g),ua(g)}n.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Pt(2)):(this.j.info("Failed to ping google.com"),Pt(1))};function Ad(g){if(g.I=0,g.ja=[],g.l){const A=eu(g.h);(A.length!=0||g.i.length!=0)&&(P(g.ja,A),P(g.ja,g.i),g.h.i.length=0,C(g.i),g.i.length=0),g.l.oa()}}function Sd(g,A,I){var b=I instanceof Pn?Lt(I):new Pn(I);if(b.g!="")A&&(b.g=A+"."+b.g),qr(b,b.u);else{var K=l.location;b=K.protocol,A=A?A+"."+K.hostname:K.hostname,K=+K.port;const W=new Pn(null);b&&Wt(W,b),A&&(W.g=A),K&&qr(W,K),I&&(W.h=I),b=W}return I=g.G,A=g.wa,I&&A&&nt(b,I,A),nt(b,"VER",g.ka),ro(g,b),b}function Id(g,A,I){if(A&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return A=g.Aa&&!g.ma?new lt(new Fi({ab:I})):new lt(g.ma),A.Fa(g.L),A}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Cd(){}n=Cd.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Qr(){}Qr.prototype.g=function(g,A){return new _n(g,A)};function _n(g,A){Mt.call(this),this.g=new Yr(A),this.l=g,this.h=A&&A.messageUrlParams||null,g=A&&A.messageHeaders||null,A&&A.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=A&&A.initMessageHeaders||null,A&&A.messageContentType&&(g?g["X-WebChannel-Content-Type"]=A.messageContentType:g={"X-WebChannel-Content-Type":A.messageContentType}),A&&A.sa&&(g?g["X-WebChannel-Client-Profile"]=A.sa:g={"X-WebChannel-Client-Profile":A.sa}),this.g.U=g,(g=A&&A.Qb)&&!M(g)&&(this.g.u=g),this.A=A&&A.supportsCrossDomainXhr||!1,this.v=A&&A.sendRawJson||!1,(A=A&&A.httpSessionIdParam)&&!M(A)&&(this.g.G=A,g=this.h,g!==null&&A in g&&(g=this.h,A in g&&delete g[A])),this.j=new ar(this)}E(_n,Mt),_n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){lu(this.g)},_n.prototype.o=function(g){var A=this.g;if(typeof g=="string"){var I={};I.__data__=g,g=I}else this.v&&(I={},I.__data__=Br(g),g=I);A.i.push(new Vt(A.Ya++,g)),A.I==3&&Gi(A)},_n.prototype.N=function(){this.g.l=null,delete this.j,lu(this.g),delete this.g,_n.Z.N.call(this)};function wd(g){tn.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var A=g.__sm__;if(A){e:{for(const I in A){g=I;break e}g=void 0}(this.i=g)&&(g=this.i,A=A!==null&&g in A?A[g]:void 0),this.data=A}else this.data=g}E(wd,tn);function Rd(){Kn.call(this),this.status=1}E(Rd,Kn);function ar(g){this.g=g}E(ar,Cd),ar.prototype.ra=function(){Kt(this.g,"a")},ar.prototype.qa=function(g){Kt(this.g,new wd(g))},ar.prototype.pa=function(g){Kt(this.g,new Rd)},ar.prototype.oa=function(){Kt(this.g,"b")},Qr.prototype.createWebChannel=Qr.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,Uw=function(){return new Qr},Lw=function(){return ta()},Vw=Ct,ty={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Xs.NO_ERROR=0,Xs.TIMEOUT=8,Xs.HTTP_ERROR=6,Wf=Xs,$l.COMPLETE="complete",kw=$l,sd.EventType=ui,ui.OPEN="a",ui.CLOSE="b",ui.ERROR="c",ui.MESSAGE="d",Mt.prototype.listen=Mt.prototype.J,rc=sd,lt.prototype.listenOnce=lt.prototype.K,lt.prototype.getLastError=lt.prototype.Ha,lt.prototype.getLastErrorCode=lt.prototype.ya,lt.prototype.getStatus=lt.prototype.ca,lt.prototype.getResponseJson=lt.prototype.La,lt.prototype.getResponseText=lt.prototype.la,lt.prototype.send=lt.prototype.ea,lt.prototype.setWithCredentials=lt.prototype.Fa,Pw=lt}).apply(typeof Pf<"u"?Pf:typeof self<"u"?self:typeof window<"u"?window:{});const IA="@firebase/firestore",CA="4.9.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let kl="12.7.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qo=new Hy("@firebase/firestore");function $a(){return qo.logLevel}function ae(n,...e){if(qo.logLevel<=ze.DEBUG){const t=e.map(t_);qo.debug(`Firestore (${kl}): ${n}`,...t)}}function Nt(n,...e){if(qo.logLevel<=ze.ERROR){const t=e.map(t_);qo.error(`Firestore (${kl}): ${n}`,...t)}}function Ac(n,...e){if(qo.logLevel<=ze.WARN){const t=e.map(t_);qo.warn(`Firestore (${kl}): ${n}`,...t)}}function t_(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ye(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Ow(n,i,t)}function Ow(n,e,t){let i=`FIRESTORE (${kl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw Nt(i),new Error(i)}function Ae(n,e,t,i){let s="Unexpected state";typeof t=="string"?s=t:i=t,n||Ow(e,s,i)}function ve(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ee={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends Pr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Yk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(fn.UNAUTHENTICATED)))}shutdown(){}}class $k{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ae(this.o===void 0,42304);let i=this.i;const s=f=>this.i!==i?(i=this.i,t(f)):Promise.resolve();let a=new Rr;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Rr,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},d=f=>{ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Rr)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ae(typeof i.accessToken=="string",31837,{l:i}),new Jk(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ae(e===null||typeof e=="string",2055,{h:e}),new fn(e)}}class Qk{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Xk{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Qk(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class wA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Wk{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ri(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){Ae(this.o===void 0,3512);const i=a=>{a.error!=null&&ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,ae("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>i(a)))};const s=a=>{ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new wA(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Ae(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new wA(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=Zk(40);for(let a=0;a<s.length;++a)i.length<20&&s[a]<t&&(i+=e.charAt(s[a]%62))}return i}}function xe(n,e){return n<e?-1:n>e?1:0}function ny(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const s=n.charAt(i),a=e.charAt(i);if(s!==a)return Pg(s)===Pg(a)?xe(s,a):Pg(s)?1:-1}return xe(n.length,e.length)}const jk=55296,eV=57343;function Pg(n){const e=n.charCodeAt(0);return e>=jk&&e<=eV}function hl(n,e,t){return n.length===e.length&&n.every(((i,s)=>t(i,e[s])))}function Fw(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA="__name__";class Qi{constructor(e,t,i){t===void 0?t=0:t>e.length&&ye(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ye(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Qi.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Qi?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const a=Qi.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return xe(e.length,t.length)}static compareSegments(e,t){const i=Qi.isNumericId(e),s=Qi.isNumericId(t);return i&&!s?-1:!i&&s?1:i&&s?Qi.extractNumericId(e).compare(Qi.extractNumericId(t)):ny(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ds.fromString(e.substring(4,e.length-2))}}class tt extends Qi{construct(e,t,i){return new tt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new ce(ee.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((s=>s.length>0)))}return new tt(t)}static emptyPath(){return new tt([])}}const tV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Et extends Qi{construct(e,t,i){return new Et(e,t,i)}static isValidIdentifier(e){return tV.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Et.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===RA}static keyField(){return new Et([RA])}static fromServerFormat(e){const t=[];let i="",s=0;const a=()=>{if(i.length===0)throw new ce(ee.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let l=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new ce(ee.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new ce(ee.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=f,s+=2}else d==="`"?(l=!l,s++):d!=="."||l?(i+=d,s++):(a(),s++)}if(a(),l)throw new ce(ee.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Et(t)}static emptyPath(){return new Et([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.path=e}static fromPath(e){return new he(tt.fromString(e))}static fromName(e){return new he(tt.fromString(e).popFirst(5))}static empty(){return new he(tt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return tt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new he(new tt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bw(n,e,t){if(!t)throw new ce(ee.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function nV(n,e,t,i){if(e===!0&&i===!0)throw new ce(ee.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bA(n){if(!he.isDocumentKey(n))throw new ce(ee.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function xA(n){if(he.isDocumentKey(n))throw new ce(ee.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function qw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function $h(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ye(12329,{type:typeof n})}function pl(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ce(ee.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$h(n);throw new ce(ee.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gt(n,e){const t={typeString:n};return e&&(t.value=e),t}function Hc(n,e){if(!qw(n))throw new ce(ee.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const s=e[i].typeString,a="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const l=n[i];if(s&&typeof l!==s){t=`JSON field '${i}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${i}' field to equal '${a.value}'`;break}}if(t)throw new ce(ee.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NA=-62135596800,DA=1e6;class st{static now(){return st.fromMillis(Date.now())}static fromDate(e){return st.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*DA);return new st(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ce(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ce(ee.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<NA)throw new ce(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(ee.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/DA}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:st._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Hc(e,st._jsonSchema))return new st(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-NA;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}st._jsonSchemaVersion="firestore/timestamp/1.0",st._jsonSchema={type:Gt("string",st._jsonSchemaVersion),seconds:Gt("number"),nanoseconds:Gt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ie{static fromTimestamp(e){return new Ie(e)}static min(){return new Ie(new st(0,0))}static max(){return new Ie(new st(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ml=-1;class Th{constructor(e,t,i,s){this.indexId=e,this.collectionGroup=t,this.fields=i,this.indexState=s}}function iy(n){return n.fields.find((e=>e.kind===2))}function Co(n){return n.fields.filter((e=>e.kind!==2))}Th.UNKNOWN_ID=-1;class Zf{constructor(e,t){this.fieldPath=e,this.kind=t}}class Sc{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Sc(0,Hn.min())}}function Gw(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=Ie.fromTimestamp(i===1e9?new st(t+1,0):new st(t,i));return new Hn(s,he.empty(),e)}function zw(n){return new Hn(n.readTime,n.key,ml)}class Hn{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new Hn(Ie.min(),he.empty(),ml)}static max(){return new Hn(Ie.max(),he.empty(),ml)}}function i_(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=he.comparator(n.documentKey,e.documentKey),t!==0?t:xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Kw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bs(n){if(n.code!==ee.FAILED_PRECONDITION||n.message!==Hw)throw n;ae("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new H(((i,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(i,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(i,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof H?t:H.resolve(t)}catch(t){return H.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):H.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):H.reject(t)}static resolve(e){return new H(((t,i)=>{t(e)}))}static reject(e){return new H(((t,i)=>{i(e)}))}static waitFor(e){return new H(((t,i)=>{let s=0,a=0,l=!1;e.forEach((d=>{++s,d.next((()=>{++a,l&&a===s&&t()}),(f=>i(f)))})),l=!0,a===s&&t()}))}static or(e){let t=H.resolve(!1);for(const i of e)t=t.next((s=>s?H.resolve(s):i()));return t}static forEach(e,t){const i=[];return e.forEach(((s,a)=>{i.push(t.call(this,s,a))})),this.waitFor(i)}static mapArray(e,t){return new H(((i,s)=>{const a=e.length,l=new Array(a);let d=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next((_=>{l[p]=_,++d,d===a&&i(l)}),(_=>s(_)))}}))}static doWhile(e,t){return new H(((i,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):i()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn="SimpleDb";class Qh{static open(e,t,i,s){try{return new Qh(t,e.transaction(s,i))}catch(a){throw new dc(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Rr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new dc(e,t.error)):this.S.resolve()},this.transaction.onerror=i=>{const s=r_(i.target.error);this.S.reject(new dc(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ae(qn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new rV(t)}}class Ms{static delete(e){return ae(qn,"Removing database:",e),bo(FC().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!JC())return!1;if(Ms.F())return!0;const e=$t(),t=Ms.M(e),i=0<t&&t<10,s=Jw(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}constructor(e,t,i){this.name=e,this.version=t,this.N=i,this.B=null,Ms.M($t())===12.2&&Nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(ae(qn,"Opening database:",this.name),this.db=await new Promise(((t,i)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{i(new dc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?i(new ce(ee.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?i(new ce(ee.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):i(new dc(e,l))},s.onupgradeneeded=a=>{ae(qn,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;this.N.k(l,s.transaction,a.oldVersion,this.version).next((()=>{ae(qn,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,i,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.L(e);const d=Qh.open(this.db,e,a?"readonly":"readwrite",i),f=s(d).next((p=>(d.C(),p))).catch((p=>(d.abort(p),H.reject(p)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,p=f.name!=="FirebaseError"&&l<3;if(ae(qn,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Jw(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class iV{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return bo(this.U.delete())}}class dc extends ce{constructor(e,t){super(ee.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function qs(n){return n.name==="IndexedDbTransactionError"}class rV{constructor(e){this.store=e}put(e,t){let i;return t!==void 0?(ae(qn,"PUT",this.store.name,e,t),i=this.store.put(t,e)):(ae(qn,"PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),bo(i)}add(e){return ae(qn,"ADD",this.store.name,e,e),bo(this.store.add(e))}get(e){return bo(this.store.get(e)).next((t=>(t===void 0&&(t=null),ae(qn,"GET",this.store.name,e,t),t)))}delete(e){return ae(qn,"DELETE",this.store.name,e),bo(this.store.delete(e))}count(){return ae(qn,"COUNT",this.store.name),bo(this.store.count())}J(e,t){const i=this.options(e,t),s=i.index?this.store.index(i.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(i.range);return new H(((l,d)=>{a.onerror=f=>{d(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(i),l=[];return this.H(a,((d,f)=>{l.push(f)})).next((()=>l))}}Y(e,t){const i=this.store.getAll(e,t===null?void 0:t);return new H(((s,a)=>{i.onerror=l=>{a(l.target.error)},i.onsuccess=l=>{s(l.target.result)}}))}Z(e,t){ae(qn,"DELETE ALL",this.store.name);const i=this.options(e,t);i.X=!1;const s=this.cursor(i);return this.H(s,((a,l,d)=>d.delete()))}ee(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.H(s,t)}te(e){const t=this.cursor({});return new H(((i,s)=>{t.onerror=a=>{const l=r_(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():i()})):i()}}))}H(e,t){const i=[];return new H(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void s();const f=new iV(d),p=t(d.primaryKey,d.value,f);if(p instanceof H){const _=p.catch((E=>(f.done(),H.reject(E))));i.push(_)}f.isDone?s():f.G===null?d.continue():d.continue(f.G)}})).next((()=>H.waitFor(i)))}options(e,t){let i;return e!==void 0&&(typeof e=="string"?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.X?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function bo(n){return new H(((e,t)=>{n.onsuccess=i=>{const s=i.target.result;e(s)},n.onerror=i=>{const s=r_(i.target.error);t(s)}}))}let MA=!1;function r_(n){const e=Ms.M($t());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return MA||(MA=!0,setTimeout((()=>{throw i}),0)),i}}return n}const fc="IndexBackfiller";class sV{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){ae(fc,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.ne.ie();ae(fc,`Documents written: ${t}`)}catch(t){qs(t)?ae(fc,"Ignoring IndexedDB error during index backfill: ",t):await Bs(t)}await this.re(6e4)}))}}class oV{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){const i=new Set;let s=t,a=!0;return H.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!i.has(l))return ae(fc,`Processing collection: ${l}`),this.oe(e,l,s).next((d=>{s-=d,i.add(l)}));a=!1})))).next((()=>t-s))}oe(e,t,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,i).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this._e(s,a))).next((d=>(ae(fc,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}_e(e,t){let i=e;return t.changes.forEach(((s,a)=>{const l=zw(a);i_(l,i)>0&&(i=l)})),new Hn(i.readTime,i.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Nn.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko=-1;function Xh(n){return n==null}function Ic(n){return n===0&&1/n==-1/0}function Yw(n){return typeof n=="number"&&Number.isInteger(n)&&!Ic(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah="";function gn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=PA(e)),e=aV(n.get(t),e);return PA(e)}function aV(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Ah:t+="";break;default:t+=a}}return t}function PA(n){return n+Ah+""}function Wi(n){const e=n.length;if(Ae(e>=2,64408,{path:n}),e===2)return Ae(n.charAt(0)===Ah&&n.charAt(1)==="",56145,{path:n}),tt.emptyPath();const t=e-2,i=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Ah,a);switch((l<0||l>t)&&ye(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(a,l);let f;s.length===0?f=d:(s+=d,f=s,s=""),i.push(f);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:ye(61167,{path:n})}a=l+2}return new tt(i)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo="remoteDocuments",Kc="owner",Ga="owner",Cc="mutationQueues",lV="userId",Ti="mutations",kA="batchId",Mo="userMutationsIndex",VA=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(n,e){return[n,gn(e)]}function $w(n,e,t){return[n,gn(e),t]}const uV={},gl="documentMutations",Sh="remoteDocumentsV14",cV=["prefixPath","collectionGroup","readTime","documentId"],eh="documentKeyIndex",dV=["prefixPath","collectionGroup","documentId"],Qw="collectionGroupIndex",fV=["collectionGroup","readTime","prefixPath","documentId"],wc="remoteDocumentGlobal",ry="remoteDocumentGlobalKey",yl="targets",Xw="queryTargetsIndex",hV=["canonicalId","targetId"],_l="targetDocuments",pV=["targetId","path"],s_="documentTargetsIndex",mV=["path","targetId"],Ih="targetGlobalKey",Vo="targetGlobal",Rc="collectionParents",gV=["collectionId","parent"],vl="clientMetadata",yV="clientId",Wh="bundles",_V="bundleId",Zh="namedQueries",vV="name",o_="indexConfiguration",EV="indexId",sy="collectionGroupIndex",TV="collectionGroup",hc="indexState",AV=["indexId","uid"],Ww="sequenceNumberIndex",SV=["uid","sequenceNumber"],pc="indexEntries",IV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Zw="documentKeyIndex",CV=["indexId","uid","orderedDocumentKey"],jh="documentOverlays",wV=["userId","collectionPath","documentId"],oy="collectionPathOverlayIndex",RV=["userId","collectionPath","largestBatchId"],jw="collectionGroupOverlayIndex",bV=["userId","collectionGroup","largestBatchId"],a_="globals",xV="name",eR=[Cc,Ti,gl,wo,yl,Kc,Vo,_l,vl,wc,Rc,Wh,Zh],NV=[...eR,jh],tR=[Cc,Ti,gl,Sh,yl,Kc,Vo,_l,vl,wc,Rc,Wh,Zh,jh],nR=tR,l_=[...nR,o_,hc,pc],DV=l_,iR=[...l_,a_],MV=iR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay extends Kw{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function Qt(n,e){const t=ve(n);return Ms.O(t.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LA(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Gs(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function rR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,t){this.comparator=e,this.root=t||ln.EMPTY}insert(e,t){return new ht(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ln.BLACK,null,null))}remove(e){return new ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ln.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(s===0)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new kf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new kf(this.root,e,this.comparator,!1)}getReverseIterator(){return new kf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new kf(this.root,e,this.comparator,!0)}}class kf{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?i(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ln{constructor(e,t,i,s,a){this.key=e,this.value=t,this.color=i??ln.RED,this.left=s??ln.EMPTY,this.right=a??ln.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,a){return new ln(e??this.key,t??this.value,i??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const a=i(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,i),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ln.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return ln.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ln.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ln.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ye(27949);return e+(this.isRed()?0:1)}}ln.EMPTY=null,ln.RED=!0,ln.BLACK=!1;ln.EMPTY=new class{constructor(){this.size=0}get key(){throw ye(57766)}get value(){throw ye(16141)}get color(){throw ye(16727)}get left(){throw ye(29726)}get right(){throw ye(36894)}copy(e,t,i,s,a){return this}insert(e,t,i){return new ln(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.comparator=e,this.data=new ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new UA(this.data.getIterator())}getIteratorFrom(e){return new UA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof at)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=i.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new at(this.comparator);return t.data=e,t}}class UA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function za(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.fields=e,e.sort(Et.comparator)}static empty(){return new Dn([])}unionWith(e){let t=new at(Et.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Dn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return hl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new sR("Invalid base64 string: "+a):a}})(e);return new Dt(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new Dt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dt.EMPTY_BYTE_STRING=new Dt("");const PV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Nr(n){if(Ae(!!n,39018),typeof n=="string"){let e=0;const t=PV.exec(n);if(Ae(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:vt(n.seconds),nanos:vt(n.nanos)}}function vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Dr(n){return typeof n=="string"?Dt.fromBase64String(n):Dt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oR="server_timestamp",aR="__type__",lR="__previous_value__",uR="__local_write_time__";function u_(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[aR])==null?void 0:i.stringValue)===oR}function ep(n){const e=n.mapValue.fields[lR];return u_(e)?ep(e):e}function bc(n){const e=Nr(n.mapValue.fields[uR].timestampValue);return new st(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kV{constructor(e,t,i,s,a,l,d,f,p,_){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=_}}const Ch="(default)";class Go{constructor(e,t){this.projectId=e,this.database=t||Ch}static empty(){return new Go("","")}get isDefaultDatabase(){return this.database===Ch}isEqual(e){return e instanceof Go&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_="__type__",cR="__max__",Rs={mapValue:{fields:{__type__:{stringValue:cR}}}},d_="__vector__",El="value",th={nullValue:"NULL_VALUE"};function ks(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?u_(n)?4:dR(n)?9007199254740991:tp(n)?10:11:ye(28295,{value:n})}function ir(n,e){if(n===e)return!0;const t=ks(n);if(t!==ks(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return bc(n).isEqual(bc(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=Nr(s.timestampValue),d=Nr(a.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return Dr(s.bytesValue).isEqual(Dr(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return vt(s.geoPointValue.latitude)===vt(a.geoPointValue.latitude)&&vt(s.geoPointValue.longitude)===vt(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return vt(s.integerValue)===vt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=vt(s.doubleValue),d=vt(a.doubleValue);return l===d?Ic(l)===Ic(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return hl(n.arrayValue.values||[],e.arrayValue.values||[],ir);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},d=a.mapValue.fields||{};if(LA(l)!==LA(d))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(d[f]===void 0||!ir(l[f],d[f])))return!1;return!0})(n,e);default:return ye(52216,{left:n})}}function xc(n,e){return(n.values||[]).find((t=>ir(t,e)))!==void 0}function Vs(n,e){if(n===e)return 0;const t=ks(n),i=ks(e);if(t!==i)return xe(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return xe(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const d=vt(a.integerValue||a.doubleValue),f=vt(l.integerValue||l.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return OA(n.timestampValue,e.timestampValue);case 4:return OA(bc(n),bc(e));case 5:return ny(n.stringValue,e.stringValue);case 6:return(function(a,l){const d=Dr(a),f=Dr(l);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const d=a.split("/"),f=l.split("/");for(let p=0;p<d.length&&p<f.length;p++){const _=xe(d[p],f[p]);if(_!==0)return _}return xe(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const d=xe(vt(a.latitude),vt(l.latitude));return d!==0?d:xe(vt(a.longitude),vt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return FA(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var T,C,P,F;const d=a.fields||{},f=l.fields||{},p=(T=d[El])==null?void 0:T.arrayValue,_=(C=f[El])==null?void 0:C.arrayValue,E=xe(((P=p==null?void 0:p.values)==null?void 0:P.length)||0,((F=_==null?void 0:_.values)==null?void 0:F.length)||0);return E!==0?E:FA(p,_)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===Rs.mapValue&&l===Rs.mapValue)return 0;if(a===Rs.mapValue)return 1;if(l===Rs.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),p=l.fields||{},_=Object.keys(p);f.sort(),_.sort();for(let E=0;E<f.length&&E<_.length;++E){const T=ny(f[E],_[E]);if(T!==0)return T;const C=Vs(d[f[E]],p[_[E]]);if(C!==0)return C}return xe(f.length,_.length)})(n.mapValue,e.mapValue);default:throw ye(23264,{he:t})}}function OA(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xe(n,e);const t=Nr(n),i=Nr(e),s=xe(t.seconds,i.seconds);return s!==0?s:xe(t.nanos,i.nanos)}function FA(n,e){const t=n.values||[],i=e.values||[];for(let s=0;s<t.length&&s<i.length;++s){const a=Vs(t[s],i[s]);if(a)return a}return xe(t.length,i.length)}function Tl(n){return ly(n)}function ly(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=Nr(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Dr(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return he.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",s=!0;for(const a of t.values||[])s?s=!1:i+=",",i+=ly(a);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of i)a?a=!1:s+=",",s+=`${l}:${ly(t.fields[l])}`;return s+"}"})(n.mapValue):ye(61005,{value:n})}function nh(n){switch(ks(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ep(n);return e?16+nh(e):16;case 5:return 2*n.stringValue.length;case 6:return Dr(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,a)=>s+nh(a)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return Gs(i.fields,((a,l)=>{s+=a.length+nh(l)})),s})(n.mapValue);default:throw ye(13486,{value:n})}}function Nc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function uy(n){return!!n&&"integerValue"in n}function Dc(n){return!!n&&"arrayValue"in n}function BA(n){return!!n&&"nullValue"in n}function qA(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ih(n){return!!n&&"mapValue"in n}function tp(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[c_])==null?void 0:i.stringValue)===d_}function mc(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return Gs(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=mc(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=mc(n.arrayValue.values[t]);return e}return{...n}}function dR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===cR}const fR={mapValue:{fields:{[c_]:{stringValue:d_},[El]:{arrayValue:{}}}}};function VV(n){return"nullValue"in n?th:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Nc(Go.empty(),he.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?tp(n)?fR:{mapValue:{}}:ye(35942,{value:n})}function LV(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Nc(Go.empty(),he.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?fR:"mapValue"in n?tp(n)?{mapValue:{}}:Rs:ye(61959,{value:n})}function GA(n,e){const t=Vs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function zA(n,e){const t=Vs(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.value=e}static empty(){return new pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!ih(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=mc(t)}setAll(e){let t=Et.emptyPath(),i={},s=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,i,s),i={},s=[],t=d.popLast()}l?i[d.lastSegment()]=mc(l):s.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,i,s)}delete(e){const t=this.field(e.popLast());ih(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ir(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];ih(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){Gs(t,((s,a)=>e[s]=a));for(const s of i)delete e[s]}clone(){return new pn(mc(this.value))}}function hR(n){const e=[];return Gs(n.fields,((t,i)=>{const s=new Et([t]);if(ih(i)){const a=hR(i.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new Dn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,t,i,s,a,l,d){this.key=e,this.documentType=t,this.version=i,this.readTime=s,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new It(e,0,Ie.min(),Ie.min(),Ie.min(),pn.empty(),0)}static newFoundDocument(e,t,i,s){return new It(e,1,t,Ie.min(),i,s,0)}static newNoDocument(e,t){return new It(e,2,t,Ie.min(),Ie.min(),pn.empty(),0)}static newUnknownDocument(e,t){return new It(e,3,t,Ie.min(),Ie.min(),pn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ie.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ie.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof It&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new It(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,t){this.position=e,this.inclusive=t}}function HA(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?i=he.comparator(he.fromName(l.referenceValue),t.key):i=Vs(l,t.data.field(a.field)),a.dir==="desc"&&(i*=-1),i!==0)break}return i}function KA(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ir(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e,t="asc"){this.field=e,this.dir=t}}function UV(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{}class He extends pR{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new OV(e,t,i):t==="array-contains"?new qV(e,i):t==="in"?new ER(e,i):t==="not-in"?new GV(e,i):t==="array-contains-any"?new zV(e,i):new He(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new FV(e,i):new BV(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Vs(t,this.value)):t!==null&&ks(this.value)===ks(t)&&this.matchesComparison(Vs(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ot extends pR{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ot(e,t)}matches(e){return Sl(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Sl(n){return n.op==="and"}function cy(n){return n.op==="or"}function f_(n){return mR(n)&&Sl(n)}function mR(n){for(const e of n.filters)if(e instanceof ot)return!1;return!0}function dy(n){if(n instanceof He)return n.field.canonicalString()+n.op.toString()+Tl(n.value);if(f_(n))return n.filters.map((e=>dy(e))).join(",");{const e=n.filters.map((t=>dy(t))).join(",");return`${n.op}(${e})`}}function gR(n,e){return n instanceof He?(function(i,s){return s instanceof He&&i.op===s.op&&i.field.isEqual(s.field)&&ir(i.value,s.value)})(n,e):n instanceof ot?(function(i,s){return s instanceof ot&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((a,l,d)=>a&&gR(l,s.filters[d])),!0):!1})(n,e):void ye(19439)}function yR(n,e){const t=n.filters.concat(e);return ot.create(t,n.op)}function _R(n){return n instanceof He?(function(t){return`${t.field.canonicalString()} ${t.op} ${Tl(t.value)}`})(n):n instanceof ot?(function(t){return t.op.toString()+" {"+t.getFilters().map(_R).join(" ,")+"}"})(n):"Filter"}class OV extends He{constructor(e,t,i){super(e,t,i),this.key=he.fromName(i.referenceValue)}matches(e){const t=he.comparator(e.key,this.key);return this.matchesComparison(t)}}class FV extends He{constructor(e,t){super(e,"in",t),this.keys=vR("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class BV extends He{constructor(e,t){super(e,"not-in",t),this.keys=vR("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function vR(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>he.fromName(i.referenceValue)))}class qV extends He{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Dc(t)&&xc(t.arrayValue,this.value)}}class ER extends He{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&xc(this.value.arrayValue,t)}}class GV extends He{constructor(e,t){super(e,"not-in",t)}matches(e){if(xc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!xc(this.value.arrayValue,t)}}class zV extends He{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Dc(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>xc(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,t=null,i=[],s=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=a,this.startAt=l,this.endAt=d,this.Te=null}}function fy(n,e=null,t=[],i=[],s=null,a=null,l=null){return new HV(n,e,t,i,s,a,l)}function zo(n){const e=ve(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>dy(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(a){return a.field.canonicalString()+a.dir})(i))).join(","),Xh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>Tl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>Tl(i))).join(",")),e.Te=t}return e.Te}function Jc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!UV(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!gR(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!KA(n.startAt,e.startAt)&&KA(n.endAt,e.endAt)}function wh(n){return he.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Rh(n,e){return n.filters.filter((t=>t instanceof He&&t.field.isEqual(e)))}function JA(n,e,t){let i=th,s=!0;for(const a of Rh(n,e)){let l=th,d=!0;switch(a.op){case"<":case"<=":l=VV(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=th}GA({value:i,inclusive:s},{value:l,inclusive:d})<0&&(i=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];GA({value:i,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(i=l,s=t.inclusive);break}}return{value:i,inclusive:s}}function YA(n,e,t){let i=Rs,s=!0;for(const a of Rh(n,e)){let l=Rs,d=!0;switch(a.op){case">=":case">":l=LV(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=Rs}zA({value:i,inclusive:s},{value:l,inclusive:d})>0&&(i=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];zA({value:i,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(i=l,s=t.inclusive);break}}return{value:i,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,t=null,i=[],s=[],a=null,l="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function TR(n,e,t,i,s,a,l,d){return new Vl(n,e,t,i,s,a,l,d)}function h_(n){return new Vl(n)}function $A(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function AR(n){return n.collectionGroup!==null}function gc(n){const e=ve(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const a of e.explicitOrderBy)e.Ie.push(a),t.add(a.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new at(Et.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Ie.push(new Mc(a,i))})),t.has(Et.keyField().canonicalString())||e.Ie.push(new Mc(Et.keyField(),i))}return e.Ie}function zn(n){const e=ve(n);return e.Ee||(e.Ee=KV(e,gc(n))),e.Ee}function KV(n,e){if(n.limitType==="F")return fy(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Mc(s.field,a)}));const t=n.endAt?new Al(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Al(n.startAt.position,n.startAt.inclusive):null;return fy(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function hy(n,e){const t=n.filters.concat([e]);return new Vl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function py(n,e,t){return new Vl(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function np(n,e){return Jc(zn(n),zn(e))&&n.limitType===e.limitType}function SR(n){return`${zo(zn(n))}|lt:${n.limitType}`}function Qa(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((s=>_R(s))).join(", ")}]`),Xh(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((s=>Tl(s))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((s=>Tl(s))).join(",")),`Target(${i})`})(zn(n))}; limitType=${n.limitType})`}function Yc(n,e){return e.isFoundDocument()&&(function(i,s){const a=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(a):he.isDocumentKey(i.path)?i.path.isEqual(a):i.path.isImmediateParentOf(a)})(n,e)&&(function(i,s){for(const a of gc(i))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(i,s){for(const a of i.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(i,s){return!(i.startAt&&!(function(l,d,f){const p=HA(l,d,f);return l.inclusive?p<=0:p<0})(i.startAt,gc(i),s)||i.endAt&&!(function(l,d,f){const p=HA(l,d,f);return l.inclusive?p>=0:p>0})(i.endAt,gc(i),s))})(n,e)}function IR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function CR(n){return(e,t)=>{let i=!1;for(const s of gc(n)){const a=JV(s,e,t);if(a!==0)return a;i=i||s.field.isKeyField()}return 0}}function JV(n,e,t){const i=n.field.isKeyField()?he.comparator(e.key,t.key):(function(a,l,d){const f=l.data.field(a),p=d.data.field(a);return f!==null&&p!==null?Vs(f,p):ye(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ye(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[s,a]of i)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(s===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return i.length===1?delete this.inner[t]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Gs(this.inner,((t,i)=>{for(const[s,a]of i)e(s,a)}))}isEmpty(){return rR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YV=new ht(he.comparator);function Gn(){return YV}const wR=new ht(he.comparator);function sc(...n){let e=wR;for(const t of n)e=e.insert(t.key,t);return e}function RR(n){let e=wR;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Zi(){return yc()}function bR(){return yc()}function yc(){return new Vr((n=>n.toString()),((n,e)=>n.isEqual(e)))}const $V=new ht(he.comparator),QV=new at(he.comparator);function Oe(...n){let e=QV;for(const t of n)e=e.add(t);return e}const XV=new at(xe);function p_(){return XV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m_(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ic(e)?"-0":e}}function xR(n){return{integerValue:""+n}}function WV(n,e){return Yw(e)?xR(e):m_(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(){this._=void 0}}function ZV(n,e,t){return n instanceof Pc?(function(s,a){const l={fields:{[aR]:{stringValue:oR},[uR]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&u_(a)&&(a=ep(a)),a&&(l.fields[lR]=a),{mapValue:l}})(t,e):n instanceof Il?DR(n,e):n instanceof Cl?MR(n,e):(function(s,a){const l=NR(s,a),d=QA(l)+QA(s.Ae);return uy(l)&&uy(s.Ae)?xR(d):m_(s.serializer,d)})(n,e)}function jV(n,e,t){return n instanceof Il?DR(n,e):n instanceof Cl?MR(n,e):t}function NR(n,e){return n instanceof kc?(function(i){return uy(i)||(function(a){return!!a&&"doubleValue"in a})(i)})(e)?e:{integerValue:0}:null}class Pc extends ip{}class Il extends ip{constructor(e){super(),this.elements=e}}function DR(n,e){const t=PR(e);for(const i of n.elements)t.some((s=>ir(s,i)))||t.push(i);return{arrayValue:{values:t}}}class Cl extends ip{constructor(e){super(),this.elements=e}}function MR(n,e){let t=PR(e);for(const i of n.elements)t=t.filter((s=>!ir(s,i)));return{arrayValue:{values:t}}}class kc extends ip{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function QA(n){return vt(n.integerValue||n.doubleValue)}function PR(n){return Dc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e,t){this.field=e,this.transform=t}}function t4(n,e){return n.field.isEqual(e.field)&&(function(i,s){return i instanceof Il&&s instanceof Il||i instanceof Cl&&s instanceof Cl?hl(i.elements,s.elements,ir):i instanceof kc&&s instanceof kc?ir(i.Ae,s.Ae):i instanceof Pc&&s instanceof Pc})(n.transform,e.transform)}class n4{constructor(e,t){this.version=e,this.transformResults=t}}class un{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new un}static exists(e){return new un(void 0,e)}static updateTime(e){return new un(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rh(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class rp{}function kR(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new $c(n.key,un.none()):new Ll(n.key,n.data,un.none());{const t=n.data,i=pn.empty();let s=new at(Et.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?i.delete(a):i.set(a,l),s=s.add(a)}return new Lr(n.key,i,new Dn(s.toArray()),un.none())}}function i4(n,e,t){n instanceof Ll?(function(s,a,l){const d=s.value.clone(),f=WA(s.fieldTransforms,a,l.transformResults);d.setAll(f),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof Lr?(function(s,a,l){if(!rh(s.precondition,a))return void a.convertToUnknownDocument(l.version);const d=WA(s.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(VR(s)),f.setAll(d),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function _c(n,e,t,i){return n instanceof Ll?(function(a,l,d,f){if(!rh(a.precondition,l))return d;const p=a.value.clone(),_=ZA(a.fieldTransforms,f,l);return p.setAll(_),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,i):n instanceof Lr?(function(a,l,d,f){if(!rh(a.precondition,l))return d;const p=ZA(a.fieldTransforms,f,l),_=l.data;return _.setAll(VR(a)),_.setAll(p),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((E=>E.field)))})(n,e,t,i):(function(a,l,d){return rh(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function r4(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),a=NR(i.transform,s||null);a!=null&&(t===null&&(t=pn.empty()),t.set(i.field,a))}return t||null}function XA(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&hl(i,s,((a,l)=>t4(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ll extends rp{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Lr extends rp{constructor(e,t,i,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function VR(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function WA(n,e,t){const i=new Map;Ae(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,d=e.data.field(a.field);i.set(a.field,jV(l,d,t[s]))}return i}function ZA(n,e,t){const i=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);i.set(s.field,ZV(a,l,e))}return i}class $c extends rp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LR extends rp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&i4(a,e,i[s])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=_c(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=_c(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=bR();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(s.key)?null:d;const f=kR(l,d);f!==null&&i.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(Ie.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Oe())}isEqual(e){return this.batchId===e.batchId&&hl(this.mutations,e.mutations,((t,i)=>XA(t,i)))&&hl(this.baseMutations,e.baseMutations,((t,i)=>XA(t,i)))}}class y_{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){Ae(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let s=(function(){return $V})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,i[l].version);return new y_(e,t,i,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qt,$e;function o4(n){switch(n){case ee.OK:return ye(64938);case ee.CANCELLED:case ee.UNKNOWN:case ee.DEADLINE_EXCEEDED:case ee.RESOURCE_EXHAUSTED:case ee.INTERNAL:case ee.UNAVAILABLE:case ee.UNAUTHENTICATED:return!1;case ee.INVALID_ARGUMENT:case ee.NOT_FOUND:case ee.ALREADY_EXISTS:case ee.PERMISSION_DENIED:case ee.FAILED_PRECONDITION:case ee.ABORTED:case ee.OUT_OF_RANGE:case ee.UNIMPLEMENTED:case ee.DATA_LOSS:return!0;default:return ye(15467,{code:n})}}function UR(n){if(n===void 0)return Nt("GRPC error has no .code"),ee.UNKNOWN;switch(n){case qt.OK:return ee.OK;case qt.CANCELLED:return ee.CANCELLED;case qt.UNKNOWN:return ee.UNKNOWN;case qt.DEADLINE_EXCEEDED:return ee.DEADLINE_EXCEEDED;case qt.RESOURCE_EXHAUSTED:return ee.RESOURCE_EXHAUSTED;case qt.INTERNAL:return ee.INTERNAL;case qt.UNAVAILABLE:return ee.UNAVAILABLE;case qt.UNAUTHENTICATED:return ee.UNAUTHENTICATED;case qt.INVALID_ARGUMENT:return ee.INVALID_ARGUMENT;case qt.NOT_FOUND:return ee.NOT_FOUND;case qt.ALREADY_EXISTS:return ee.ALREADY_EXISTS;case qt.PERMISSION_DENIED:return ee.PERMISSION_DENIED;case qt.FAILED_PRECONDITION:return ee.FAILED_PRECONDITION;case qt.ABORTED:return ee.ABORTED;case qt.OUT_OF_RANGE:return ee.OUT_OF_RANGE;case qt.UNIMPLEMENTED:return ee.UNIMPLEMENTED;case qt.DATA_LOSS:return ee.DATA_LOSS;default:return ye(39323,{code:n})}}($e=qt||(qt={}))[$e.OK=0]="OK",$e[$e.CANCELLED=1]="CANCELLED",$e[$e.UNKNOWN=2]="UNKNOWN",$e[$e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$e[$e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$e[$e.NOT_FOUND=5]="NOT_FOUND",$e[$e.ALREADY_EXISTS=6]="ALREADY_EXISTS",$e[$e.PERMISSION_DENIED=7]="PERMISSION_DENIED",$e[$e.UNAUTHENTICATED=16]="UNAUTHENTICATED",$e[$e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$e[$e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$e[$e.ABORTED=10]="ABORTED",$e[$e.OUT_OF_RANGE=11]="OUT_OF_RANGE",$e[$e.UNIMPLEMENTED=12]="UNIMPLEMENTED",$e[$e.INTERNAL=13]="INTERNAL",$e[$e.UNAVAILABLE=14]="UNAVAILABLE",$e[$e.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a4(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l4=new Ds([4294967295,4294967295],0);function jA(n){const e=a4().encode(n),t=new Mw;return t.update(e),new Uint8Array(t.digest())}function eS(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new Ds([t,i],0),new Ds([s,a],0)]}class v_{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new oc(`Invalid padding: ${t}`);if(i<0)throw new oc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new oc(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new oc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ds.fromNumber(this.ge)}ye(e,t,i){let s=e.add(t.multiply(Ds.fromNumber(i)));return s.compare(l4)===1&&(s=new Ds([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=jA(e),[i,s]=eS(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(i,s,a);if(!this.we(l))return!1}return!0}static create(e,t,i){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new v_(a,s,t);return i.forEach((d=>l.insert(d))),l}insert(e){if(this.ge===0)return;const t=jA(e),[i,s]=eS(t);for(let a=0;a<this.hashCount;a++){const l=this.ye(i,s,a);this.Se(l)}}Se(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class oc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,t,i,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const s=new Map;return s.set(e,Xc.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Qc(Ie.min(),s,new ht(xe),Gn(),Oe())}}class Xc{constructor(e,t,i,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Xc(i,t,Oe(),Oe(),Oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e,t,i,s){this.be=e,this.removedTargetIds=t,this.key=i,this.De=s}}class OR{constructor(e,t){this.targetId=e,this.Ce=t}}class FR{constructor(e,t,i=Dt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class tS{constructor(){this.ve=0,this.Fe=nS(),this.Me=Dt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Oe(),t=Oe(),i=Oe();return this.Fe.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:ye(38017,{changeType:a})}})),new Xc(this.Me,this.xe,e,t,i)}qe(){this.Oe=!1,this.Fe=nS()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Ae(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class u4{constructor(e){this.Ge=e,this.ze=new Map,this.je=Gn(),this.Je=Vf(),this.He=Vf(),this.Ye=new ht(xe)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:ye(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,s)=>{this.rt(s)&&t(s)}))}st(e){const t=e.targetId,i=e.Ce.count,s=this.ot(t);if(s){const a=s.target;if(wh(a))if(i===0){const l=new he(a.path);this.et(t,l,It.newNoDocument(l,Ie.min()))}else Ae(i===1,20013,{expectedCount:i});else{const l=this._t(t);if(l!==i){const d=this.ut(e),f=d?this.ct(d,e,l):1;if(f!==0){this.it(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,p)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:a=0}=t;let l,d;try{l=Dr(i).toUint8Array()}catch(f){if(f instanceof sR)return Ac("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new v_(l,s,a)}catch(f){return Ac(f instanceof oc?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let s=0;return i.forEach((a=>{const l=this.Ge.ht(),d=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.et(t,a,null),s++)})),s}Tt(e){const t=new Map;this.ze.forEach(((a,l)=>{const d=this.ot(l);if(d){if(a.current&&wh(d.target)){const f=new he(d.target.path);this.It(f).has(l)||this.Et(l,f)||this.et(l,f,It.newNoDocument(f,e))}a.Be&&(t.set(l,a.ke()),a.qe())}}));let i=Oe();this.He.forEach(((a,l)=>{let d=!0;l.forEachWhile((f=>{const p=this.ot(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(a))})),this.je.forEach(((a,l)=>l.setReadTime(e)));const s=new Qc(e,t,this.Ye,this.je,i);return this.je=Gn(),this.Je=Vf(),this.He=Vf(),this.Ye=new ht(xe),s}Xe(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,i),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,t)?s.Qe(t,1):s.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new tS,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new at(xe),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new at(xe),this.Je=this.Je.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||ae("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new tS),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function Vf(){return new ht(he.comparator)}function nS(){return new ht(he.comparator)}const c4={asc:"ASCENDING",desc:"DESCENDING"},d4={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},f4={and:"AND",or:"OR"};class h4{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function my(n,e){return n.useProto3Json||Xh(e)?e:{value:e}}function wl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function BR(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function p4(n,e){return wl(n,e.toTimestamp())}function Tn(n){return Ae(!!n,49232),Ie.fromTimestamp((function(t){const i=Nr(t);return new st(i.seconds,i.nanos)})(n))}function E_(n,e){return gy(n,e).canonicalString()}function gy(n,e){const t=(function(s){return new tt(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function qR(n){const e=tt.fromString(n);return Ae(XR(e),10190,{key:e.toString()}),e}function bh(n,e){return E_(n.databaseId,e.path)}function Lo(n,e){const t=qR(e);if(t.get(1)!==n.databaseId.projectId)throw new ce(ee.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ce(ee.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new he(HR(t))}function GR(n,e){return E_(n.databaseId,e)}function zR(n){const e=qR(n);return e.length===4?tt.emptyPath():HR(e)}function yy(n){return new tt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function HR(n){return Ae(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function iS(n,e,t){return{name:bh(n,e),fields:t.value.mapValue.fields}}function m4(n,e,t){const i=Lo(n,e.name),s=Tn(e.updateTime),a=e.createTime?Tn(e.createTime):Ie.min(),l=new pn({mapValue:{fields:e.fields}}),d=It.newFoundDocument(i,s,a,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function g4(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:ye(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(p,_){return p.useProto3Json?(Ae(_===void 0||typeof _=="string",58123),Dt.fromBase64String(_||"")):(Ae(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),Dt.fromUint8Array(_||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(p){const _=p.code===void 0?ee.UNKNOWN:UR(p.code);return new ce(_,p.message||"")})(l);t=new FR(i,s,a,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const s=Lo(n,i.document.name),a=Tn(i.document.updateTime),l=i.document.createTime?Tn(i.document.createTime):Ie.min(),d=new pn({mapValue:{fields:i.document.fields}}),f=It.newFoundDocument(s,a,l,d),p=i.targetIds||[],_=i.removedTargetIds||[];t=new sh(p,_,f.key,f)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const s=Lo(n,i.document),a=i.readTime?Tn(i.readTime):Ie.min(),l=It.newNoDocument(s,a),d=i.removedTargetIds||[];t=new sh([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const s=Lo(n,i.document),a=i.removedTargetIds||[];t=new sh([],a,s,null)}else{if(!("filter"in e))return ye(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:s=0,unchangedNames:a}=i,l=new s4(s,a),d=i.targetId;t=new OR(d,l)}}return t}function xh(n,e){let t;if(e instanceof Ll)t={update:iS(n,e.key,e.value)};else if(e instanceof $c)t={delete:bh(n,e.key)};else if(e instanceof Lr)t={update:iS(n,e.key,e.data),updateMask:A4(e.fieldMask)};else{if(!(e instanceof LR))return ye(16599,{Vt:e.type});t={verify:bh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(a,l){const d=l.transform;if(d instanceof Pc)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Il)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Cl)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof kc)return{fieldPath:l.field.canonicalString(),increment:d.Ae};throw ye(20930,{transform:l.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:p4(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:ye(27497)})(n,e.precondition)),t}function _y(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?un.updateTime(Tn(a.updateTime)):a.exists!==void 0?un.exists(a.exists):un.none()})(e.currentDocument):un.none(),i=e.updateTransforms?e.updateTransforms.map((s=>(function(l,d){let f=null;if("setToServerValue"in d)Ae(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new Pc;else if("appendMissingElements"in d){const _=d.appendMissingElements.values||[];f=new Il(_)}else if("removeAllFromArray"in d){const _=d.removeAllFromArray.values||[];f=new Cl(_)}else"increment"in d?f=new kc(l,d.increment):ye(16584,{proto:d});const p=Et.fromServerFormat(d.fieldPath);return new e4(p,f)})(n,s))):[];if(e.update){e.update.name;const s=Lo(n,e.update.name),a=new pn({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const p=f.fieldPaths||[];return new Dn(p.map((_=>Et.fromServerFormat(_))))})(e.updateMask);return new Lr(s,a,l,t,i)}return new Ll(s,a,t,i)}if(e.delete){const s=Lo(n,e.delete);return new $c(s,t)}if(e.verify){const s=Lo(n,e.verify);return new LR(s,t)}return ye(1463,{proto:e})}function y4(n,e){return n&&n.length>0?(Ae(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?Tn(s.updateTime):Tn(a);return l.isEqual(Ie.min())&&(l=Tn(a)),new n4(l,s.transformResults||[])})(t,e)))):[]}function KR(n,e){return{documents:[GR(n,e.path)]}}function JR(n,e){const t={structuredQuery:{}},i=e.path;let s;e.collectionGroup!==null?(s=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=GR(n,s);const a=(function(p){if(p.length!==0)return QR(ot.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(p){if(p.length!==0)return p.map((_=>(function(T){return{field:Xa(T.field),direction:v4(T.dir)}})(_)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=my(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{ft:t,parent:s}}function YR(n){let e=zR(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){Ae(i===1,65062);const _=t.from[0];_.allDescendants?s=_.collectionId:e=e.child(_.collectionId)}let a=[];t.where&&(a=(function(E){const T=$R(E);return T instanceof ot&&f_(T)?T.getFilters():[T]})(t.where));let l=[];t.orderBy&&(l=(function(E){return E.map((T=>(function(P){return new Mc(Wa(P.field),(function(V){switch(V){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(P.direction))})(T)))})(t.orderBy));let d=null;t.limit&&(d=(function(E){let T;return T=typeof E=="object"?E.value:E,Xh(T)?null:T})(t.limit));let f=null;t.startAt&&(f=(function(E){const T=!!E.before,C=E.values||[];return new Al(C,T)})(t.startAt));let p=null;return t.endAt&&(p=(function(E){const T=!E.before,C=E.values||[];return new Al(C,T)})(t.endAt)),TR(e,s,l,a,d,"F",f,p)}function _4(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ye(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function $R(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=Wa(t.unaryFilter.field);return He.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=Wa(t.unaryFilter.field);return He.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Wa(t.unaryFilter.field);return He.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Wa(t.unaryFilter.field);return He.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ye(61313);default:return ye(60726)}})(n):n.fieldFilter!==void 0?(function(t){return He.create(Wa(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ye(58110);default:return ye(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ot.create(t.compositeFilter.filters.map((i=>$R(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return ye(1026)}})(t.compositeFilter.op))})(n):ye(30097,{filter:n})}function v4(n){return c4[n]}function E4(n){return d4[n]}function T4(n){return f4[n]}function Xa(n){return{fieldPath:n.canonicalString()}}function Wa(n){return Et.fromServerFormat(n.fieldPath)}function QR(n){return n instanceof He?(function(t){if(t.op==="=="){if(qA(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NAN"}};if(BA(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(qA(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NOT_NAN"}};if(BA(t.value))return{unaryFilter:{field:Xa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xa(t.field),op:E4(t.op),value:t.value}}})(n):n instanceof ot?(function(t){const i=t.getFilters().map((s=>QR(s)));return i.length===1?i[0]:{compositeFilter:{op:T4(t.op),filters:i}}})(n):ye(54877,{filter:n})}function A4(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function XR(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,t,i,s,a=Ie.min(),l=Ie.min(),d=Dt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new Cr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e){this.yt=e}}function S4(n,e){let t;if(e.document)t=m4(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const i=he.fromSegments(e.noDocument.path),s=Ko(e.noDocument.readTime);t=It.newNoDocument(i,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ye(56709);{const i=he.fromSegments(e.unknownDocument.path),s=Ko(e.unknownDocument.version);t=It.newUnknownDocument(i,s)}}return e.readTime&&t.setReadTime((function(s){const a=new st(s[0],s[1]);return Ie.fromTimestamp(a)})(e.readTime)),t}function rS(n,e){const t=e.key,i={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Nh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())i.document=(function(a,l){return{name:bh(a,l.key),fields:l.data.value.mapValue.fields,updateTime:wl(a,l.version.toTimestamp()),createTime:wl(a,l.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())i.noDocument={path:t.path.toArray(),readTime:Ho(e.version)};else{if(!e.isUnknownDocument())return ye(57904,{document:e});i.unknownDocument={path:t.path.toArray(),version:Ho(e.version)}}return i}function Nh(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Ho(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ko(n){const e=new st(n.seconds,n.nanoseconds);return Ie.fromTimestamp(e)}function xo(n,e){const t=(e.baseMutations||[]).map((a=>_y(n.yt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const i=e.mutations.map((a=>_y(n.yt,a))),s=st.fromMillis(e.localWriteTimeMs);return new g_(e.batchId,s,t,i)}function ac(n){const e=Ko(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Ko(n.lastLimboFreeSnapshotVersion):Ie.min();let i;return i=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return Ae(l===1,1966,{count:l}),zn(h_(zR(a.documents[0])))})(n.query):(function(a){return zn(YR(a))})(n.query),new Cr(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Dt.fromBase64String(n.resumeToken))}function ZR(n,e){const t=Ho(e.snapshotVersion),i=Ho(e.lastLimboFreeSnapshotVersion);let s;s=wh(e.target)?KR(n.yt,e.target):JR(n.yt,e.target).ft;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:zo(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:s}}function jR(n){const e=YR({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?py(e,e.limit,"L"):e}function kg(n,e){return new __(e.largestBatchId,_y(n.yt,e.overlayMutation))}function sS(n,e){const t=e.path.lastSegment();return[n,gn(e.path.popLast()),t]}function oS(n,e,t,i){return{indexId:n,uid:e,sequenceNumber:t,readTime:Ho(i.readTime),documentKey:gn(i.documentKey.path),largestBatchId:i.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I4{getBundleMetadata(e,t){return aS(e).get(t).next((i=>{if(i)return(function(a){return{id:a.bundleId,createTime:Ko(a.createTime),version:a.version}})(i)}))}saveBundleMetadata(e,t){return aS(e).put((function(s){return{bundleId:s.id,createTime:Ho(Tn(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return lS(e).get(t).next((i=>{if(i)return(function(a){return{name:a.name,query:jR(a.bundledQuery),readTime:Ko(a.readTime)}})(i)}))}saveNamedQuery(e,t){return lS(e).put((function(s){return{name:s.name,readTime:Ho(Tn(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function aS(n){return Qt(n,Wh)}function lS(n){return Qt(n,Zh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const i=t.uid||"";return new sp(e,i)}getOverlay(e,t){return Qu(e).get(sS(this.userId,t)).next((i=>i?kg(this.serializer,i):null))}getOverlays(e,t){const i=Zi();return H.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&i.set(s,a)})))).next((()=>i))}saveOverlays(e,t,i){const s=[];return i.forEach(((a,l)=>{const d=new __(t,l);s.push(this.St(e,d))})),H.waitFor(s)}removeOverlaysForBatchId(e,t,i){const s=new Set;t.forEach((l=>s.add(gn(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,i],[this.userId,l,i+1],!1,!0);a.push(Qu(e).Z(oy,d))})),H.waitFor(a)}getOverlaysForCollection(e,t,i){const s=Zi(),a=gn(t),l=IDBKeyRange.bound([this.userId,a,i],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Qu(e).J(oy,l).next((d=>{for(const f of d){const p=kg(this.serializer,f);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,i,s){const a=Zi();let l;const d=IDBKeyRange.bound([this.userId,t,i],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Qu(e).ee({index:jw,range:d},((f,p,_)=>{const E=kg(this.serializer,p);a.size()<s||E.largestBatchId===l?(a.set(E.getKey(),E),l=E.largestBatchId):_.done()})).next((()=>a))}St(e,t){return Qu(e).put((function(s,a,l){const[d,f,p]=sS(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:xh(s.yt,l.mutation)}})(this.serializer,this.userId,t))}}function Qu(n){return Qt(n,jh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C4{bt(e){return Qt(e,a_)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{const i=t==null?void 0:t.value;return i?Dt.fromUint8Array(i):Dt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(vt(e.integerValue));else if("doubleValue"in e){const i=vt(e.doubleValue);isNaN(i)?this.Ft(t,13):(this.Ft(t,15),Ic(i)?t.Mt(0):t.Mt(i))}else if("timestampValue"in e){let i=e.timestampValue;this.Ft(t,20),typeof i=="string"&&(i=Nr(i)),t.xt(`${i.seconds||""}`),t.Mt(i.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Dr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const i=e.geoPointValue;this.Ft(t,45),t.Mt(i.latitude||0),t.Mt(i.longitude||0)}else"mapValue"in e?dR(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):tp(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):ye(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const i=e.fields||{};this.Ft(t,55);for(const s of Object.keys(i))this.Ot(s,t),this.Ct(i[s],t)}kt(e,t){var l,d;const i=e.fields||{};this.Ft(t,53);const s=El,a=((d=(l=i[s].arrayValue)==null?void 0:l.values)==null?void 0:d.length)||0;this.Ft(t,15),t.Mt(vt(a)),this.Ot(s,t),this.Ct(i[s],t)}Qt(e,t){const i=e.values||[];this.Ft(t,50);for(const s of i)this.Ct(s,t)}Lt(e,t){this.Ft(t,37),he.fromName(e).path.forEach((i=>{this.Ft(t,60),this.Ut(i,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}No.Kt=new No;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha=255;function w4(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function uS(n){const e=64-(function(i){let s=0;for(let a=0;a<8;++a){const l=w4(255&i[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class R4{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Gt(i.value),i=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let i=t.next();for(;!i.done;)this.Jt(i.value),i=t.next();this.Ht()}Yt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Gt(i);else if(i<2048)this.Gt(960|i>>>6),this.Gt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i);else{const s=t.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Zt(e){for(const t of e){const i=t.charCodeAt(0);if(i<128)this.Jt(i);else if(i<2048)this.Jt(960|i>>>6),this.Jt(128|63&i);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i);else{const s=t.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Ht()}Xt(e){const t=this.en(e),i=uS(t);this.tn(1+i),this.buffer[this.position++]=255&i;for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=255&t[s]}nn(e){const t=this.en(e),i=uS(t);this.tn(1+i),this.buffer[this.position++]=~(255&i);for(let s=t.length-i;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}rn(){this.sn(Ha),this.sn(255)}_n(){this.an(Ha),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),i=!!(128&t[0]);t[0]^=i?255:128;for(let s=1;s<t.length;++s)t[s]^=i?255:0;return t}Gt(e){const t=255&e;t===0?(this.sn(0),this.sn(255)):t===Ha?(this.sn(Ha),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;t===0?(this.an(0),this.an(255)):t===Ha?(this.an(Ha),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let i=2*this.buffer.length;i<t&&(i=t);const s=new Uint8Array(i);s.set(this.buffer),this.buffer=s}}class b4{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class x4{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Xu{constructor(){this.cn=new R4,this.ln=new b4(this.cn),this.hn=new x4(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,t,i,s){this.Tn=e,this.In=t,this.En=i,this.dn=s}An(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,i=new Uint8Array(t);return i.set(this.dn,0),t!==e?i.set([0],this.dn.length):++i[i.length-1],new Do(this.Tn,this.In,this.En,i)}Rn(e,t,i){return{indexId:this.Tn,uid:e,arrayValue:oh(this.En),directionalValue:oh(this.dn),orderedDocumentKey:oh(t),documentKey:i.path.toArray()}}Vn(e,t,i){const s=this.Rn(e,t,i);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function vs(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=cS(n.En,e.En),t!==0?t:(t=cS(n.dn,e.dn),t!==0?t:he.comparator(n.In,e.In)))}function cS(n,e){for(let t=0;t<n.length&&t<e.length;++t){const i=n[t]-e[t];if(i!==0)return i}return n.length-e.length}function oh(n){return KC()?(function(t){let i="";for(let s=0;s<t.length;s++)i+=String.fromCharCode(t[s]);return i})(n):n}function dS(n){return typeof n!="string"?n:(function(t){const i=new Uint8Array(t.length);for(let s=0;s<t.length;s++)i[s]=t.charCodeAt(s);return i})(n)}class fS{constructor(e){this.mn=new at(((t,i)=>Et.comparator(t.field,i.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const i=t;i.isInequality()?this.mn=this.mn.add(i):this.gn.push(i)}}get pn(){return this.mn.size>1}yn(e){if(Ae(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=iy(e);if(t!==void 0&&!this.wn(t))return!1;const i=Co(e);let s=new Set,a=0,l=0;for(;a<i.length&&this.wn(i[a]);++a)s=s.add(i[a].fieldPath.canonicalString());if(a===i.length)return!0;if(this.mn.size>0){const d=this.mn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const f=i[a];if(!this.Sn(d,f)||!this.bn(this.fn[l++],f))return!1}++a}for(;a<i.length;++a){const d=i[a];if(l>=this.fn.length||!this.bn(this.fn[l++],d))return!1}return!0}Dn(){if(this.pn)return null;let e=new at(Et.comparator);const t=[];for(const i of this.gn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")t.push(new Zf(i.field,2));else{if(e.has(i.field))continue;e=e.add(i.field),t.push(new Zf(i.field,0))}for(const i of this.fn)i.field.isKeyField()||e.has(i.field)||(e=e.add(i.field),t.push(new Zf(i.field,i.dir==="asc"?0:1)));return new Th(Th.UNKNOWN_ID,this.collectionId,t,Sc.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const i=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===i}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eb(n){var t,i;if(Ae(n instanceof He||n instanceof ot,20012),n instanceof He){if(n instanceof ER){const s=((i=(t=n.value.arrayValue)==null?void 0:t.values)==null?void 0:i.map((a=>He.create(n.field,"==",a))))||[];return ot.create(s,"or")}return n}const e=n.filters.map((s=>eb(s)));return ot.create(e,n.op)}function N4(n){if(n.getFilters().length===0)return[];const e=Ty(eb(n));return Ae(tb(e),7391),vy(e)||Ey(e)?[e]:e.getFilters()}function vy(n){return n instanceof He}function Ey(n){return n instanceof ot&&f_(n)}function tb(n){return vy(n)||Ey(n)||(function(t){if(t instanceof ot&&cy(t)){for(const i of t.getFilters())if(!vy(i)&&!Ey(i))return!1;return!0}return!1})(n)}function Ty(n){if(Ae(n instanceof He||n instanceof ot,34018),n instanceof He)return n;if(n.filters.length===1)return Ty(n.filters[0]);const e=n.filters.map((i=>Ty(i)));let t=ot.create(e,n.op);return t=Dh(t),tb(t)?t:(Ae(t instanceof ot,64498),Ae(Sl(t),40251),Ae(t.filters.length>1,57927),t.filters.reduce(((i,s)=>T_(i,s))))}function T_(n,e){let t;return Ae(n instanceof He||n instanceof ot,38388),Ae(e instanceof He||e instanceof ot,25473),t=n instanceof He?e instanceof He?(function(s,a){return ot.create([s,a],"and")})(n,e):hS(n,e):e instanceof He?hS(e,n):(function(s,a){if(Ae(s.filters.length>0&&a.filters.length>0,48005),Sl(s)&&Sl(a))return yR(s,a.getFilters());const l=cy(s)?s:a,d=cy(s)?a:s,f=l.filters.map((p=>T_(p,d)));return ot.create(f,"or")})(n,e),Dh(t)}function hS(n,e){if(Sl(e))return yR(e,n.getFilters());{const t=e.filters.map((i=>T_(n,i)));return ot.create(t,"or")}}function Dh(n){if(Ae(n instanceof He||n instanceof ot,11850),n instanceof He)return n;const e=n.getFilters();if(e.length===1)return Dh(e[0]);if(mR(n))return n;const t=e.map((s=>Dh(s))),i=[];return t.forEach((s=>{s instanceof He?i.push(s):s instanceof ot&&(s.op===n.op?i.push(...s.filters):i.push(s))})),i.length===1?i[0]:ot.create(i,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D4{constructor(){this.Cn=new A_}addToCollectionParentIndex(e,t){return this.Cn.add(t),H.resolve()}getCollectionParents(e,t){return H.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return H.resolve()}deleteFieldIndex(e,t){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,t){return H.resolve()}getDocumentsMatchingTarget(e,t){return H.resolve(null)}getIndexType(e,t){return H.resolve(0)}getFieldIndexes(e,t){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,t){return H.resolve(Hn.min())}getMinOffsetFromCollectionGroup(e,t){return H.resolve(Hn.min())}updateCollectionGroup(e,t,i){return H.resolve()}updateIndexEntries(e,t){return H.resolve()}}class A_{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new at(tt.comparator),a=!s.has(i);return this.index[t]=s.add(i),a}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new at(tt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="IndexedDbIndexManager",Lf=new Uint8Array(0);class M4{constructor(e,t){this.databaseId=t,this.vn=new A_,this.Fn=new Vr((i=>zo(i)),((i,s)=>Jc(i,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:i,parent:gn(s)};return mS(e).put(a)}return H.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[Fw(t),""],!1,!0);return mS(e).J(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;i.push(Wi(l.parent))}return i}))}addFieldIndex(e,t){const i=Wu(e),s=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete s.indexId;const a=i.add(s);if(t.indexState){const l=Ja(e);return a.next((d=>{l.put(oS(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const i=Wu(e),s=Ja(e),a=Ka(e);return i.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=Wu(e),i=Ka(e),s=Ja(e);return t.Z().next((()=>i.Z())).next((()=>s.Z()))}createTargetIndexes(e,t){return H.forEach(this.Mn(t),(i=>this.getIndexType(e,i).next((s=>{if(s===0||s===1){const a=new fS(i).Dn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const i=Ka(e);let s=!0;const a=new Map;return H.forEach(this.Mn(t),(l=>this.xn(e,l).next((d=>{s&&(s=!!d),a.set(l,d)})))).next((()=>{if(s){let l=Oe();const d=[];return H.forEach(a,((f,p)=>{ae(pS,`Using index ${(function(X){return`id=${X.indexId}|cg=${X.collectionGroup}|f=${X.fields.map((se=>`${se.fieldPath}:${se.kind}`)).join(",")}`})(f)} to execute ${zo(t)}`);const _=(function(X,se){const le=iy(se);if(le===void 0)return null;for(const ue of Rh(X,le.fieldPath))switch(ue.op){case"array-contains-any":return ue.value.arrayValue.values||[];case"array-contains":return[ue.value]}return null})(p,f),E=(function(X,se){const le=new Map;for(const ue of Co(se))for(const N of Rh(X,ue.fieldPath))switch(N.op){case"==":case"in":le.set(ue.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return le.set(ue.fieldPath.canonicalString(),N.value),Array.from(le.values())}return null})(p,f),T=(function(X,se){const le=[];let ue=!0;for(const N of Co(se)){const D=N.kind===0?JA(X,N.fieldPath,X.startAt):YA(X,N.fieldPath,X.startAt);le.push(D.value),ue&&(ue=D.inclusive)}return new Al(le,ue)})(p,f),C=(function(X,se){const le=[];let ue=!0;for(const N of Co(se)){const D=N.kind===0?YA(X,N.fieldPath,X.endAt):JA(X,N.fieldPath,X.endAt);le.push(D.value),ue&&(ue=D.inclusive)}return new Al(le,ue)})(p,f),P=this.On(f,p,T),F=this.On(f,p,C),V=this.Nn(f,p,E),Q=this.Bn(f.indexId,_,P,T.inclusive,F,C.inclusive,V);return H.forEach(Q,(j=>i.Y(j,t.limit).next((X=>{X.forEach((se=>{const le=he.fromSegments(se.documentKey);l.has(le)||(l=l.add(le),d.push(le))}))}))))})).next((()=>d))}return H.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=N4(ot.create(e.filters,"and")).map((i=>fy(e.path,e.collectionGroup,e.orderBy,i.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,i,s,a,l,d){const f=(t!=null?t.length:1)*Math.max(i.length,a.length),p=f/(t!=null?t.length:1),_=[];for(let E=0;E<f;++E){const T=t?this.Ln(t[E/p]):Lf,C=this.kn(e,T,i[E%p],s),P=this.qn(e,T,a[E%p],l),F=d.map((V=>this.kn(e,T,V,!0)));_.push(...this.createRange(C,P,F))}return _}kn(e,t,i,s){const a=new Do(e,he.empty(),t,i);return s?a:a.An()}qn(e,t,i,s){const a=new Do(e,he.empty(),t,i);return s?a.An():a}xn(e,t){const i=new fS(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const d of a)i.yn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let i=2;const s=this.Mn(t);return H.forEach(s,(a=>this.xn(e,a).next((l=>{l?i!==0&&l.fields.length<(function(f){let p=new at(Et.comparator),_=!1;for(const E of f.filters)for(const T of E.getFlattenedFilters())T.field.isKeyField()||(T.op==="array-contains"||T.op==="array-contains-any"?_=!0:p=p.add(T.field));for(const E of f.orderBy)E.field.isKeyField()||(p=p.add(E.field));return p.size+(_?1:0)})(a)&&(i=1):i=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&i===2?1:i))}Qn(e,t){const i=new Xu;for(const s of Co(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=i.Pn(s.kind);No.Kt.Dt(a,l)}return i.un()}Ln(e){const t=new Xu;return No.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const i=new Xu;return No.Kt.Dt(Nc(this.databaseId,t),i.Pn((function(a){const l=Co(a);return l.length===0?0:l[l.length-1].kind})(e))),i.un()}Nn(e,t,i){if(i===null)return[];let s=[];s.push(new Xu);let a=0;for(const l of Co(e)){const d=i[a++];for(const f of s)if(this.Un(t,l.fieldPath)&&Dc(d))s=this.Kn(s,l,d);else{const p=f.Pn(l.kind);No.Kt.Dt(d,p)}}return this.Wn(s)}On(e,t,i){return this.Nn(e,t,i.position)}Wn(e){const t=[];for(let i=0;i<e.length;++i)t[i]=e[i].un();return t}Kn(e,t,i){const s=[...e],a=[];for(const l of i.arrayValue.values||[])for(const d of s){const f=new Xu;f.seed(d.un()),No.Kt.Dt(l,f.Pn(t.kind)),a.push(f)}return a}Un(e,t){return!!e.filters.find((i=>i instanceof He&&i.field.isEqual(t)&&(i.op==="in"||i.op==="not-in")))}getFieldIndexes(e,t){const i=Wu(e),s=Ja(e);return(t?i.J(sy,IDBKeyRange.bound(t,t)):i.J()).next((a=>{const l=[];return H.forEach(a,(d=>s.get([d.indexId,this.uid]).next((f=>{l.push((function(_,E){const T=E?new Sc(E.sequenceNumber,new Hn(Ko(E.readTime),new he(Wi(E.documentKey)),E.largestBatchId)):Sc.empty(),C=_.fields.map((([P,F])=>new Zf(Et.fromServerFormat(P),F)));return new Th(_.indexId,_.collectionGroup,C,T)})(d,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((i,s)=>{const a=i.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:xe(i.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,i){const s=Wu(e),a=Ja(e);return this.Gn(e).next((l=>s.J(sy,IDBKeyRange.bound(t,t)).next((d=>H.forEach(d,(f=>a.put(oS(f.indexId,this.uid,l,i))))))))}updateIndexEntries(e,t){const i=new Map;return H.forEach(t,((s,a)=>{const l=i.get(s.collectionGroup);return(l?H.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((d=>(i.set(s.collectionGroup,d),H.forEach(d,(f=>this.zn(e,s,f).next((p=>{const _=this.jn(a,f);return p.isEqual(_)?H.resolve():this.Jn(e,a,f,p,_)})))))))}))}Hn(e,t,i,s){return Ka(e).put(s.Rn(this.uid,this.$n(i,t.key),t.key))}Yn(e,t,i,s){return Ka(e).delete(s.Vn(this.uid,this.$n(i,t.key),t.key))}zn(e,t,i){const s=Ka(e);let a=new at(vs);return s.ee({index:Zw,range:IDBKeyRange.only([i.indexId,this.uid,oh(this.$n(i,t))])},((l,d)=>{a=a.add(new Do(i.indexId,t,dS(d.arrayValue),dS(d.directionalValue)))})).next((()=>a))}jn(e,t){let i=new at(vs);const s=this.Qn(t,e);if(s==null)return i;const a=iy(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Dc(l))for(const d of l.arrayValue.values||[])i=i.add(new Do(t.indexId,e.key,this.Ln(d),s))}else i=i.add(new Do(t.indexId,e.key,Lf,s));return i}Jn(e,t,i,s,a){ae(pS,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,p,_,E,T){const C=f.getIterator(),P=p.getIterator();let F=za(C),V=za(P);for(;F||V;){let Q=!1,j=!1;if(F&&V){const X=_(F,V);X<0?j=!0:X>0&&(Q=!0)}else F!=null?j=!0:Q=!0;Q?(E(V),V=za(P)):j?(T(F),F=za(C)):(F=za(C),V=za(P))}})(s,a,vs,(d=>{l.push(this.Hn(e,t,i,d))}),(d=>{l.push(this.Yn(e,t,i,d))})),H.waitFor(l)}Gn(e){let t=1;return Ja(e).ee({index:Ww,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((i,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,i){i=i.sort(((l,d)=>vs(l,d))).filter(((l,d,f)=>!d||vs(l,f[d-1])!==0));const s=[];s.push(e);for(const l of i){const d=vs(l,e),f=vs(l,t);if(d===0)s[0]=e.An();else if(d>0&&f<0)s.push(l),s.push(l.An());else if(f>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Zn(s[l],s[l+1]))return[];const d=s[l].Vn(this.uid,Lf,he.empty()),f=s[l+1].Vn(this.uid,Lf,he.empty());a.push(IDBKeyRange.bound(d,f))}return a}Zn(e,t){return vs(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(gS)}getMinOffset(e,t){return H.mapArray(this.Mn(t),(i=>this.xn(e,i).next((s=>s||ye(44426))))).next(gS)}}function mS(n){return Qt(n,Rc)}function Ka(n){return Qt(n,pc)}function Wu(n){return Qt(n,o_)}function Ja(n){return Qt(n,hc)}function gS(n){Ae(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let i=1;i<n.length;i++){const s=n[i].indexState.offset;i_(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Hn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},nb=41943040;class hn{static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(n,e,t){const i=n.store(Ti),s=n.store(gl),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const f=i.ee({range:l},((_,E,T)=>(d++,T.delete())));a.push(f.next((()=>{Ae(d===1,47070,{batchId:t.batchId})})));const p=[];for(const _ of t.mutations){const E=$w(e,_.key.path,t.batchId);a.push(s.delete(E)),p.push(_.key)}return H.waitFor(a).next((()=>p))}function Mh(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ye(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(nb,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);class op{constructor(e,t,i,s){this.userId=e,this.serializer=t,this.indexManager=i,this.referenceDelegate=s,this.Xn={}}static wt(e,t,i,s){Ae(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new op(a,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Es(e).ee({index:Mo,range:i},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,i,s){const a=Za(e),l=Es(e);return l.add({}).next((d=>{Ae(typeof d=="number",49019);const f=new g_(d,t,i,s),p=(function(C,P,F){const V=F.baseMutations.map((j=>xh(C.yt,j))),Q=F.mutations.map((j=>xh(C.yt,j)));return{userId:P,batchId:F.batchId,localWriteTimeMs:F.localWriteTime.toMillis(),baseMutations:V,mutations:Q}})(this.serializer,this.userId,f),_=[];let E=new at(((T,C)=>xe(T.canonicalString(),C.canonicalString())));for(const T of s){const C=$w(this.userId,T.key.path,d);E=E.add(T.key.path.popLast()),_.push(l.put(p)),_.push(a.put(C,uV))}return E.forEach((T=>{_.push(this.indexManager.addToCollectionParentIndex(e,T))})),e.addOnCommittedListener((()=>{this.Xn[d]=f.keys()})),H.waitFor(_).next((()=>f))}))}lookupMutationBatch(e,t){return Es(e).get(t).next((i=>i?(Ae(i.userId===this.userId,48,"Unexpected user for mutation batch",{userId:i.userId,batchId:t}),xo(this.serializer,i)):null))}er(e,t){return this.Xn[t]?H.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((i=>{if(i){const s=i.keys();return this.Xn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let a=null;return Es(e).ee({index:Mo,range:s},((l,d,f)=>{d.userId===this.userId&&(Ae(d.batchId>=i,47524,{tr:i}),a=xo(this.serializer,d)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=ko;return Es(e).ee({index:Mo,range:t,reverse:!0},((s,a,l)=>{i=a.batchId,l.done()})).next((()=>i))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,ko],[this.userId,Number.POSITIVE_INFINITY]);return Es(e).J(Mo,t).next((i=>i.map((s=>xo(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=jf(this.userId,t.path),s=IDBKeyRange.lowerBound(i),a=[];return Za(e).ee({range:s},((l,d,f)=>{const[p,_,E]=l,T=Wi(_);if(p===this.userId&&t.path.isEqual(T))return Es(e).get(E).next((C=>{if(!C)throw ye(61480,{nr:l,batchId:E});Ae(C.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:C.userId,batchId:E}),a.push(xo(this.serializer,C))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new at(xe);const s=[];return t.forEach((a=>{const l=jf(this.userId,a.path),d=IDBKeyRange.lowerBound(l),f=Za(e).ee({range:d},((p,_,E)=>{const[T,C,P]=p,F=Wi(C);T===this.userId&&a.path.isEqual(F)?i=i.add(P):E.done()}));s.push(f)})),H.waitFor(s).next((()=>this.rr(e,i)))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,a=jf(this.userId,i),l=IDBKeyRange.lowerBound(a);let d=new at(xe);return Za(e).ee({range:l},((f,p,_)=>{const[E,T,C]=f,P=Wi(T);E===this.userId&&i.isPrefixOf(P)?P.length===s&&(d=d.add(C)):_.done()})).next((()=>this.rr(e,d)))}rr(e,t){const i=[],s=[];return t.forEach((a=>{s.push(Es(e).get(a).next((l=>{if(l===null)throw ye(35274,{batchId:a});Ae(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),i.push(xo(this.serializer,l))})))})),H.waitFor(s).next((()=>i))}removeMutationBatch(e,t){return ib(e.le,this.userId,t).next((i=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),H.forEach(i,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return H.resolve();const i=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return Za(e).ee({range:i},((a,l,d)=>{if(a[0]===this.userId){const f=Wi(a[1]);s.push(f)}else d.done()})).next((()=>{Ae(s.length===0,56720,{sr:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return rb(e,this.userId,t)}_r(e){return sb(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:ko,lastStreamToken:""}))}}function rb(n,e,t){const i=jf(e,t.path),s=i[1],a=IDBKeyRange.lowerBound(i);let l=!1;return Za(n).ee({range:a,X:!0},((d,f,p)=>{const[_,E,T]=d;_===e&&E===s&&(l=!0),p.done()})).next((()=>l))}function Es(n){return Qt(n,Ti)}function Za(n){return Qt(n,gl)}function sb(n){return Qt(n,Cc)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Jo(0)}static cr(){return new Jo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{const i=new Jo(t.highestTargetId);return t.highestTargetId=i.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>Ie.fromTimestamp(new st(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,i){return this.lr(e).next((s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.hr(e,s))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((i=>(i.targetCount+=1,this.Tr(t,i),this.hr(e,i))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Ya(e).delete(t.targetId))).next((()=>this.lr(e))).next((i=>(Ae(i.targetCount>0,8065),i.targetCount-=1,this.hr(e,i))))}removeTargets(e,t,i){let s=0;const a=[];return Ya(e).ee(((l,d)=>{const f=ac(d);f.sequenceNumber<=t&&i.get(f.targetId)===null&&(s++,a.push(this.removeTargetData(e,f)))})).next((()=>H.waitFor(a))).next((()=>s))}forEachTarget(e,t){return Ya(e).ee(((i,s)=>{const a=ac(s);t(a)}))}lr(e){return _S(e).get(Ih).next((t=>(Ae(t!==null,2888),t)))}hr(e,t){return _S(e).put(Ih,t)}Pr(e,t){return Ya(e).put(ZR(this.serializer,t))}Tr(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){const i=zo(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let a=null;return Ya(e).ee({range:s,index:Xw},((l,d,f)=>{const p=ac(d);Jc(t,p.target)&&(a=p,f.done())})).next((()=>a))}addMatchingKeys(e,t,i){const s=[],a=ws(e);return t.forEach((l=>{const d=gn(l.path);s.push(a.put({targetId:i,path:d})),s.push(this.referenceDelegate.addReference(e,i,l))})),H.waitFor(s)}removeMatchingKeys(e,t,i){const s=ws(e);return H.forEach(t,(a=>{const l=gn(a.path);return H.waitFor([s.delete([i,l]),this.referenceDelegate.removeReference(e,i,a)])}))}removeMatchingKeysForTargetId(e,t){const i=ws(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=ws(e);let a=Oe();return s.ee({range:i,X:!0},((l,d,f)=>{const p=Wi(l[1]),_=new he(p);a=a.add(_)})).next((()=>a))}containsKey(e,t){const i=gn(t.path),s=IDBKeyRange.bound([i],[Fw(i)],!1,!0);let a=0;return ws(e).ee({index:s_,X:!0,range:s},(([l,d],f,p)=>{l!==0&&(a++,p.done())})).next((()=>a>0))}At(e,t){return Ya(e).get(t).next((i=>i?ac(i):null))}}function Ya(n){return Qt(n,yl)}function _S(n){return Qt(n,Vo)}function ws(n){return Qt(n,_l)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS="LruGarbageCollector",ob=1048576;function ES([n,e],[t,i]){const s=xe(n,t);return s===0?xe(e,i):s}class k4{constructor(e){this.Ir=e,this.buffer=new at(ES),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();ES(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ab{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ae(vS,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){qs(t)?ae(vS,"Ignoring IndexedDB error during garbage collection: ",t):await Bs(t)}await this.Vr(3e5)}))}}class V4{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return H.resolve(Nn.ce);const i=new k4(t);return this.mr.forEachTarget(e,(s=>i.Ar(s.sequenceNumber))).next((()=>this.mr.pr(e,(s=>i.Ar(s))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.mr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ae("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(yS)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),yS):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let i,s,a,l,d,f,p;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),s=this.params.maximumSequenceNumbersToCollect):s=E,l=Date.now(),this.nthSequenceNumber(e,s)))).next((E=>(i=E,d=Date.now(),this.removeTargets(e,i,t)))).next((E=>(a=E,f=Date.now(),this.removeOrphanedDocuments(e,i)))).next((E=>(p=Date.now(),$a()<=ze.DEBUG&&ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-_}ms
	Determined least recently used ${s} in `+(d-l)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${E} documents in `+(p-f)+`ms
Total Duration: ${p-_}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:E}))))}}function lb(n,e){return new V4(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L4{constructor(e,t){this.db=e,this.garbageCollector=lb(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((i,s)=>t(s)))}addReference(e,t,i){return Uf(e,i)}removeReference(e,t,i){return Uf(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Uf(e,t)}br(e,t){return(function(s,a){let l=!1;return sb(s).te((d=>rb(s,d,a).next((f=>(f&&(l=!0),H.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.Sr(e,((l,d)=>{if(d<=t){const f=this.br(e,l).next((p=>{if(!p)return a++,i.getEntry(e,l).next((()=>(i.removeEntry(l,Ie.min()),ws(e).delete((function(E){return[0,gn(E.path)]})(l)))))}));s.push(f)}})).next((()=>H.waitFor(s))).next((()=>i.apply(e))).next((()=>a))}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Uf(e,t)}Sr(e,t){const i=ws(e);let s,a=Nn.ce;return i.ee({index:s_},(([l,d],{path:f,sequenceNumber:p})=>{l===0?(a!==Nn.ce&&t(new he(Wi(s)),a),a=p,s=f):a=Nn.ce})).next((()=>{a!==Nn.ce&&t(new he(Wi(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Uf(n,e){return ws(n).put((function(i,s){return{targetId:0,path:gn(i.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(){this.changes=new Vr((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,It.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?H.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,i){return So(e).put(i)}removeEntry(e,t,i){return So(e).delete((function(a,l){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Nh(l),d[d.length-1]]})(t,i))}updateMetadata(e,t){return this.getMetadata(e).next((i=>(i.byteSize+=t,this.Dr(e,i))))}getEntry(e,t){let i=It.newInvalidDocument(t);return So(e).ee({index:eh,range:IDBKeyRange.only(Zu(t))},((s,a)=>{i=this.Cr(t,a)})).next((()=>i))}vr(e,t){let i={size:0,document:It.newInvalidDocument(t)};return So(e).ee({index:eh,range:IDBKeyRange.only(Zu(t))},((s,a)=>{i={document:this.Cr(t,a),size:Mh(a)}})).next((()=>i))}getEntries(e,t){let i=Gn();return this.Fr(e,t,((s,a)=>{const l=this.Cr(s,a);i=i.insert(s,l)})).next((()=>i))}Mr(e,t){let i=Gn(),s=new ht(he.comparator);return this.Fr(e,t,((a,l)=>{const d=this.Cr(a,l);i=i.insert(a,d),s=s.insert(a,Mh(l))})).next((()=>({documents:i,Or:s})))}Fr(e,t,i){if(t.isEmpty())return H.resolve();let s=new at(SS);t.forEach((f=>s=s.add(f)));const a=IDBKeyRange.bound(Zu(s.first()),Zu(s.last())),l=s.getIterator();let d=l.getNext();return So(e).ee({index:eh,range:a},((f,p,_)=>{const E=he.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;d&&SS(d,E)<0;)i(d,null),d=l.getNext();d&&d.isEqual(E)&&(i(d,p),d=l.hasNext()?l.getNext():null),d?_.j(Zu(d)):_.done()})).next((()=>{for(;d;)i(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,i,s,a){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),Nh(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return So(e).J(IDBKeyRange.bound(d,f,!0)).next((p=>{a==null||a.incrementDocumentReadCount(p.length);let _=Gn();for(const E of p){const T=this.Cr(he.fromSegments(E.prefixPath.concat(E.collectionGroup,E.documentId)),E);T.isFoundDocument()&&(Yc(t,T)||s.has(T.key))&&(_=_.insert(T.key,T))}return _}))}getAllFromCollectionGroup(e,t,i,s){let a=Gn();const l=AS(t,i),d=AS(t,Hn.max());return So(e).ee({index:Qw,range:IDBKeyRange.bound(l,d,!0)},((f,p,_)=>{const E=this.Cr(he.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(E.key,E),a.size===s&&_.done()})).next((()=>a))}newChangeBuffer(e){return new O4(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return TS(e).get(ry).next((t=>(Ae(!!t,20021),t)))}Dr(e,t){return TS(e).put(ry,t)}Cr(e,t){if(t){const i=S4(this.serializer,t);if(!(i.isNoDocument()&&i.version.isEqual(Ie.min())))return i}return It.newInvalidDocument(e)}}function cb(n){return new U4(n)}class O4 extends ub{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Vr((i=>i.toString()),((i,s)=>i.isEqual(s)))}applyChanges(e){const t=[];let i=0,s=new at(((a,l)=>xe(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const d=this.Br.get(a);if(t.push(this.Nr.removeEntry(e,a,d.readTime)),l.isValidDocument()){const f=rS(this.Nr.serializer,l);s=s.add(a.path.popLast());const p=Mh(f);i+=p-d.size,t.push(this.Nr.addEntry(e,a,f))}else if(i-=d.size,this.trackRemovals){const f=rS(this.Nr.serializer,l.convertToNoDocument(Ie.min()));t.push(this.Nr.addEntry(e,a,f))}})),s.forEach((a=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Nr.updateMetadata(e,i)),H.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((i=>(this.Br.set(t,{size:i.size,readTime:i.document.readTime}),i.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:i,Or:s})=>(s.forEach(((a,l)=>{this.Br.set(a,{size:l,readTime:i.get(a).readTime})})),i)))}}function TS(n){return Qt(n,wc)}function So(n){return Qt(n,Sh)}function Zu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function AS(n,e){const t=e.documentKey.path.toArray();return[n,Nh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function SS(n,e){const t=n.path.toArray(),i=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<i.length-2;++a)if(s=xe(t[a],i[a]),s)return s;return s=xe(t.length,i.length),s||(s=xe(t[t.length-2],i[i.length-2]),s||xe(t[t.length-1],i[i.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class db{constructor(e,t,i,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=s}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(i=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(i!==null&&_c(i.mutation,s,Dn.empty(),st.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,Oe()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=Oe()){const s=Zi();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,i).next((a=>{let l=sc();return a.forEach(((d,f)=>{l=l.insert(d,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const i=Zi();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,Oe())))}populateOverlays(e,t,i){const s=[];return i.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,i,s){let a=Gn();const l=yc(),d=(function(){return yc()})();return t.forEach(((f,p)=>{const _=i.get(p.key);s.has(p.key)&&(_===void 0||_.mutation instanceof Lr)?a=a.insert(p.key,p):_!==void 0?(l.set(p.key,_.mutation.getFieldMask()),_c(_.mutation,p,_.mutation.getFieldMask(),st.now())):l.set(p.key,Dn.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((p,_)=>l.set(p,_))),t.forEach(((p,_)=>d.set(p,new F4(_,l.get(p)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=yc();let s=new ht(((l,d)=>l-d)),a=Oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let _=i.get(f)||Dn.empty();_=d.applyToLocalView(p,_),i.set(f,_);const E=(s.get(d.batchId)||Oe()).add(f);s=s.insert(d.batchId,E)}))})).next((()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,_=f.value,E=bR();_.forEach((T=>{if(!a.has(T)){const C=kR(t.get(T),i.get(T));C!==null&&E.set(T,C),a=a.add(T)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,E))}return H.waitFor(l)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,s){return(function(l){return he.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):AR(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,s):this.getDocumentsMatchingCollectionQuery(e,t,i,s)}getNextDocuments(e,t,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,s-a.size):H.resolve(Zi());let d=ml,f=a;return l.next((p=>H.forEach(p,((_,E)=>(d<E.largestBatchId&&(d=E.largestBatchId),a.get(_)?H.resolve():this.remoteDocumentCache.getEntry(e,_).next((T=>{f=f.insert(_,T)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,f,p,Oe()))).next((_=>({batchId:d,changes:RR(_)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new he(t)).next((i=>{let s=sc();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,s){const a=t.collectionGroup;let l=sc();return this.indexManager.getCollectionParents(e,a).next((d=>H.forEach(d,(f=>{const p=(function(E,T){return new Vl(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,i,s).next((_=>{_.forEach(((E,T)=>{l=l.insert(E,T)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,i,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,a,s)))).next((l=>{a.forEach(((f,p)=>{const _=p.getKey();l.get(_)===null&&(l=l.insert(_,It.newInvalidDocument(_)))}));let d=sc();return l.forEach(((f,p)=>{const _=a.get(f);_!==void 0&&_c(_.mutation,p,Dn.empty(),st.now()),Yc(t,p)&&(d=d.insert(f,p))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B4{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return H.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:Tn(s.createTime)}})(t)),H.resolve()}getNamedQuery(e,t){return H.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(s){return{name:s.name,query:jR(s.bundledQuery),readTime:Tn(s.readTime)}})(t)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(){this.overlays=new ht(he.comparator),this.qr=new Map}getOverlay(e,t){return H.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Zi();return H.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&i.set(s,a)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((s,a)=>{this.St(e,t,a)})),H.resolve()}removeOverlaysForBatchId(e,t,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.qr.delete(i)),H.resolve()}getOverlaysForCollection(e,t,i){const s=Zi(),a=t.length+1,l=new he(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>i&&s.set(f.getKey(),f)}return H.resolve(s)}getOverlaysForCollectionGroup(e,t,i,s){let a=new ht(((p,_)=>p-_));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>i){let _=a.get(p.largestBatchId);_===null&&(_=Zi(),a=a.insert(p.largestBatchId,_)),_.set(p.getKey(),p)}}const d=Zi(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,_)=>d.set(p,_))),!(d.size()>=s)););return H.resolve(d)}St(e,t,i){const s=this.overlays.get(i.key);if(s!==null){const l=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(i.key,new __(t,i));let a=this.qr.get(t);a===void 0&&(a=Oe(),this.qr.set(t,a)),this.qr.set(t,a.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G4{constructor(){this.sessionToken=Dt.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(){this.Qr=new at(jt.$r),this.Ur=new at(jt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const i=new jt(e,t);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Gr(new jt(e,t))}zr(e,t){e.forEach((i=>this.removeReference(i,t)))}jr(e){const t=new he(new tt([])),i=new jt(t,e),s=new jt(t,e+1),a=[];return this.Ur.forEachInRange([i,s],(l=>{this.Gr(l),a.push(l.key)})),a}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new he(new tt([])),i=new jt(t,e),s=new jt(t,e+1);let a=Oe();return this.Ur.forEachInRange([i,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new jt(e,0),i=this.Qr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class jt{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return he.comparator(e.key,t.key)||xe(e.Yr,t.Yr)}static Kr(e,t){return xe(e.Yr,t.Yr)||he.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new at(jt.$r)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,s){const a=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new g_(a,t,i,s);this.mutationQueue.push(l);for(const d of s)this.Zr=this.Zr.add(new jt(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return H.resolve(l)}lookupMutationBatch(e,t){return H.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=this.ei(i),a=s<0?0:s;return H.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?ko:this.tr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new jt(t,0),s=new jt(t,Number.POSITIVE_INFINITY),a=[];return this.Zr.forEachInRange([i,s],(l=>{const d=this.Xr(l.Yr);a.push(d)})),H.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new at(xe);return t.forEach((s=>{const a=new jt(s,0),l=new jt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([a,l],(d=>{i=i.add(d.Yr)}))})),H.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let a=i;he.isDocumentKey(a)||(a=a.child(""));const l=new jt(new he(a),0);let d=new at(xe);return this.Zr.forEachWhile((f=>{const p=f.key.path;return!!i.isPrefixOf(p)&&(p.length===s&&(d=d.add(f.Yr)),!0)}),l),H.resolve(this.ti(d))}ti(e){const t=[];return e.forEach((i=>{const s=this.Xr(i);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){Ae(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return H.forEach(t.mutations,(s=>{const a=new jt(s.key,t.batchId);return i=i.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,t){const i=new jt(t,0),s=this.Zr.firstAfterOrEqual(i);return H.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(e){this.ri=e,this.docs=(function(){return new ht(he.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,s=this.docs.get(i),a=s?s.size:0,l=this.ri(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return H.resolve(i?i.document.mutableCopy():It.newInvalidDocument(t))}getEntries(e,t){let i=Gn();return t.forEach((s=>{const a=this.docs.get(s);i=i.insert(s,a?a.document.mutableCopy():It.newInvalidDocument(s))})),H.resolve(i)}getDocumentsMatchingQuery(e,t,i,s){let a=Gn();const l=t.path,d=new he(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:_}}=f.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||i_(zw(_),i)<=0||(s.has(_.key)||Yc(t,_))&&(a=a.insert(_.key,_.mutableCopy()))}return H.resolve(a)}getAllFromCollectionGroup(e,t,i,s){ye(9500)}ii(e,t){return H.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new K4(this)}getSize(e){return H.resolve(this.size)}}class K4 extends ub{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?t.push(this.Nr.addEntry(e,s)):this.Nr.removeEntry(i)})),H.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e){this.persistence=e,this.si=new Vr((t=>zo(t)),Jc),this.lastRemoteSnapshotVersion=Ie.min(),this.highestTargetId=0,this.oi=0,this._i=new S_,this.targetCount=0,this.ai=Jo.ur()}forEachTarget(e,t){return this.si.forEach(((i,s)=>t(s))),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.oi&&(this.oi=t),H.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Jo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,H.resolve()}updateTargetData(e,t){return this.Pr(t),H.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,t,i){let s=0;const a=[];return this.si.forEach(((l,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.si.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)})),H.waitFor(a).next((()=>s))}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,t){const i=this.si.get(t)||null;return H.resolve(i)}addMatchingKeys(e,t,i){return this._i.Wr(t,i),H.resolve()}removeMatchingKeys(e,t,i){this._i.zr(t,i);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),H.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),H.resolve()}getMatchingKeysForTargetId(e,t){const i=this._i.Hr(t);return H.resolve(i)}containsKey(e,t){return H.resolve(this._i.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,t){this.ui={},this.overlays={},this.ci=new Nn(0),this.li=!1,this.li=!0,this.hi=new G4,this.referenceDelegate=e(this),this.Pi=new J4(this),this.indexManager=new D4,this.remoteDocumentCache=(function(s){return new H4(s)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new WR(t),this.Ii=new B4(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new q4,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this.ui[e.toKey()];return i||(i=new z4(t,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,i){ae("MemoryPersistence","Starting transaction:",e);const s=new Y4(this.ci.next());return this.referenceDelegate.Ei(),i(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ai(e,t){return H.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,t))))}}class Y4 extends Kw{constructor(e){super(),this.currentSequenceNumber=e}}class ap{constructor(e){this.persistence=e,this.Ri=new S_,this.Vi=null}static mi(e){return new ap(e)}get fi(){if(this.Vi)return this.Vi;throw ye(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.fi.delete(i.toString()),H.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.fi.add(i.toString()),H.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),H.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((s=>this.fi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.fi.add(a.toString())))})).next((()=>i.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.fi,(i=>{const s=he.fromPath(i);return this.gi(e,s).next((a=>{a||t.removeEntry(s,Ie.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((i=>{i?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return H.or([()=>H.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ph{constructor(e,t){this.persistence=e,this.pi=new Vr((i=>gn(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=lb(this,t)}static mi(e,t){return new Ph(e,t)}Ei(){}di(e){return H.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((s=>i+s))))}wr(e){let t=0;return this.pr(e,(i=>{t++})).next((()=>t))}pr(e,t){return H.forEach(this.pi,((i,s)=>this.br(e,i,s).next((a=>a?H.resolve():t(s)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ii(e,(l=>this.br(e,l,t).next((d=>{d||(i++,a.removeEntry(l,Ie.min()))})))).next((()=>a.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),H.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),H.resolve()}removeReference(e,t,i){return this.pi.set(i,e.currentSequenceNumber),H.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),H.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=nh(e.data.value)),t}br(e,t,i){return H.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.pi.get(t);return H.resolve(s!==void 0&&s>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{constructor(e){this.serializer=e}k(e,t,i,s){const a=new Qh("createOrUpgrade",t);i<1&&s>=1&&((function(f){f.createObjectStore(Kc)})(e),(function(f){f.createObjectStore(Cc,{keyPath:lV}),f.createObjectStore(Ti,{keyPath:kA,autoIncrement:!0}).createIndex(Mo,VA,{unique:!0}),f.createObjectStore(gl)})(e),IS(e),(function(f){f.createObjectStore(wo)})(e));let l=H.resolve();return i<3&&s>=3&&(i!==0&&((function(f){f.deleteObjectStore(_l),f.deleteObjectStore(yl),f.deleteObjectStore(Vo)})(e),IS(e)),l=l.next((()=>(function(f){const p=f.store(Vo),_={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ie.min().toTimestamp(),targetCount:0};return p.put(Ih,_)})(a)))),i<4&&s>=4&&(i!==0&&(l=l.next((()=>(function(f,p){return p.store(Ti).J().next((E=>{f.deleteObjectStore(Ti),f.createObjectStore(Ti,{keyPath:kA,autoIncrement:!0}).createIndex(Mo,VA,{unique:!0});const T=p.store(Ti),C=E.map((P=>T.put(P)));return H.waitFor(C)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(vl,{keyPath:yV})})(e)}))),i<5&&s>=5&&(l=l.next((()=>this.yi(a)))),i<6&&s>=6&&(l=l.next((()=>((function(f){f.createObjectStore(wc)})(e),this.wi(a))))),i<7&&s>=7&&(l=l.next((()=>this.Si(a)))),i<8&&s>=8&&(l=l.next((()=>this.bi(e,a)))),i<9&&s>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),i<10&&s>=10&&(l=l.next((()=>this.Di(a)))),i<11&&s>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(Wh,{keyPath:_V})})(e),(function(f){f.createObjectStore(Zh,{keyPath:vV})})(e)}))),i<12&&s>=12&&(l=l.next((()=>{(function(f){const p=f.createObjectStore(jh,{keyPath:wV});p.createIndex(oy,RV,{unique:!1}),p.createIndex(jw,bV,{unique:!1})})(e)}))),i<13&&s>=13&&(l=l.next((()=>(function(f){const p=f.createObjectStore(Sh,{keyPath:cV});p.createIndex(eh,dV),p.createIndex(Qw,fV)})(e))).next((()=>this.Ci(e,a))).next((()=>e.deleteObjectStore(wo)))),i<14&&s>=14&&(l=l.next((()=>this.Fi(e,a)))),i<15&&s>=15&&(l=l.next((()=>(function(f){f.createObjectStore(o_,{keyPath:EV,autoIncrement:!0}).createIndex(sy,TV,{unique:!1}),f.createObjectStore(hc,{keyPath:AV}).createIndex(Ww,SV,{unique:!1}),f.createObjectStore(pc,{keyPath:IV}).createIndex(Zw,CV,{unique:!1})})(e)))),i<16&&s>=16&&(l=l.next((()=>{t.objectStore(hc).clear()})).next((()=>{t.objectStore(pc).clear()}))),i<17&&s>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(a_,{keyPath:xV})})(e)}))),i<18&&s>=18&&KC()&&(l=l.next((()=>{t.objectStore(hc).clear()})).next((()=>{t.objectStore(pc).clear()}))),l}wi(e){let t=0;return e.store(wo).ee(((i,s)=>{t+=Mh(s)})).next((()=>{const i={byteSize:t};return e.store(wc).put(ry,i)}))}yi(e){const t=e.store(Cc),i=e.store(Ti);return t.J().next((s=>H.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,ko],[a.userId,a.lastAcknowledgedBatchId]);return i.J(Mo,l).next((d=>H.forEach(d,(f=>{Ae(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=xo(this.serializer,f);return ib(e,a.userId,p).next((()=>{}))}))))}))))}Si(e){const t=e.store(_l),i=e.store(wo);return e.store(Vo).get(Ih).next((s=>{const a=[];return i.ee(((l,d)=>{const f=new tt(l),p=(function(E){return[0,gn(E)]})(f);a.push(t.get(p).next((_=>_?H.resolve():(E=>t.put({targetId:0,path:gn(E),sequenceNumber:s.highestListenSequenceNumber}))(f))))})).next((()=>H.waitFor(a)))}))}bi(e,t){e.createObjectStore(Rc,{keyPath:gV});const i=t.store(Rc),s=new A_,a=l=>{if(s.add(l)){const d=l.lastSegment(),f=l.popLast();return i.put({collectionId:d,parent:gn(f)})}};return t.store(wo).ee({X:!0},((l,d)=>{const f=new tt(l);return a(f.popLast())})).next((()=>t.store(gl).ee({X:!0},(([l,d,f],p)=>{const _=Wi(d);return a(_.popLast())}))))}Di(e){const t=e.store(yl);return t.ee(((i,s)=>{const a=ac(s),l=ZR(this.serializer,a);return t.put(l)}))}Ci(e,t){const i=t.store(wo),s=[];return i.ee(((a,l)=>{const d=t.store(Sh),f=(function(E){return E.document?new he(tt.fromString(E.document.name).popFirst(5)):E.noDocument?he.fromSegments(E.noDocument.path):E.unknownDocument?he.fromSegments(E.unknownDocument.path):ye(36783)})(l).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(d.put(p))})).next((()=>H.waitFor(s)))}Fi(e,t){const i=t.store(Ti),s=cb(this.serializer),a=new I_(ap.mi,this.serializer.yt);return i.J().next((l=>{const d=new Map;return l.forEach((f=>{let p=d.get(f.userId)??Oe();xo(this.serializer,f).keys().forEach((_=>p=p.add(_))),d.set(f.userId,p)})),H.forEach(d,((f,p)=>{const _=new fn(p),E=sp.wt(this.serializer,_),T=a.getIndexManager(_),C=op.wt(_,this.serializer,T,a.referenceDelegate);return new db(s,C,E,T).recalculateAndSaveOverlaysForDocumentKeys(new ay(t,Nn.ce),f).next()}))}))}}function IS(n){n.createObjectStore(_l,{keyPath:pV}).createIndex(s_,mV,{unique:!0}),n.createObjectStore(yl,{keyPath:"targetId"}).createIndex(Xw,hV,{unique:!0}),n.createObjectStore(Vo)}const Ts="IndexedDbPersistence",Vg=18e5,Lg=5e3,Ug="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Q4="main";class C_{constructor(e,t,i,s,a,l,d,f,p,_,E=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Mi=a,this.window=l,this.document=d,this.xi=p,this.Oi=_,this.Ni=E,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=T=>Promise.resolve(),!C_.v())throw new ce(ee.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new L4(this,s),this.$i=t+Q4,this.serializer=new WR(f),this.Ui=new Ms(this.$i,this.Ni,new $4(this.serializer)),this.hi=new C4,this.Pi=new P4(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cb(this.serializer),this.Ii=new I4,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,_===!1&&Nt(Ts,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ce(ee.FAILED_PRECONDITION,Ug);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Nn(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Of(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(qs(e))return ae(Ts,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ae(Ts,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return ju(e).get(Ga).next((t=>H.resolve(this.es(t))))}ts(e){return Of(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Vg)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const i=Qt(t,vl);return i.J().next((s=>{const a=this.ss(s,Vg),l=s.filter((d=>a.indexOf(d)===-1));return H.forEach(l,(d=>i.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?H.resolve(!0):ju(e).get(Ga).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Lg)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new ce(ee.FAILED_PRECONDITION,Ug);return!1}}return!(!this.networkEnabled||!this.inForeground)||Of(e).J().next((i=>this.ss(i,Lg).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(a||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ae(Ts,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Kc,vl],(e=>{const t=new ay(e,Nn.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((i=>this.rs(i.updateTimeMs,t)&&!this.us(i.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>Of(e).J().next((t=>this.ss(t,Vg).map((i=>i.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return op.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new M4(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return sp.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,i){ae(Ts,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?MV:f===17?iR:f===16?DV:f===15?l_:f===14?nR:f===13?tR:f===12?NV:f===11?eR:void ye(60245)})(this.Ni);let l;return this.Ui.runTransaction(e,s,a,(d=>(l=new ay(d,this.ci?this.ci.next():Nn.ce),t==="readwrite-primary"?this.Hi(l).next((f=>!!f||this.Yi(l))).next((f=>{if(!f)throw Nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new ce(ee.FAILED_PRECONDITION,Hw);return i(l)})).next((f=>this.Xi(l).next((()=>f)))):this.Is(l).next((()=>i(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Is(e){return ju(e).get(Ga).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Lg)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ce(ee.FAILED_PRECONDITION,Ug)}))}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ju(e).put(Ga,t)}static v(){return Ms.v()}Zi(e){const t=ju(e);return t.get(Ga).next((i=>this.es(i)?(ae(Ts,"Releasing primary lease."),t.delete(Ga)):H.resolve()))}rs(e,t){const i=Date.now();return!(e<i-t)&&(!(e>i)||(Nt(`Detected an update time that is in the future: ${e} > ${i}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Bi=()=>{this.cs();const t=/(?:Version|Mobile)\/1[456]/;HC()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){var t;try{const i=((t=this.Ki)==null?void 0:t.getItem(this._s(e)))!==null;return ae(Ts,`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Nt(Ts,"Failed to get zombied client id.",i),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Nt("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ju(n){return Qt(n,Kc)}function Of(n){return Qt(n,vl)}function fb(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Es=i,this.ds=s}static As(e,t){let i=Oe(),s=Oe();for(const a of t.docChanges)switch(a.type){case 0:i=i.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new w_(e,t.fromCache,i,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return HC()?8:Jw($t())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,s){const a={result:null};return this.ys(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ws(e,t,s,i).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new X4;return this.Ss(e,t,l).next((d=>{if(a.result=d,this.Vs)return this.bs(e,t,l,d.size)}))})).next((()=>a.result))}bs(e,t,i,s){return i.documentReadCount<this.fs?($a()<=ze.DEBUG&&ae("QueryEngine","SDK will not create cache indexes for query:",Qa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),H.resolve()):($a()<=ze.DEBUG&&ae("QueryEngine","Query:",Qa(t),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?($a()<=ze.DEBUG&&ae("QueryEngine","The SDK decides to create cache indexes for query:",Qa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zn(t))):H.resolve())}ys(e,t){if($A(t))return H.resolve(null);let i=zn(t);return this.indexManager.getIndexType(e,i).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=py(t,null,"F"),i=zn(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((a=>{const l=Oe(...a);return this.ps.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,i).next((f=>{const p=this.Ds(t,d);return this.Cs(t,p,l,f.readTime)?this.ys(e,py(t,null,"F")):this.vs(e,p,t,f)}))))})))))}ws(e,t,i,s){return $A(t)||s.isEqual(Ie.min())?H.resolve(null):this.ps.getDocuments(e,i).next((a=>{const l=this.Ds(t,a);return this.Cs(t,l,i,s)?H.resolve(null):($a()<=ze.DEBUG&&ae("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Qa(t)),this.vs(e,l,t,Gw(s,ml)).next((d=>d)))}))}Ds(e,t){let i=new at(CR(e));return t.forEach(((s,a)=>{Yc(e,a)&&(i=i.add(a))})),i}Cs(e,t,i,s){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}Ss(e,t,i){return $a()<=ze.DEBUG&&ae("QueryEngine","Using full collection scan to execute query:",Qa(t)),this.ps.getDocumentsMatchingQuery(e,t,Hn.min(),i)}vs(e,t,i,s){return this.ps.getDocumentsMatchingQuery(e,i,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R_="LocalStore",W4=3e8;class Z4{constructor(e,t,i,s){this.persistence=e,this.Fs=t,this.serializer=s,this.Ms=new ht(xe),this.xs=new Vr((a=>zo(a)),Jc),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new db(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function pb(n,e,t,i){return new Z4(n,e,t,i)}async function mb(n,e){const t=ve(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return t.mutationQueue.getAllMutationBatches(i).next((a=>(s=a,t.Bs(e),t.mutationQueue.getAllMutationBatches(i)))).next((a=>{const l=[],d=[];let f=Oe();for(const p of s){l.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}for(const p of a){d.push(p.batchId);for(const _ of p.mutations)f=f.add(_.key)}return t.localDocuments.getDocuments(i,f).next((p=>({Ls:p,removedBatchIds:l,addedBatchIds:d})))}))}))}function j4(n,e){const t=ve(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=e.batch.keys(),a=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,_){const E=p.batch,T=E.keys();let C=H.resolve();return T.forEach((P=>{C=C.next((()=>_.getEntry(f,P))).next((F=>{const V=p.docVersions.get(P);Ae(V!==null,48541),F.version.compareTo(V)<0&&(E.applyToRemoteDocument(F,p),F.isValidDocument()&&(F.setReadTime(p.commitVersion),_.addEntry(F)))}))})),C.next((()=>d.mutationQueue.removeMutationBatch(f,E)))})(t,i,e,a).next((()=>a.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let f=Oe();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(i,s)))}))}function gb(n){const e=ve(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function eL(n,e){const t=ve(n),i=e.snapshotVersion;let s=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Ns.newChangeBuffer({trackRemovals:!0});s=t.Ms;const d=[];e.targetChanges.forEach(((_,E)=>{const T=s.get(E);if(!T)return;d.push(t.Pi.removeMatchingKeys(a,_.removedDocuments,E).next((()=>t.Pi.addMatchingKeys(a,_.addedDocuments,E))));let C=T.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(E)!==null?C=C.withResumeToken(Dt.EMPTY_BYTE_STRING,Ie.min()).withLastLimboFreeSnapshotVersion(Ie.min()):_.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(_.resumeToken,i)),s=s.insert(E,C),(function(F,V,Q){return F.resumeToken.approximateByteSize()===0||V.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=W4?!0:Q.addedDocuments.size+Q.modifiedDocuments.size+Q.removedDocuments.size>0})(T,C,_)&&d.push(t.Pi.updateTargetData(a,C))}));let f=Gn(),p=Oe();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,_))})),d.push(tL(a,l,e.documentUpdates).next((_=>{f=_.ks,p=_.qs}))),!i.isEqual(Ie.min())){const _=t.Pi.getLastRemoteSnapshotVersion(a).next((E=>t.Pi.setTargetsMetadata(a,a.currentSequenceNumber,i)));d.push(_)}return H.waitFor(d).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,p))).next((()=>f))})).then((a=>(t.Ms=s,a)))}function tL(n,e,t){let i=Oe(),s=Oe();return t.forEach((a=>i=i.add(a))),e.getEntries(n,i).next((a=>{let l=Gn();return t.forEach(((d,f)=>{const p=a.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(d)),f.isNoDocument()&&f.version.isEqual(Ie.min())?(e.removeEntry(d,f.readTime),l=l.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),l=l.insert(d,f)):ae(R_,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{ks:l,qs:s}}))}function nL(n,e){const t=ve(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=ko),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function kh(n,e){const t=ve(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return t.Pi.getTargetData(i,e).next((a=>a?(s=a,H.resolve(s)):t.Pi.allocateTargetId(i).next((l=>(s=new Cr(e,l,"TargetPurposeListen",i.currentSequenceNumber),t.Pi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=t.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(i.targetId,i),t.xs.set(e,i.targetId)),i}))}async function Rl(n,e,t){const i=ve(n),s=i.Ms.get(e),a=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",a,(l=>i.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!qs(l))throw l;ae(R_,`Failed to update sequence numbers for target ${e}: ${l}`)}i.Ms=i.Ms.remove(e),i.xs.delete(s.target)}function Ay(n,e,t){const i=ve(n);let s=Ie.min(),a=Oe();return i.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,p,_){const E=ve(f),T=E.xs.get(_);return T!==void 0?H.resolve(E.Ms.get(T)):E.Pi.getTargetData(p,_)})(i,l,zn(e)).next((d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(l,d.targetId).next((f=>{a=f}))})).next((()=>i.Fs.getDocumentsMatchingQuery(l,e,t?s:Ie.min(),t?a:Oe()))).next((d=>(vb(i,IR(e),d),{documents:d,Qs:a})))))}function yb(n,e){const t=ve(n),i=ve(t.Pi),s=t.Ms.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",(a=>i.At(a,e).next((l=>l?l.target:null))))}function _b(n,e){const t=ve(n),i=t.Os.get(e)||Ie.min();return t.persistence.runTransaction("Get new document changes","readonly",(s=>t.Ns.getAllFromCollectionGroup(s,e,Gw(i,ml),Number.MAX_SAFE_INTEGER))).then((s=>(vb(t,e,s),s)))}function vb(n,e,t){let i=n.Os.get(e)||Ie.min();t.forEach(((s,a)=>{a.readTime.compareTo(i)>0&&(i=a.readTime)})),n.Os.set(e,i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eb="firestore_clients";function CS(n,e){return`${Eb}_${n}_${e}`}const Tb="firestore_mutations";function wS(n,e,t){let i=`${Tb}_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}const Ab="firestore_targets";function Og(n,e){return`${Ab}_${n}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="SharedClientState";class Vh{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static Ws(e,t,i){const s=JSON.parse(i);let a,l=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return l&&s.error&&(l=typeof s.error.message=="string"&&typeof s.error.code=="string",l&&(a=new ce(s.error.code,s.error.message))),l?new Vh(e,t,s.state,a):(Nt(Xi,`Failed to parse mutation state for ID '${t}': ${i}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class vc{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static Ws(e,t){const i=JSON.parse(t);let s,a=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return a&&i.error&&(a=typeof i.error.message=="string"&&typeof i.error.code=="string",a&&(s=new ce(i.error.code,i.error.message))),a?new vc(e,i.state,s):(Nt(Xi,`Failed to parse target state for ID '${e}': ${t}`),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Lh{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const i=JSON.parse(t);let s=typeof i=="object"&&i.activeTargetIds instanceof Array,a=p_();for(let l=0;s&&l<i.activeTargetIds.length;++l)s=Yw(i.activeTargetIds[l]),a=a.add(i.activeTargetIds[l]);return s?new Lh(e,a):(Nt(Xi,`Failed to parse client data for instance '${e}': ${t}`),null)}}class b_{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new b_(t.clientId,t.onlineState):(Nt(Xi,`Failed to parse online state: ${e}`),null)}}class Sy{constructor(){this.activeTargetIds=p_()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fg{constructor(e,t,i,s,a){this.window=e,this.Mi=t,this.persistenceKey=i,this.Js=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new ht(xe),this.started=!1,this.Xs=[];const l=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.eo=CS(this.persistenceKey,this.Js),this.no=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Sy),this.ro=new RegExp(`^${Eb}_${l}_([^_]*)$`),this.io=new RegExp(`^${Tb}_${l}_(\\d+)(?:_(.*))?$`),this.so=new RegExp(`^${Ab}_${l}_(\\d+)$`),this.oo=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this._o=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const i of e){if(i===this.Js)continue;const s=this.getItem(CS(this.persistenceKey,i));if(s){const a=Lh.Ws(i,s);a&&(this.Zs=this.Zs.insert(a.clientId,a))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const i=this.uo(t);i&&this.co(i)}for(const i of this.Xs)this.Ys(i);this.Xs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach(((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,i){this.ho(e,t,i),this.Po(e)}addLocalQueryTarget(e,t=!0){let i="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Og(this.persistenceKey,e));if(s){const a=vc.Ws(e,s);a&&(i=a.state)}}return t&&this.To.zs(e),this.ao(),i}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Og(this.persistenceKey,e))}updateQueryState(e,t,i){this.Io(e,t,i)}handleUserChange(e,t,i){t.forEach((s=>{this.Po(s)})),this.currentUser=e,i.forEach((s=>{this.addPendingMutation(s)}))}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ae(Xi,"READ",e,t),t}setItem(e,t){ae(Xi,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){ae(Xi,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(ae(Xi,"EVENT",t.key,t.newValue),t.key===this.eo)return void Nt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.ro.test(t.key)){if(t.newValue==null){const i=this.Ro(t.key);return this.Vo(i,null)}{const i=this.mo(t.key,t.newValue);if(i)return this.Vo(i.clientId,i)}}else if(this.io.test(t.key)){if(t.newValue!==null){const i=this.fo(t.key,t.newValue);if(i)return this.po(i)}}else if(this.so.test(t.key)){if(t.newValue!==null){const i=this.yo(t.key,t.newValue);if(i)return this.wo(i)}}else if(t.key===this.oo){if(t.newValue!==null){const i=this.uo(t.newValue);if(i)return this.co(i)}}else if(t.key===this.no){const i=(function(a){let l=Nn.ce;if(a!=null)try{const d=JSON.parse(a);Ae(typeof d=="number",30636,{So:a}),l=d}catch(d){Nt(Xi,"Failed to read sequence number from WebStorage",d)}return l})(t.newValue);i!==Nn.ce&&this.sequenceNumberHandler(i)}else if(t.key===this._o){const i=this.bo(t.newValue);await Promise.all(i.map((s=>this.syncEngine.Do(s))))}}}else this.Xs.push(t)}))}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,i){const s=new Vh(this.currentUser,e,t,i),a=wS(this.persistenceKey,this.currentUser,e);this.setItem(a,s.Gs())}Po(e){const t=wS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,i){const s=Og(this.persistenceKey,e),a=new vc(e,t,i);this.setItem(s,a.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const i=this.Ro(e);return Lh.Ws(i,t)}fo(e,t){const i=this.io.exec(e),s=Number(i[1]),a=i[2]!==void 0?i[2]:null;return Vh.Ws(new fn(a),s,t)}yo(e,t){const i=this.so.exec(e),s=Number(i[1]);return vc.Ws(s,t)}uo(e){return b_.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);ae(Xi,`Ignoring mutation for non-active user ${e.user.uid}`)}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const i=t?this.Zs.insert(e,t):this.Zs.remove(e),s=this.lo(this.Zs),a=this.lo(i),l=[],d=[];return a.forEach((f=>{s.has(f)||l.push(f)})),s.forEach((f=>{a.has(f)||d.push(f)})),this.syncEngine.Fo(l,d).then((()=>{this.Zs=i}))}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=p_();return e.forEach(((i,s)=>{t=t.unionWith(s.activeTargetIds)})),t}}class Sb{constructor(){this.Mo=new Sy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,i){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Sy,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RS="ConnectivityMonitor";class bS{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ae(RS,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ae(RS,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ff=null;function Iy(){return Ff===null?Ff=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ff++,"0x"+Ff.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bg="RestConnection",rL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class sL{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===Ch?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(e,t,i,s,a){const l=Iy(),d=this.zo(e,t.toUriEncodedString());ae(Bg,`Sending RPC '${e}' ${l}:`,d,i);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,s,a);const{host:p}=new URL(d),_=Dl(p);return this.Jo(e,d,f,i,_).then((E=>(ae(Bg,`Received RPC '${e}' ${l}: `,E),E)),(E=>{throw Ac(Bg,`RPC '${e}' ${l} failed with error: `,E,"url: ",d,"request:",i),E}))}Ho(e,t,i,s,a,l){return this.Go(e,t,i,s,a)}jo(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+kl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),i&&i.headers.forEach(((s,a)=>e[a]=s))}zo(e,t){const i=rL[e];return`${this.Uo}/v1/${t}:${i}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn="WebChannelConnection";class aL extends sL{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,i,s,a){const l=Iy();return new Promise(((d,f)=>{const p=new Pw;p.setWithCredentials(!0),p.listenOnce(kw.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Wf.NO_ERROR:const E=p.getResponseJson();ae(dn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(E)),d(E);break;case Wf.TIMEOUT:ae(dn,`RPC '${e}' ${l} timed out`),f(new ce(ee.DEADLINE_EXCEEDED,"Request time out"));break;case Wf.HTTP_ERROR:const T=p.getStatus();if(ae(dn,`RPC '${e}' ${l} failed with status:`,T,"response text:",p.getResponseText()),T>0){let C=p.getResponseJson();Array.isArray(C)&&(C=C[0]);const P=C==null?void 0:C.error;if(P&&P.status&&P.message){const F=(function(Q){const j=Q.toLowerCase().replace(/_/g,"-");return Object.values(ee).indexOf(j)>=0?j:ee.UNKNOWN})(P.status);f(new ce(F,P.message))}else f(new ce(ee.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new ce(ee.UNAVAILABLE,"Connection failed."));break;default:ye(9055,{l_:e,streamId:l,h_:p.getLastErrorCode(),P_:p.getLastError()})}}finally{ae(dn,`RPC '${e}' ${l} completed.`)}}));const _=JSON.stringify(s);ae(dn,`RPC '${e}' ${l} sending request:`,s),p.send(t,"POST",_,i,15)}))}T_(e,t,i){const s=Iy(),a=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=Uw(),d=Lw(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,t,i),f.encodeInitMessageHeaders=!0;const _=a.join("");ae(dn,`Creating RPC '${e}' stream ${s}: ${_}`,f);const E=l.createWebChannel(_,f);this.I_(E);let T=!1,C=!1;const P=new oL({Yo:V=>{C?ae(dn,`Not sending because RPC '${e}' stream ${s} is closed:`,V):(T||(ae(dn,`Opening RPC '${e}' stream ${s} transport.`),E.open(),T=!0),ae(dn,`RPC '${e}' stream ${s} sending:`,V),E.send(V))},Zo:()=>E.close()}),F=(V,Q,j)=>{V.listen(Q,(X=>{try{j(X)}catch(se){setTimeout((()=>{throw se}),0)}}))};return F(E,rc.EventType.OPEN,(()=>{C||(ae(dn,`RPC '${e}' stream ${s} transport opened.`),P.o_())})),F(E,rc.EventType.CLOSE,(()=>{C||(C=!0,ae(dn,`RPC '${e}' stream ${s} transport closed`),P.a_(),this.E_(E))})),F(E,rc.EventType.ERROR,(V=>{C||(C=!0,Ac(dn,`RPC '${e}' stream ${s} transport errored. Name:`,V.name,"Message:",V.message),P.a_(new ce(ee.UNAVAILABLE,"The operation could not be completed")))})),F(E,rc.EventType.MESSAGE,(V=>{var Q;if(!C){const j=V.data[0];Ae(!!j,16349);const X=j,se=(X==null?void 0:X.error)||((Q=X[0])==null?void 0:Q.error);if(se){ae(dn,`RPC '${e}' stream ${s} received error:`,se);const le=se.status;let ue=(function(x){const L=qt[x];if(L!==void 0)return UR(L)})(le),N=se.message;ue===void 0&&(ue=ee.INTERNAL,N="Unknown error status: "+le+" with message "+se.message),C=!0,P.a_(new ce(ue,N)),E.close()}else ae(dn,`RPC '${e}' stream ${s} received:`,j),P.u_(j)}})),F(d,Vw.STAT_EVENT,(V=>{V.stat===ty.PROXY?ae(dn,`RPC '${e}' stream ${s} detected buffering proxy`):V.stat===ty.NOPROXY&&ae(dn,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{P.__()}),0),P}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ib(){return typeof window<"u"?window:null}function ah(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lp(n){return new h4(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cb{constructor(e,t,i=1e3,s=1.5,a=6e4){this.Mi=e,this.timerId=t,this.d_=i,this.A_=s,this.R_=a,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,t-i);s>0&&ae("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS="PersistentStream";class wb{constructor(e,t,i,s,a,l,d,f){this.Mi=e,this.S_=i,this.b_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Cb(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===ee.RESOURCE_EXHAUSTED?(Nt(t.toString()),Nt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===ee.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===t&&this.G_(i,s)}),(i=>{e((()=>{const s=new ce(ee.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(e,t){const i=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return ae(xS,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(ae(xS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lL extends wb{constructor(e,t,i,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,s,l),this.serializer=a}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=g4(this.serializer,e),i=(function(a){if(!("targetChange"in a))return Ie.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?Ie.min():l.readTime?Tn(l.readTime):Ie.min()})(e);return this.listener.H_(t,i)}Y_(e){const t={};t.database=yy(this.serializer),t.addTarget=(function(a,l){let d;const f=l.target;if(d=wh(f)?{documents:KR(a,f)}:{query:JR(a,f).ft},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=BR(a,l.resumeToken);const p=my(a,l.expectedCount);p!==null&&(d.expectedCount=p)}else if(l.snapshotVersion.compareTo(Ie.min())>0){d.readTime=wl(a,l.snapshotVersion.toTimestamp());const p=my(a,l.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const i=_4(this.serializer,e);i&&(t.labels=i),this.q_(t)}Z_(e){const t={};t.database=yy(this.serializer),t.removeTarget=e,this.q_(t)}}class uL extends wb{constructor(e,t,i,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,s,l),this.serializer=a}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return Ae(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ae(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Ae(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=y4(e.writeResults,e.commitTime),i=Tn(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=yy(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>xh(this.serializer,i)))};this.q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cL{}class dL extends cL{constructor(e,t,i,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new ce(ee.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Go(e,gy(t,i),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new ce(ee.UNKNOWN,a.toString())}))}Ho(e,t,i,s,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Ho(e,gy(t,i),s,l,d,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ee.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ce(ee.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class fL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Nt(t),this.aa=!1):ae("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo="RemoteStore";class hL{constructor(e,t,i,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=a,this.Aa.Oo((l=>{i.enqueueAndForget((async()=>{Qo(this)&&(ae(Yo,"Restarting streams for network reachability change."),await(async function(f){const p=ve(f);p.Ea.add(4),await Wc(p),p.Ra.set("Unknown"),p.Ea.delete(4),await up(p)})(this))}))})),this.Ra=new fL(i,s)}}async function up(n){if(Qo(n))for(const e of n.da)await e(!0)}async function Wc(n){for(const e of n.da)await e(!1)}function cp(n,e){const t=ve(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),D_(t)?N_(t):Ol(t).O_()&&x_(t,e))}function bl(n,e){const t=ve(n),i=Ol(t);t.Ia.delete(e),i.O_()&&Rb(t,e),t.Ia.size===0&&(i.O_()?i.L_():Qo(t)&&t.Ra.set("Unknown"))}function x_(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ie.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ol(n).Y_(e)}function Rb(n,e){n.Va.Ue(e),Ol(n).Z_(e)}function N_(n){n.Va=new u4({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Ol(n).start(),n.Ra.ua()}function D_(n){return Qo(n)&&!Ol(n).x_()&&n.Ia.size>0}function Qo(n){return ve(n).Ea.size===0}function bb(n){n.Va=void 0}async function pL(n){n.Ra.set("Online")}async function mL(n){n.Ia.forEach(((e,t)=>{x_(n,e)}))}async function gL(n,e){bb(n),D_(n)?(n.Ra.ha(e),N_(n)):n.Ra.set("Unknown")}async function yL(n,e,t){if(n.Ra.set("Online"),e instanceof FR&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const d of a.targetIds)s.Ia.has(d)&&(await s.remoteSyncer.rejectListen(d,l),s.Ia.delete(d),s.Va.removeTarget(d))})(n,e)}catch(i){ae(Yo,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Uh(n,i)}else if(e instanceof sh?n.Va.Ze(e):e instanceof OR?n.Va.st(e):n.Va.tt(e),!t.isEqual(Ie.min()))try{const i=await gb(n.localStore);t.compareTo(i)>=0&&await(function(a,l){const d=a.Va.Tt(l);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const _=a.Ia.get(p);_&&a.Ia.set(p,_.withResumeToken(f.resumeToken,l))}})),d.targetMismatches.forEach(((f,p)=>{const _=a.Ia.get(f);if(!_)return;a.Ia.set(f,_.withResumeToken(Dt.EMPTY_BYTE_STRING,_.snapshotVersion)),Rb(a,f);const E=new Cr(_.target,f,p,_.sequenceNumber);x_(a,E)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){ae(Yo,"Failed to raise snapshot:",i),await Uh(n,i)}}async function Uh(n,e,t){if(!qs(e))throw e;n.Ea.add(1),await Wc(n),n.Ra.set("Offline"),t||(t=()=>gb(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ae(Yo,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await up(n)}))}function xb(n,e){return e().catch((t=>Uh(n,t,e)))}async function Ul(n){const e=ve(n),t=Ls(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ko;for(;_L(e);)try{const s=await nL(e.localStore,i);if(s===null){e.Ta.length===0&&t.L_();break}i=s.batchId,vL(e,s)}catch(s){await Uh(e,s)}Nb(e)&&Db(e)}function _L(n){return Qo(n)&&n.Ta.length<10}function vL(n,e){n.Ta.push(e);const t=Ls(n);t.O_()&&t.X_&&t.ea(e.mutations)}function Nb(n){return Qo(n)&&!Ls(n).x_()&&n.Ta.length>0}function Db(n){Ls(n).start()}async function EL(n){Ls(n).ra()}async function TL(n){const e=Ls(n);for(const t of n.Ta)e.ea(t.mutations)}async function AL(n,e,t){const i=n.Ta.shift(),s=y_.from(i,e,t);await xb(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Ul(n)}async function SL(n,e){e&&Ls(n).X_&&await(async function(i,s){if((function(l){return o4(l)&&l!==ee.ABORTED})(s.code)){const a=i.Ta.shift();Ls(i).B_(),await xb(i,(()=>i.remoteSyncer.rejectFailedWrite(a.batchId,s))),await Ul(i)}})(n,e),Nb(n)&&Db(n)}async function NS(n,e){const t=ve(n);t.asyncQueue.verifyOperationInProgress(),ae(Yo,"RemoteStore received new credentials");const i=Qo(t);t.Ea.add(3),await Wc(t),i&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await up(t)}async function Cy(n,e){const t=ve(n);e?(t.Ea.delete(2),await up(t)):e||(t.Ea.add(2),await Wc(t),t.Ra.set("Unknown"))}function Ol(n){return n.ma||(n.ma=(function(t,i,s){const a=ve(t);return a.sa(),new lL(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:pL.bind(null,n),t_:mL.bind(null,n),r_:gL.bind(null,n),H_:yL.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),D_(n)?N_(n):n.Ra.set("Unknown")):(await n.ma.stop(),bb(n))}))),n.ma}function Ls(n){return n.fa||(n.fa=(function(t,i,s){const a=ve(t);return a.sa(),new uL(i,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:EL.bind(null,n),r_:SL.bind(null,n),ta:TL.bind(null,n),na:AL.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await Ul(n)):(await n.fa.stop(),n.Ta.length>0&&(ae(Yo,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e,t,i,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=a,this.deferred=new Rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,s,a){const l=Date.now()+i,d=new M_(e,t,l,s,a);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ce(ee.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function P_(n,e){if(Nt("AsyncQueue",`${e}: ${n}`),qs(n))return new ce(ee.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{static emptySet(e){return new ol(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||he.comparator(t.key,i.key):(t,i)=>he.comparator(t.key,i.key),this.keyedMap=sc(),this.sortedSet=new ht(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ol)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=i.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new ol;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DS{constructor(){this.ga=new ht(he.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ye(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class xl{constructor(e,t,i,s,a,l,d,f,p){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,i,s,a){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new xl(e,t,ol.emptySet(t),l,i,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&np(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IL{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class CL{constructor(){this.queries=MS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const s=ve(t),a=s.queries;s.queries=MS(),a.forEach(((l,d)=>{for(const f of d.Sa)f.onError(i)}))})(this,new ce(ee.ABORTED,"Firestore shutting down"))}}function MS(){return new Vr((n=>SR(n)),np)}async function wL(n,e){const t=ve(n);let i=3;const s=e.query;let a=t.queries.get(s);a?!a.ba()&&e.Da()&&(i=2):(a=new IL,i=e.Da()?0:1);try{switch(i){case 0:a.wa=await t.onListen(s,!0);break;case 1:a.wa=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const d=P_(l,`Initialization of query '${Qa(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,a),a.Sa.push(e),e.va(t.onlineState),a.wa&&e.Fa(a.wa)&&k_(t)}async function RL(n,e){const t=ve(n),i=e.query;let s=3;const a=t.queries.get(i);if(a){const l=a.Sa.indexOf(e);l>=0&&(a.Sa.splice(l,1),a.Sa.length===0?s=e.Da()?0:1:!a.ba()&&e.Da()&&(s=2))}switch(s){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function bL(n,e){const t=ve(n);let i=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const d of l.Sa)d.Fa(s)&&(i=!0);l.wa=s}}i&&k_(t)}function xL(n,e,t){const i=ve(n),s=i.queries.get(e);if(s)for(const a of s.Sa)a.onError(t);i.queries.delete(e)}function k_(n){n.Ca.forEach((e=>{e.next()}))}var wy,PS;(PS=wy||(wy={})).Ma="default",PS.Cache="cache";class NL{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)s.type!==3&&i.push(s);e=new xl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=xl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==wy.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e){this.key=e}}class Pb{constructor(e){this.key=e}}class DL{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Oe(),this.mutatedKeys=Oe(),this.eu=CR(e),this.tu=new ol(this.eu)}get nu(){return this.Ya}ru(e,t){const i=t?t.iu:new DS,s=t?t.tu:this.tu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((_,E)=>{const T=s.get(_),C=Yc(this.query,E)?E:null,P=!!T&&this.mutatedKeys.has(T.key),F=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let V=!1;T&&C?T.data.isEqual(C.data)?P!==F&&(i.track({type:3,doc:C}),V=!0):this.su(T,C)||(i.track({type:2,doc:C}),V=!0,(f&&this.eu(C,f)>0||p&&this.eu(C,p)<0)&&(d=!0)):!T&&C?(i.track({type:0,doc:C}),V=!0):T&&!C&&(i.track({type:1,doc:T}),V=!0,(f||p)&&(d=!0)),V&&(C?(l=l.add(C),a=F?a.add(_):a.delete(_)):(l=l.delete(_),a=a.delete(_)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),a=a.delete(_.key),i.track({type:1,doc:_})}return{tu:l,iu:i,Cs:d,mutatedKeys:a}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,s){const a=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((_,E)=>(function(C,P){const F=V=>{switch(V){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ye(20277,{Rt:V})}};return F(C)-F(P)})(_.type,E.type)||this.eu(_.doc,E.doc))),this.ou(i),s=s??!1;const d=t&&!s?this._u():[],f=this.Xa.size===0&&this.current&&!s?1:0,p=f!==this.Za;return this.Za=f,l.length!==0||p?{snapshot:new xl(this.query,e.tu,a,l,e.mutatedKeys,f===0,p,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new DS,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Oe(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const t=[];return e.forEach((i=>{this.Xa.has(i)||t.push(new Pb(i))})),this.Xa.forEach((i=>{e.has(i)||t.push(new Mb(i))})),t}cu(e){this.Ya=e.Qs,this.Xa=Oe();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return xl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Fl="SyncEngine";class ML{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class PL{constructor(e){this.key=e,this.hu=!1}}class kL{constructor(e,t,i,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new Vr((d=>SR(d)),np),this.Iu=new Map,this.Eu=new Set,this.du=new ht(he.comparator),this.Au=new Map,this.Ru=new S_,this.Vu={},this.mu=new Map,this.fu=Jo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function VL(n,e,t=!0){const i=dp(n);let s;const a=i.Tu.get(e);return a?(i.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.lu()):s=await kb(i,e,t,!0),s}async function LL(n,e){const t=dp(n);await kb(t,e,!0,!1)}async function kb(n,e,t,i){const s=await kh(n.localStore,zn(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let d;return i&&(d=await V_(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&cp(n.remoteStore,s),d}async function V_(n,e,t,i,s){n.pu=(E,T,C)=>(async function(F,V,Q,j){let X=V.view.ru(Q);X.Cs&&(X=await Ay(F.localStore,V.query,!1).then((({documents:N})=>V.view.ru(N,X))));const se=j&&j.targetChanges.get(V.targetId),le=j&&j.targetMismatches.get(V.targetId)!=null,ue=V.view.applyChanges(X,F.isPrimaryClient,se,le);return Ry(F,V.targetId,ue.au),ue.snapshot})(n,E,T,C);const a=await Ay(n.localStore,e,!0),l=new DL(e,a.Qs),d=l.ru(a.documents),f=Xc.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",s),p=l.applyChanges(d,n.isPrimaryClient,f);Ry(n,t,p.au);const _=new ML(e,t,l);return n.Tu.set(e,_),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),p.snapshot}async function UL(n,e,t){const i=ve(n),s=i.Tu.get(e),a=i.Iu.get(s.targetId);if(a.length>1)return i.Iu.set(s.targetId,a.filter((l=>!np(l,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await Rl(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),t&&bl(i.remoteStore,s.targetId),Nl(i,s.targetId)})).catch(Bs)):(Nl(i,s.targetId),await Rl(i.localStore,s.targetId,!0))}async function OL(n,e){const t=ve(n),i=t.Tu.get(e),s=t.Iu.get(i.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),bl(t.remoteStore,i.targetId))}async function FL(n,e,t){const i=F_(n);try{const s=await(function(l,d){const f=ve(l),p=st.now(),_=d.reduce(((C,P)=>C.add(P.key)),Oe());let E,T;return f.persistence.runTransaction("Locally write mutations","readwrite",(C=>{let P=Gn(),F=Oe();return f.Ns.getEntries(C,_).next((V=>{P=V,P.forEach(((Q,j)=>{j.isValidDocument()||(F=F.add(Q))}))})).next((()=>f.localDocuments.getOverlayedDocuments(C,P))).next((V=>{E=V;const Q=[];for(const j of d){const X=r4(j,E.get(j.key).overlayedDocument);X!=null&&Q.push(new Lr(j.key,X,hR(X.value.mapValue),un.exists(!0)))}return f.mutationQueue.addMutationBatch(C,p,Q,d)})).next((V=>{T=V;const Q=V.applyToLocalDocumentSet(E,F);return f.documentOverlayCache.saveOverlays(C,V.batchId,Q)}))})).then((()=>({batchId:T.batchId,changes:RR(E)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),(function(l,d,f){let p=l.Vu[l.currentUser.toKey()];p||(p=new ht(xe)),p=p.insert(d,f),l.Vu[l.currentUser.toKey()]=p})(i,s.batchId,t),await zs(i,s.changes),await Ul(i.remoteStore)}catch(s){const a=P_(s,"Failed to persist write");t.reject(a)}}async function Vb(n,e){const t=ve(n);try{const i=await eL(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Au.get(a);l&&(Ae(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.hu=!0:s.modifiedDocuments.size>0?Ae(l.hu,14607):s.removedDocuments.size>0&&(Ae(l.hu,42227),l.hu=!1))})),await zs(t,i,e)}catch(i){await Bs(i)}}function kS(n,e,t){const i=ve(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const s=[];i.Tu.forEach(((a,l)=>{const d=l.view.va(e);d.snapshot&&s.push(d.snapshot)})),(function(l,d){const f=ve(l);f.onlineState=d;let p=!1;f.queries.forEach(((_,E)=>{for(const T of E.Sa)T.va(d)&&(p=!0)})),p&&k_(f)})(i.eventManager,e),s.length&&i.Pu.H_(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function BL(n,e,t){const i=ve(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Au.get(e),a=s&&s.key;if(a){let l=new ht(he.comparator);l=l.insert(a,It.newNoDocument(a,Ie.min()));const d=Oe().add(a),f=new Qc(Ie.min(),new Map,new ht(xe),l,d);await Vb(i,f),i.du=i.du.remove(a),i.Au.delete(e),O_(i)}else await Rl(i.localStore,e,!1).then((()=>Nl(i,e,t))).catch(Bs)}async function qL(n,e){const t=ve(n),i=e.batch.batchId;try{const s=await j4(t.localStore,e);U_(t,i,null),L_(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await zs(t,s)}catch(s){await Bs(s)}}async function GL(n,e,t){const i=ve(n);try{const s=await(function(l,d){const f=ve(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let _;return f.mutationQueue.lookupMutationBatch(p,d).next((E=>(Ae(E!==null,37113),_=E.keys(),f.mutationQueue.removeMutationBatch(p,E)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,_,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,_))).next((()=>f.localDocuments.getDocuments(p,_)))}))})(i.localStore,e);U_(i,e,t),L_(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await zs(i,s)}catch(s){await Bs(s)}}function L_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function U_(n,e,t){const i=ve(n);let s=i.Vu[i.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),i.Vu[i.currentUser.toKey()]=s}}function Nl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((i=>{n.Ru.containsKey(i)||Lb(n,i)}))}function Lb(n,e){n.Eu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(bl(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),O_(n))}function Ry(n,e,t){for(const i of t)i instanceof Mb?(n.Ru.addReference(i.key,e),zL(n,i)):i instanceof Pb?(ae(Fl,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,e),n.Ru.containsKey(i.key)||Lb(n,i.key)):ye(19791,{wu:i})}function zL(n,e){const t=e.key,i=t.path.canonicalString();n.du.get(t)||n.Eu.has(i)||(ae(Fl,"New document in limbo: "+t),n.Eu.add(i),O_(n))}function O_(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new he(tt.fromString(e)),i=n.fu.next();n.Au.set(i,new PL(t)),n.du=n.du.insert(t,i),cp(n.remoteStore,new Cr(zn(h_(t.path)),i,"TargetPurposeLimboResolution",Nn.ce))}}async function zs(n,e,t){const i=ve(n),s=[],a=[],l=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,f)=>{l.push(i.pu(f,e,t).then((p=>{var _;if((p||t)&&i.isPrimaryClient){const E=p?!p.fromCache:(_=t==null?void 0:t.targetChanges.get(f.targetId))==null?void 0:_.current;i.sharedClientState.updateQueryState(f.targetId,E?"current":"not-current")}if(p){s.push(p);const E=w_.As(f.targetId,p);a.push(E)}})))})),await Promise.all(l),i.Pu.H_(s),await(async function(f,p){const _=ve(f);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>H.forEach(p,(T=>H.forEach(T.Es,(C=>_.persistence.referenceDelegate.addReference(E,T.targetId,C))).next((()=>H.forEach(T.ds,(C=>_.persistence.referenceDelegate.removeReference(E,T.targetId,C)))))))))}catch(E){if(!qs(E))throw E;ae(R_,"Failed to update sequence numbers: "+E)}for(const E of p){const T=E.targetId;if(!E.fromCache){const C=_.Ms.get(T),P=C.snapshotVersion,F=C.withLastLimboFreeSnapshotVersion(P);_.Ms=_.Ms.insert(T,F)}}})(i.localStore,a))}async function HL(n,e){const t=ve(n);if(!t.currentUser.isEqual(e)){ae(Fl,"User change. New user:",e.toKey());const i=await mb(t.localStore,e);t.currentUser=e,(function(a,l){a.mu.forEach((d=>{d.forEach((f=>{f.reject(new ce(ee.CANCELLED,l))}))})),a.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await zs(t,i.Ls)}}function KL(n,e){const t=ve(n),i=t.Au.get(e);if(i&&i.hu)return Oe().add(i.key);{let s=Oe();const a=t.Iu.get(e);if(!a)return s;for(const l of a){const d=t.Tu.get(l);s=s.unionWith(d.view.nu)}return s}}async function JL(n,e){const t=ve(n),i=await Ay(t.localStore,e.query,!0),s=e.view.cu(i);return t.isPrimaryClient&&Ry(t,e.targetId,s.au),s}async function YL(n,e){const t=ve(n);return _b(t.localStore,e).then((i=>zs(t,i)))}async function $L(n,e,t,i){const s=ve(n),a=await(function(d,f){const p=ve(d),_=ve(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(E=>_.er(E,f).next((T=>T?p.localDocuments.getDocuments(E,T):H.resolve(null)))))})(s.localStore,e);a!==null?(t==="pending"?await Ul(s.remoteStore):t==="acknowledged"||t==="rejected"?(U_(s,e,i||null),L_(s,e),(function(d,f){ve(ve(d).mutationQueue).ir(f)})(s.localStore,e)):ye(6720,"Unknown batchState",{Su:t}),await zs(s,a)):ae(Fl,"Cannot apply mutation batch with id: "+e)}async function QL(n,e){const t=ve(n);if(dp(t),F_(t),e===!0&&t.gu!==!0){const i=t.sharedClientState.getAllActiveQueryTargets(),s=await VS(t,i.toArray());t.gu=!0,await Cy(t.remoteStore,!0);for(const a of s)cp(t.remoteStore,a)}else if(e===!1&&t.gu!==!1){const i=[];let s=Promise.resolve();t.Iu.forEach(((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?i.push(l):s=s.then((()=>(Nl(t,l),Rl(t.localStore,l,!0)))),bl(t.remoteStore,l)})),await s,await VS(t,i),(function(l){const d=ve(l);d.Au.forEach(((f,p)=>{bl(d.remoteStore,p)})),d.Ru.Jr(),d.Au=new Map,d.du=new ht(he.comparator)})(t),t.gu=!1,await Cy(t.remoteStore,!1)}}async function VS(n,e,t){const i=ve(n),s=[],a=[];for(const l of e){let d;const f=i.Iu.get(l);if(f&&f.length!==0){d=await kh(i.localStore,zn(f[0]));for(const p of f){const _=i.Tu.get(p),E=await JL(i,_);E.snapshot&&a.push(E.snapshot)}}else{const p=await yb(i.localStore,l);d=await kh(i.localStore,p),await V_(i,Ub(p),l,!1,d.resumeToken)}s.push(d)}return i.Pu.H_(a),s}function Ub(n){return TR(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function XL(n){return(function(t){return ve(ve(t).persistence).Ts()})(ve(n).localStore)}async function WL(n,e,t,i){const s=ve(n);if(s.gu)return void ae(Fl,"Ignoring unexpected query state notification.");const a=s.Iu.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=await _b(s.localStore,IR(a[0])),d=Qc.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Dt.EMPTY_BYTE_STRING);await zs(s,l,d);break}case"rejected":await Rl(s.localStore,e,!0),Nl(s,e,i);break;default:ye(64155,t)}}async function ZL(n,e,t){const i=dp(n);if(i.gu){for(const s of e){if(i.Iu.has(s)&&i.sharedClientState.isActiveQueryTarget(s)){ae(Fl,"Adding an already active target "+s);continue}const a=await yb(i.localStore,s),l=await kh(i.localStore,a);await V_(i,Ub(a),l.targetId,!1,l.resumeToken),cp(i.remoteStore,l)}for(const s of t)i.Iu.has(s)&&await Rl(i.localStore,s,!1).then((()=>{bl(i.remoteStore,s),Nl(i,s)})).catch(Bs)}}function dp(n){const e=ve(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BL.bind(null,e),e.Pu.H_=bL.bind(null,e.eventManager),e.Pu.yu=xL.bind(null,e.eventManager),e}function F_(n){const e=ve(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=GL.bind(null,e),e}class Vc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return pb(this.persistence,new hb,e.initialUser,this.serializer)}Cu(e){return new I_(ap.mi,this.serializer)}Du(e){return new Sb}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Vc.provider={build:()=>new Vc};class jL extends Vc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){Ae(this.persistence.referenceDelegate instanceof Ph,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new ab(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new I_((i=>Ph.mi(i,t)),this.serializer)}}class Ob extends Vc{constructor(e,t,i){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await F_(this.xu.syncEngine),await Ul(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return pb(this.persistence,new hb,e.initialUser,this.serializer)}Fu(e,t){const i=this.persistence.referenceDelegate.garbageCollector;return new ab(i,e.asyncQueue,t)}Mu(e,t){const i=new oV(t,this.persistence);return new sV(e.asyncQueue,i)}Cu(e){const t=fb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new C_(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,Ib(),ah(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Sb}}class eU extends Ob{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Fg&&(this.sharedClientState.syncEngine={Co:$L.bind(null,t),vo:WL.bind(null,t),Fo:ZL.bind(null,t),Ts:XL.bind(null,t),Do:YL.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji((async i=>{await QL(this.xu.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))}Du(e){const t=Ib();if(!Fg.v(t))throw new ce(ee.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=fb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Fg(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class Lc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>kS(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=HL.bind(null,this.syncEngine),await Cy(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new CL})()}createDatastore(e){const t=lp(e.databaseInfo.databaseId),i=(function(a){return new aL(a)})(e.databaseInfo);return(function(a,l,d,f){return new dL(a,l,d,f)})(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,s,a,l,d){return new hL(i,s,a,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>kS(this.syncEngine,t,0)),(function(){return bS.v()?new bS:new iL})())}createSyncEngine(e,t){return(function(s,a,l,d,f,p,_){const E=new kL(s,a,l,d,f,p);return _&&(E.gu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const a=ve(s);ae(Yo,"RemoteStore shutting down."),a.Ea.add(5),await Wc(a),a.Aa.shutdown(),a.Ra.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}Lc.provider={build:()=>new Lc};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Nt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us="FirestoreClient";class nU{constructor(e,t,i,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this.databaseInfo=s,this.user=fn.UNAUTHENTICATED,this.clientId=n_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(i,(async l=>{ae(Us,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(i,(l=>(ae(Us,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=P_(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function qg(n,e){n.asyncQueue.verifyOperationInProgress(),ae(Us,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await mb(e.localStore,s),i=s)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function LS(n,e){n.asyncQueue.verifyOperationInProgress();const t=await iU(n);ae(Us,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>NS(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>NS(e.remoteStore,s))),n._onlineComponents=e}async function iU(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ae(Us,"Using user provided OfflineComponentProvider");try{await qg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===ee.FAILED_PRECONDITION||s.code===ee.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Ac("Error using user provided cache. Falling back to memory cache: "+t),await qg(n,new Vc)}}else ae(Us,"Using default OfflineComponentProvider"),await qg(n,new jL(void 0));return n._offlineComponents}async function Fb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ae(Us,"Using user provided OnlineComponentProvider"),await LS(n,n._uninitializedComponentsProvider._online)):(ae(Us,"Using default OnlineComponentProvider"),await LS(n,new Lc))),n._onlineComponents}function rU(n){return Fb(n).then((e=>e.syncEngine))}async function sU(n){const e=await Fb(n),t=e.eventManager;return t.onListen=VL.bind(null,e.syncEngine),t.onUnlisten=UL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=LL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=OL.bind(null,e.syncEngine),t}function oU(n,e,t={}){const i=new Rr;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,p){const _=new tU({next:T=>{_.Nu(),l.enqueueAndForget((()=>RL(a,E))),T.fromCache&&f.source==="server"?p.reject(new ce(ee.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(T)},error:T=>p.reject(T)}),E=new NL(d,_,{includeMetadataChanges:!0,qa:!0});return wL(a,E)})(await sU(n),n.asyncQueue,e,t,i))),i.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bb(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const US=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aU="firestore.googleapis.com",OS=!0;class FS{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ce(ee.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=aU,this.ssl=OS}else this.host=e.host,this.ssl=e.ssl??OS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=nb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ob)throw new ce(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}nV("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Bb(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ce(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ce(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ce(ee.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class B_{constructor(e,t,i,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(ee.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ce(ee.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Yk;switch(i.type){case"firstParty":return new Xk(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new ce(ee.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=US.get(t);i&&(ae("ComponentProvider","Removing Datastore"),US.delete(t),i.terminate())})(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Xo(this.firestore,e,this._query)}}class Yt{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ps(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yt(this.firestore,e,this._key)}toJSON(){return{type:Yt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Hc(t,Yt._jsonSchema))return new Yt(e,i||null,new he(tt.fromString(t.referencePath)))}}Yt._jsonSchemaVersion="firestore/documentReference/1.0",Yt._jsonSchema={type:Gt("string",Yt._jsonSchemaVersion),referencePath:Gt("string")};class Ps extends Xo{constructor(e,t,i){super(e,t,h_(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yt(this.firestore,null,new he(e))}withConverter(e){return new Ps(this.firestore,e,this._path)}}function lU(n,e,...t){if(n=zt(n),Bw("collection","path",e),n instanceof B_){const i=tt.fromString(e,...t);return xA(i),new Ps(n,null,i)}{if(!(n instanceof Yt||n instanceof Ps))throw new ce(ee.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(tt.fromString(e,...t));return xA(i),new Ps(n.firestore,null,i)}}function fp(n,e,...t){if(n=zt(n),arguments.length===1&&(e=n_.newId()),Bw("doc","path",e),n instanceof B_){const i=tt.fromString(e,...t);return bA(i),new Yt(n,null,new he(i))}{if(!(n instanceof Yt||n instanceof Ps))throw new ce(ee.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(tt.fromString(e,...t));return bA(i),new Yt(n.firestore,n instanceof Ps?n.converter:null,new he(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BS="AsyncQueue";class qS{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Cb(this,"async_queue_retry"),this._c=()=>{const i=ah();i&&ae(BS,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=ah();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=ah();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new Rr;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!qs(e))throw e;ae(BS,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Nt("INTERNAL UNHANDLED ERROR: ",GS(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const s=M_.createAndSchedule(this,e,t,i,(a=>this.hc(a)));return this.tc.push(s),s}uc(){this.nc&&ye(47125,{Pc:GS(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function GS(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class Zc extends B_{constructor(e,t,i,s){super(e,t,i,s),this.type="firestore",this._queue=new qS,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qS(e),this._firestoreClient=void 0,await e}}}function uU(n,e,t){t||(t=Ch);const i=Jy(n,"firestore");if(i.isInitialized(t)){const s=i.getImmediate({identifier:t}),a=i.getOptions(t);if(Uo(a,e))return s;throw new ce(ee.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ce(ee.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ob)throw new ce(ee.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Dl(e.host)&&GC(e.host),i.initialize({options:e,instanceIdentifier:t})}function q_(n){if(n._terminated)throw new ce(ee.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||cU(n),n._firestoreClient}function cU(n){var i,s,a;const e=n._freezeSettings(),t=(function(d,f,p,_){return new kV(d,f,p,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,Bb(_.experimentalLongPollingOptions),_.useFetchStreams,_.isUsingEmulator)})(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,e);n._componentsProvider||(s=e.localCache)!=null&&s._offlineComponentProvider&&((a=e.localCache)!=null&&a._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new nU(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(d){const f=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(f),_online:f}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this._byteString=e}static fromBase64String(e){try{return new si(Dt.fromBase64String(e))}catch(t){throw new ce(ee.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new si(Dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:si._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Hc(e,si._jsonSchema))return si.fromBase64String(e.bytes)}}si._jsonSchemaVersion="firestore/bytes/1.0",si._jsonSchema={type:Gt("string",si._jsonSchemaVersion),bytes:Gt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ce(ee.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ce(ee.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ce(ee.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:tr._jsonSchemaVersion}}static fromJSON(e){if(Hc(e,tr._jsonSchema))return new tr(e.latitude,e.longitude)}}tr._jsonSchemaVersion="firestore/geoPoint/1.0",tr._jsonSchema={type:Gt("string",tr._jsonSchemaVersion),latitude:Gt("number"),longitude:Gt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,s){if(i.length!==s.length)return!1;for(let a=0;a<i.length;++a)if(i[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:nr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Hc(e,nr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new nr(e.vectorValues);throw new ce(ee.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}nr._jsonSchemaVersion="firestore/vectorValue/1.0",nr._jsonSchema={type:Gt("string",nr._jsonSchemaVersion),vectorValues:Gt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dU=/^__.*__$/;class fU{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new Lr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ll(e,this.data,t,this.fieldTransforms)}}class qb{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new Lr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Gb(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ye(40011,{Ac:n})}}class z_{constructor(e,t,i,s,a,l){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=s,a===void 0&&this.Rc(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new z_({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),i=this.Vc({path:t,fc:!1});return i.gc(e),i}yc(e){var s;const t=(s=this.path)==null?void 0:s.child(e),i=this.Vc({path:t,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Oh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(Gb(this.Ac)&&dU.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hU{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||lp(e)}Cc(e,t,i,s=!1){return new z_({Ac:e,methodName:t,Dc:i,path:Et.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function H_(n){const e=n._freezeSettings(),t=lp(n._databaseId);return new hU(n._databaseId,!!e.ignoreUndefinedProperties,t)}function zb(n,e,t,i,s,a={}){const l=n.Cc(a.merge||a.mergeFields?2:0,e,t,s);K_("Data must be an object, but it was:",l,i);const d=Hb(i,l);let f,p;if(a.merge)f=new Dn(l.fieldMask),p=l.fieldTransforms;else if(a.mergeFields){const _=[];for(const E of a.mergeFields){const T=by(e,E,t);if(!l.contains(T))throw new ce(ee.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Jb(_,T)||_.push(T)}f=new Dn(_),p=l.fieldTransforms.filter((E=>f.covers(E.field)))}else f=null,p=l.fieldTransforms;return new fU(new pn(d),f,p)}class pp extends G_{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pp}}function pU(n,e,t,i){const s=n.Cc(1,e,t);K_("Data must be an object, but it was:",s,i);const a=[],l=pn.empty();Gs(i,((f,p)=>{const _=J_(e,f,t);p=zt(p);const E=s.yc(_);if(p instanceof pp)a.push(_);else{const T=jc(p,E);T!=null&&(a.push(_),l.set(_,T))}}));const d=new Dn(a);return new qb(l,d,s.fieldTransforms)}function mU(n,e,t,i,s,a){const l=n.Cc(1,e,t),d=[by(e,i,t)],f=[s];if(a.length%2!=0)throw new ce(ee.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<a.length;T+=2)d.push(by(e,a[T])),f.push(a[T+1]);const p=[],_=pn.empty();for(let T=d.length-1;T>=0;--T)if(!Jb(p,d[T])){const C=d[T];let P=f[T];P=zt(P);const F=l.yc(C);if(P instanceof pp)p.push(C);else{const V=jc(P,F);V!=null&&(p.push(C),_.set(C,V))}}const E=new Dn(p);return new qb(_,E,l.fieldTransforms)}function gU(n,e,t,i=!1){return jc(t,n.Cc(i?4:3,e))}function jc(n,e){if(Kb(n=zt(n)))return K_("Unsupported field value:",e,n),Hb(n,e);if(n instanceof G_)return(function(i,s){if(!Gb(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const a=i._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,s){const a=[];let l=0;for(const d of i){let f=jc(d,s.wc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(i,s){if((i=zt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return WV(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const a=st.fromDate(i);return{timestampValue:wl(s.serializer,a)}}if(i instanceof st){const a=new st(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:wl(s.serializer,a)}}if(i instanceof tr)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof si)return{bytesValue:BR(s.serializer,i._byteString)};if(i instanceof Yt){const a=s.databaseId,l=i.firestore._databaseId;if(!l.isEqual(a))throw s.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:E_(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof nr)return(function(l,d){return{mapValue:{fields:{[c_]:{stringValue:d_},[El]:{arrayValue:{values:l.toArray().map((p=>{if(typeof p!="number")throw d.Sc("VectorValues must only contain numeric values.");return m_(d.serializer,p)}))}}}}}})(i,s);throw s.Sc(`Unsupported field value: ${$h(i)}`)})(n,e)}function Hb(n,e){const t={};return rR(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Gs(n,((i,s)=>{const a=jc(s,e.mc(i));a!=null&&(t[i]=a)})),{mapValue:{fields:t}}}function Kb(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof st||n instanceof tr||n instanceof si||n instanceof Yt||n instanceof G_||n instanceof nr)}function K_(n,e,t){if(!Kb(t)||!qw(t)){const i=$h(t);throw i==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+i)}}function by(n,e,t){if((e=zt(e))instanceof hp)return e._internalPath;if(typeof e=="string")return J_(n,e);throw Oh("Field path arguments must be of type string or ",n,!1,void 0,t)}const yU=new RegExp("[~\\*/\\[\\]]");function J_(n,e,t){if(e.search(yU)>=0)throw Oh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new hp(...e.split("."))._internalPath}catch{throw Oh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Oh(n,e,t,i,s){const a=i&&!i.isEmpty(),l=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${i}`),l&&(f+=` in document ${s}`),f+=")"),new ce(ee.INVALID_ARGUMENT,d+n+f)}function Jb(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{constructor(e,t,i,s,a){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new _U(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Y_("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class _U extends Yb{data(){return super.data()}}function Y_(n,e){return typeof e=="string"?J_(n,e):e instanceof hp?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vU(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ce(ee.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $_{}class $b extends $_{}function EU(n,e,...t){let i=[];e instanceof $_&&i.push(e),i=i.concat(t),(function(a){const l=a.filter((f=>f instanceof X_)).length,d=a.filter((f=>f instanceof Q_)).length;if(l>1||l>0&&d>0)throw new ce(ee.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class Q_ extends $b{constructor(e,t,i){super(),this._field=e,this._op=t,this._value=i,this.type="where"}static _create(e,t,i){return new Q_(e,t,i)}_apply(e){const t=this._parse(e);return Qb(e._query,t),new Xo(e.firestore,e.converter,hy(e._query,t))}_parse(e){const t=H_(e.firestore);return(function(a,l,d,f,p,_,E){let T;if(p.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new ce(ee.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){HS(E,_);const P=[];for(const F of E)P.push(zS(f,a,F));T={arrayValue:{values:P}}}else T=zS(f,a,E)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||HS(E,_),T=gU(d,l,E,_==="in"||_==="not-in");return He.create(p,_,T)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class X_ extends $_{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new X_(e,t)}_parse(e){const t=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return t.length===1?t[0]:ot.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const d=a.getFlattenedFilters();for(const f of d)Qb(l,f),l=hy(l,f)})(e._query,t),new Xo(e.firestore,e.converter,hy(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class W_ extends $b{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new W_(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new ce(ee.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ce(ee.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Mc(a,l)})(e._query,this._field,this._direction);return new Xo(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new Vl(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function TU(n,e="asc"){const t=e,i=Y_("orderBy",n);return W_._create(i,t)}function zS(n,e,t){if(typeof(t=zt(t))=="string"){if(t==="")throw new ce(ee.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!AR(e)&&t.indexOf("/")!==-1)throw new ce(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(tt.fromString(t));if(!he.isDocumentKey(i))throw new ce(ee.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return Nc(n,new he(i))}if(t instanceof Yt)return Nc(n,t._key);throw new ce(ee.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$h(t)}.`)}function HS(n,e){if(!Array.isArray(n)||n.length===0)throw new ce(ee.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Qb(n,e){const t=(function(s,a){for(const l of s)for(const d of l.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ce(ee.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ce(ee.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class AU{convertValue(e,t="none"){switch(ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Dr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return Gs(e,((s,a)=>{i[s]=this.convertValue(a,t)})),i}convertVectorValue(e){var i,s,a;const t=(a=(s=(i=e.fields)==null?void 0:i[El].arrayValue)==null?void 0:s.values)==null?void 0:a.map((l=>vt(l.doubleValue)));return new nr(t)}convertGeoPoint(e){return new tr(vt(e.latitude),vt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=ep(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(bc(e));default:return null}}convertTimestamp(e){const t=Nr(e);return new st(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=tt.fromString(e);Ae(XR(i),9688,{name:e});const s=new Go(i.get(1),i.get(3)),a=new he(i.popFirst(5));return s.isEqual(t)||Nt(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Bf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class al extends Yb{constructor(e,t,i,s,a,l){super(e,t,i,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new lh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Y_("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(ee.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=al._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}al._jsonSchemaVersion="firestore/documentSnapshot/1.0",al._jsonSchema={type:Gt("string",al._jsonSchemaVersion),bundleSource:Gt("string","DocumentSnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class lh extends al{data(e={}){return super.data(e)}}class ll{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Bf(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new lh(this._firestore,this._userDataWriter,i.key,i,new Bf(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ce(ee.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((d=>{const f=new lh(s._firestore,s._userDataWriter,d.doc.key,d.doc,new Bf(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new lh(s._firestore,s._userDataWriter,d.doc.key,d.doc,new Bf(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,_=-1;return d.type!==0&&(p=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),_=l.indexOf(d.doc.key)),{type:SU(d.type),doc:f,oldIndex:p,newIndex:_}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ce(ee.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ll._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=n_.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),i.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function SU(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ye(61501,{type:n})}}ll._jsonSchemaVersion="firestore/querySnapshot/1.0",ll._jsonSchema={type:Gt("string",ll._jsonSchemaVersion),bundleSource:Gt("string","QuerySnapshot"),bundleName:Gt("string"),bundle:Gt("string")};class IU extends AU{constructor(e){super(),this.firestore=e}convertBytes(e){return new si(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Yt(this.firestore,null,t)}}function CU(n){n=pl(n,Xo);const e=pl(n.firestore,Zc),t=q_(e),i=new IU(e);return vU(n._query),oU(t,n._query).then((s=>new ll(e,i,n,s)))}function wU(n,e,t){n=pl(n,Yt);const i=pl(n.firestore,Zc),s=Xb(n.converter,e,t);return Z_(i,[zb(H_(i),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,un.none())])}function RU(n){return Z_(pl(n.firestore,Zc),[new $c(n._key,un.none())])}function Z_(n,e){return(function(i,s){const a=new Rr;return i.asyncQueue.enqueueAndForget((async()=>FL(await rU(i),s,a))),a.promise})(q_(n),e)}class bU{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=MU(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function xU(n){return new bU(n)}class NU{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Lc.provider,this._offlineComponentProvider={build:t=>new Ob(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class DU{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Lc.provider,this._offlineComponentProvider={build:t=>new eU(t,e==null?void 0:e.cacheSizeBytes)}}}function MU(n){return new NU(n==null?void 0:n.forceOwnership)}function PU(){return new DU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=H_(e)}set(e,t,i){this._verifyNotCommitted();const s=Gg(e,this._firestore),a=Xb(s.converter,t,i),l=zb(this._dataReader,"WriteBatch.set",s._key,a,s.converter!==null,i);return this._mutations.push(l.toMutation(s._key,un.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const a=Gg(e,this._firestore);let l;return l=typeof(t=zt(t))=="string"||t instanceof hp?mU(this._dataReader,"WriteBatch.update",a._key,t,i,s):pU(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,un.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Gg(e,this._firestore);return this._mutations=this._mutations.concat(new $c(t._key,un.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ce(ee.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Gg(n,e){if((n=zt(n)).firestore!==e)throw new ce(ee.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wb(n){return q_(n=pl(n,Zc)),new kU(n,(e=>Z_(n,e)))}(function(e,t=!0){(function(s){kl=s})(Ml),dl(new Oo("firestore",((i,{instanceIdentifier:s,options:a})=>{const l=i.getProvider("app").getImmediate(),d=new Zc(new $k(i.getProvider("auth-internal")),new Wk(l,i.getProvider("app-check-internal")),(function(p,_){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new ce(ee.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Go(p.options.projectId,_)})(l,s),l);return a={useFetchStreams:t,...a},d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),Ns(IA,CA,e),Ns(IA,CA,"esm2020")})();const VU={apiKey:"AIzaSyDAbQWI8JJJZxi4u2m3CpXoVXo_tfV9idQ",authDomain:"spanish-reading-7f2f6.firebaseapp.com",projectId:"spanish-reading-7f2f6",storageBucket:"spanish-reading-7f2f6.firebasestorage.app",messagingSenderId:"199552752380",appId:"1:199552752380:web:7f00e4d764d4cefcde5579",measurementId:"G-B41M23QF87"},Zb=QC(VU),oi=Hk(Zb),ed=uU(Zb,{ignoreUndefinedProperties:!0,localCache:xU({tabManager:PU()})}),LU=({currentView:n,onChangeView:e,children:t,theme:i,onToggleTheme:s,isGuest:a,onLogoutGuest:l})=>{var p,_,E;const d=async()=>{if(window.confirm("Mchten Sie sich wirklich abmelden?"))if(a)l==null||l();else try{await PP(oi)}catch(T){console.error("Logout failed:",T)}},f=a?"Gast":((p=oi.currentUser)==null?void 0:p.displayName)||((E=(_=oi.currentUser)==null?void 0:_.email)==null?void 0:E.split("@")[0]);return R.jsxs("div",{className:"min-h-screen flex flex-col bg-[#FDFBF7] dark:bg-[#12100E]",children:[R.jsx("header",{className:"bg-[#FDFBF7]/90 dark:bg-[#12100E]/90 backdrop-blur-xl border-b border-[#EAE2D6] dark:border-[#2C2420] sticky top-0 z-50 transition-colors",children:R.jsxs("div",{className:"max-w-6xl mx-auto px-6 h-20 flex justify-between items-center",children:[R.jsxs("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:()=>e(St.HOME),children:[R.jsx("div",{className:"bg-[#2C2420] dark:bg-[#D4A373] p-2 rounded-xl text-[#FDFBF7] dark:text-[#12100E] shadow-md group-hover:bg-[#B26B4A] dark:group-hover:bg-[#B26B4A] transition-colors duration-500",children:R.jsx(Kg,{className:"w-4 h-4"})}),R.jsxs("div",{className:"hidden sm:block",children:[R.jsx("h1",{className:"text-lg font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] tracking-tight",children:"Leseassistent"}),R.jsx("p",{className:"text-[8px] font-bold text-[#6B705C] dark:text-[#A5A58D] uppercase tracking-[0.2em] -mt-1 opacity-60",children:"Tu compaero"})]})]}),R.jsxs("nav",{className:"flex items-center bg-[#2C2420]/5 dark:bg-white/5 p-1.5 rounded-2xl border border-[#2C2420]/5 dark:border-white/5 mx-2",children:[R.jsxs("button",{onClick:()=>e(St.HOME),className:`flex items-center gap-2 py-2 px-4 rounded-xl transition-all duration-300 ${n===St.HOME?"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm":"text-[#6B705C] dark:text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7]"}`,children:[R.jsx(Kg,{className:"w-4 h-4"}),R.jsx("span",{className:"hidden md:inline text-[10px] font-bold uppercase tracking-wider",children:"Lesen"})]}),R.jsxs("button",{onClick:()=>e(St.ANALYZE),className:`flex items-center gap-2 py-2 px-4 rounded-xl transition-all duration-300 ${n===St.ANALYZE?"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm":"text-[#6B705C] dark:text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7]"}`,children:[R.jsx(xC,{className:"w-4 h-4"}),R.jsx("span",{className:"hidden md:inline text-[10px] font-bold uppercase tracking-wider",children:"Scan"})]}),R.jsxs("button",{onClick:()=>e(St.VOCAB),className:`flex items-center gap-2 py-2 px-4 rounded-xl transition-all duration-300 ${n===St.VOCAB?"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm":"text-[#6B705C] dark:text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7]"}`,children:[R.jsx(bC,{className:"w-4 h-4"}),R.jsx("span",{className:"hidden md:inline text-[10px] font-bold uppercase tracking-wider",children:"Lernen"})]})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsxs("div",{className:"hidden lg:flex items-center gap-2 px-3 py-1.5 bg-[#FDFBF7] dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] rounded-xl mr-2",children:[R.jsx(kC,{className:"w-3.5 h-3.5 text-[#B26B4A] dark:text-[#D4A373]"}),R.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-[#6B705C] dark:text-[#A5A58D]",children:f})]}),R.jsx("button",{onClick:s,className:"p-2.5 rounded-xl bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#6B705C] dark:text-[#A5A58D] hover:text-[#B26B4A] dark:hover:text-[#D4A373] transition-all",title:"Design ndern",children:i==="dark"?R.jsx(FD,{className:"w-4 h-4"}):R.jsx(RD,{className:"w-4 h-4"})}),R.jsx("button",{onClick:()=>e(St.SETTINGS),className:`p-2.5 rounded-xl transition-colors shadow-sm ${n===St.SETTINGS?"bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E]":"bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#6B705C] dark:text-[#A5A58D] hover:text-[#B26B4A] dark:hover:text-[#D4A373]"}`,title:"Einstellungen",children:R.jsx(NC,{className:"w-4 h-4"})}),R.jsx("button",{onClick:d,className:"p-2.5 rounded-xl bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#6B705C] dark:text-[#A5A58D] hover:text-red-500 transition-all",title:"Abmelden",children:R.jsx(SD,{className:"w-4 h-4"})})]})]})}),R.jsx("main",{className:`flex-grow p-6 w-full mx-auto ${n===St.ANALYZE?"max-w-6xl":"max-w-4xl"} transition-colors`,children:t})]})};var UU={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let OU,FU;function BU(){return{geminiUrl:OU,vertexUrl:FU}}function qU(n,e,t,i){var s,a;if(!(n!=null&&n.baseUrl)){const l=BU();return e?(s=l.vertexUrl)!==null&&s!==void 0?s:t:(a=l.geminiUrl)!==null&&a!==void 0?a:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ur{}function me(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function m(n,e,t){for(let a=0;a<e.length-1;a++){const l=e[a];if(l.endsWith("[]")){const d=l.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(n[d])){const f=n[d];if(Array.isArray(t))for(let p=0;p<f.length;p++){const _=f[p];m(_,e.slice(a+1),t[p])}else for(const p of f)m(p,e.slice(a+1),t)}return}else if(l.endsWith("[0]")){const d=l.slice(0,-3);d in n||(n[d]=[{}]);const f=n[d];m(f[0],e.slice(a+1),t);return}(!n[l]||typeof n[l]!="object")&&(n[l]={}),n=n[l]}const i=e[e.length-1],s=n[i];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function h(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const s=e[i];if(s.endsWith("[]")){const a=s.slice(0,-2);if(a in n){const l=n[a];return Array.isArray(l)?l.map(d=>h(d,e.slice(i+1),t)):t}else return t}else n=n[s]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function GU(n,e){for(const[t,i]of Object.entries(e)){const s=t.split("."),a=i.split("."),l=new Set;let d=-1;for(let f=0;f<s.length;f++)if(s[f]==="*"){d=f;break}if(d!==-1&&a.length>d)for(let f=d;f<a.length;f++){const p=a[f];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&l.add(p)}xy(n,s,a,0,l)}}function xy(n,e,t,i,s){if(i>=e.length||typeof n!="object"||n===null)return;const a=e[i];if(a.endsWith("[]")){const l=a.slice(0,-2),d=n;if(l in d&&Array.isArray(d[l]))for(const f of d[l])xy(f,e,t,i+1,s)}else if(a==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const l=n,d=Object.keys(l).filter(p=>!p.startsWith("_")&&!s.has(p)),f={};for(const p of d)f[p]=l[p];for(const[p,_]of Object.entries(f)){const E=[];for(const T of t.slice(i))T==="*"?E.push(p):E.push(T);m(l,E,_)}for(const p of d)delete l[p]}}else{const l=n;a in l&&xy(l[a],e,t,i+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function j_(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zU(n){const e={},t=h(n,["operationName"]);t!=null&&m(e,["operationName"],t);const i=h(n,["resourceName"]);return i!=null&&m(e,["_url","resourceName"],i),e}function HU(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],JU(l)),e}function KU(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],YU(l)),e}function JU(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>$U(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const s=h(n,["raiMediaFilteredReasons"]);return s!=null&&m(e,["raiMediaFilteredReasons"],s),e}function YU(n){const e={},t=h(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>QU(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const s=h(n,["raiMediaFilteredReasons"]);return s!=null&&m(e,["raiMediaFilteredReasons"],s),e}function $U(n){const e={},t=h(n,["video"]);return t!=null&&m(e,["video"],tO(t)),e}function QU(n){const e={},t=h(n,["_self"]);return t!=null&&m(e,["video"],nO(t)),e}function XU(n){const e={},t=h(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function WU(n){const e={},t=h(n,["operationName"]);return t!=null&&m(e,["_url","operationName"],t),e}function ZU(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],jU(l)),e}function jU(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const s=h(n,["documentName"]);return s!=null&&m(e,["documentName"],s),e}function jb(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],eO(l)),e}function eO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const s=h(n,["documentName"]);return s!=null&&m(e,["documentName"],s),e}function tO(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["encodedVideo"]);i!=null&&m(e,["videoBytes"],j_(i));const s=h(n,["encoding"]);return s!=null&&m(e,["mimeType"],s),e}function nO(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["videoBytes"],j_(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var KS;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(KS||(KS={}));var JS;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(JS||(JS={}));var YS;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(YS||(YS={}));var xt;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(xt||(xt={}));var $S;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})($S||($S={}));var QS;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(QS||(QS={}));var XS;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(XS||(XS={}));var WS;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(WS||(WS={}));var ZS;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(ZS||(ZS={}));var jS;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(jS||(jS={}));var eI;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(eI||(eI={}));var tI;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(tI||(tI={}));var nI;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(nI||(nI={}));var iI;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(iI||(iI={}));var rI;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(rI||(rI={}));var sI;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(sI||(sI={}));var oI;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(oI||(oI={}));var aI;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(aI||(aI={}));var lI;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(lI||(lI={}));var Uc;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(Uc||(Uc={}));var uI;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(uI||(uI={}));var cI;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(cI||(cI={}));var dI;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(dI||(dI={}));var Ny;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Ny||(Ny={}));var fI;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(fI||(fI={}));var hI;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(hI||(hI={}));var pI;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(pI||(pI={}));var mI;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(mI||(mI={}));var gI;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(gI||(gI={}));var yI;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(yI||(yI={}));var _I;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(_I||(_I={}));var vI;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(vI||(vI={}));var EI;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(EI||(EI={}));var TI;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(TI||(TI={}));var AI;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(AI||(AI={}));var SI;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(SI||(SI={}));var II;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(II||(II={}));var CI;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(CI||(CI={}));var wI;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(wI||(wI={}));var RI;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(RI||(RI={}));var bI;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(bI||(bI={}));var xI;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(xI||(xI={}));var NI;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(NI||(NI={}));var DI;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(DI||(DI={}));var MI;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(MI||(MI={}));var PI;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(PI||(PI={}));var kI;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(kI||(kI={}));var VI;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(VI||(VI={}));var LI;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(LI||(LI={}));var UI;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(UI||(UI={}));var OI;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(OI||(OI={}));var FI;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(FI||(FI={}));var BI;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(BI||(BI={}));var qI;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(qI||(qI={}));var GI;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(GI||(GI={}));var tl;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(tl||(tl={}));class Dy{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class ec{get text(){var e,t,i,s,a,l,d,f;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",_=!1;const E=[];for(const T of(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[C,P]of Object.entries(T))C!=="text"&&C!=="thought"&&C!=="thoughtSignature"&&(P!==null||P!==void 0)&&E.push(C);if(typeof T.text=="string"){if(typeof T.thought=="boolean"&&T.thought)continue;_=!0,p+=T.text}}return E.length>0&&console.warn(`there are non-text parts ${E} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),_?p:void 0}get data(){var e,t,i,s,a,l,d,f;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const _=[];for(const E of(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)!==null&&f!==void 0?f:[]){for(const[T,C]of Object.entries(E))T!=="inlineData"&&(C!==null||C!==void 0)&&_.push(T);E.inlineData&&typeof E.inlineData.data=="string"&&(p+=atob(E.inlineData.data))}return _.length>0&&console.warn(`there are non-data parts ${_} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,i,s,a,l,d,f;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(_=>_.functionCall).map(_=>_.functionCall).filter(_=>_!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,i,s,a,l,d,f,p;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const _=(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(E=>E.executableCode).map(E=>E.executableCode).filter(E=>E!==void 0);if((_==null?void 0:_.length)!==0)return(p=_==null?void 0:_[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,i,s,a,l,d,f,p;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const _=(f=(d=(l=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content)===null||d===void 0?void 0:d.parts)===null||f===void 0?void 0:f.filter(E=>E.codeExecutionResult).map(E=>E.codeExecutionResult).filter(E=>E!==void 0);if((_==null?void 0:_.length)!==0)return(p=_==null?void 0:_[0])===null||p===void 0?void 0:p.output}}class zI{}class HI{}class iO{}class rO{}class sO{}class oO{}class KI{}class JI{}class YI{}class aO{}class Fh{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Fh;let s;const a=e;return t?s=KU(a):s=HU(a),Object.assign(i,s),i}}class $I{}class QI{}class XI{}class WI{}class lO{}class uO{}class cO{}class ev{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new ev,a=ZU(e);return Object.assign(i,a),i}}class dO{}class fO{}class hO{}class ZI{}class pO{get text(){var e,t,i;let s="",a=!1;const l=[];for(const d of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[f,p]of Object.entries(d))f!=="text"&&f!=="thought"&&p!==null&&l.push(f);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;a=!0,s+=d.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,i;let s="";const a=[];for(const l of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,f]of Object.entries(l))d!=="inlineData"&&f!==null&&a.push(d);l.inlineData&&typeof l.inlineData.data=="string"&&(s+=atob(l.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class mO{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class tv{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new tv,a=jb(e);return Object.assign(i,a),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ze(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function ex(n,e){const t=Ze(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function tx(n){return Array.isArray(n)?n.map(e=>Bh(e)):[Bh(n)]}function Bh(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function nx(n){const e=Bh(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function ix(n){const e=Bh(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function jI(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function rx(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>jI(e)):[jI(n)]}function My(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function eC(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function tC(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function mn(n){if(n==null)throw new Error("ContentUnion is required");return My(n)?n:{role:"user",parts:rx(n)}}function nv(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=mn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=mn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>mn(t)):[mn(e)]}function ai(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(eC(n)||tC(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[mn(n)]}const e=[],t=[],i=My(n[0]);for(const s of n){const a=My(s);if(a!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)e.push(s);else{if(eC(s)||tC(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return i||e.push({role:"user",parts:rx(t)}),e}function gO(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(xt).includes(t[0].toUpperCase())?t[0].toUpperCase():xt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(xt).includes(i.toUpperCase())?i.toUpperCase():xt.TYPE_UNSPECIFIED})}}function ul(n){const e={},t=["items"],i=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&gO(n.type,e);for(const[l,d]of Object.entries(n))if(d!=null)if(l=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(xt).includes(d.toUpperCase())?d.toUpperCase():xt.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=ul(d);else if(i.includes(l)){const f=[];for(const p of d){if(p.type=="null"){e.nullable=!0;continue}f.push(ul(p))}e[l]=f}else if(s.includes(l)){const f={};for(const[p,_]of Object.entries(d))f[p]=ul(_);e[l]=f}else{if(l==="additionalProperties")continue;e[l]=d}return e}function iv(n){return ul(n)}function rv(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function sv(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Bl(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=ul(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=ul(e.response));return n}function ql(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function yO(n,e,t,i=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Or(n,e){if(typeof e!="string")throw new Error("name must be a string");return yO(n,e,"cachedContents")}function sx(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Hs(n){return j_(n)}function _O(n){return n!=null&&typeof n=="object"&&"name"in n}function vO(n){return n!=null&&typeof n=="object"&&"video"in n}function EO(n){return n!=null&&typeof n=="object"&&"uri"in n}function ox(n){var e;let t;if(_O(n)&&(t=n.name),!(EO(n)&&(t=n.uri,t===void 0))&&!(vO(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function ax(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function lx(n){for(const e of["models","tunedModels","publisherModels"])if(TO(n,e))return n[e];return[]}function TO(n,e){return n!==null&&typeof n=="object"&&e in n}function AO(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function SO(n,e={}){const t=[],i=new Set;for(const s of n){const a=s.name;if(i.has(a))throw new Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);i.add(a);const l=AO(s,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function ux(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(s>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function IO(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function cx(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return n;let a=!1;for(const l of s){if(typeof l!="object"||l===null)continue;const f=l.response;if(typeof f!="object"||f===null)continue;if(f.embedding!==void 0){a=!0;break}}return a&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Gl(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function dx(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function CO(n){const e={},t=h(n,["responsesFile"]);t!=null&&m(e,["fileName"],t);const i=h(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>s6(l))),m(e,["inlinedResponses"],a)}const s=h(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["inlinedEmbedContentResponses"],a)}return e}function wO(n){const e={},t=h(n,["predictionsFormat"]);t!=null&&m(e,["format"],t);const i=h(n,["gcsDestination","outputUriPrefix"]);i!=null&&m(e,["gcsUri"],i);const s=h(n,["bigqueryDestination","outputUri"]);return s!=null&&m(e,["bigqueryUri"],s),e}function RO(n){const e={},t=h(n,["format"]);t!=null&&m(e,["predictionsFormat"],t);const i=h(n,["gcsUri"]);i!=null&&m(e,["gcsDestination","outputUriPrefix"],i);const s=h(n,["bigqueryUri"]);if(s!=null&&m(e,["bigqueryDestination","outputUri"],s),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(h(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function uh(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata","displayName"]);i!=null&&m(e,["displayName"],i);const s=h(n,["metadata","state"]);s!=null&&m(e,["state"],dx(s));const a=h(n,["metadata","createTime"]);a!=null&&m(e,["createTime"],a);const l=h(n,["metadata","endTime"]);l!=null&&m(e,["endTime"],l);const d=h(n,["metadata","updateTime"]);d!=null&&m(e,["updateTime"],d);const f=h(n,["metadata","model"]);f!=null&&m(e,["model"],f);const p=h(n,["metadata","output"]);return p!=null&&m(e,["dest"],CO(cx(p))),e}function Py(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const s=h(n,["state"]);s!=null&&m(e,["state"],dx(s));const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["createTime"]);l!=null&&m(e,["createTime"],l);const d=h(n,["startTime"]);d!=null&&m(e,["startTime"],d);const f=h(n,["endTime"]);f!=null&&m(e,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(e,["updateTime"],p);const _=h(n,["model"]);_!=null&&m(e,["model"],_);const E=h(n,["inputConfig"]);E!=null&&m(e,["src"],bO(E));const T=h(n,["outputConfig"]);T!=null&&m(e,["dest"],wO(cx(T)));const C=h(n,["completionStats"]);return C!=null&&m(e,["completionStats"],C),e}function bO(n){const e={},t=h(n,["instancesFormat"]);t!=null&&m(e,["format"],t);const i=h(n,["gcsSource","uris"]);i!=null&&m(e,["gcsUri"],i);const s=h(n,["bigquerySource","inputUri"]);return s!=null&&m(e,["bigqueryUri"],s),e}function xO(n,e){const t={};if(h(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(h(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=h(e,["fileName"]);i!=null&&m(t,["fileName"],i);const s=h(e,["inlinedRequests"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>r6(n,l))),m(t,["requests","requests"],a)}return t}function NO(n){const e={},t=h(n,["format"]);t!=null&&m(e,["instancesFormat"],t);const i=h(n,["gcsUri"]);i!=null&&m(e,["gcsSource","uris"],i);const s=h(n,["bigqueryUri"]);if(s!=null&&m(e,["bigquerySource","inputUri"],s),h(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(h(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function DO(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function MO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Gl(n,i)),t}function PO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Gl(n,i)),t}function kO(n){const e={},t=h(n,["content"]);t!=null&&m(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&m(e,["citationMetadata"],VO(i));const s=h(n,["tokenCount"]);s!=null&&m(e,["tokenCount"],s);const a=h(n,["finishReason"]);a!=null&&m(e,["finishReason"],a);const l=h(n,["avgLogprobs"]);l!=null&&m(e,["avgLogprobs"],l);const d=h(n,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(n,["index"]);f!=null&&m(e,["index"],f);const p=h(n,["logprobsResult"]);p!=null&&m(e,["logprobsResult"],p);const _=h(n,["safetyRatings"]);if(_!=null){let T=_;Array.isArray(T)&&(T=T.map(C=>C)),m(e,["safetyRatings"],T)}const E=h(n,["urlContextMetadata"]);return E!=null&&m(e,["urlContextMetadata"],E),e}function VO(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),m(e,["citations"],i)}return e}function fx(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>f6(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function LO(n,e){const t={},i=h(n,["displayName"]);if(e!==void 0&&i!=null&&m(e,["batch","displayName"],i),h(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function UO(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const s=h(n,["dest"]);return e!==void 0&&s!=null&&m(e,["outputConfig"],RO(IO(s))),t}function nC(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["src"]);s!=null&&m(t,["batch","inputConfig"],xO(n,ux(n,s)));const a=h(e,["config"]);return a!=null&&LO(a,t),t}function OO(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],Ze(n,i));const s=h(e,["src"]);s!=null&&m(t,["inputConfig"],NO(ux(n,s)));const a=h(e,["config"]);return a!=null&&UO(a,t),t}function FO(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&m(e,["batch","displayName"],i),t}function BO(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["src"]);s!=null&&m(t,["batch","inputConfig"],YO(n,s));const a=h(e,["config"]);return a!=null&&FO(a,t),t}function qO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Gl(n,i)),t}function GO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Gl(n,i)),t}function zO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);return a!=null&&m(e,["error"],a),e}function HO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);return a!=null&&m(e,["error"],a),e}function KO(n,e){const t={},i=h(e,["contents"]);if(i!=null){let a=nv(n,i);Array.isArray(a)&&(a=a.map(l=>l)),m(t,["requests[]","request","content"],a)}const s=h(e,["config"]);return s!=null&&(m(t,["_self"],JO(s,t)),GU(t,{"requests[].*":"requests[].request.*"})),t}function JO(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["requests[]","taskType"],i);const s=h(n,["title"]);e!==void 0&&s!=null&&m(e,["requests[]","title"],s);const a=h(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&m(e,["requests[]","outputDimensionality"],a),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function YO(n,e){const t={},i=h(e,["fileName"]);i!=null&&m(t,["file_name"],i);const s=h(e,["inlinedRequests"]);return s!=null&&m(t,["requests"],KO(n,s)),t}function $O(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function QO(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function XO(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function WO(n,e,t){const i={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&m(t,["systemInstruction"],fx(mn(s)));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&m(i,["topP"],l);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const T=h(e,["logprobs"]);T!=null&&m(i,["logprobs"],T);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&m(i,["frequencyPenalty"],P);const F=h(e,["seed"]);F!=null&&m(i,["seed"],F);const V=h(e,["responseMimeType"]);V!=null&&m(i,["responseMimeType"],V);const Q=h(e,["responseSchema"]);Q!=null&&m(i,["responseSchema"],iv(Q));const j=h(e,["responseJsonSchema"]);if(j!=null&&m(i,["responseJsonSchema"],j),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const X=h(e,["safetySettings"]);if(t!==void 0&&X!=null){let M=X;Array.isArray(M)&&(M=M.map(Ee=>h6(Ee))),m(t,["safetySettings"],M)}const se=h(e,["tools"]);if(t!==void 0&&se!=null){let M=ql(se);Array.isArray(M)&&(M=M.map(Ee=>m6(Bl(Ee)))),m(t,["tools"],M)}const le=h(e,["toolConfig"]);if(t!==void 0&&le!=null&&m(t,["toolConfig"],p6(le)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ue=h(e,["cachedContent"]);t!==void 0&&ue!=null&&m(t,["cachedContent"],Or(n,ue));const N=h(e,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const D=h(e,["mediaResolution"]);D!=null&&m(i,["mediaResolution"],D);const x=h(e,["speechConfig"]);if(x!=null&&m(i,["speechConfig"],rv(x)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=h(e,["thinkingConfig"]);L!=null&&m(i,["thinkingConfig"],L);const k=h(e,["imageConfig"]);k!=null&&m(i,["imageConfig"],i6(k));const O=h(e,["enableEnhancedCivicAnswers"]);return O!=null&&m(i,["enableEnhancedCivicAnswers"],O),i}function ZO(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(p=>kO(p))),m(e,["candidates"],f)}const s=h(n,["modelVersion"]);s!=null&&m(e,["modelVersion"],s);const a=h(n,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const l=h(n,["responseId"]);l!=null&&m(e,["responseId"],l);const d=h(n,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function jO(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Gl(n,i)),t}function e6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Gl(n,i)),t}function t6(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function n6(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function i6(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);if(i!=null&&m(e,["imageSize"],i),h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function r6(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["request","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let d=ai(s);Array.isArray(d)&&(d=d.map(f=>fx(f))),m(t,["request","contents"],d)}const a=h(e,["metadata"]);a!=null&&m(t,["metadata"],a);const l=h(e,["config"]);return l!=null&&m(t,["request","generationConfig"],WO(n,l,h(t,["request"],{}))),t}function s6(n){const e={},t=h(n,["response"]);t!=null&&m(e,["response"],ZO(t));const i=h(n,["error"]);return i!=null&&m(e,["error"],i),e}function o6(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);if(e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),h(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function a6(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);e!==void 0&&s!=null&&m(e,["_query","pageToken"],s);const a=h(n,["filter"]);return e!==void 0&&a!=null&&m(e,["_query","filter"],a),t}function l6(n){const e={},t=h(n,["config"]);return t!=null&&o6(t,e),e}function u6(n){const e={},t=h(n,["config"]);return t!=null&&a6(t,e),e}function c6(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["operations"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>uh(l))),m(e,["batchJobs"],a)}return e}function d6(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["batchPredictionJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>Py(l))),m(e,["batchJobs"],a)}return e}function f6(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],$O(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],QO(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],DO(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function h6(n){const e={},t=h(n,["category"]);if(t!=null&&m(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=h(n,["threshold"]);return i!=null&&m(e,["threshold"],i),e}function p6(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],XO(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function m6(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],t6(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],n6(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Mr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Mr||(Mr={}));class Wo{constructor(e,t,i,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,s)}init(e,t,i){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!i||Object.keys(i).length===0?l={config:{}}:typeof i=="object"?l=Object.assign({},i):l=i,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(a=(s=l.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class g6 extends Ur{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wo(Mr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=nC(this.apiClient,e),i=t._url,s=me("{model}:batchGenerateContent",i),d=t.batch.inputConfig.requests,f=d.requests,p=[];for(const _ of f){const E=Object.assign({},_);if(E.systemInstruction){const T=E.systemInstruction;delete E.systemInstruction;const C=E.request;C.systemInstruction=T,E.request=C}p.push(E)}return d.requests=p,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},s=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${s}`),i.dest===void 0){const a=this.getGcsUri(e),l=this.getBigqueryUri(e);if(a)a.endsWith(".jsonl")?i.dest=`${a.slice(0,-6)}/dest`:i.dest=`${a}_dest_${s}`;else if(l)i.dest=`${l}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=OO(this.apiClient,e);return d=me("batchPredictionJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Py(_))}else{const p=nC(this.apiClient,e);return d=me("{model}:batchGenerateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>uh(_))}}async createEmbeddingsInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=BO(this.apiClient,e);return a=me("{model}:asyncBatchEmbedContent",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>uh(f))}}async get(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=e6(this.apiClient,e);return d=me("batchPredictionJobs/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Py(_))}else{const p=jO(this.apiClient,e);return d=me("batches/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>uh(_))}}async cancel(e){var t,i,s,a;let l="",d={};if(this.apiClient.isVertexAI()){const f=PO(this.apiClient,e);l=me("batchPredictionJobs/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const f=MO(this.apiClient,e);l=me("batches/{name}:cancel",f._url),d=f._query,delete f._url,delete f._query,await this.apiClient.request({path:l,queryParams:d,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal})}}async listInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=u6(e);return d=me("batchPredictionJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=d6(_),T=new ZI;return Object.assign(T,E),T})}else{const p=l6(e);return d=me("batches",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=c6(_),T=new ZI;return Object.assign(T,E),T})}}async delete(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=GO(this.apiClient,e);return d=me("batchPredictionJobs/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>HO(_))}else{const p=qO(this.apiClient,e);return d=me("batches/{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>zO(_))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function y6(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function iC(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>B6(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function _6(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const s=h(n,["expireTime"]);e!==void 0&&s!=null&&m(e,["expireTime"],s);const a=h(n,["displayName"]);e!==void 0&&a!=null&&m(e,["displayName"],a);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let _=ai(l);Array.isArray(_)&&(_=_.map(E=>iC(E))),m(e,["contents"],_)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&m(e,["systemInstruction"],iC(mn(d)));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let _=f;Array.isArray(_)&&(_=_.map(E=>G6(E))),m(e,["tools"],_)}const p=h(n,["toolConfig"]);if(e!==void 0&&p!=null&&m(e,["toolConfig"],q6(p)),h(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function v6(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const s=h(n,["expireTime"]);e!==void 0&&s!=null&&m(e,["expireTime"],s);const a=h(n,["displayName"]);e!==void 0&&a!=null&&m(e,["displayName"],a);const l=h(n,["contents"]);if(e!==void 0&&l!=null){let E=ai(l);Array.isArray(E)&&(E=E.map(T=>T)),m(e,["contents"],E)}const d=h(n,["systemInstruction"]);e!==void 0&&d!=null&&m(e,["systemInstruction"],mn(d));const f=h(n,["tools"]);if(e!==void 0&&f!=null){let E=f;Array.isArray(E)&&(E=E.map(T=>z6(T))),m(e,["tools"],E)}const p=h(n,["toolConfig"]);e!==void 0&&p!=null&&m(e,["toolConfig"],p);const _=h(n,["kmsKeyName"]);return e!==void 0&&_!=null&&m(e,["encryption_spec","kmsKeyName"],_),t}function E6(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],ex(n,i));const s=h(e,["config"]);return s!=null&&_6(s,t),t}function T6(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["model"],ex(n,i));const s=h(e,["config"]);return s!=null&&v6(s,t),t}function A6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Or(n,i)),t}function S6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Or(n,i)),t}function I6(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function C6(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function w6(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function R6(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function b6(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function x6(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["parameters"]);s!=null&&m(e,["parameters"],s);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&m(e,["response"],l);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function N6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Or(n,i)),t}function D6(n,e){const t={},i=h(e,["name"]);return i!=null&&m(t,["_url","name"],Or(n,i)),t}function M6(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function P6(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function k6(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function V6(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function L6(n){const e={},t=h(n,["config"]);return t!=null&&k6(t,e),e}function U6(n){const e={},t=h(n,["config"]);return t!=null&&V6(t,e),e}function O6(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["cachedContents"],a)}return e}function F6(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["cachedContents"],a)}return e}function B6(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],w6(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],R6(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],y6(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function q6(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],b6(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function G6(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],M6(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],P6(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function z6(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(T=>x6(T))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const s=h(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function H6(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const s=h(n,["expireTime"]);return e!==void 0&&s!=null&&m(e,["expireTime"],s),t}function K6(n,e){const t={},i=h(n,["ttl"]);e!==void 0&&i!=null&&m(e,["ttl"],i);const s=h(n,["expireTime"]);return e!==void 0&&s!=null&&m(e,["expireTime"],s),t}function J6(n,e){const t={},i=h(e,["name"]);i!=null&&m(t,["_url","name"],Or(n,i));const s=h(e,["config"]);return s!=null&&H6(s,t),t}function Y6(n,e){const t={},i=h(e,["name"]);i!=null&&m(t,["_url","name"],Or(n,i));const s=h(e,["config"]);return s!=null&&K6(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $6 extends Ur{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wo(Mr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=T6(this.apiClient,e);return d=me("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=E6(this.apiClient,e);return d=me("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async get(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=D6(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=N6(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async delete(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=S6(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=C6(_),T=new XI;return Object.assign(T,E),T})}else{const p=A6(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=I6(_),T=new XI;return Object.assign(T,E),T})}}async update(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=Y6(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>_)}else{const p=J6(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>_)}}async listInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=U6(e);return d=me("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=F6(_),T=new WI;return Object.assign(T,E),T})}else{const p=L6(e);return d=me("cachedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=O6(_),T=new WI;return Object.assign(T,E),T})}}}function qh(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}function rC(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ne(n){return this instanceof Ne?(this.v=n,this):new Ne(n)}function Si(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",l),s[Symbol.asyncIterator]=function(){return this},s;function l(C){return function(P){return Promise.resolve(P).then(C,E)}}function d(C,P){i[C]&&(s[C]=function(F){return new Promise(function(V,Q){a.push([C,F,V,Q])>1||f(C,F)})},P&&(s[C]=P(s[C])))}function f(C,P){try{p(i[C](P))}catch(F){T(a[0][3],F)}}function p(C){C.value instanceof Ne?Promise.resolve(C.value.v).then(_,E):T(a[0][2],C)}function _(C){f("next",C)}function E(C){f("throw",C)}function T(C,P){C(P),a.shift(),a.length&&f(a[0][0],a[0][1])}}function Ii(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof rC=="function"?rC(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=n[a]&&function(l){return new Promise(function(d,f){l=n[a](l),s(d,f,l.done,l.value)})}}function s(a,l,d,f){Promise.resolve(f).then(function(p){a({value:p,done:d})},l)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Q6(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:hx(t)}function hx(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function X6(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function sC(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const s=[];let a=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),a&&!hx(n[i])&&(a=!1),i++;a?e.push(...s):e.pop()}return e}class W6{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new Z6(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class Z6{constructor(e,t,i,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),X6(a)}async sendMessage(e){var t;await this.sendPromise;const i=mn(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,l,d;const f=await s,p=(l=(a=f.candidates)===null||a===void 0?void 0:a[0])===null||l===void 0?void 0:l.content,_=f.automaticFunctionCallingHistory,E=this.getHistory(!0).length;let T=[];_!=null&&(T=(d=_.slice(E))!==null&&d!==void 0?d:[]);const C=p?[p]:[];this.recordHistory(i,C,T)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const i=mn(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,i)}getHistory(e=!1){const t=e?sC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Si(this,arguments,function*(){var s,a,l,d,f,p;const _=[];try{for(var E=!0,T=Ii(e),C;C=yield Ne(T.next()),s=C.done,!s;E=!0){d=C.value,E=!1;const P=d;if(Q6(P)){const F=(p=(f=P.candidates)===null||f===void 0?void 0:f[0])===null||p===void 0?void 0:p.content;F!==void 0&&_.push(F)}yield yield Ne(P)}}catch(P){a={error:P}}finally{try{!E&&!s&&(l=T.return)&&(yield Ne(l.call(T)))}finally{if(a)throw a.error}}this.recordHistory(t,_)})}recordHistory(e,t,i){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...sC(i)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mp extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,mp.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function j6(n){const e={},t=h(n,["file"]);return t!=null&&m(e,["file"],t),e}function e3(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function t3(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","file"],ox(t)),e}function n3(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function i3(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","file"],ox(t)),e}function r3(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function s3(n){const e={},t=h(n,["config"]);return t!=null&&r3(t,e),e}function o3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["files"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class a3 extends Ur{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wo(Mr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=s3(e);return a=me("files",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=o3(f),_=new dO;return Object.assign(_,p),_})}}async createInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=j6(e);return a=me("upload/v1beta/files",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=e3(f),_=new fO;return Object.assign(_,p),_})}}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=i3(e);return a=me("files/{file}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=t3(e);return a=me("files/{file}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=n3(f),_=new hO;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ch(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function l3(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>I3(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function u3(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function c3(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function d3(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["parameters"]);s!=null&&m(e,["parameters"],s);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&m(e,["response"],l);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function f3(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const i=h(n,["responseJsonSchema"]);i!=null&&m(e,["responseJsonSchema"],i);const s=h(n,["audioTimestamp"]);s!=null&&m(e,["audioTimestamp"],s);const a=h(n,["candidateCount"]);a!=null&&m(e,["candidateCount"],a);const l=h(n,["enableAffectiveDialog"]);l!=null&&m(e,["enableAffectiveDialog"],l);const d=h(n,["frequencyPenalty"]);d!=null&&m(e,["frequencyPenalty"],d);const f=h(n,["logprobs"]);f!=null&&m(e,["logprobs"],f);const p=h(n,["maxOutputTokens"]);p!=null&&m(e,["maxOutputTokens"],p);const _=h(n,["mediaResolution"]);_!=null&&m(e,["mediaResolution"],_);const E=h(n,["presencePenalty"]);E!=null&&m(e,["presencePenalty"],E);const T=h(n,["responseLogprobs"]);T!=null&&m(e,["responseLogprobs"],T);const C=h(n,["responseMimeType"]);C!=null&&m(e,["responseMimeType"],C);const P=h(n,["responseModalities"]);P!=null&&m(e,["responseModalities"],P);const F=h(n,["responseSchema"]);F!=null&&m(e,["responseSchema"],F);const V=h(n,["routingConfig"]);V!=null&&m(e,["routingConfig"],V);const Q=h(n,["seed"]);Q!=null&&m(e,["seed"],Q);const j=h(n,["speechConfig"]);j!=null&&m(e,["speechConfig"],j);const X=h(n,["stopSequences"]);X!=null&&m(e,["stopSequences"],X);const se=h(n,["temperature"]);se!=null&&m(e,["temperature"],se);const le=h(n,["thinkingConfig"]);le!=null&&m(e,["thinkingConfig"],le);const ue=h(n,["topK"]);ue!=null&&m(e,["topK"],ue);const N=h(n,["topP"]);if(N!=null&&m(e,["topP"],N),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function h3(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function p3(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function m3(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],i);const s=h(n,["responseModalities"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","responseModalities"],s);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],sv(E));const T=h(n,["thinkingConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","thinkingConfig"],T);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&m(e,["setup","systemInstruction"],l3(mn(P)));const F=h(n,["tools"]);if(e!==void 0&&F!=null){let ue=ql(F);Array.isArray(ue)&&(ue=ue.map(N=>w3(Bl(N)))),m(e,["setup","tools"],ue)}const V=h(n,["sessionResumption"]);e!==void 0&&V!=null&&m(e,["setup","sessionResumption"],C3(V));const Q=h(n,["inputAudioTranscription"]);e!==void 0&&Q!=null&&m(e,["setup","inputAudioTranscription"],Q);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const X=h(n,["realtimeInputConfig"]);e!==void 0&&X!=null&&m(e,["setup","realtimeInputConfig"],X);const se=h(n,["contextWindowCompression"]);e!==void 0&&se!=null&&m(e,["setup","contextWindowCompression"],se);const le=h(n,["proactivity"]);if(e!==void 0&&le!=null&&m(e,["setup","proactivity"],le),h(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function g3(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],f3(i));const s=h(n,["responseModalities"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","responseModalities"],s);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],sv(E));const T=h(n,["thinkingConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","thinkingConfig"],T);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&m(e,["setup","systemInstruction"],mn(P));const F=h(n,["tools"]);if(e!==void 0&&F!=null){let N=ql(F);Array.isArray(N)&&(N=N.map(D=>R3(Bl(D)))),m(e,["setup","tools"],N)}const V=h(n,["sessionResumption"]);e!==void 0&&V!=null&&m(e,["setup","sessionResumption"],V);const Q=h(n,["inputAudioTranscription"]);e!==void 0&&Q!=null&&m(e,["setup","inputAudioTranscription"],Q);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const X=h(n,["realtimeInputConfig"]);e!==void 0&&X!=null&&m(e,["setup","realtimeInputConfig"],X);const se=h(n,["contextWindowCompression"]);e!==void 0&&se!=null&&m(e,["setup","contextWindowCompression"],se);const le=h(n,["proactivity"]);e!==void 0&&le!=null&&m(e,["setup","proactivity"],le);const ue=h(n,["explicitVadSignal"]);return e!==void 0&&ue!=null&&m(e,["setup","explicitVadSignal"],ue),t}function y3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Ze(n,i));const s=h(e,["config"]);return s!=null&&m(t,["config"],m3(s,t)),t}function _3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Ze(n,i));const s=h(e,["config"]);return s!=null&&m(t,["config"],g3(s,t)),t}function v3(n){const e={},t=h(n,["musicGenerationConfig"]);return t!=null&&m(e,["musicGenerationConfig"],t),e}function E3(n){const e={},t=h(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),m(e,["weightedPrompts"],i)}return e}function T3(n){const e={},t=h(n,["media"]);if(t!=null){let p=tx(t);Array.isArray(p)&&(p=p.map(_=>ch(_))),m(e,["mediaChunks"],p)}const i=h(n,["audio"]);i!=null&&m(e,["audio"],ch(ix(i)));const s=h(n,["audioStreamEnd"]);s!=null&&m(e,["audioStreamEnd"],s);const a=h(n,["video"]);a!=null&&m(e,["video"],ch(nx(a)));const l=h(n,["text"]);l!=null&&m(e,["text"],l);const d=h(n,["activityStart"]);d!=null&&m(e,["activityStart"],d);const f=h(n,["activityEnd"]);return f!=null&&m(e,["activityEnd"],f),e}function A3(n){const e={},t=h(n,["media"]);if(t!=null){let p=tx(t);Array.isArray(p)&&(p=p.map(_=>_)),m(e,["mediaChunks"],p)}const i=h(n,["audio"]);i!=null&&m(e,["audio"],ix(i));const s=h(n,["audioStreamEnd"]);s!=null&&m(e,["audioStreamEnd"],s);const a=h(n,["video"]);a!=null&&m(e,["video"],nx(a));const l=h(n,["text"]);l!=null&&m(e,["text"],l);const d=h(n,["activityStart"]);d!=null&&m(e,["activityStart"],d);const f=h(n,["activityEnd"]);return f!=null&&m(e,["activityEnd"],f),e}function S3(n){const e={},t=h(n,["setupComplete"]);t!=null&&m(e,["setupComplete"],t);const i=h(n,["serverContent"]);i!=null&&m(e,["serverContent"],i);const s=h(n,["toolCall"]);s!=null&&m(e,["toolCall"],s);const a=h(n,["toolCallCancellation"]);a!=null&&m(e,["toolCallCancellation"],a);const l=h(n,["usageMetadata"]);l!=null&&m(e,["usageMetadata"],b3(l));const d=h(n,["goAway"]);d!=null&&m(e,["goAway"],d);const f=h(n,["sessionResumptionUpdate"]);f!=null&&m(e,["sessionResumptionUpdate"],f);const p=h(n,["voiceActivityDetectionSignal"]);return p!=null&&m(e,["voiceActivityDetectionSignal"],p),e}function I3(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],u3(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],c3(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],ch(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function C3(n){const e={},t=h(n,["handle"]);if(t!=null&&m(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function w3(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],h3(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],p3(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function R3(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(T=>d3(T))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const s=h(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function b3(n){const e={},t=h(n,["promptTokenCount"]);t!=null&&m(e,["promptTokenCount"],t);const i=h(n,["cachedContentTokenCount"]);i!=null&&m(e,["cachedContentTokenCount"],i);const s=h(n,["candidatesTokenCount"]);s!=null&&m(e,["responseTokenCount"],s);const a=h(n,["toolUsePromptTokenCount"]);a!=null&&m(e,["toolUsePromptTokenCount"],a);const l=h(n,["thoughtsTokenCount"]);l!=null&&m(e,["thoughtsTokenCount"],l);const d=h(n,["totalTokenCount"]);d!=null&&m(e,["totalTokenCount"],d);const f=h(n,["promptTokensDetails"]);if(f!=null){let C=f;Array.isArray(C)&&(C=C.map(P=>P)),m(e,["promptTokensDetails"],C)}const p=h(n,["cacheTokensDetails"]);if(p!=null){let C=p;Array.isArray(C)&&(C=C.map(P=>P)),m(e,["cacheTokensDetails"],C)}const _=h(n,["candidatesTokensDetails"]);if(_!=null){let C=_;Array.isArray(C)&&(C=C.map(P=>P)),m(e,["responseTokensDetails"],C)}const E=h(n,["toolUsePromptTokensDetails"]);if(E!=null){let C=E;Array.isArray(C)&&(C=C.map(P=>P)),m(e,["toolUsePromptTokensDetails"],C)}const T=h(n,["trafficType"]);return T!=null&&m(e,["trafficType"],T),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function x3(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function N3(n){const e={},t=h(n,["content"]);t!=null&&m(e,["content"],t);const i=h(n,["citationMetadata"]);i!=null&&m(e,["citationMetadata"],D3(i));const s=h(n,["tokenCount"]);s!=null&&m(e,["tokenCount"],s);const a=h(n,["finishReason"]);a!=null&&m(e,["finishReason"],a);const l=h(n,["avgLogprobs"]);l!=null&&m(e,["avgLogprobs"],l);const d=h(n,["groundingMetadata"]);d!=null&&m(e,["groundingMetadata"],d);const f=h(n,["index"]);f!=null&&m(e,["index"],f);const p=h(n,["logprobsResult"]);p!=null&&m(e,["logprobsResult"],p);const _=h(n,["safetyRatings"]);if(_!=null){let T=_;Array.isArray(T)&&(T=T.map(C=>C)),m(e,["safetyRatings"],T)}const E=h(n,["urlContextMetadata"]);return E!=null&&m(e,["urlContextMetadata"],E),e}function D3(n){const e={},t=h(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),m(e,["citations"],i)}return e}function M3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let a=ai(s);Array.isArray(a)&&(a=a.map(l=>l)),m(t,["contents"],a)}return t}function P3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["tokensInfo"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),m(e,["tokensInfo"],s)}return e}function k3(n){const e={},t=h(n,["values"]);t!=null&&m(e,["values"],t);const i=h(n,["statistics"]);return i!=null&&m(e,["statistics"],V3(i)),e}function V3(n){const e={},t=h(n,["truncated"]);t!=null&&m(e,["truncated"],t);const i=h(n,["token_count"]);return i!=null&&m(e,["tokenCount"],i),e}function gp(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>HF(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function L3(n){const e={},t=h(n,["controlType"]);t!=null&&m(e,["controlType"],t);const i=h(n,["enableControlImageComputation"]);return i!=null&&m(e,["computeControl"],i),e}function U3(n){const e={};if(h(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(h(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(h(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function O3(n,e){const t={},i=h(n,["systemInstruction"]);e!==void 0&&i!=null&&m(e,["systemInstruction"],mn(i));const s=h(n,["tools"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(d=>yx(d))),m(e,["tools"],l)}const a=h(n,["generationConfig"]);return e!==void 0&&a!=null&&m(e,["generationConfig"],xF(a)),t}function F3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=ai(s);Array.isArray(l)&&(l=l.map(d=>gp(d))),m(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&U3(a),t}function B3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=ai(s);Array.isArray(l)&&(l=l.map(d=>d)),m(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&O3(a,t),t}function q3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);i!=null&&m(e,["totalTokens"],i);const s=h(n,["cachedContentTokenCount"]);return s!=null&&m(e,["cachedContentTokenCount"],s),e}function G3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["totalTokens"]);return i!=null&&m(e,["totalTokens"],i),e}function z3(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],Ze(n,i)),t}function H3(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],Ze(n,i)),t}function K3(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function J3(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}function Y3(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const s=h(n,["negativePrompt"]);e!==void 0&&s!=null&&m(e,["parameters","negativePrompt"],s);const a=h(n,["numberOfImages"]);e!==void 0&&a!=null&&m(e,["parameters","sampleCount"],a);const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&m(e,["parameters","guidanceScale"],d);const f=h(n,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const p=h(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&m(e,["parameters","safetySetting"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&m(e,["parameters","includeSafetyAttributes"],E);const T=h(n,["includeRaiReason"]);e!==void 0&&T!=null&&m(e,["parameters","includeRaiReason"],T);const C=h(n,["language"]);e!==void 0&&C!=null&&m(e,["parameters","language"],C);const P=h(n,["outputMimeType"]);e!==void 0&&P!=null&&m(e,["parameters","outputOptions","mimeType"],P);const F=h(n,["outputCompressionQuality"]);e!==void 0&&F!=null&&m(e,["parameters","outputOptions","compressionQuality"],F);const V=h(n,["addWatermark"]);e!==void 0&&V!=null&&m(e,["parameters","addWatermark"],V);const Q=h(n,["labels"]);e!==void 0&&Q!=null&&m(e,["labels"],Q);const j=h(n,["editMode"]);e!==void 0&&j!=null&&m(e,["parameters","editMode"],j);const X=h(n,["baseSteps"]);return e!==void 0&&X!=null&&m(e,["parameters","editConfig","baseSteps"],X),t}function $3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["referenceImages"]);if(a!=null){let d=a;Array.isArray(d)&&(d=d.map(f=>XF(f))),m(t,["instances[0]","referenceImages"],d)}const l=h(e,["config"]);return l!=null&&Y3(l,t),t}function Q3(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>yp(a))),m(e,["generatedImages"],s)}return e}function X3(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["requests[]","taskType"],i);const s=h(n,["title"]);e!==void 0&&s!=null&&m(e,["requests[]","title"],s);const a=h(n,["outputDimensionality"]);if(e!==void 0&&a!=null&&m(e,["requests[]","outputDimensionality"],a),h(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(h(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function W3(n,e){const t={},i=h(n,["taskType"]);e!==void 0&&i!=null&&m(e,["instances[]","task_type"],i);const s=h(n,["title"]);e!==void 0&&s!=null&&m(e,["instances[]","title"],s);const a=h(n,["outputDimensionality"]);e!==void 0&&a!=null&&m(e,["parameters","outputDimensionality"],a);const l=h(n,["mimeType"]);e!==void 0&&l!=null&&m(e,["instances[]","mimeType"],l);const d=h(n,["autoTruncate"]);return e!==void 0&&d!=null&&m(e,["parameters","autoTruncate"],d),t}function Z3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let d=nv(n,s);Array.isArray(d)&&(d=d.map(f=>f)),m(t,["requests[]","content"],d)}const a=h(e,["config"]);a!=null&&X3(a,t);const l=h(e,["model"]);return l!==void 0&&m(t,["requests[]","model"],Ze(n,l)),t}function j3(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=nv(n,s);Array.isArray(l)&&(l=l.map(d=>d)),m(t,["instances[]","content"],l)}const a=h(e,["config"]);return a!=null&&W3(a,t),t}function eF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["embeddings"],a)}const s=h(n,["metadata"]);return s!=null&&m(e,["metadata"],s),e}function tF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions[]","embeddings"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>k3(l))),m(e,["embeddings"],a)}const s=h(n,["metadata"]);return s!=null&&m(e,["metadata"],s),e}function nF(n){const e={},t=h(n,["endpoint"]);t!=null&&m(e,["name"],t);const i=h(n,["deployedModelId"]);return i!=null&&m(e,["deployedModelId"],i),e}function iF(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function rF(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function sF(n){const e={},t=h(n,["mode"]);t!=null&&m(e,["mode"],t);const i=h(n,["allowedFunctionNames"]);if(i!=null&&m(e,["allowedFunctionNames"],i),h(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function oF(n){const e={};if(h(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=h(n,["description"]);t!=null&&m(e,["description"],t);const i=h(n,["name"]);i!=null&&m(e,["name"],i);const s=h(n,["parameters"]);s!=null&&m(e,["parameters"],s);const a=h(n,["parametersJsonSchema"]);a!=null&&m(e,["parametersJsonSchema"],a);const l=h(n,["response"]);l!=null&&m(e,["response"],l);const d=h(n,["responseJsonSchema"]);return d!=null&&m(e,["responseJsonSchema"],d),e}function aF(n,e,t){const i={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&m(t,["systemInstruction"],gp(mn(s)));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&m(i,["topP"],l);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const T=h(e,["logprobs"]);T!=null&&m(i,["logprobs"],T);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&m(i,["frequencyPenalty"],P);const F=h(e,["seed"]);F!=null&&m(i,["seed"],F);const V=h(e,["responseMimeType"]);V!=null&&m(i,["responseMimeType"],V);const Q=h(e,["responseSchema"]);Q!=null&&m(i,["responseSchema"],iv(Q));const j=h(e,["responseJsonSchema"]);if(j!=null&&m(i,["responseJsonSchema"],j),h(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(h(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const X=h(e,["safetySettings"]);if(t!==void 0&&X!=null){let M=X;Array.isArray(M)&&(M=M.map(Ee=>WF(Ee))),m(t,["safetySettings"],M)}const se=h(e,["tools"]);if(t!==void 0&&se!=null){let M=ql(se);Array.isArray(M)&&(M=M.map(Ee=>r5(Bl(Ee)))),m(t,["tools"],M)}const le=h(e,["toolConfig"]);if(t!==void 0&&le!=null&&m(t,["toolConfig"],i5(le)),h(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const ue=h(e,["cachedContent"]);t!==void 0&&ue!=null&&m(t,["cachedContent"],Or(n,ue));const N=h(e,["responseModalities"]);N!=null&&m(i,["responseModalities"],N);const D=h(e,["mediaResolution"]);D!=null&&m(i,["mediaResolution"],D);const x=h(e,["speechConfig"]);if(x!=null&&m(i,["speechConfig"],rv(x)),h(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=h(e,["thinkingConfig"]);L!=null&&m(i,["thinkingConfig"],L);const k=h(e,["imageConfig"]);k!=null&&m(i,["imageConfig"],kF(k));const O=h(e,["enableEnhancedCivicAnswers"]);return O!=null&&m(i,["enableEnhancedCivicAnswers"],O),i}function lF(n,e,t){const i={},s=h(e,["systemInstruction"]);t!==void 0&&s!=null&&m(t,["systemInstruction"],mn(s));const a=h(e,["temperature"]);a!=null&&m(i,["temperature"],a);const l=h(e,["topP"]);l!=null&&m(i,["topP"],l);const d=h(e,["topK"]);d!=null&&m(i,["topK"],d);const f=h(e,["candidateCount"]);f!=null&&m(i,["candidateCount"],f);const p=h(e,["maxOutputTokens"]);p!=null&&m(i,["maxOutputTokens"],p);const _=h(e,["stopSequences"]);_!=null&&m(i,["stopSequences"],_);const E=h(e,["responseLogprobs"]);E!=null&&m(i,["responseLogprobs"],E);const T=h(e,["logprobs"]);T!=null&&m(i,["logprobs"],T);const C=h(e,["presencePenalty"]);C!=null&&m(i,["presencePenalty"],C);const P=h(e,["frequencyPenalty"]);P!=null&&m(i,["frequencyPenalty"],P);const F=h(e,["seed"]);F!=null&&m(i,["seed"],F);const V=h(e,["responseMimeType"]);V!=null&&m(i,["responseMimeType"],V);const Q=h(e,["responseSchema"]);Q!=null&&m(i,["responseSchema"],iv(Q));const j=h(e,["responseJsonSchema"]);j!=null&&m(i,["responseJsonSchema"],j);const X=h(e,["routingConfig"]);X!=null&&m(i,["routingConfig"],X);const se=h(e,["modelSelectionConfig"]);se!=null&&m(i,["modelConfig"],se);const le=h(e,["safetySettings"]);if(t!==void 0&&le!=null){let z=le;Array.isArray(z)&&(z=z.map(oe=>oe)),m(t,["safetySettings"],z)}const ue=h(e,["tools"]);if(t!==void 0&&ue!=null){let z=ql(ue);Array.isArray(z)&&(z=z.map(oe=>yx(Bl(oe)))),m(t,["tools"],z)}const N=h(e,["toolConfig"]);t!==void 0&&N!=null&&m(t,["toolConfig"],N);const D=h(e,["labels"]);t!==void 0&&D!=null&&m(t,["labels"],D);const x=h(e,["cachedContent"]);t!==void 0&&x!=null&&m(t,["cachedContent"],Or(n,x));const L=h(e,["responseModalities"]);L!=null&&m(i,["responseModalities"],L);const k=h(e,["mediaResolution"]);k!=null&&m(i,["mediaResolution"],k);const O=h(e,["speechConfig"]);O!=null&&m(i,["speechConfig"],rv(O));const M=h(e,["audioTimestamp"]);M!=null&&m(i,["audioTimestamp"],M);const Ee=h(e,["thinkingConfig"]);Ee!=null&&m(i,["thinkingConfig"],Ee);const Ue=h(e,["imageConfig"]);if(Ue!=null&&m(i,["imageConfig"],VF(Ue)),h(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return i}function oC(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=ai(s);Array.isArray(l)&&(l=l.map(d=>gp(d))),m(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&m(t,["generationConfig"],aF(n,a,t)),t}function aC(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["contents"]);if(s!=null){let l=ai(s);Array.isArray(l)&&(l=l.map(d=>d)),m(t,["contents"],l)}const a=h(e,["config"]);return a!=null&&m(t,["generationConfig"],lF(n,a,t)),t}function lC(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(p=>N3(p))),m(e,["candidates"],f)}const s=h(n,["modelVersion"]);s!=null&&m(e,["modelVersion"],s);const a=h(n,["promptFeedback"]);a!=null&&m(e,["promptFeedback"],a);const l=h(n,["responseId"]);l!=null&&m(e,["responseId"],l);const d=h(n,["usageMetadata"]);return d!=null&&m(e,["usageMetadata"],d),e}function uC(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(_=>_)),m(e,["candidates"],p)}const s=h(n,["createTime"]);s!=null&&m(e,["createTime"],s);const a=h(n,["modelVersion"]);a!=null&&m(e,["modelVersion"],a);const l=h(n,["promptFeedback"]);l!=null&&m(e,["promptFeedback"],l);const d=h(n,["responseId"]);d!=null&&m(e,["responseId"],d);const f=h(n,["usageMetadata"]);return f!=null&&m(e,["usageMetadata"],f),e}function uF(n,e){const t={};if(h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const s=h(n,["aspectRatio"]);e!==void 0&&s!=null&&m(e,["parameters","aspectRatio"],s);const a=h(n,["guidanceScale"]);if(e!==void 0&&a!=null&&m(e,["parameters","guidanceScale"],a),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=h(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&m(e,["parameters","safetySetting"],l);const d=h(n,["personGeneration"]);e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d);const f=h(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&m(e,["parameters","includeSafetyAttributes"],f);const p=h(n,["includeRaiReason"]);e!==void 0&&p!=null&&m(e,["parameters","includeRaiReason"],p);const _=h(n,["language"]);e!==void 0&&_!=null&&m(e,["parameters","language"],_);const E=h(n,["outputMimeType"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","mimeType"],E);const T=h(n,["outputCompressionQuality"]);if(e!==void 0&&T!=null&&m(e,["parameters","outputOptions","compressionQuality"],T),h(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const C=h(n,["imageSize"]);if(e!==void 0&&C!=null&&m(e,["parameters","sampleImageSize"],C),h(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function cF(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const s=h(n,["negativePrompt"]);e!==void 0&&s!=null&&m(e,["parameters","negativePrompt"],s);const a=h(n,["numberOfImages"]);e!==void 0&&a!=null&&m(e,["parameters","sampleCount"],a);const l=h(n,["aspectRatio"]);e!==void 0&&l!=null&&m(e,["parameters","aspectRatio"],l);const d=h(n,["guidanceScale"]);e!==void 0&&d!=null&&m(e,["parameters","guidanceScale"],d);const f=h(n,["seed"]);e!==void 0&&f!=null&&m(e,["parameters","seed"],f);const p=h(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&m(e,["parameters","safetySetting"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["includeSafetyAttributes"]);e!==void 0&&E!=null&&m(e,["parameters","includeSafetyAttributes"],E);const T=h(n,["includeRaiReason"]);e!==void 0&&T!=null&&m(e,["parameters","includeRaiReason"],T);const C=h(n,["language"]);e!==void 0&&C!=null&&m(e,["parameters","language"],C);const P=h(n,["outputMimeType"]);e!==void 0&&P!=null&&m(e,["parameters","outputOptions","mimeType"],P);const F=h(n,["outputCompressionQuality"]);e!==void 0&&F!=null&&m(e,["parameters","outputOptions","compressionQuality"],F);const V=h(n,["addWatermark"]);e!==void 0&&V!=null&&m(e,["parameters","addWatermark"],V);const Q=h(n,["labels"]);e!==void 0&&Q!=null&&m(e,["labels"],Q);const j=h(n,["imageSize"]);e!==void 0&&j!=null&&m(e,["parameters","sampleImageSize"],j);const X=h(n,["enhancePrompt"]);return e!==void 0&&X!=null&&m(e,["parameters","enhancePrompt"],X),t}function dF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["config"]);return a!=null&&uF(a,t),t}function fF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["config"]);return a!=null&&cF(a,t),t}function hF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>CF(l))),m(e,["generatedImages"],a)}const s=h(n,["positivePromptSafetyAttributes"]);return s!=null&&m(e,["positivePromptSafetyAttributes"],mx(s)),e}function pF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>yp(l))),m(e,["generatedImages"],a)}const s=h(n,["positivePromptSafetyAttributes"]);return s!=null&&m(e,["positivePromptSafetyAttributes"],gx(s)),e}function mF(n,e){const t={},i=h(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i),h(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(h(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=h(n,["durationSeconds"]);if(e!==void 0&&s!=null&&m(e,["parameters","durationSeconds"],s),h(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=h(n,["aspectRatio"]);e!==void 0&&a!=null&&m(e,["parameters","aspectRatio"],a);const l=h(n,["resolution"]);e!==void 0&&l!=null&&m(e,["parameters","resolution"],l);const d=h(n,["personGeneration"]);if(e!==void 0&&d!=null&&m(e,["parameters","personGeneration"],d),h(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const f=h(n,["negativePrompt"]);e!==void 0&&f!=null&&m(e,["parameters","negativePrompt"],f);const p=h(n,["enhancePrompt"]);if(e!==void 0&&p!=null&&m(e,["parameters","enhancePrompt"],p),h(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const _=h(n,["lastFrame"]);e!==void 0&&_!=null&&m(e,["instances[0]","lastFrame"],_p(_));const E=h(n,["referenceImages"]);if(e!==void 0&&E!=null){let T=E;Array.isArray(T)&&(T=T.map(C=>y5(C))),m(e,["instances[0]","referenceImages"],T)}if(h(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(h(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function gF(n,e){const t={},i=h(n,["numberOfVideos"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const s=h(n,["outputGcsUri"]);e!==void 0&&s!=null&&m(e,["parameters","storageUri"],s);const a=h(n,["fps"]);e!==void 0&&a!=null&&m(e,["parameters","fps"],a);const l=h(n,["durationSeconds"]);e!==void 0&&l!=null&&m(e,["parameters","durationSeconds"],l);const d=h(n,["seed"]);e!==void 0&&d!=null&&m(e,["parameters","seed"],d);const f=h(n,["aspectRatio"]);e!==void 0&&f!=null&&m(e,["parameters","aspectRatio"],f);const p=h(n,["resolution"]);e!==void 0&&p!=null&&m(e,["parameters","resolution"],p);const _=h(n,["personGeneration"]);e!==void 0&&_!=null&&m(e,["parameters","personGeneration"],_);const E=h(n,["pubsubTopic"]);e!==void 0&&E!=null&&m(e,["parameters","pubsubTopic"],E);const T=h(n,["negativePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","negativePrompt"],T);const C=h(n,["enhancePrompt"]);e!==void 0&&C!=null&&m(e,["parameters","enhancePrompt"],C);const P=h(n,["generateAudio"]);e!==void 0&&P!=null&&m(e,["parameters","generateAudio"],P);const F=h(n,["lastFrame"]);e!==void 0&&F!=null&&m(e,["instances[0]","lastFrame"],wi(F));const V=h(n,["referenceImages"]);if(e!==void 0&&V!=null){let X=V;Array.isArray(X)&&(X=X.map(se=>_5(se))),m(e,["instances[0]","referenceImages"],X)}const Q=h(n,["mask"]);e!==void 0&&Q!=null&&m(e,["instances[0]","mask"],g5(Q));const j=h(n,["compressionQuality"]);return e!==void 0&&j!=null&&m(e,["parameters","compressionQuality"],j),t}function yF(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response","generateVideoResponse"]);return l!=null&&m(e,["response"],TF(l)),e}function _F(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],AF(l)),e}function vF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["image"]);a!=null&&m(t,["instances[0]","image"],_p(a));const l=h(e,["video"]);l!=null&&m(t,["instances[0]","video"],_x(l));const d=h(e,["source"]);d!=null&&SF(d,t);const f=h(e,["config"]);return f!=null&&mF(f,t),t}function EF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["prompt"]);s!=null&&m(t,["instances[0]","prompt"],s);const a=h(e,["image"]);a!=null&&m(t,["instances[0]","image"],wi(a));const l=h(e,["video"]);l!=null&&m(t,["instances[0]","video"],vx(l));const d=h(e,["source"]);d!=null&&IF(d,t);const f=h(e,["config"]);return f!=null&&gF(f,t),t}function TF(n){const e={},t=h(n,["generatedSamples"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>RF(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const s=h(n,["raiMediaFilteredReasons"]);return s!=null&&m(e,["raiMediaFilteredReasons"],s),e}function AF(n){const e={},t=h(n,["videos"]);if(t!=null){let a=t;Array.isArray(a)&&(a=a.map(l=>bF(l))),m(e,["generatedVideos"],a)}const i=h(n,["raiMediaFilteredCount"]);i!=null&&m(e,["raiMediaFilteredCount"],i);const s=h(n,["raiMediaFilteredReasons"]);return s!=null&&m(e,["raiMediaFilteredReasons"],s),e}function SF(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const s=h(n,["image"]);e!==void 0&&s!=null&&m(e,["instances[0]","image"],_p(s));const a=h(n,["video"]);return e!==void 0&&a!=null&&m(e,["instances[0]","video"],_x(a)),t}function IF(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const s=h(n,["image"]);e!==void 0&&s!=null&&m(e,["instances[0]","image"],wi(s));const a=h(n,["video"]);return e!==void 0&&a!=null&&m(e,["instances[0]","video"],vx(a)),t}function CF(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["image"],LF(t));const i=h(n,["raiFilteredReason"]);i!=null&&m(e,["raiFilteredReason"],i);const s=h(n,["_self"]);return s!=null&&m(e,["safetyAttributes"],mx(s)),e}function yp(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["image"],px(t));const i=h(n,["raiFilteredReason"]);i!=null&&m(e,["raiFilteredReason"],i);const s=h(n,["_self"]);s!=null&&m(e,["safetyAttributes"],gx(s));const a=h(n,["prompt"]);return a!=null&&m(e,["enhancedPrompt"],a),e}function wF(n){const e={},t=h(n,["_self"]);t!=null&&m(e,["mask"],px(t));const i=h(n,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),m(e,["labels"],s)}return e}function RF(n){const e={},t=h(n,["video"]);return t!=null&&m(e,["video"],p5(t)),e}function bF(n){const e={},t=h(n,["_self"]);return t!=null&&m(e,["video"],m5(t)),e}function xF(n){const e={},t=h(n,["modelSelectionConfig"]);t!=null&&m(e,["modelConfig"],t);const i=h(n,["responseJsonSchema"]);i!=null&&m(e,["responseJsonSchema"],i);const s=h(n,["audioTimestamp"]);s!=null&&m(e,["audioTimestamp"],s);const a=h(n,["candidateCount"]);a!=null&&m(e,["candidateCount"],a);const l=h(n,["enableAffectiveDialog"]);l!=null&&m(e,["enableAffectiveDialog"],l);const d=h(n,["frequencyPenalty"]);d!=null&&m(e,["frequencyPenalty"],d);const f=h(n,["logprobs"]);f!=null&&m(e,["logprobs"],f);const p=h(n,["maxOutputTokens"]);p!=null&&m(e,["maxOutputTokens"],p);const _=h(n,["mediaResolution"]);_!=null&&m(e,["mediaResolution"],_);const E=h(n,["presencePenalty"]);E!=null&&m(e,["presencePenalty"],E);const T=h(n,["responseLogprobs"]);T!=null&&m(e,["responseLogprobs"],T);const C=h(n,["responseMimeType"]);C!=null&&m(e,["responseMimeType"],C);const P=h(n,["responseModalities"]);P!=null&&m(e,["responseModalities"],P);const F=h(n,["responseSchema"]);F!=null&&m(e,["responseSchema"],F);const V=h(n,["routingConfig"]);V!=null&&m(e,["routingConfig"],V);const Q=h(n,["seed"]);Q!=null&&m(e,["seed"],Q);const j=h(n,["speechConfig"]);j!=null&&m(e,["speechConfig"],j);const X=h(n,["stopSequences"]);X!=null&&m(e,["stopSequences"],X);const se=h(n,["temperature"]);se!=null&&m(e,["temperature"],se);const le=h(n,["thinkingConfig"]);le!=null&&m(e,["thinkingConfig"],le);const ue=h(n,["topK"]);ue!=null&&m(e,["topK"],ue);const N=h(n,["topP"]);if(N!=null&&m(e,["topP"],N),h(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function NF(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],Ze(n,i)),t}function DF(n,e){const t={},i=h(e,["model"]);return i!=null&&m(t,["_url","name"],Ze(n,i)),t}function MF(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function PF(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function kF(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);if(i!=null&&m(e,["imageSize"],i),h(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(h(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function VF(n){const e={},t=h(n,["aspectRatio"]);t!=null&&m(e,["aspectRatio"],t);const i=h(n,["imageSize"]);i!=null&&m(e,["imageSize"],i);const s=h(n,["outputMimeType"]);s!=null&&m(e,["imageOutputOptions","mimeType"],s);const a=h(n,["outputCompressionQuality"]);return a!=null&&m(e,["imageOutputOptions","compressionQuality"],a),e}function LF(n){const e={},t=h(n,["bytesBase64Encoded"]);t!=null&&m(e,["imageBytes"],Hs(t));const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function px(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["imageBytes"],Hs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function _p(n){const e={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=h(n,["imageBytes"]);t!=null&&m(e,["bytesBase64Encoded"],Hs(t));const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function wi(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["imageBytes"]);i!=null&&m(e,["bytesBase64Encoded"],Hs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function UF(n,e,t){const i={},s=h(e,["pageSize"]);t!==void 0&&s!=null&&m(t,["_query","pageSize"],s);const a=h(e,["pageToken"]);t!==void 0&&a!=null&&m(t,["_query","pageToken"],a);const l=h(e,["filter"]);t!==void 0&&l!=null&&m(t,["_query","filter"],l);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&m(t,["_url","models_url"],ax(n,d)),i}function OF(n,e,t){const i={},s=h(e,["pageSize"]);t!==void 0&&s!=null&&m(t,["_query","pageSize"],s);const a=h(e,["pageToken"]);t!==void 0&&a!=null&&m(t,["_query","pageToken"],a);const l=h(e,["filter"]);t!==void 0&&l!=null&&m(t,["_query","filter"],l);const d=h(e,["queryBase"]);return t!==void 0&&d!=null&&m(t,["_url","models_url"],ax(n,d)),i}function FF(n,e){const t={},i=h(e,["config"]);return i!=null&&UF(n,i,t),t}function BF(n,e){const t={},i=h(e,["config"]);return i!=null&&OF(n,i,t),t}function qF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["_self"]);if(s!=null){let a=lx(s);Array.isArray(a)&&(a=a.map(l=>ky(l))),m(e,["models"],a)}return e}function GF(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["_self"]);if(s!=null){let a=lx(s);Array.isArray(a)&&(a=a.map(l=>Vy(l))),m(e,["models"],a)}return e}function zF(n){const e={},t=h(n,["maskMode"]);t!=null&&m(e,["maskMode"],t);const i=h(n,["segmentationClasses"]);i!=null&&m(e,["maskClasses"],i);const s=h(n,["maskDilation"]);return s!=null&&m(e,["dilation"],s),e}function ky(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const s=h(n,["description"]);s!=null&&m(e,["description"],s);const a=h(n,["version"]);a!=null&&m(e,["version"],a);const l=h(n,["_self"]);l!=null&&m(e,["tunedModelInfo"],s5(l));const d=h(n,["inputTokenLimit"]);d!=null&&m(e,["inputTokenLimit"],d);const f=h(n,["outputTokenLimit"]);f!=null&&m(e,["outputTokenLimit"],f);const p=h(n,["supportedGenerationMethods"]);p!=null&&m(e,["supportedActions"],p);const _=h(n,["temperature"]);_!=null&&m(e,["temperature"],_);const E=h(n,["maxTemperature"]);E!=null&&m(e,["maxTemperature"],E);const T=h(n,["topP"]);T!=null&&m(e,["topP"],T);const C=h(n,["topK"]);C!=null&&m(e,["topK"],C);const P=h(n,["thinking"]);return P!=null&&m(e,["thinking"],P),e}function Vy(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["displayName"]);i!=null&&m(e,["displayName"],i);const s=h(n,["description"]);s!=null&&m(e,["description"],s);const a=h(n,["versionId"]);a!=null&&m(e,["version"],a);const l=h(n,["deployedModels"]);if(l!=null){let E=l;Array.isArray(E)&&(E=E.map(T=>nF(T))),m(e,["endpoints"],E)}const d=h(n,["labels"]);d!=null&&m(e,["labels"],d);const f=h(n,["_self"]);f!=null&&m(e,["tunedModelInfo"],o5(f));const p=h(n,["defaultCheckpointId"]);p!=null&&m(e,["defaultCheckpointId"],p);const _=h(n,["checkpoints"]);if(_!=null){let E=_;Array.isArray(E)&&(E=E.map(T=>T)),m(e,["checkpoints"],E)}return e}function HF(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],iF(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],rF(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],x3(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function KF(n){const e={},t=h(n,["productImage"]);return t!=null&&m(e,["image"],wi(t)),e}function JF(n,e){const t={},i=h(n,["numberOfImages"]);e!==void 0&&i!=null&&m(e,["parameters","sampleCount"],i);const s=h(n,["baseSteps"]);e!==void 0&&s!=null&&m(e,["parameters","baseSteps"],s);const a=h(n,["outputGcsUri"]);e!==void 0&&a!=null&&m(e,["parameters","storageUri"],a);const l=h(n,["seed"]);e!==void 0&&l!=null&&m(e,["parameters","seed"],l);const d=h(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&m(e,["parameters","safetySetting"],d);const f=h(n,["personGeneration"]);e!==void 0&&f!=null&&m(e,["parameters","personGeneration"],f);const p=h(n,["addWatermark"]);e!==void 0&&p!=null&&m(e,["parameters","addWatermark"],p);const _=h(n,["outputMimeType"]);e!==void 0&&_!=null&&m(e,["parameters","outputOptions","mimeType"],_);const E=h(n,["outputCompressionQuality"]);e!==void 0&&E!=null&&m(e,["parameters","outputOptions","compressionQuality"],E);const T=h(n,["enhancePrompt"]);e!==void 0&&T!=null&&m(e,["parameters","enhancePrompt"],T);const C=h(n,["labels"]);return e!==void 0&&C!=null&&m(e,["labels"],C),t}function YF(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["source"]);s!=null&&QF(s,t);const a=h(e,["config"]);return a!=null&&JF(a,t),t}function $F(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>yp(s))),m(e,["generatedImages"],i)}return e}function QF(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const s=h(n,["personImage"]);e!==void 0&&s!=null&&m(e,["instances[0]","personImage","image"],wi(s));const a=h(n,["productImages"]);if(e!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(d=>KF(d))),m(e,["instances[0]","productImages"],l)}return t}function XF(n){const e={},t=h(n,["referenceImage"]);t!=null&&m(e,["referenceImage"],wi(t));const i=h(n,["referenceId"]);i!=null&&m(e,["referenceId"],i);const s=h(n,["referenceType"]);s!=null&&m(e,["referenceType"],s);const a=h(n,["maskImageConfig"]);a!=null&&m(e,["maskImageConfig"],zF(a));const l=h(n,["controlImageConfig"]);l!=null&&m(e,["controlImageConfig"],L3(l));const d=h(n,["styleImageConfig"]);d!=null&&m(e,["styleImageConfig"],d);const f=h(n,["subjectImageConfig"]);return f!=null&&m(e,["subjectImageConfig"],f),e}function mx(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&m(e,["scores"],i);const s=h(n,["contentType"]);return s!=null&&m(e,["contentType"],s),e}function gx(n){const e={},t=h(n,["safetyAttributes","categories"]);t!=null&&m(e,["categories"],t);const i=h(n,["safetyAttributes","scores"]);i!=null&&m(e,["scores"],i);const s=h(n,["contentType"]);return s!=null&&m(e,["contentType"],s),e}function WF(n){const e={},t=h(n,["category"]);if(t!=null&&m(e,["category"],t),h(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=h(n,["threshold"]);return i!=null&&m(e,["threshold"],i),e}function ZF(n){const e={},t=h(n,["image"]);return t!=null&&m(e,["image"],wi(t)),e}function jF(n,e){const t={},i=h(n,["mode"]);e!==void 0&&i!=null&&m(e,["parameters","mode"],i);const s=h(n,["maxPredictions"]);e!==void 0&&s!=null&&m(e,["parameters","maxPredictions"],s);const a=h(n,["confidenceThreshold"]);e!==void 0&&a!=null&&m(e,["parameters","confidenceThreshold"],a);const l=h(n,["maskDilation"]);e!==void 0&&l!=null&&m(e,["parameters","maskDilation"],l);const d=h(n,["binaryColorThreshold"]);e!==void 0&&d!=null&&m(e,["parameters","binaryColorThreshold"],d);const f=h(n,["labels"]);return e!==void 0&&f!=null&&m(e,["labels"],f),t}function e5(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["source"]);s!=null&&n5(s,t);const a=h(e,["config"]);return a!=null&&jF(a,t),t}function t5(n){const e={},t=h(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>wF(s))),m(e,["generatedMasks"],i)}return e}function n5(n,e){const t={},i=h(n,["prompt"]);e!==void 0&&i!=null&&m(e,["instances[0]","prompt"],i);const s=h(n,["image"]);e!==void 0&&s!=null&&m(e,["instances[0]","image"],wi(s));const a=h(n,["scribbleImage"]);return e!==void 0&&a!=null&&m(e,["instances[0]","scribble"],ZF(a)),t}function i5(n){const e={},t=h(n,["functionCallingConfig"]);t!=null&&m(e,["functionCallingConfig"],sF(t));const i=h(n,["retrievalConfig"]);return i!=null&&m(e,["retrievalConfig"],i),e}function r5(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],MF(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],PF(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}function yx(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let E=t;Array.isArray(E)&&(E=E.map(T=>oF(T))),m(e,["functionDeclarations"],E)}const i=h(n,["retrieval"]);i!=null&&m(e,["retrieval"],i);const s=h(n,["googleSearchRetrieval"]);s!=null&&m(e,["googleSearchRetrieval"],s);const a=h(n,["computerUse"]);if(a!=null&&m(e,["computerUse"],a),h(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=h(n,["codeExecution"]);l!=null&&m(e,["codeExecution"],l);const d=h(n,["enterpriseWebSearch"]);d!=null&&m(e,["enterpriseWebSearch"],d);const f=h(n,["googleMaps"]);f!=null&&m(e,["googleMaps"],f);const p=h(n,["googleSearch"]);p!=null&&m(e,["googleSearch"],p);const _=h(n,["urlContext"]);return _!=null&&m(e,["urlContext"],_),e}function s5(n){const e={},t=h(n,["baseModel"]);t!=null&&m(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&m(e,["createTime"],i);const s=h(n,["updateTime"]);return s!=null&&m(e,["updateTime"],s),e}function o5(n){const e={},t=h(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&m(e,["baseModel"],t);const i=h(n,["createTime"]);i!=null&&m(e,["createTime"],i);const s=h(n,["updateTime"]);return s!=null&&m(e,["updateTime"],s),e}function a5(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const s=h(n,["description"]);e!==void 0&&s!=null&&m(e,["description"],s);const a=h(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&m(e,["defaultCheckpointId"],a),t}function l5(n,e){const t={},i=h(n,["displayName"]);e!==void 0&&i!=null&&m(e,["displayName"],i);const s=h(n,["description"]);e!==void 0&&s!=null&&m(e,["description"],s);const a=h(n,["defaultCheckpointId"]);return e!==void 0&&a!=null&&m(e,["defaultCheckpointId"],a),t}function u5(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","name"],Ze(n,i));const s=h(e,["config"]);return s!=null&&a5(s,t),t}function c5(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["config"]);return s!=null&&l5(s,t),t}function d5(n,e){const t={},i=h(n,["outputGcsUri"]);e!==void 0&&i!=null&&m(e,["parameters","storageUri"],i);const s=h(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&m(e,["parameters","safetySetting"],s);const a=h(n,["personGeneration"]);e!==void 0&&a!=null&&m(e,["parameters","personGeneration"],a);const l=h(n,["includeRaiReason"]);e!==void 0&&l!=null&&m(e,["parameters","includeRaiReason"],l);const d=h(n,["outputMimeType"]);e!==void 0&&d!=null&&m(e,["parameters","outputOptions","mimeType"],d);const f=h(n,["outputCompressionQuality"]);e!==void 0&&f!=null&&m(e,["parameters","outputOptions","compressionQuality"],f);const p=h(n,["enhanceInputImage"]);e!==void 0&&p!=null&&m(e,["parameters","upscaleConfig","enhanceInputImage"],p);const _=h(n,["imagePreservationFactor"]);e!==void 0&&_!=null&&m(e,["parameters","upscaleConfig","imagePreservationFactor"],_);const E=h(n,["labels"]);e!==void 0&&E!=null&&m(e,["labels"],E);const T=h(n,["numberOfImages"]);e!==void 0&&T!=null&&m(e,["parameters","sampleCount"],T);const C=h(n,["mode"]);return e!==void 0&&C!=null&&m(e,["parameters","mode"],C),t}function f5(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["_url","model"],Ze(n,i));const s=h(e,["image"]);s!=null&&m(t,["instances[0]","image"],wi(s));const a=h(e,["upscaleFactor"]);a!=null&&m(t,["parameters","upscaleConfig","upscaleFactor"],a);const l=h(e,["config"]);return l!=null&&d5(l,t),t}function h5(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>yp(a))),m(e,["generatedImages"],s)}return e}function p5(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["encodedVideo"]);i!=null&&m(e,["videoBytes"],Hs(i));const s=h(n,["encoding"]);return s!=null&&m(e,["mimeType"],s),e}function m5(n){const e={},t=h(n,["gcsUri"]);t!=null&&m(e,["uri"],t);const i=h(n,["bytesBase64Encoded"]);i!=null&&m(e,["videoBytes"],Hs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}function g5(n){const e={},t=h(n,["image"]);t!=null&&m(e,["_self"],wi(t));const i=h(n,["maskMode"]);return i!=null&&m(e,["maskMode"],i),e}function y5(n){const e={},t=h(n,["image"]);t!=null&&m(e,["image"],_p(t));const i=h(n,["referenceType"]);return i!=null&&m(e,["referenceType"],i),e}function _5(n){const e={},t=h(n,["image"]);t!=null&&m(e,["image"],wi(t));const i=h(n,["referenceType"]);return i!=null&&m(e,["referenceType"],i),e}function _x(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["uri"],t);const i=h(n,["videoBytes"]);i!=null&&m(e,["encodedVideo"],Hs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["encoding"],s),e}function vx(n){const e={},t=h(n,["uri"]);t!=null&&m(e,["gcsUri"],t);const i=h(n,["videoBytes"]);i!=null&&m(e,["bytesBase64Encoded"],Hs(i));const s=h(n,["mimeType"]);return s!=null&&m(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function v5(n,e){const t={},i=h(n,["displayName"]);return e!==void 0&&i!=null&&m(e,["displayName"],i),t}function E5(n){const e={},t=h(n,["config"]);return t!=null&&v5(t,e),e}function T5(n,e){const t={},i=h(n,["force"]);return e!==void 0&&i!=null&&m(e,["_query","force"],i),t}function A5(n){const e={},t=h(n,["name"]);t!=null&&m(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&T5(i,e),e}function S5(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function I5(n,e){const t={},i=h(n,["customMetadata"]);if(e!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["customMetadata"],a)}const s=h(n,["chunkingConfig"]);return e!==void 0&&s!=null&&m(e,["chunkingConfig"],s),t}function C5(n){const e={},t=h(n,["name"]);t!=null&&m(e,["name"],t);const i=h(n,["metadata"]);i!=null&&m(e,["metadata"],i);const s=h(n,["done"]);s!=null&&m(e,["done"],s);const a=h(n,["error"]);a!=null&&m(e,["error"],a);const l=h(n,["response"]);return l!=null&&m(e,["response"],R5(l)),e}function w5(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const i=h(n,["fileName"]);i!=null&&m(e,["fileName"],i);const s=h(n,["config"]);return s!=null&&I5(s,e),e}function R5(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["parent"]);i!=null&&m(e,["parent"],i);const s=h(n,["documentName"]);return s!=null&&m(e,["documentName"],s),e}function b5(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function x5(n){const e={},t=h(n,["config"]);return t!=null&&b5(t,e),e}function N5(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["fileSearchStores"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["fileSearchStores"],a)}return e}function Ex(n,e){const t={},i=h(n,["mimeType"]);e!==void 0&&i!=null&&m(e,["mimeType"],i);const s=h(n,["displayName"]);e!==void 0&&s!=null&&m(e,["displayName"],s);const a=h(n,["customMetadata"]);if(e!==void 0&&a!=null){let d=a;Array.isArray(d)&&(d=d.map(f=>f)),m(e,["customMetadata"],d)}const l=h(n,["chunkingConfig"]);return e!==void 0&&l!=null&&m(e,["chunkingConfig"],l),t}function D5(n){const e={},t=h(n,["fileSearchStoreName"]);t!=null&&m(e,["_url","file_search_store_name"],t);const i=h(n,["config"]);return i!=null&&Ex(i,e),e}function M5(n){const e={},t=h(n,["sdkHttpResponse"]);return t!=null&&m(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const P5="Content-Type",k5="X-Server-Timeout",V5="User-Agent",Ly="x-goog-api-client",L5="1.34.0",U5=`google-genai-sdk/${L5}`,O5="v1beta1",F5="v1beta";class B5{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:O5,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:F5,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const s=[this.getRequestUrlInternal(t)];return i&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[l,d]of Object.entries(e.queryParams))s.searchParams.append(l,String(d));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,s.toString(),e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?i[s]=Object.assign(Object.assign({},i[s]),a):a!==void 0&&(i[s]=a);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,s.toString(),e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,s){if(t&&t.timeout||s){const a=new AbortController,l=a.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const d=setTimeout(()=>a.abort(),t.timeout);d&&typeof d.unref=="function"&&d.unref()}s&&s.addEventListener("abort",()=>{a.abort()}),e.signal=l}return t&&t.extraBody!==null&&q5(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await cC(s),new Dy(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await cC(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return Si(this,arguments,function*(){var i;const s=(i=e==null?void 0:e.body)===null||i===void 0?void 0:i.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let l="";const d="data:",f=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:p,value:_}=yield Ne(s.read());if(p){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const E=a.decode(_,{stream:!0});try{const P=JSON.parse(E);if("error"in P){const F=JSON.parse(JSON.stringify(P.error)),V=F.status,Q=F.code,j=`got status: ${V}. ${JSON.stringify(P)}`;if(Q>=400&&Q<600)throw new mp({message:j,status:Q})}}catch(P){if(P.name==="ApiError")throw P}l+=E;let T=-1,C=0;for(;;){T=-1,C=0;for(const V of f){const Q=l.indexOf(V);Q!==-1&&(T===-1||Q<T)&&(T=Q,C=V.length)}if(T===-1)break;const P=l.substring(0,T);l=l.substring(T+C);const F=P.trim();if(F.startsWith(d)){const V=F.substring(d.length).trim();try{const Q=new Response(V,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ne(new Dy(Q))}catch(Q){throw new Error(`exception parsing stream chunk ${V}. ${Q}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=U5+" "+this.clientOptions.userAgentExtra;return e[V5]=t,e[Ly]=t,e[P5]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[s,a]of Object.entries(e.headers))i.append(s,a);e.timeout&&e.timeout>0&&i.append(k5,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,l=await a.stat(e);s.sizeBytes=String(l.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:l.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=d;const f={file:s},p=this.getFileName(e),_=me("upload/v1beta/files",f._url),E=await this.fetchUploadUrl(_,s.sizeBytes,s.mimeType,p,f,t==null?void 0:t.httpOptions);return a.upload(e,E,this)}async uploadFileToFileSearchStore(e,t,i){var s;const a=this.clientOptions.uploader,l=await a.stat(t),d=String(l.size),f=(s=i==null?void 0:i.mimeType)!==null&&s!==void 0?s:l.type;if(f===void 0||f==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,_=this.getFileName(t),E={};i!=null&&Ex(i,E);const T=await this.fetchUploadUrl(p,d,f,_,E,i==null?void 0:i.httpOptions);return a.uploadToFileSearchStore(t,T,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,s,a,l){var d;let f={};l?f=l:f={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},s?{"X-Goog-Upload-File-Name":s}:{})};const p=await this.request({path:e,body:JSON.stringify(a),httpMethod:"POST",httpOptions:f});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const _=(d=p==null?void 0:p.headers)===null||d===void 0?void 0:d["x-goog-upload-url"];if(_===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return _}}async function cC(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(i);throw t>=400&&t<600?new mp({message:s,status:t}):new Error(s)}}function q5(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const a=JSON.parse(n.body);if(typeof a=="object"&&a!==null&&!Array.isArray(a))t=a;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(a,l){const d=Object.assign({},a);for(const f in l)if(Object.prototype.hasOwnProperty.call(l,f)){const p=l[f],_=d[f];p&&typeof p=="object"&&!Array.isArray(p)&&_&&typeof _=="object"&&!Array.isArray(_)?d[f]=i(_,p):(_&&p&&typeof _!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${f}". Original type: ${typeof _}, New type: ${typeof p}. Overwriting.`),d[f]=p)}return d}const s=i(t,e);n.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const G5="mcp_used/unknown";let z5=!1;function Tx(n){for(const e of n)if(H5(e)||typeof e=="object"&&"inputSchema"in e)return!0;return z5}function Ax(n){var e;const t=(e=n[Ly])!==null&&e!==void 0?e:"";n[Ly]=(t+` ${G5}`).trimStart()}function H5(n){return n!==null&&typeof n=="object"&&n instanceof ov}function K5(n){return Si(this,arguments,function*(t,i=100){let s,a=0;for(;a<i;){const l=yield Ne(t.listTools({cursor:s}));for(const d of l.tools)yield yield Ne(d),a++;if(!l.nextCursor)break;s=l.nextCursor}})}class ov{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new ov(e,t)}async initialize(){var e,t,i,s;if(this.mcpTools.length>0)return;const a={},l=[];for(const _ of this.mcpClients)try{for(var d=!0,f=(t=void 0,Ii(K5(_))),p;p=await f.next(),e=p.done,!e;d=!0){s=p.value,d=!1;const E=s;l.push(E);const T=E.name;if(a[T])throw new Error(`Duplicate function name ${T} found in MCP tools. Please ensure function names are unique.`);a[T]=_}}catch(E){t={error:E}}finally{try{!d&&!e&&(i=f.return)&&await i.call(f)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=a}async tool(){return await this.initialize(),SO(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[i.name];let a;this.config.timeout&&(a={timeout:this.config.timeout});const l=await s.callTool({name:i.name,arguments:i.args},void 0,a);t.push({functionResponse:{name:i.name,response:l.isError?{error:l}:l}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function J5(n,e,t){const i=new mO;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(i,s),e(i)}class Y5{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),l=X5(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),f=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${d}`;let p=()=>{};const _=new Promise(X=>{p=X}),E=e.callbacks,T=function(){p({})},C=this.apiClient,P={onopen:T,onmessage:X=>{J5(C,E.onmessage,X)},onerror:(t=E==null?void 0:E.onerror)!==null&&t!==void 0?t:function(X){},onclose:(i=E==null?void 0:E.onclose)!==null&&i!==void 0?i:function(X){}},F=this.webSocketFactory.create(f,Q5(l),P);F.connect(),await _;const j={setup:{model:Ze(this.apiClient,e.model)}};return F.send(JSON.stringify(j)),new $5(F,this.apiClient)}}class $5{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=E3(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=v3(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(tl.PLAY)}pause(){this.sendPlaybackControl(tl.PAUSE)}stop(){this.sendPlaybackControl(tl.STOP)}resetContext(){this.sendPlaybackControl(tl.RESET_CONTEXT)}close(){this.conn.close()}}function Q5(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function X5(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const W5="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Z5(n,e,t){const i=new pO;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const a=JSON.parse(s);if(n.isVertexAI()){const l=S3(a);Object.assign(i,l)}else Object.assign(i,a);e(i)}class j5{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new Y5(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,s,a,l,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const f=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let _;const E=this.apiClient.getHeaders();e.config&&e.config.tools&&Tx(e.config.tools)&&Ax(E);const T=iB(E);if(this.apiClient.isVertexAI())_=`${f}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(T,_);else{const x=this.apiClient.getApiKey();let L="BidiGenerateContent",k="key";x!=null&&x.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),L="BidiGenerateContentConstrained",k="access_token"),_=`${f}/ws/google.ai.generativelanguage.${p}.GenerativeService.${L}?${k}=${x}`}let C=()=>{};const P=new Promise(x=>{C=x}),F=e.callbacks,V=function(){var x;(x=F==null?void 0:F.onopen)===null||x===void 0||x.call(F),C({})},Q=this.apiClient,j={onopen:V,onmessage:x=>{Z5(Q,F.onmessage,x)},onerror:(t=F==null?void 0:F.onerror)!==null&&t!==void 0?t:function(x){},onclose:(i=F==null?void 0:F.onclose)!==null&&i!==void 0?i:function(x){}},X=this.webSocketFactory.create(_,nB(T),j);X.connect(),await P;let se=Ze(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&se.startsWith("publishers/")){const x=this.apiClient.getProject(),L=this.apiClient.getLocation();se=`projects/${x}/locations/${L}/`+se}let le={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Uc.AUDIO]}:e.config.responseModalities=[Uc.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const ue=(d=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&d!==void 0?d:[],N=[];for(const x of ue)if(this.isCallableTool(x)){const L=x;N.push(await L.tool())}else N.push(x);N.length>0&&(e.config.tools=N);const D={model:se,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?le=_3(this.apiClient,D):le=y3(this.apiClient,D),delete le.config,X.send(JSON.stringify(le)),new tB(X,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const eB={turnComplete:!0};class tB{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=ai(t.turns),e.isVertexAI()||(i=i.map(s=>gp(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const a of i){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(W5)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},eB),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:A3(e)}:t={realtimeInput:T3(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function nB(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function iB(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dC=10;function fC(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const l of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(cl(l)){s=!0;break}if(!s)return!0;const a=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function cl(n){return"callTool"in n&&typeof n.callTool=="function"}function rB(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>cl(s)))!==null&&i!==void 0?i:!1}function hC(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,s)=>{if(cl(i))return;const a=i;a.functionDeclarations&&a.functionDeclarations.length>0&&t.push(s)}),t}function pC(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sB extends Ur{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,s,a,l,d;const f=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!rB(t)||fC(t.config))return await this.generateContentInternal(f);const p=hC(t);if(p.length>0){const F=p.map(V=>`tools[${V}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${F}.`)}let _,E;const T=ai(f.contents),C=(a=(s=(i=f.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:dC;let P=0;for(;P<C&&(_=await this.generateContentInternal(f),!(!_.functionCalls||_.functionCalls.length===0));){const F=_.candidates[0].content,V=[];for(const Q of(d=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&d!==void 0?d:[])if(cl(Q)){const X=await Q.callTool(_.functionCalls);V.push(...X)}P++,E={role:"user",parts:V},f.contents=ai(f.contents),f.contents.push(F),f.contents.push(E),pC(f.config)&&(T.push(F),T.push(E))}return pC(f.config)&&(_.automaticFunctionCallingHistory=T),_},this.generateContentStream=async t=>{var i,s,a,l,d;if(this.maybeMoveToResponseJsonSchem(t),fC(t.config)){const E=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(E)}const f=hC(t);if(f.length>0){const E=f.map(T=>`tools[${T}]`).join(", ");throw new Error(`Incompatible tools found at ${E}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(a=(s=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||a===void 0?void 0:a.streamFunctionCallArguments,_=(d=(l=t==null?void 0:t.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||d===void 0?void 0:d.disable;if(p&&!_)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var s;let a;const l=[];if(i!=null&&i.generatedImages)for(const f of i.generatedImages)f&&(f!=null&&f.safetyAttributes)&&((s=f==null?void 0:f.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=f==null?void 0:f.safetyAttributes:l.push(f);let d;return a?d={generatedImages:l,positivePromptSafetyAttributes:a,sdkHttpResponse:i.sdkHttpResponse}:d={generatedImages:l,sdkHttpResponse:i.sdkHttpResponse},d}),this.list=async t=>{var i;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((i=l.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new Wo(Mr.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(l),l)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var i,s,a,l,d,f;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.uri&&(!((f=(d=t.source)===null||d===void 0?void 0:d.video)===null||f===void 0)&&f.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,s;const a=(t=e.config)===null||t===void 0?void 0:t.tools;if(!a)return e;const l=await Promise.all(a.map(async f=>cl(f)?await f.tool():f)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(d.config.tools=l,e.config&&e.config.tools&&Tx(e.config.tools)){const f=(s=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&s!==void 0?s:{};let p=Object.assign({},f);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),Ax(p),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return d}async initAfcToolsMap(e){var t,i,s;const a=new Map;for(const l of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(cl(l)){const d=l,f=await d.tool();for(const p of(s=f.functionDeclarations)!==null&&s!==void 0?s:[]){if(!p.name)throw new Error("Function declaration name is required.");if(a.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);a.set(p.name,d)}}return a}async processAfcStream(e){var t,i,s;const a=(s=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:dC;let l=!1,d=0;const f=await this.initAfcToolsMap(e);return(function(p,_,E){return Si(this,arguments,function*(){for(var T,C,P,F,V,Q;d<a;){l&&(d++,l=!1);const le=yield Ne(p.processParamsMaybeAddMcpUsage(E)),ue=yield Ne(p.generateContentStreamInternal(le)),N=[],D=[];try{for(var j=!0,X=(C=void 0,Ii(ue)),se;se=yield Ne(X.next()),T=se.done,!T;j=!0){F=se.value,j=!1;const x=F;if(yield yield Ne(x),x.candidates&&(!((V=x.candidates[0])===null||V===void 0)&&V.content)){D.push(x.candidates[0].content);for(const L of(Q=x.candidates[0].content.parts)!==null&&Q!==void 0?Q:[])if(d<a&&L.functionCall){if(!L.functionCall.name)throw new Error("Function call name was not returned by the model.");if(_.has(L.functionCall.name)){const k=yield Ne(_.get(L.functionCall.name).callTool([L.functionCall]));N.push(...k)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${_.keys()}, mising tool: ${L.functionCall.name}`)}}}}catch(x){C={error:x}}finally{try{!j&&!T&&(P=X.return)&&(yield Ne(P.call(X)))}finally{if(C)throw C.error}}if(N.length>0){l=!0;const x=new ec;x.candidates=[{content:{role:"user",parts:N}}],yield yield Ne(x);const L=[];L.push(...D),L.push({role:"user",parts:N});const k=ai(E.contents).concat(L);E.contents=k}else break}})})(this,f,e)}async generateContentInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=aC(this.apiClient,e);return d=me("{model}:generateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=uC(_),T=new ec;return Object.assign(T,E),T})}else{const p=oC(this.apiClient,e);return d=me("{model}:generateContent",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=lC(_),T=new ec;return Object.assign(T,E),T})}}async generateContentStreamInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=aC(this.apiClient,e);return d=me("{model}:streamGenerateContent?alt=sse",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),l.then(function(E){return Si(this,arguments,function*(){var T,C,P,F;try{for(var V=!0,Q=Ii(E),j;j=yield Ne(Q.next()),T=j.done,!T;V=!0){F=j.value,V=!1;const X=F,se=uC(yield Ne(X.json()));se.sdkHttpResponse={headers:X.headers};const le=new ec;Object.assign(le,se),yield yield Ne(le)}}catch(X){C={error:X}}finally{try{!V&&!T&&(P=Q.return)&&(yield Ne(P.call(Q)))}finally{if(C)throw C.error}}})})}else{const p=oC(this.apiClient,e);return d=me("{model}:streamGenerateContent?alt=sse",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.requestStream({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),l.then(function(E){return Si(this,arguments,function*(){var T,C,P,F;try{for(var V=!0,Q=Ii(E),j;j=yield Ne(Q.next()),T=j.done,!T;V=!0){F=j.value,V=!1;const X=F,se=lC(yield Ne(X.json()));se.sdkHttpResponse={headers:X.headers};const le=new ec;Object.assign(le,se),yield yield Ne(le)}}catch(X){C={error:X}}finally{try{!V&&!T&&(P=Q.return)&&(yield Ne(P.call(Q)))}finally{if(C)throw C.error}}})})}}async embedContent(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=j3(this.apiClient,e);return d=me("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=tF(_),T=new zI;return Object.assign(T,E),T})}else{const p=Z3(this.apiClient,e);return d=me("{model}:batchEmbedContents",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=eF(_),T=new zI;return Object.assign(T,E),T})}}async generateImagesInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=fF(this.apiClient,e);return d=me("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=pF(_),T=new HI;return Object.assign(T,E),T})}else{const p=dF(this.apiClient,e);return d=me("{model}:predict",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=hF(_),T=new HI;return Object.assign(T,E),T})}}async editImageInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=$3(this.apiClient,e);return a=me("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=Q3(f),_=new iO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=f5(this.apiClient,e);return a=me("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=h5(f),_=new rO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=YF(this.apiClient,e);return a=me("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=$F(f),_=new sO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=e5(this.apiClient,e);return a=me("{model}:predict",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=t5(f),_=new oO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=DF(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Vy(_))}else{const p=NF(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>ky(_))}}async listInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=BF(this.apiClient,e);return d=me("{models_url}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=GF(_),T=new KI;return Object.assign(T,E),T})}else{const p=FF(this.apiClient,e);return d=me("{models_url}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=qF(_),T=new KI;return Object.assign(T,E),T})}}async update(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=c5(this.apiClient,e);return d=me("{model}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>Vy(_))}else{const p=u5(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>ky(_))}}async delete(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=H3(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=J3(_),T=new JI;return Object.assign(T,E),T})}else{const p=z3(this.apiClient,e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=K3(_),T=new JI;return Object.assign(T,E),T})}}async countTokens(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=B3(this.apiClient,e);return d=me("{model}:countTokens",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=G3(_),T=new YI;return Object.assign(T,E),T})}else{const p=F3(this.apiClient,e);return d=me("{model}:countTokens",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=q3(_),T=new YI;return Object.assign(T,E),T})}}async computeTokens(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=M3(this.apiClient,e);return a=me("{model}:computeTokens",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>{const p=P3(f),_=new aO;return Object.assign(_,p),_})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=EF(this.apiClient,e);return d=me("{model}:predictLongRunning",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l.then(_=>{const E=_F(_),T=new Fh;return Object.assign(T,E),T})}else{const p=vF(this.apiClient,e);return d=me("{model}:predictLongRunning",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l.then(_=>{const E=yF(_),T=new Fh;return Object.assign(T,E),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oB extends Ur{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;i&&"httpOptions"in i&&(a=i.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=WU(e);return d=me("{operationName}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json()),l}else{const p=XU(e);return d=me("{operationName}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json()),l}}async fetchPredictVideosOperationInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=zU(e);return a=me("{resourceName}:fetchPredictOperation",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aB(n){const e={},t=h(n,["data"]);if(t!=null&&m(e,["data"],t),h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function lB(n){const e={},t=h(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>yB(a))),m(e,["parts"],s)}const i=h(n,["role"]);return i!=null&&m(e,["role"],i),e}function uB(n,e,t){const i={},s=h(e,["expireTime"]);t!==void 0&&s!=null&&m(t,["expireTime"],s);const a=h(e,["newSessionExpireTime"]);t!==void 0&&a!=null&&m(t,["newSessionExpireTime"],a);const l=h(e,["uses"]);t!==void 0&&l!=null&&m(t,["uses"],l);const d=h(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&m(t,["bidiGenerateContentSetup"],gB(n,d));const f=h(e,["lockAdditionalFields"]);return t!==void 0&&f!=null&&m(t,["fieldMask"],f),i}function cB(n,e){const t={},i=h(e,["config"]);return i!=null&&m(t,["config"],uB(n,i,t)),t}function dB(n){const e={};if(h(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=h(n,["fileUri"]);t!=null&&m(e,["fileUri"],t);const i=h(n,["mimeType"]);return i!=null&&m(e,["mimeType"],i),e}function fB(n){const e={},t=h(n,["id"]);t!=null&&m(e,["id"],t);const i=h(n,["args"]);i!=null&&m(e,["args"],i);const s=h(n,["name"]);if(s!=null&&m(e,["name"],s),h(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(h(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function hB(n){const e={};if(h(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=h(n,["enableWidget"]);return t!=null&&m(e,["enableWidget"],t),e}function pB(n){const e={};if(h(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(h(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=h(n,["timeRangeFilter"]);return t!=null&&m(e,["timeRangeFilter"],t),e}function mB(n,e){const t={},i=h(n,["generationConfig"]);e!==void 0&&i!=null&&m(e,["setup","generationConfig"],i);const s=h(n,["responseModalities"]);e!==void 0&&s!=null&&m(e,["setup","generationConfig","responseModalities"],s);const a=h(n,["temperature"]);e!==void 0&&a!=null&&m(e,["setup","generationConfig","temperature"],a);const l=h(n,["topP"]);e!==void 0&&l!=null&&m(e,["setup","generationConfig","topP"],l);const d=h(n,["topK"]);e!==void 0&&d!=null&&m(e,["setup","generationConfig","topK"],d);const f=h(n,["maxOutputTokens"]);e!==void 0&&f!=null&&m(e,["setup","generationConfig","maxOutputTokens"],f);const p=h(n,["mediaResolution"]);e!==void 0&&p!=null&&m(e,["setup","generationConfig","mediaResolution"],p);const _=h(n,["seed"]);e!==void 0&&_!=null&&m(e,["setup","generationConfig","seed"],_);const E=h(n,["speechConfig"]);e!==void 0&&E!=null&&m(e,["setup","generationConfig","speechConfig"],sv(E));const T=h(n,["thinkingConfig"]);e!==void 0&&T!=null&&m(e,["setup","generationConfig","thinkingConfig"],T);const C=h(n,["enableAffectiveDialog"]);e!==void 0&&C!=null&&m(e,["setup","generationConfig","enableAffectiveDialog"],C);const P=h(n,["systemInstruction"]);e!==void 0&&P!=null&&m(e,["setup","systemInstruction"],lB(mn(P)));const F=h(n,["tools"]);if(e!==void 0&&F!=null){let ue=ql(F);Array.isArray(ue)&&(ue=ue.map(N=>vB(Bl(N)))),m(e,["setup","tools"],ue)}const V=h(n,["sessionResumption"]);e!==void 0&&V!=null&&m(e,["setup","sessionResumption"],_B(V));const Q=h(n,["inputAudioTranscription"]);e!==void 0&&Q!=null&&m(e,["setup","inputAudioTranscription"],Q);const j=h(n,["outputAudioTranscription"]);e!==void 0&&j!=null&&m(e,["setup","outputAudioTranscription"],j);const X=h(n,["realtimeInputConfig"]);e!==void 0&&X!=null&&m(e,["setup","realtimeInputConfig"],X);const se=h(n,["contextWindowCompression"]);e!==void 0&&se!=null&&m(e,["setup","contextWindowCompression"],se);const le=h(n,["proactivity"]);if(e!==void 0&&le!=null&&m(e,["setup","proactivity"],le),h(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function gB(n,e){const t={},i=h(e,["model"]);i!=null&&m(t,["setup","model"],Ze(n,i));const s=h(e,["config"]);return s!=null&&m(t,["config"],mB(s,t)),t}function yB(n){const e={},t=h(n,["mediaResolution"]);t!=null&&m(e,["mediaResolution"],t);const i=h(n,["codeExecutionResult"]);i!=null&&m(e,["codeExecutionResult"],i);const s=h(n,["executableCode"]);s!=null&&m(e,["executableCode"],s);const a=h(n,["fileData"]);a!=null&&m(e,["fileData"],dB(a));const l=h(n,["functionCall"]);l!=null&&m(e,["functionCall"],fB(l));const d=h(n,["functionResponse"]);d!=null&&m(e,["functionResponse"],d);const f=h(n,["inlineData"]);f!=null&&m(e,["inlineData"],aB(f));const p=h(n,["text"]);p!=null&&m(e,["text"],p);const _=h(n,["thought"]);_!=null&&m(e,["thought"],_);const E=h(n,["thoughtSignature"]);E!=null&&m(e,["thoughtSignature"],E);const T=h(n,["videoMetadata"]);return T!=null&&m(e,["videoMetadata"],T),e}function _B(n){const e={},t=h(n,["handle"]);if(t!=null&&m(e,["handle"],t),h(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function vB(n){const e={},t=h(n,["functionDeclarations"]);if(t!=null){let _=t;Array.isArray(_)&&(_=_.map(E=>E)),m(e,["functionDeclarations"],_)}if(h(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=h(n,["googleSearchRetrieval"]);i!=null&&m(e,["googleSearchRetrieval"],i);const s=h(n,["computerUse"]);s!=null&&m(e,["computerUse"],s);const a=h(n,["fileSearch"]);a!=null&&m(e,["fileSearch"],a);const l=h(n,["codeExecution"]);if(l!=null&&m(e,["codeExecution"],l),h(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const d=h(n,["googleMaps"]);d!=null&&m(e,["googleMaps"],hB(d));const f=h(n,["googleSearch"]);f!=null&&m(e,["googleSearch"],pB(f));const p=h(n,["urlContext"]);return p!=null&&m(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function EB(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const s=Object.keys(i).map(a=>`${t}.${a}`);e.push(...s)}else e.push(t)}return e.join(",")}function TB(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const a=i.setup;typeof a=="object"&&a!==null?(n.bidiGenerateContentSetup=a,t=a):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const a=EB(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)a?n.fieldMask=a:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];s.length>0&&(d=s.map(p=>l.includes(p)?`generationConfig.${p}`:p));const f=[];a&&f.push(a),d.length>0&&f.push(...d),f.length>0?n.fieldMask=f.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class AB extends Ur{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=cB(this.apiClient,e);a=me("auth_tokens",d._url),l=d._query,delete d.config,delete d._url,delete d._query;const f=TB(d,e.config);return s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),s.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SB(n,e){const t={},i=h(n,["force"]);return e!==void 0&&i!=null&&m(e,["_query","force"],i),t}function IB(n){const e={},t=h(n,["name"]);t!=null&&m(e,["_url","name"],t);const i=h(n,["config"]);return i!=null&&SB(i,e),e}function CB(n){const e={},t=h(n,["name"]);return t!=null&&m(e,["_url","name"],t),e}function wB(n,e){const t={},i=h(n,["pageSize"]);e!==void 0&&i!=null&&m(e,["_query","pageSize"],i);const s=h(n,["pageToken"]);return e!==void 0&&s!=null&&m(e,["_query","pageToken"],s),t}function RB(n){const e={},t=h(n,["parent"]);t!=null&&m(e,["_url","parent"],t);const i=h(n,["config"]);return i!=null&&wB(i,e),e}function bB(n){const e={},t=h(n,["sdkHttpResponse"]);t!=null&&m(e,["sdkHttpResponse"],t);const i=h(n,["nextPageToken"]);i!=null&&m(e,["nextPageToken"],i);const s=h(n,["documents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(l=>l)),m(e,["documents"],a)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xB extends Ur{constructor(e){super(),this.apiClient=e,this.list=async t=>new Wo(Mr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=CB(e);return a=me("{name}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var t,i;let s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=IB(e);s=me("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=RB(e);return a=me("{parent}/documents",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=bB(f),_=new lO;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class NB extends Ur{constructor(e,t=new xB(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new Wo(Mr.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=E5(e);return a=me("fileSearchStores",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async get(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=S5(e);return a=me("{name}",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>f)}}async delete(e){var t,i;let s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=A5(e);s=me("{name}",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=x5(e);return a=me("fileSearchStores",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=N5(f),_=new uO;return Object.assign(_,p),_})}}async uploadToFileSearchStoreInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=D5(e);return a=me("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=M5(f),_=new cO;return Object.assign(_,p),_})}}async importFile(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=w5(e);return a=me("{file_search_store_name}:importFile",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json()),s.then(f=>{const p=C5(f),_=new ev;return Object.assign(_,p),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Sx=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return Sx=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))};const DB=()=>Sx();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uy(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const Oy=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class li extends Error{}class An extends li{constructor(e,t,i,s){super(`${An.makeMessage(e,t,i)}`),this.status=e,this.headers=s,this.error=t}static makeMessage(e,t,i){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,i,s){if(!e||!s)return new vp({message:i,cause:Oy(t)});const a=t;return e===400?new Cx(e,a,i,s):e===401?new wx(e,a,i,s):e===403?new Rx(e,a,i,s):e===404?new bx(e,a,i,s):e===409?new xx(e,a,i,s):e===422?new Nx(e,a,i,s):e===429?new Dx(e,a,i,s):e>=500?new Mx(e,a,i,s):new An(e,a,i,s)}}class Fy extends An{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class vp extends An{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Ix extends vp{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Cx extends An{}class wx extends An{}class Rx extends An{}class bx extends An{}class xx extends An{}class Nx extends An{}class Dx extends An{}class Mx extends An{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const MB=/^[a-z][a-z0-9+.-]*:/i,PB=n=>MB.test(n);let By=n=>(By=Array.isArray,By(n));const kB=By;let VB=kB;const mC=VB;function LB(n){if(!n)return!0;for(const e in n)return!1;return!0}function UB(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const OB=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new li(`${n} must be an integer`);if(e<0)throw new li(`${n} must be a positive integer`);return e},FB=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BB=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ja="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qB(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const GB=()=>{var n,e,t,i,s;const a=qB();if(a==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ja,"X-Stainless-OS":yC(Deno.build.os),"X-Stainless-Arch":gC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ja,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(a==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ja,"X-Stainless-OS":yC((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":gC((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const l=zB();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ja,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ja,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function zB(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const i=t.exec(navigator.userAgent);if(i){const s=i[1]||0,a=i[2]||0,l=i[3]||0;return{browser:e,version:`${s}.${a}.${l}`}}}return null}const gC=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",yC=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let qf;const HB=()=>qf??(qf=GB());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KB(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Px(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function JB(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return Px({start(){},async pull(t){const{done:i,value:s}=await e.next();i?t.close():t.enqueue(s)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function kx(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function YB(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const i=n.getReader(),s=i.cancel();i.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $B=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vx=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function zg(n,e,t){return Vx(),new File(n,e??"unknown_file",t)}function QB(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const XB=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Lx=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",WB=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Lx(n),ZB=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function jB(n,e,t){if(Vx(),n=await n,WB(n))return n instanceof File?n:zg([await n.arrayBuffer()],n.name);if(ZB(n)){const s=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),zg(await qy(s),e,t)}const i=await qy(n);if(e||(e=QB(n)),!(t!=null&&t.type)){const s=i.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof s=="string"&&(t=Object.assign(Object.assign({},t),{type:s}))}return zg(i,e,t)}async function qy(n){var e,t,i,s,a;let l=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)l.push(n);else if(Lx(n))l.push(n instanceof Blob?n:await n.arrayBuffer());else if(XB(n))try{for(var d=!0,f=Ii(n),p;p=await f.next(),e=p.done,!e;d=!0){s=p.value,d=!1;const _=s;l.push(...await qy(_))}}catch(_){t={error:_}}finally{try{!d&&!e&&(i=f.return)&&await i.call(f)}finally{if(t)throw t.error}}else{const _=(a=n==null?void 0:n.constructor)===null||a===void 0?void 0:a.name;throw new Error(`Unexpected data type: ${typeof n}${_?`; constructor: ${_}`:""}${e9(n)}`)}return l}function e9(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ux{constructor(e){this._client=e}}Ux._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ox(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const _C=Object.freeze(Object.create(null)),t9=(n=Ox)=>(function(t,...i){if(t.length===1)return t[0];let s=!1;const a=[],l=t.reduce((_,E,T)=>{var C,P,F;/[?#]/.test(E)&&(s=!0);const V=i[T];let Q=(s?encodeURIComponent:n)(""+V);return T!==i.length&&(V==null||typeof V=="object"&&V.toString===((F=Object.getPrototypeOf((P=Object.getPrototypeOf((C=V.hasOwnProperty)!==null&&C!==void 0?C:_C))!==null&&P!==void 0?P:_C))===null||F===void 0?void 0:F.toString))&&(Q=V+"",a.push({start:_.length+E.length,length:Q.length,error:`Value of type ${Object.prototype.toString.call(V).slice(8,-1)} is not a valid path parameter`})),_+E+(T===i.length?"":Q)},""),d=l.split(/[?#]/,1)[0],f=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let p;for(;(p=f.exec(d))!==null;)a.push({start:p.index,length:p[0].length,error:`Value "${p[0]}" can't be safely passed as a path parameter`});if(a.sort((_,E)=>_.start-E.start),a.length>0){let _=0;const E=a.reduce((T,C)=>{const P=" ".repeat(C.start-_),F="^".repeat(C.length);return _=C.start+C.length,T+P+F},"");throw new li(`Path parameters result in path with invalid segments:
${a.map(T=>T.error).join(`
`)}
${l}
${E}`)}return l}),Gf=t9(Ox);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fx extends Ux{create(e,t){var i;const{api_version:s=this._client.apiVersion}=e,a=qh(e,["api_version"]);if("model"in a&&"agent_config"in a)throw new li("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in a&&"generation_config"in a)throw new li("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Gf`/${s}/interactions`,Object.assign(Object.assign({body:a},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){const{api_version:s=this._client.apiVersion}=t??{};return this._client.delete(Gf`/${s}/interactions/${e}`,i)}cancel(e,t={},i){const{api_version:s=this._client.apiVersion}=t??{};return this._client.post(Gf`/${s}/interactions/${e}/cancel`,i)}get(e,t={},i){var s;const a=t??{},{api_version:l=this._client.apiVersion}=a,d=qh(a,["api_version"]);return this._client.get(Gf`/${l}/interactions/${e}`,Object.assign(Object.assign({query:d},i),{stream:(s=t==null?void 0:t.stream)!==null&&s!==void 0?s:!1}))}}Fx._key=Object.freeze(["interactions"]);class Bx extends Fx{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n9(n){let e=0;for(const s of n)e+=s.length;const t=new Uint8Array(e);let i=0;for(const s of n)t.set(s,i),i+=s.length;return t}let zf;function av(n){let e;return(zf??(e=new globalThis.TextEncoder,zf=e.encode.bind(e)))(n)}let Hf;function vC(n){let e;return(Hf??(e=new globalThis.TextDecoder,Hf=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ep{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?av(e):e;this.buffer=n9([this.buffer,t]);const i=[];let s;for(;(s=i9(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){i.push(vC(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const a=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,l=vC(this.buffer.subarray(0,a));i.push(l),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}Ep.NEWLINE_CHARS=new Set([`
`,"\r"]);Ep.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function i9(n,e){for(let s=e??0;s<n.length;s++){if(n[s]===10)return{preceding:s,index:s+1,carriage:!1};if(n[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function r9(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Gh={off:0,error:200,warn:300,info:400,debug:500},EC=(n,e,t)=>{if(n){if(UB(Gh,n))return n;En(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(Gh))}`)}};function lc(){}function Kf(n,e,t){return!e||Gh[n]>Gh[t]?lc:e[n].bind(e)}const s9={error:lc,warn:lc,info:lc,debug:lc};let TC=new WeakMap;function En(n){var e;const t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return s9;const s=TC.get(t);if(s&&s[0]===i)return s[1];const a={error:Kf("error",t,i),warn:Kf("warn",t,i),info:Kf("info",t,i),debug:Kf("debug",t,i)};return TC.set(t,[i,a]),a}const Ro=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nl{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let s=!1;const a=i?En(i):console;function l(){return Si(this,arguments,function*(){var f,p,_,E;if(s)throw new li("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let T=!1;try{try{for(var C=!0,P=Ii(o9(e,t)),F;F=yield Ne(P.next()),f=F.done,!f;C=!0){E=F.value,C=!1;const V=E;if(!T)if(V.data.startsWith("[DONE]")){T=!0;continue}else try{yield yield Ne(JSON.parse(V.data))}catch(Q){throw a.error("Could not parse message into JSON:",V.data),a.error("From chunk:",V.raw),Q}}}catch(V){p={error:V}}finally{try{!C&&!f&&(_=P.return)&&(yield Ne(_.call(P)))}finally{if(p)throw p.error}}T=!0}catch(V){if(Uy(V))return yield Ne(void 0);throw V}finally{T||t.abort()}})}return new nl(l,t,i)}static fromReadableStream(e,t,i){let s=!1;function a(){return Si(this,arguments,function*(){var f,p,_,E;const T=new Ep,C=kx(e);try{for(var P=!0,F=Ii(C),V;V=yield Ne(F.next()),f=V.done,!f;P=!0){E=V.value,P=!1;const Q=E;for(const j of T.decode(Q))yield yield Ne(j)}}catch(Q){p={error:Q}}finally{try{!P&&!f&&(_=F.return)&&(yield Ne(_.call(F)))}finally{if(p)throw p.error}}for(const Q of T.flush())yield yield Ne(Q)})}function l(){return Si(this,arguments,function*(){var f,p,_,E;if(s)throw new li("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let T=!1;try{try{for(var C=!0,P=Ii(a()),F;F=yield Ne(P.next()),f=F.done,!f;C=!0){E=F.value,C=!1;const V=E;T||V&&(yield yield Ne(JSON.parse(V)))}}catch(V){p={error:V}}finally{try{!C&&!f&&(_=P.return)&&(yield Ne(_.call(P)))}finally{if(p)throw p.error}}T=!0}catch(V){if(Uy(V))return yield Ne(void 0);throw V}finally{T||t.abort()}})}return new nl(l,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],i=this.iterator(),s=a=>({next:()=>{if(a.length===0){const l=i.next();e.push(l),t.push(l)}return a.shift()}});return[new nl(()=>s(e),this.controller,this.client),new nl(()=>s(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return Px({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:s,done:a}=await t.next();if(a)return i.close();const l=av(JSON.stringify(s)+`
`);i.enqueue(l)}catch(s){i.error(s)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}}function o9(n,e){return Si(this,arguments,function*(){var i,s,a,l;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new li("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new li("Attempted to iterate over a response with no body");const d=new l9,f=new Ep,p=kx(n.body);try{for(var _=!0,E=Ii(a9(p)),T;T=yield Ne(E.next()),i=T.done,!i;_=!0){l=T.value,_=!1;const C=l;for(const P of f.decode(C)){const F=d.decode(P);F&&(yield yield Ne(F))}}}catch(C){s={error:C}}finally{try{!_&&!i&&(a=E.return)&&(yield Ne(a.call(E)))}finally{if(s)throw s.error}}for(const C of f.flush()){const P=d.decode(C);P&&(yield yield Ne(P))}})}function a9(n){return Si(this,arguments,function*(){var t,i,s,a;let l=new Uint8Array;try{for(var d=!0,f=Ii(n),p;p=yield Ne(f.next()),t=p.done,!t;d=!0){a=p.value,d=!1;const _=a;if(_==null)continue;const E=_ instanceof ArrayBuffer?new Uint8Array(_):typeof _=="string"?av(_):_;let T=new Uint8Array(l.length+E.length);T.set(l),T.set(E,l.length),l=T;let C;for(;(C=r9(l))!==-1;)yield yield Ne(l.slice(0,C)),l=l.slice(C)}}catch(_){i={error:_}}finally{try{!d&&!t&&(s=f.return)&&(yield Ne(s.call(f)))}finally{if(i)throw i.error}}l.length>0&&(yield yield Ne(l))})}class l9{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,s]=u9(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function u9(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function c9(n,e){const{response:t,requestLogID:i,retryOfRequestLogID:s,startTime:a}=e,l=await(async()=>{var d;if(e.options.stream)return En(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):nl.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const f=t.headers.get("content-type"),p=(d=f==null?void 0:f.split(";")[0])===null||d===void 0?void 0:d.trim();return(p==null?void 0:p.includes("application/json"))||(p==null?void 0:p.endsWith("+json"))?await t.json():await t.text()})();return En(n).debug(`[${i}] response parsed`,Ro({retryOfRequestLogID:s,url:t.url,status:t.status,body:l,durationMs:Date.now()-a})),l}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lv extends Promise{constructor(e,t,i=c9){super(s=>{s(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new lv(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qx=Symbol("brand.privateNullableHeaders");function*d9(n){if(!n)return;if(qx in n){const{values:i,nulls:s}=n;yield*i.entries();for(const a of s)yield[a,null];return}let e=!1,t;n instanceof Headers?t=n.entries():mC(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){const s=i[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const a=mC(i[1])?i[1]:[i[1]];let l=!1;for(const d of a)d!==void 0&&(e&&!l&&(l=!0,yield[s,null]),yield[s,d])}}const tc=n=>{const e=new Headers,t=new Set;for(const i of n){const s=new Set;for(const[a,l]of d9(i)){const d=a.toLowerCase();s.has(d)||(e.delete(a),s.add(d)),l===null?(e.delete(a),t.add(d)):(e.append(a,l),t.delete(d))}}return{[qx]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Hg=n=>{var e,t,i,s,a,l;if(typeof globalThis.process<"u")return(i=(t=(e=UU)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(l=(a=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||a===void 0?void 0:a.call(s,n))===null||l===void 0?void 0:l.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Gx;class Tp{constructor(e){var t,i,s,a,l,d,f,{baseURL:p=Hg("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:_=(t=Hg("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:E="v1beta"}=e,T=qh(e,["baseURL","apiKey","apiVersion"]);const C=Object.assign(Object.assign({apiKey:_,apiVersion:E},T),{baseURL:p||"https://generativelanguage.googleapis.com"});this.baseURL=C.baseURL,this.timeout=(i=C.timeout)!==null&&i!==void 0?i:Tp.DEFAULT_TIMEOUT,this.logger=(s=C.logger)!==null&&s!==void 0?s:console;const P="warn";this.logLevel=P,this.logLevel=(l=(a=EC(C.logLevel,"ClientOptions.logLevel",this))!==null&&a!==void 0?a:EC(Hg("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:P,this.fetchOptions=C.fetchOptions,this.maxRetries=(d=C.maxRetries)!==null&&d!==void 0?d:2,this.fetch=(f=C.fetch)!==null&&f!==void 0?f:KB(),this.encoder=$B,this._options=C,this.apiKey=_,this.apiVersion=E,this.clientAdapter=C.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=tc([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return tc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return tc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,i])=>typeof i<"u").map(([t,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(t)}=`;throw new li(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${ja}`}defaultIdempotencyKey(){return`stainless-node-retry-${DB()}`}makeStatusError(e,t,i,s){return An.generate(e,t,i,s)}buildURL(e,t,i){const s=!this.baseURLOverridden()&&i||this.baseURL,a=PB(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return LB(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:i}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,i){return this.request(Promise.resolve(i).then(s=>Object.assign({method:e,path:t},s)))}request(e,t=null){return new lv(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,i){var s,a,l;const d=await e,f=(s=d.maxRetries)!==null&&s!==void 0?s:this.maxRetries;t==null&&(t=f),await this.prepareOptions(d);const{req:p,url:_,timeout:E}=await this.buildRequest(d,{retryCount:f-t});await this.prepareRequest(p,{url:_,options:d});const T="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),C=i===void 0?"":`, retryOf: ${i}`,P=Date.now();if(En(this).debug(`[${T}] sending request`,Ro({retryOfRequestLogID:i,method:d.method,url:_,options:d,headers:p.headers})),!((a=d.signal)===null||a===void 0)&&a.aborted)throw new Fy;const F=new AbortController,V=await this.fetchWithTimeout(_,p,E,F).catch(Oy),Q=Date.now();if(V instanceof globalThis.Error){const X=`retrying, ${t} attempts remaining`;if(!((l=d.signal)===null||l===void 0)&&l.aborted)throw new Fy;const se=Uy(V)||/timed? ?out/i.test(String(V)+("cause"in V?String(V.cause):""));if(t)return En(this).info(`[${T}] connection ${se?"timed out":"failed"} - ${X}`),En(this).debug(`[${T}] connection ${se?"timed out":"failed"} (${X})`,Ro({retryOfRequestLogID:i,url:_,durationMs:Q-P,message:V.message})),this.retryRequest(d,t,i??T);throw En(this).info(`[${T}] connection ${se?"timed out":"failed"} - error; no more retries left`),En(this).debug(`[${T}] connection ${se?"timed out":"failed"} (error; no more retries left)`,Ro({retryOfRequestLogID:i,url:_,durationMs:Q-P,message:V.message})),se?new Ix:new vp({cause:V})}const j=`[${T}${C}] ${p.method} ${_} ${V.ok?"succeeded":"failed"} with status ${V.status} in ${Q-P}ms`;if(!V.ok){const X=await this.shouldRetry(V);if(t&&X){const x=`retrying, ${t} attempts remaining`;return await YB(V.body),En(this).info(`${j} - ${x}`),En(this).debug(`[${T}] response error (${x})`,Ro({retryOfRequestLogID:i,url:V.url,status:V.status,headers:V.headers,durationMs:Q-P})),this.retryRequest(d,t,i??T,V.headers)}const se=X?"error; no more retries left":"error; not retryable";En(this).info(`${j} - ${se}`);const le=await V.text().catch(x=>Oy(x).message),ue=FB(le),N=ue?void 0:le;throw En(this).debug(`[${T}] response error (${se})`,Ro({retryOfRequestLogID:i,url:V.url,status:V.status,headers:V.headers,message:N,durationMs:Date.now()-P})),this.makeStatusError(V.status,ue,N,V.headers)}return En(this).info(j),En(this).debug(`[${T}] response start`,Ro({retryOfRequestLogID:i,url:V.url,status:V.status,headers:V.headers,durationMs:Q-P})),{response:V,options:d,controller:F,requestLogID:T,retryOfRequestLogID:i,startTime:P}}async fetchWithTimeout(e,t,i,s){const a=t||{},{signal:l,method:d}=a,f=qh(a,["signal","method"]);l&&l.addEventListener("abort",()=>s.abort());const p=setTimeout(()=>s.abort(),i),_=globalThis.ReadableStream&&f.body instanceof globalThis.ReadableStream||typeof f.body=="object"&&f.body!==null&&Symbol.asyncIterator in f.body,E=Object.assign(Object.assign(Object.assign({signal:s.signal},_?{duplex:"half"}:{}),{method:"GET"}),f);d&&(E.method=d.toUpperCase());try{return await this.fetch.call(void 0,e,E)}finally{clearTimeout(p)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,i,s){var a;let l;const d=s==null?void 0:s.get("retry-after-ms");if(d){const p=parseFloat(d);Number.isNaN(p)||(l=p)}const f=s==null?void 0:s.get("retry-after");if(f&&!l){const p=parseFloat(f);Number.isNaN(p)?l=Date.parse(f)-Date.now():l=p*1e3}if(!(l&&0<=l&&l<60*1e3)){const p=(a=e.maxRetries)!==null&&a!==void 0?a:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,p)}return await BB(l),this.makeRequest(e,t-1,i)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,l=Math.min(.5*Math.pow(2,a),8),d=1-Math.random()*.25;return l*d*1e3}async buildRequest(e,{retryCount:t=0}={}){var i,s,a;const l=Object.assign({},e),{method:d,path:f,query:p,defaultBaseURL:_}=l,E=this.buildURL(f,p,_);"timeout"in l&&OB("timeout",l.timeout),l.timeout=(i=l.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:T,body:C}=this.buildBody({options:l}),P=await this.buildHeaders({options:e,method:d,bodyHeaders:T,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:d,headers:P},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&C instanceof globalThis.ReadableStream&&{duplex:"half"}),C&&{body:C}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(a=l.fetchOptions)!==null&&a!==void 0?a:{}),url:E,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:i,retryCount:s}){let a={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let d=tc([a,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),HB()),this._options.defaultHeaders,i,e.headers,l]);return this.validateHeaders(d),d.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=tc([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:JB(e)}:this.encoder({body:e,headers:i})}}Tp.DEFAULT_TIMEOUT=6e4;class en extends Tp{constructor(){super(...arguments),this.interactions=new Bx(this)}}Gx=en;en.GeminiNextGenAPIClient=Gx;en.GeminiNextGenAPIClientError=li;en.APIError=An;en.APIConnectionError=vp;en.APIConnectionTimeoutError=Ix;en.APIUserAbortError=Fy;en.NotFoundError=bx;en.ConflictError=xx;en.RateLimitError=Dx;en.BadRequestError=Cx;en.AuthenticationError=wx;en.InternalServerError=Mx;en.PermissionDeniedError=Rx;en.UnprocessableEntityError=Nx;en.toFile=jB;en.Interactions=Bx;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function f9(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function h9(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function p9(n,e){const t={},i=h(n,["sdkHttpResponse"]);return i!=null&&m(t,["sdkHttpResponse"],i),t}function m9(n,e){const t={},i=h(n,["sdkHttpResponse"]);return i!=null&&m(t,["sdkHttpResponse"],i),t}function g9(n,e,t){const i={};if(h(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=h(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&m(e,["displayName"],s),h(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=h(n,["epochCount"]);e!==void 0&&a!=null&&m(e,["tuningTask","hyperparameters","epochCount"],a);const l=h(n,["learningRateMultiplier"]);if(l!=null&&m(i,["tuningTask","hyperparameters","learningRateMultiplier"],l),h(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(h(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(h(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const d=h(n,["batchSize"]);e!==void 0&&d!=null&&m(e,["tuningTask","hyperparameters","batchSize"],d);const f=h(n,["learningRate"]);if(e!==void 0&&f!=null&&m(e,["tuningTask","hyperparameters","learningRate"],f),h(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(h(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function y9(n,e,t){const i={};let s=h(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const C=h(n,["validationDataset"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec"],AC(C))}else if(s==="PREFERENCE_TUNING"){const C=h(n,["validationDataset"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec"],AC(C))}const a=h(n,["tunedModelDisplayName"]);e!==void 0&&a!=null&&m(e,["tunedModelDisplayName"],a);const l=h(n,["description"]);e!==void 0&&l!=null&&m(e,["description"],l);let d=h(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const C=h(n,["epochCount"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","epochCount"],C)}else if(d==="PREFERENCE_TUNING"){const C=h(n,["epochCount"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],C)}let f=h(t,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const C=h(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],C)}else if(f==="PREFERENCE_TUNING"){const C=h(n,["learningRateMultiplier"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],C)}let p=h(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const C=h(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","exportLastCheckpointOnly"],C)}else if(p==="PREFERENCE_TUNING"){const C=h(n,["exportLastCheckpointOnly"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],C)}let _=h(t,["config","method"]);if(_===void 0&&(_="SUPERVISED_FINE_TUNING"),_==="SUPERVISED_FINE_TUNING"){const C=h(n,["adapterSize"]);e!==void 0&&C!=null&&m(e,["supervisedTuningSpec","hyperParameters","adapterSize"],C)}else if(_==="PREFERENCE_TUNING"){const C=h(n,["adapterSize"]);e!==void 0&&C!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],C)}if(h(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(h(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const E=h(n,["labels"]);e!==void 0&&E!=null&&m(e,["labels"],E);const T=h(n,["beta"]);return e!==void 0&&T!=null&&m(e,["preferenceOptimizationSpec","hyperParameters","beta"],T),i}function _9(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const s=h(n,["preTunedModel"]);s!=null&&m(t,["preTunedModel"],s);const a=h(n,["trainingDataset"]);a!=null&&x9(a);const l=h(n,["config"]);return l!=null&&g9(l,t),t}function v9(n,e){const t={},i=h(n,["baseModel"]);i!=null&&m(t,["baseModel"],i);const s=h(n,["preTunedModel"]);s!=null&&m(t,["preTunedModel"],s);const a=h(n,["trainingDataset"]);a!=null&&N9(a,t,e);const l=h(n,["config"]);return l!=null&&y9(l,t,e),t}function E9(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function T9(n,e){const t={},i=h(n,["name"]);return i!=null&&m(t,["_url","name"],i),t}function A9(n,e,t){const i={},s=h(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&m(e,["_query","filter"],l),i}function S9(n,e,t){const i={},s=h(n,["pageSize"]);e!==void 0&&s!=null&&m(e,["_query","pageSize"],s);const a=h(n,["pageToken"]);e!==void 0&&a!=null&&m(e,["_query","pageToken"],a);const l=h(n,["filter"]);return e!==void 0&&l!=null&&m(e,["_query","filter"],l),i}function I9(n,e){const t={},i=h(n,["config"]);return i!=null&&A9(i,t),t}function C9(n,e){const t={},i=h(n,["config"]);return i!=null&&S9(i,t),t}function w9(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["nextPageToken"]);s!=null&&m(t,["nextPageToken"],s);const a=h(n,["tunedModels"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(d=>zx(d))),m(t,["tuningJobs"],l)}return t}function R9(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["nextPageToken"]);s!=null&&m(t,["nextPageToken"],s);const a=h(n,["tuningJobs"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(d=>Gy(d))),m(t,["tuningJobs"],l)}return t}function b9(n,e){const t={},i=h(n,["name"]);i!=null&&m(t,["model"],i);const s=h(n,["name"]);return s!=null&&m(t,["endpoint"],s),t}function x9(n,e){const t={};if(h(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(h(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=h(n,["examples"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>a)),m(t,["examples","examples"],s)}return t}function N9(n,e,t){const i={};let s=h(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=h(n,["gcsUri"]);e!==void 0&&l!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let a=h(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&m(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(a==="PREFERENCE_TUNING"){const l=h(n,["vertexDatasetResource"]);e!==void 0&&l!=null&&m(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(h(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function zx(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["name"]);s!=null&&m(t,["name"],s);const a=h(n,["state"]);a!=null&&m(t,["state"],sx(a));const l=h(n,["createTime"]);l!=null&&m(t,["createTime"],l);const d=h(n,["tuningTask","startTime"]);d!=null&&m(t,["startTime"],d);const f=h(n,["tuningTask","completeTime"]);f!=null&&m(t,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(t,["updateTime"],p);const _=h(n,["description"]);_!=null&&m(t,["description"],_);const E=h(n,["baseModel"]);E!=null&&m(t,["baseModel"],E);const T=h(n,["_self"]);return T!=null&&m(t,["tunedModel"],b9(T)),t}function Gy(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["name"]);s!=null&&m(t,["name"],s);const a=h(n,["state"]);a!=null&&m(t,["state"],sx(a));const l=h(n,["createTime"]);l!=null&&m(t,["createTime"],l);const d=h(n,["startTime"]);d!=null&&m(t,["startTime"],d);const f=h(n,["endTime"]);f!=null&&m(t,["endTime"],f);const p=h(n,["updateTime"]);p!=null&&m(t,["updateTime"],p);const _=h(n,["error"]);_!=null&&m(t,["error"],_);const E=h(n,["description"]);E!=null&&m(t,["description"],E);const T=h(n,["baseModel"]);T!=null&&m(t,["baseModel"],T);const C=h(n,["tunedModel"]);C!=null&&m(t,["tunedModel"],C);const P=h(n,["preTunedModel"]);P!=null&&m(t,["preTunedModel"],P);const F=h(n,["supervisedTuningSpec"]);F!=null&&m(t,["supervisedTuningSpec"],F);const V=h(n,["preferenceOptimizationSpec"]);V!=null&&m(t,["preferenceOptimizationSpec"],V);const Q=h(n,["tuningDataStats"]);Q!=null&&m(t,["tuningDataStats"],Q);const j=h(n,["encryptionSpec"]);j!=null&&m(t,["encryptionSpec"],j);const X=h(n,["partnerModelTuningSpec"]);X!=null&&m(t,["partnerModelTuningSpec"],X);const se=h(n,["customBaseModel"]);se!=null&&m(t,["customBaseModel"],se);const le=h(n,["experiment"]);le!=null&&m(t,["experiment"],le);const ue=h(n,["labels"]);ue!=null&&m(t,["labels"],ue);const N=h(n,["outputUri"]);N!=null&&m(t,["outputUri"],N);const D=h(n,["pipelineJob"]);D!=null&&m(t,["pipelineJob"],D);const x=h(n,["serviceAccount"]);x!=null&&m(t,["serviceAccount"],x);const L=h(n,["tunedModelDisplayName"]);L!=null&&m(t,["tunedModelDisplayName"],L);const k=h(n,["veoTuningSpec"]);return k!=null&&m(t,["veoTuningSpec"],k),t}function D9(n,e){const t={},i=h(n,["sdkHttpResponse"]);i!=null&&m(t,["sdkHttpResponse"],i);const s=h(n,["name"]);s!=null&&m(t,["name"],s);const a=h(n,["metadata"]);a!=null&&m(t,["metadata"],a);const l=h(n,["done"]);l!=null&&m(t,["done"],l);const d=h(n,["error"]);return d!=null&&m(t,["error"],d),t}function AC(n,e){const t={},i=h(n,["gcsUri"]);i!=null&&m(t,["validationDatasetUri"],i);const s=h(n,["vertexDatasetResource"]);return s!=null&&m(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class M9 extends Ur{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Wo(Mr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const a=Object.assign(Object.assign({},t),{preTunedModel:s});return a.baseModel=void 0,await this.tuneInternal(a)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),a=await this.tuneMldevInternal(s);let l="";return a.metadata!==void 0&&a.metadata.tunedModel!==void 0?l=a.metadata.tunedModel:a.name!==void 0&&a.name.includes("/operations/")&&(l=a.name.split("/operations/")[0]),{name:l,state:Ny.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=T9(e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>Gy(_))}else{const p=E9(e);return d=me("{name}",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>zx(_))}}async listInternal(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=C9(e);return d=me("tuningJobs",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=R9(_),T=new $I;return Object.assign(T,E),T})}else{const p=I9(e);return d=me("tunedModels",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=w9(_),T=new $I;return Object.assign(T,E),T})}}async cancel(e){var t,i,s,a;let l,d="",f={};if(this.apiClient.isVertexAI()){const p=h9(e);return d=me("{name}:cancel",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=m9(_),T=new QI;return Object.assign(T,E),T})}else{const p=f9(e);return d=me("{name}:cancel",p._url),f=p._query,delete p._url,delete p._query,l=this.apiClient.request({path:d,queryParams:f,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(_=>_.json().then(E=>{const T=E;return T.sdkHttpResponse={headers:_.headers},T})),l.then(_=>{const E=p9(_),T=new QI;return Object.assign(T,E),T})}}async tuneInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI()){const d=v9(e,e);return a=me("tuningJobs",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>Gy(f))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let s,a="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=_9(e);return a=me("tunedModels",d._url),l=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(f=>f.json().then(p=>{const _=p;return _.sdkHttpResponse={headers:f.headers},_})),s.then(f=>D9(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class P9{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const k9=1024*1024*8,V9=3,L9=1e3,U9=2,zh="x-goog-upload-status";async function O9(n,e,t){var i;const s=await Hx(n,e,t),a=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[zh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return a.file}async function F9(n,e,t){var i;const s=await Hx(n,e,t),a=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[zh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=jb(a),d=new tv;return Object.assign(d,l),d}async function Hx(n,e,t){var i,s;let a=0,l=0,d=new Dy(new Response),f="upload";for(a=n.size;l<a;){const p=Math.min(k9,a-l),_=n.slice(l,l+p);l+p>=a&&(f+=", finalize");let E=0,T=L9;for(;E<V9&&(d=await t.request({path:"",body:_,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":f,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((i=d==null?void 0:d.headers)===null||i===void 0)&&i[zh]));)E++,await q9(T),T=T*U9;if(l+=p,((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[zh])!=="active")break;if(a<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return d}async function B9(n){return{size:n.size,type:n.type}}function q9(n){return new Promise(e=>setTimeout(e,n))}class G9{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await O9(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await F9(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await B9(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class z9{create(e,t,i){return new H9(e,t,i)}}class H9{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const SC="x-goog-api-key";class K9{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(SC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(SC,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const J9="gl-node/";class Y9{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new en({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=qU(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new K9(this.apiKey);this.apiClient=new B5({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:J9+"web",uploader:new G9,downloader:new P9}),this.models=new sB(this.apiClient),this.live=new j5(this.apiClient,s,new z9),this.batches=new g6(this.apiClient),this.chats=new W6(this.models,this.apiClient),this.caches=new $6(this.apiClient),this.files=new a3(this.apiClient),this.operations=new oB(this.apiClient),this.authTokens=new AB(this.apiClient),this.tunings=new M9(this.apiClient),this.fileSearchStores=new NB(this.apiClient)}}const td="spanish_assistant_vocab",uv="spanish_assistant_last_analysis",Kx="spanish_assistant_history",Jx="spanish_assistant_theme",cv="spanish_assistant_session_key",dv=n=>{const e={};return Object.keys(n).forEach(t=>{n[t]!==void 0&&(e[t]=n[t])}),e},Yx=n=>{sessionStorage.setItem(cv,n)},fv=()=>sessionStorage.getItem(cv),$9=()=>{sessionStorage.removeItem(cv)},hv=()=>{const n=oi.currentUser;return n?lU(ed,"users",n.uid,"vocabulary"):null},Os=async()=>{if(oi.currentUser)try{const e=hv();if(!e)return[];const t=EU(e,TU("addedAt","desc"));return(await CU(t)).docs.map(s=>s.data())}catch(e){return console.error("Failed to load vocab from Firestore",e),[]}try{const e=localStorage.getItem(td);return e?JSON.parse(e):[]}catch(e){return console.error("Failed to load vocab from LocalStorage",e),[]}},Q9=async n=>{const e=oi.currentUser,t=Date.now();let i=0;const s=await Os(),a=new Set(s.map(d=>d.word.toLowerCase()));if(e)try{const d=Wb(ed),f=hv();if(!f)return 0;for(const p of n){const _=p.word.toLowerCase();if(!a.has(_)){const E=crypto.randomUUID(),T={...p,id:E,addedAt:t,mastered:!1},C=fp(f,E);d.set(C,dv(T)),i++,a.add(_)}}return i>0&&await d.commit(),i}catch(d){return console.error("Batch add failed in Firestore",d),0}const l=[...s];return n.forEach(d=>{const f=d.word.toLowerCase();a.has(f)||(l.unshift({...d,id:crypto.randomUUID(),addedAt:t,mastered:!1}),i++,a.add(f))}),i>0&&localStorage.setItem(td,JSON.stringify(l)),i},X9=async n=>{const e=oi.currentUser;let t=0;if(e)try{const l=Wb(ed),d=hv();if(!d)return 0;const f=await Os(),p=new Set(f.map(_=>_.word.toLowerCase()));for(const _ of n)if(!p.has(_.word.toLowerCase())){const E=_.id||crypto.randomUUID(),T=fp(d,E),C={..._,id:E};l.set(T,dv(C)),t++,p.add(_.word.toLowerCase())}return await l.commit(),t}catch(l){return console.error("Import failed in Firestore",l),0}const i=await Os(),s=[...i],a=new Set(i.map(l=>l.word.toLowerCase()));return n.forEach(l=>{a.has(l.word.toLowerCase())||(s.unshift({...l,id:l.id||crypto.randomUUID()}),t++,a.add(l.word.toLowerCase()))}),t>0&&localStorage.setItem(td,JSON.stringify(s)),t},W9=async n=>{const e=oi.currentUser;if(e)try{const s=fp(ed,"users",e.uid,"vocabulary",n);await RU(s);return}catch(s){console.error("Failed to delete from Firestore",s)}const i=(await Os()).filter(s=>s.id!==n);localStorage.setItem(td,JSON.stringify(i))},Z9=async n=>{const e=oi.currentUser,t=await Os(),i=t.find(l=>l.id===n);if(!i)return;const s={...i,mastered:!i.mastered};if(e)try{const l=fp(ed,"users",e.uid,"vocabulary",n);await wU(l,dv(s),{merge:!0});return}catch(l){console.error("Failed to update Firestore",l)}const a=t.map(l=>l.id===n?s:l);localStorage.setItem(td,JSON.stringify(a))},j9=async n=>(await Os()).some(t=>t.word.toLowerCase()===n.toLowerCase()),eq=(n,e)=>{const t={data:n,image:e,timestamp:Date.now()};localStorage.setItem(uv,JSON.stringify(t));const i=tq(),s=[t,...i].slice(0,10);localStorage.setItem(Kx,JSON.stringify(s))},$x=()=>{const n=localStorage.getItem(uv);return n?JSON.parse(n):null},IC=()=>{localStorage.removeItem(uv)},tq=()=>{const n=localStorage.getItem(Kx);return n?JSON.parse(n):[]},nq=()=>localStorage.getItem(Jx)||"light",iq=n=>{localStorage.setItem(Jx,n)};function rq(n){const e=atob(n),t=e.length,i=new Uint8Array(t);for(let s=0;s<t;s++)i[s]=e.charCodeAt(s);return i}async function sq(n,e,t,i){const s=new Int16Array(n.buffer),a=s.length/i,l=e.createBuffer(i,a,t);for(let d=0;d<i;d++){const f=l.getChannelData(d);for(let p=0;p<a;p++)f[p]=s[p*i+d]/32768}return l}const oq={type:xt.OBJECT,properties:{sentences:{type:xt.ARRAY,items:{type:xt.OBJECT,properties:{original:{type:xt.STRING,description:"The EXACT verbatim sentence from the image. No omissions."},translation:{type:xt.STRING,description:"Natural German translation of the full sentence."},words:{type:xt.ARRAY,items:{type:xt.OBJECT,properties:{word:{type:xt.STRING,description:"The word, phrase, punctuation, or space."},type:{type:xt.STRING,enum:["word","punctuation"],description:"Use 'word' for lexical units/phrases, 'punctuation' for symbols/spaces."},translation:{type:xt.STRING,description:"German translation (required if type='word')."},explanation:{type:xt.STRING,description:"German Grammar/context explanation (required if type='word')."},category:{type:xt.STRING,enum:["noun","verb","adjective","function"],description:"Grammatical category."},baseForm:{type:xt.STRING,description:"Lemma/Infinitiv."}},required:["word","type"]}}},required:["original","translation","words"]}}},required:["sentences"]},Qx=()=>{const t=fv()||void 0;if(!t)throw new Error("Kein API Key gefunden. Bitte geben Sie einen in den Einstellungen ein.");return new Y9({apiKey:t})},aq=async n=>{const e=Qx(),t=`
    Analyze the attached Spanish book page. You are an expert Spanish teacher.
    
    CRITICAL INSTRUCTIONS:
    1. COMPLETE TRANSCRIPTION: You MUST process EVERY SINGLE SENTENCE visible on the page. Do not skip any sentences.
    2. PHRASE BINDING: Combine words that belong together (reflexive verbs like "se levant", idioms like "tener que") into a SINGLE 'word' object.
    3. FULL CHARACTER COVERAGE: Reconstruct the 'original' string perfectly including spaces.
    4. Provide the result in German.
  `;try{const s=(await e.models.generateContent({model:"gemini-3-flash-preview",contents:{parts:[{inlineData:{mimeType:"image/jpeg",data:n}},{text:t}]},config:{responseMimeType:"application/json",responseSchema:oq,systemInstruction:"You are a professional Spanish-to-German translator. Extract all text and provide linguistic analysis for learners."}})).text;if(!s)throw new Error("No response text from Gemini.");return JSON.parse(s)}catch(i){throw console.error("Analysis failed:",i),i}},Xx=async n=>{var t,i,s,a,l,d;const e=Qx();try{const p=(d=(l=(a=(s=(i=(t=(await e.models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:n}]}],config:{responseModalities:[Uc.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:"Puck"}}}}})).candidates)==null?void 0:t[0])==null?void 0:i.content)==null?void 0:s.parts)==null?void 0:a[0])==null?void 0:l.inlineData)==null?void 0:d.data;if(!p)throw new Error("No audio data returned");const _=new(window.AudioContext||window.webkitAudioContext)({sampleRate:24e3}),E=_.createGain();E.connect(_.destination);const T=await sq(rq(p),_,24e3,1),C=_.createBufferSource();C.buffer=T,C.connect(E),C.start()}catch(f){throw console.error("TTS failed:",f),f}},lq=({onChangeView:n})=>{const[e,t]=Ce.useState(null),[i,s]=Ce.useState(!1),[a,l]=Ce.useState(null),[d,f]=Ce.useState(0),[p,_]=Ce.useState("sentence"),[E,T]=Ce.useState(0),[C,P]=Ce.useState(null),[F,V]=Ce.useState(!1),[Q,j]=Ce.useState(0),[X,se]=Ce.useState(new Set),le=Ce.useRef(null);Ce.useEffect(()=>{const z=$x();z&&!a&&(l(z.data),t(z.image))},[]);const ue=Ce.useCallback(async()=>{if(!a)return;const z=new Set;for(const oe of a.sentences)for(const fe of oe.words)fe.type==="word"&&await j9(fe.word)&&z.add(fe.word.toLowerCase());se(z)},[a]);Ce.useEffect(()=>{ue()},[a,ue]);const N=async z=>{s(!0),l(null),V(!1),f(0),_("sentence"),T(0),j(0);try{const oe=await aq(z);l(oe),eq(oe,z)}catch(oe){console.error(oe),t(null)}finally{s(!1)}},D=z=>{var fe;const oe=(fe=z.target.files)==null?void 0:fe[0];if(oe){const Me=new FileReader;Me.onloadend=()=>{const q=Me.result.split(",")[1];t(q),N(q)},Me.readAsDataURL(oe)}},x=async(z,oe)=>{if(!C){P(oe);try{await Xx(z)}catch(fe){console.error(fe)}finally{P(null)}}},L=a==null?void 0:a.sentences[d],k=(L==null?void 0:L.words.filter(z=>z.type==="word"))||[],O=Ce.useCallback(async()=>{if(!(!a||!L)){if(p==="sentence")k.length>0?(_("words"),T(0)):_("translation");else if(p==="words")E<k.length-1?T(z=>z+1):_("translation");else if(p==="translation"){const z=k.map(fe=>({word:fe.word,translation:fe.translation||"",explanation:fe.explanation||"",category:fe.category,baseForm:fe.baseForm,contextSentence:L.original})),oe=await Q9(z);j(fe=>fe+oe),se(fe=>{const Me=new Set(fe);return z.forEach(Qe=>Me.add(Qe.word.toLowerCase())),Me}),d<a.sentences.length-1?(f(fe=>fe+1),_("sentence"),T(0)):(V(!0),IC())}}},[a,p,E,d,k,L]),M=()=>{p==="translation"?k.length>0?(_("words"),T(k.length-1)):_("sentence"):p==="words"?E>0?T(z=>z-1):_("sentence"):p==="sentence"&&d>0&&(f(z=>z-1),_("translation"))},Ee=()=>{t(null),l(null),V(!1),IC()};if(Ce.useEffect(()=>{const z=oe=>{oe.code==="Space"&&a&&!F&&(oe.preventDefault(),O())};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[a,F,O]),i)return R.jsxs("div",{className:"fixed inset-0 bg-[#FDFBF7] dark:bg-[#12100E] flex flex-col items-center justify-center text-center p-6 z-50",children:[R.jsx(Po,{className:"w-12 h-12 animate-spin text-[#6B705C] dark:text-[#D4A373] mb-4"}),R.jsx("h2",{className:"text-xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7]",children:"Verarbeite Seite..."}),R.jsx("p",{className:"text-sm text-[#6B705C] dark:text-[#A5A58D] font-serif italic mt-2",children:"Die KI analysiert Grammatik und Vokabeln."})]});if(!a&&!e)return R.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] gap-6 animate-fade-in text-center px-6",children:[R.jsx(Kg,{className:"w-16 h-16 text-[#6B705C] dark:text-[#A5A58D] opacity-20"}),R.jsxs("div",{children:[R.jsx("h2",{className:"text-2xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2",children:"Bereit zum Lesen?"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Scanne eine Seite deines spanischen Buches."})]}),R.jsx("input",{type:"file",accept:"image/*",capture:"environment",ref:le,className:"hidden",onChange:D}),R.jsx("button",{onClick:()=>{var z;return(z=le.current)==null?void 0:z.click()},className:"bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E] py-4 px-10 rounded-2xl shadow-xl font-bold uppercase text-[10px] tracking-widest active:scale-95 transition-transform",children:"Kamera starten"})]});if(F)return R.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] text-center px-6 animate-fade-in",children:[R.jsx("div",{className:"w-16 h-16 bg-[#E9EDC9] dark:bg-[#2C2420] rounded-2xl flex items-center justify-center text-[#6B705C] dark:text-[#D4A373] mb-6",children:R.jsx(dh,{className:"w-8 h-8"})}),R.jsx("h2",{className:"text-2xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2",children:"Seite beendet!"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] font-serif italic mb-8",children:Q>0?`Du hast ${Q} neue Fundstcke in deine Sammlung aufgenommen.`:"Alle Wrter dieser Seite sind bereits in deiner Sammlung."}),R.jsxs("div",{className:"flex gap-4",children:[R.jsx("button",{onClick:Ee,className:"bg-[#6B705C] dark:bg-[#2C2420] text-white px-8 py-4 rounded-2xl font-bold uppercase text-[10px] tracking-widest border dark:border-[#2C2420] shadow-md",children:"Nchste Seite"}),R.jsx("button",{onClick:()=>n==null?void 0:n(St.VOCAB),className:"bg-[#B26B4A] dark:bg-[#D4A373] text-white dark:text-[#12100E] px-8 py-4 rounded-2xl font-bold uppercase text-[10px] tracking-widest shadow-md",children:"Zum Lernbereich"})]})]});const Ue=k[E];return R.jsxs("div",{className:"fixed inset-0 bg-[#FDFBF7] dark:bg-[#12100E] flex flex-col overflow-hidden animate-fade-in transition-colors",children:[R.jsxs("div",{className:"px-6 pt-4 pb-2 flex justify-between items-center bg-[#FDFBF7] dark:bg-[#12100E] z-10 transition-colors",children:[R.jsxs("div",{className:"flex flex-col gap-1 w-full max-w-[150px]",children:[R.jsxs("span",{className:"text-[9px] font-bold text-[#6B705C] dark:text-[#A5A58D] uppercase tracking-widest",children:["Satz ",d+1," / ",a==null?void 0:a.sentences.length]}),R.jsx("div",{className:"h-1 bg-[#EAE2D6] dark:bg-[#2C2420] rounded-full overflow-hidden",children:R.jsx("div",{className:"h-full bg-[#B26B4A] dark:bg-[#D4A373] transition-all duration-500",style:{width:`${(d+1)/((a==null?void 0:a.sentences.length)||1)*100}%`}})})]}),R.jsx("button",{onClick:Ee,className:"p-2 text-[#A5A58D] dark:text-[#2C2420] hover:text-[#B26B4A] dark:hover:text-[#D4A373]",children:R.jsx(aD,{className:"w-5 h-5"})})]}),R.jsxs("div",{className:"flex-grow flex flex-col px-6 py-4 overflow-hidden relative",children:[p==="sentence"&&R.jsx("div",{className:"flex-grow flex items-center justify-center animate-fade-in",children:R.jsx("p",{className:"text-2xl sm:text-3xl font-serif text-[#2C2420] dark:text-[#FDFBF7] leading-relaxed text-center italic",children:L==null?void 0:L.original})}),p==="words"&&L&&R.jsxs("div",{className:"flex-grow flex flex-col gap-6 animate-fade-in h-full",children:[R.jsx("div",{className:"bg-white dark:bg-[#1C1917] p-4 rounded-2xl border border-[#EAE2D6] dark:border-[#2C2420] shadow-sm shrink-0",children:R.jsx("p",{className:"text-lg font-serif text-[#2C2420] dark:text-[#FDFBF7] leading-relaxed",children:L.words.map((z,oe)=>{const fe=Ue&&z.word===Ue.word;return R.jsx("span",{className:`transition-colors duration-300 ${fe?"bg-[#FEFAE0] dark:bg-[#2C2420] text-[#B26B4A] dark:text-[#D4A373] font-bold px-1 rounded":"opacity-40"}`,children:z.word},oe)})})}),R.jsx("div",{className:"flex-grow flex items-center justify-center overflow-hidden",children:Ue&&R.jsxs("div",{className:"w-full bg-[#2C2420] dark:bg-[#1C1917] text-[#FDFBF7] p-6 rounded-[2rem] shadow-xl border border-transparent dark:border-[#2C2420] flex flex-col animate-fade-in overflow-hidden max-h-full",children:[R.jsxs("div",{className:"overflow-y-auto",children:[R.jsx("span",{className:"text-[8px] font-bold uppercase tracking-[0.2em] text-[#B26B4A] dark:text-[#D4A373] mb-2 block",children:Ue.category||"Vokabel"}),R.jsx("h3",{className:"text-3xl font-serif font-bold text-[#FEFAE0] dark:text-[#D4A373] mb-2",children:Ue.word}),R.jsx("p",{className:"text-xl font-serif italic text-[#FDFBF7]/90 mb-4",children:Ue.translation}),Ue.explanation&&R.jsx("div",{className:"bg-white/5 dark:bg-black/20 p-4 rounded-xl border border-white/10 dark:border-white/5 mb-4",children:R.jsx("p",{className:"text-sm font-serif italic text-[#FDFBF7]/70 leading-relaxed",children:Ue.explanation})})]}),R.jsxs("div",{className:"mt-auto pt-4 flex justify-between items-center border-t border-white/10",children:[R.jsx("button",{onClick:()=>x(Ue.word,`w-${d}-${E}`),className:"w-10 h-10 bg-[#B26B4A] dark:bg-[#D4A373] rounded-xl flex items-center justify-center",children:C===`w-${d}-${E}`?R.jsx(Po,{className:"w-4 h-4 animate-spin text-white"}):R.jsx(hh,{className:"w-4 h-4 fill-white text-white dark:text-[#12100E] dark:fill-[#12100E]"})}),X.has(Ue.word.toLowerCase())&&R.jsxs("div",{className:"flex items-center gap-1.5 bg-[#E9EDC9]/20 px-3 py-1.5 rounded-full",children:[R.jsx(dh,{className:"w-3 h-3 text-[#E9EDC9]"}),R.jsx("span",{className:"text-[8px] font-bold uppercase tracking-widest text-[#E9EDC9]",children:"In Sammlung"})]})]})]})})]}),p==="translation"&&L&&R.jsxs("div",{className:"flex-grow flex flex-col justify-center gap-8 animate-fade-in",children:[R.jsxs("div",{className:"text-center",children:[R.jsx("span",{className:"text-[8px] font-bold text-[#6B705C] dark:text-[#A5A58D] uppercase tracking-widest mb-2 block",children:"Original"}),R.jsx("p",{className:"text-2xl font-serif text-[#2C2420] dark:text-[#FDFBF7] leading-relaxed italic",children:L.original})]}),R.jsx("div",{className:"w-12 h-[1px] bg-[#EAE2D6] dark:bg-[#2C2420] mx-auto opacity-50"}),R.jsxs("div",{className:"text-center",children:[R.jsx("span",{className:"text-[8px] font-bold text-[#B26B4A] dark:text-[#D4A373] uppercase tracking-widest mb-2 block",children:"bersetzung"}),R.jsx("p",{className:"text-xl font-serif text-[#6B705C] dark:text-[#A5A58D] leading-relaxed",children:L.translation})]}),R.jsx("button",{onClick:()=>x(L.original,`s-${d}`),className:"mx-auto w-12 h-12 bg-[#FDFBF7] dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] rounded-full flex items-center justify-center text-[#6B705C] dark:text-[#A5A58D] hover:bg-[#FEFAE0] dark:hover:bg-[#2C2420] transition-colors",children:C===`s-${d}`?R.jsx(Po,{className:"w-4 h-4 animate-spin"}):R.jsx(hh,{className:"w-4 h-4 fill-current"})})]})]}),R.jsx("div",{className:"px-6 py-6 bg-[#FDFBF7] dark:bg-[#12100E] border-t border-[#EAE2D6] dark:border-[#2C2420] shrink-0 pb-[max(1.5rem,env(safe-area-inset-bottom))] transition-colors",children:R.jsxs("div",{className:"flex gap-3 max-w-lg mx-auto",children:[R.jsx("button",{onClick:M,disabled:p==="sentence"&&d===0,className:"w-14 h-14 flex items-center justify-center bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl text-[#6B705C] dark:text-[#A5A58D] disabled:opacity-20 active:scale-95 transition-all shadow-sm",children:R.jsx(jN,{className:"w-6 h-6"})}),R.jsxs("button",{onClick:O,className:`flex-grow h-14 rounded-2xl flex items-center justify-center gap-3 font-bold text-[10px] uppercase tracking-[0.2em] shadow-lg active:scale-95 transition-all ${p==="translation"?"bg-[#B26B4A] dark:bg-[#D4A373] text-white dark:text-[#12100E]":"bg-[#2C2420] dark:bg-white text-white dark:text-[#12100E]"}`,children:[p==="sentence"?"Wrter analysieren":p==="words"&&E<k.length-1?"Nchstes Wort":p==="words"?"bersetzung":"Nchster Satz",R.jsx(WN,{className:"w-4 h-4"})]})]})})]})},uq=()=>{const[n,e]=Ce.useState([]),[t,i]=Ce.useState(!0),[s,a]=Ce.useState("list"),[l,d]=Ce.useState("all"),[f,p]=Ce.useState([]),[_,E]=Ce.useState(0),[T,C]=Ce.useState(!1),[P,F]=Ce.useState(!1),V=Ce.useRef(null);Ce.useEffect(()=>{Q()},[]);const Q=async()=>{i(!0);const O=await Os();e(O.sort((M,Ee)=>Ee.addedAt-M.addedAt)),i(!1)},j=()=>l==="all"?n:n.filter(O=>(O.category||"function")===l),X=async O=>{window.confirm("Dieses Wort aus deiner Sammlung lschen?")&&(await W9(O),Q())},se=()=>{const O=JSON.stringify(n,null,2),M="data:application/json;charset=utf-8,"+encodeURIComponent(O),Ee=`spanish-vocab-${new Date().toISOString().split("T")[0]}.json`,Ue=document.createElement("a");Ue.setAttribute("href",M),Ue.setAttribute("download",Ee),Ue.click()},le=()=>{var O;(O=V.current)==null||O.click()},ue=async O=>{var Ue;const M=(Ue=O.target.files)==null?void 0:Ue[0];if(!M)return;F(!0);const Ee=new FileReader;Ee.onload=async z=>{var oe;try{const fe=JSON.parse((oe=z.target)==null?void 0:oe.result);if(Array.isArray(fe)){const Me=await X9(fe);alert(`${Me} neue Vokabeln importiert!`),await Q()}else alert("Ungltiges JSON-Format. Erwartet wird ein Array von Vokabeln.")}catch(fe){console.error("Import failed:",fe),alert("Import fehlgeschlagen. Bitte berprfen Sie die Datei.")}finally{F(!1),V.current&&(V.current.value="")}},Ee.readAsText(M)},N=()=>{const O=j().filter(Ee=>!Ee.mastered);if(O.length===0){alert("Keine offenen Vokabeln in dieser Kategorie!");return}const M=[...O].sort(()=>Math.random()-.5);p(M),E(0),C(!1),a("train")},D=async O=>{const M=f[_];O==="good"?await Z9(M.id):p(Ee=>[...Ee,M]),C(!1),_<f.length-1?E(Ee=>Ee+1):(alert("Sitzung abgeschlossen! Gut gemacht."),a("list"),Q())},x=async()=>{if(s==="train"&&f[_])try{await Xx(f[_].word)}catch(O){console.error(O)}},L=()=>R.jsx("div",{className:"flex overflow-x-auto gap-3 pb-3 mb-6 scrollbar-hide px-1",children:["all","noun","verb","adjective","function"].map(O=>R.jsx("button",{onClick:()=>d(O),className:`px-5 py-2.5 rounded-2xl whitespace-nowrap text-xs font-bold uppercase tracking-widest transition-all duration-300 ${l===O?"bg-[#B26B4A] dark:bg-[#D4A373] text-[#FDFBF7] dark:text-[#12100E] shadow-lg":"bg-white dark:bg-[#1C1917] text-[#6B705C] dark:text-[#A5A58D] border border-[#EAE2D6] dark:border-[#2C2420]"}`,children:O==="all"?"Alle":O==="noun"?"Nomen":O==="verb"?"Verben":O==="adjective"?"Adjektive":"Andere"},O))});if(t)return R.jsx("div",{className:"flex flex-col items-center justify-center h-[50vh] animate-fade-in",children:R.jsx(Po,{className:"w-10 h-10 animate-spin text-[#B26B4A] dark:text-[#D4A373]"})});if(n.length===0&&!P)return R.jsxs("div",{className:"flex flex-col items-center justify-center h-[50vh] text-center p-8 animate-fade-in",children:[R.jsx("div",{className:"w-20 h-20 bg-white dark:bg-[#1C1917] rounded-full flex items-center justify-center mb-6 text-[#A5A58D] border border-[#EAE2D6] dark:border-[#2C2420]",children:R.jsx(dD,{className:"w-10 h-10"})}),R.jsx("h3",{className:"text-2xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7]",children:"Deine Sammlung ist leer"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] mt-3 font-serif italic mb-6",children:"Scanne ein Buch, um neue Vokabeln automatisch hierher zu speichern."}),R.jsx("input",{type:"file",accept:".json",ref:V,className:"hidden",onChange:ue}),R.jsxs("button",{onClick:le,className:"bg-white dark:bg-[#1C1917] text-[#6B705C] dark:text-[#A5A58D] border border-[#EAE2D6] dark:border-[#2C2420] px-6 py-3 rounded-2xl flex items-center gap-2 font-bold uppercase text-[10px] tracking-widest shadow-sm hover:bg-[#FDFBF7] transition-all",children:[R.jsx(J0,{className:"w-4 h-4"}),"JSON Importieren"]})]});if(s==="list"){const O=j(),M=O.filter(Ee=>!Ee.mastered).length;return R.jsxs("div",{className:"space-y-6 pb-24 animate-fade-in",children:[R.jsxs("div",{className:"bg-[#2C2420] dark:bg-[#1C1917] rounded-[2.5rem] p-8 text-[#FDFBF7] shadow-2xl mb-8 relative overflow-hidden border border-transparent dark:border-[#2C2420]",children:[R.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#B26B4A]/10 dark:bg-[#D4A373]/5 rounded-full -mr-16 -mt-16"}),R.jsxs("div",{className:"relative z-10",children:[R.jsxs("div",{className:"flex justify-between items-start mb-4",children:[R.jsxs("div",{children:[R.jsx("h2",{className:"text-4xl font-serif font-bold",children:M}),R.jsx("p",{className:"text-[#FDFBF7]/60 text-sm font-serif italic tracking-wide",children:"offene Fundstcke"})]}),R.jsxs("div",{className:"flex gap-2",children:[R.jsx("input",{type:"file",accept:".json",ref:V,className:"hidden",onChange:ue}),R.jsx("button",{onClick:le,disabled:P,className:"p-3 bg-white/10 hover:bg-white/20 rounded-2xl text-[#FDFBF7] transition-all border border-white/10",title:"Vokabeln importieren",children:P?R.jsx(Po,{className:"w-5 h-5 animate-spin"}):R.jsx(J0,{className:"w-5 h-5"})}),R.jsx("button",{onClick:se,className:"p-3 bg-white/10 hover:bg-white/20 rounded-2xl text-[#FDFBF7] transition-all border border-white/10",title:"Vokabeln exportieren",children:R.jsx(uD,{className:"w-5 h-5"})}),R.jsx(gD,{className:"w-8 h-8 text-[#B26B4A] dark:text-[#D4A373] ml-2"})]})]}),R.jsx("button",{onClick:N,disabled:M===0,className:"w-full bg-[#B26B4A] dark:bg-[#D4A373] text-white dark:text-[#12100E] font-bold py-4 rounded-2xl shadow-xl hover:bg-[#9E5A3B] transition-all disabled:opacity-30 mt-4 uppercase text-xs tracking-[0.2em]",children:"Sitzung starten"})]})]}),L(),R.jsx("div",{className:"grid gap-4",children:O.length===0?R.jsx("p",{className:"text-center text-[#A5A58D] py-12 font-serif italic",children:"In dieser Kategorie hast du noch keine Wrter gesammelt."}):O.map(Ee=>R.jsxs("div",{className:"bg-white dark:bg-[#1C1917] p-5 rounded-3xl border border-[#EAE2D6] dark:border-[#2C2420] shadow-sm flex justify-between items-center group transition-all hover:border-[#B26B4A]/30 dark:hover:border-[#D4A373]/30",children:[R.jsxs("div",{className:"flex-grow",children:[R.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[R.jsx("p",{className:"font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] text-xl",children:Ee.word}),Ee.mastered&&R.jsx(dh,{className:"w-4 h-4 text-[#6B705C] dark:text-[#D4A373]"}),Ee.category&&R.jsx("span",{className:"text-[7px] font-bold uppercase tracking-widest text-[#B26B4A] dark:text-[#D4A373] bg-[#B26B4A]/10 px-1.5 py-0.5 rounded",children:Ee.category})]}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] text-sm italic font-serif",children:Ee.translation})]}),R.jsx("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:R.jsx("button",{onClick:()=>X(Ee.id),className:"p-3 text-[#A5A58D] hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/10 rounded-2xl transition-all",children:R.jsx(PC,{className:"w-5 h-5"})})})]},Ee.id))})]})}const k=f[_];return R.jsxs("div",{className:"h-full flex flex-col items-center max-w-md mx-auto animate-fade-in",children:[R.jsxs("div",{className:"w-full flex justify-between items-center mb-8",children:[R.jsx("button",{onClick:()=>a("list"),className:"text-[#6B705C] dark:text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7] text-xs font-bold uppercase tracking-widest bg-white dark:bg-[#1C1917] px-4 py-2 rounded-xl border border-[#EAE2D6] dark:border-[#2C2420]",children:"Abbrechen"}),R.jsxs("span",{className:"text-[#A5A58D] text-xs font-bold tracking-[0.3em]",children:[_+1," / ",f.length]})]}),R.jsx("div",{className:"w-full aspect-[4/5] perspective-1000 cursor-pointer mb-10",onClick:()=>!T&&C(!0),children:R.jsxs("div",{className:"relative w-full h-full bg-white dark:bg-[#1C1917] rounded-[3rem] shadow-2xl border border-[#EAE2D6] dark:border-[#2C2420] overflow-hidden flex flex-col transition-all duration-500",children:[R.jsxs("div",{className:`flex-1 flex flex-col items-center justify-center p-10 text-center ${T?"border-b border-[#FDFBF7] dark:border-[#12100E]":""}`,children:[R.jsx("span",{className:"text-[10px] font-bold text-[#B26B4A] dark:text-[#D4A373] uppercase tracking-[0.3em] mb-6",children:k.category||"Wort"}),R.jsx("h2",{className:"text-5xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-8",children:k.word}),!T&&R.jsxs("div",{className:"flex flex-col items-center gap-4",children:[R.jsx("p",{className:"text-[#A5A58D] text-sm font-serif italic animate-pulse",children:"Karte aufdecken"}),R.jsx("button",{onClick:O=>{O.stopPropagation(),x()},className:"p-4 bg-[#FEFAE0] dark:bg-[#2C2420] text-[#B26B4A] dark:text-[#D4A373] rounded-2xl hover:bg-[#FAEDCD] dark:hover:bg-black/20",children:R.jsx(hh,{className:"w-6 h-6 fill-current"})})]})]}),T&&R.jsxs("div",{className:"flex-1 bg-[#FDFBF7] dark:bg-[#12100E] flex flex-col items-center justify-center p-10 text-center animate-in fade-in slide-in-from-bottom-6 duration-500 overflow-y-auto",children:[R.jsx("h2",{className:"text-3xl font-serif font-bold text-[#B26B4A] dark:text-[#D4A373] mb-3",children:k.translation}),k.baseForm&&k.baseForm.toLowerCase()!==k.word.toLowerCase()&&R.jsxs("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] mb-4 font-bold uppercase tracking-widest opacity-60",children:["Grundform: ",k.baseForm]}),R.jsxs("p",{className:"text-[#6B705C] dark:text-[#A5A58D] italic font-serif text-lg leading-relaxed mb-6",children:['"',k.explanation,'"']}),k.contextSentence&&R.jsxs("div",{className:"mb-6 p-4 bg-white/50 dark:bg-white/5 rounded-2xl border border-[#EAE2D6] dark:border-white/10 relative",children:[R.jsx(ND,{className:"w-3 h-3 text-[#B26B4A] dark:text-[#D4A373] absolute top-2 left-2 opacity-30"}),R.jsx("p",{className:"text-[11px] font-serif italic text-[#6B705C] dark:text-[#A5A58D] px-2",children:k.contextSentence})]}),R.jsx("button",{onClick:O=>{O.stopPropagation(),x()},className:"p-3 bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#6B705C] dark:text-[#A5A58D] rounded-xl hover:bg-[#E9EDC9] dark:hover:bg-[#2C2420]",children:R.jsx(hh,{className:"w-5 h-5 fill-current"})})]})]})}),T?R.jsxs("div",{className:"grid grid-cols-2 gap-6 w-full px-4",children:[R.jsxs("button",{onClick:()=>D("again"),className:"flex flex-col items-center justify-center p-5 bg-white dark:bg-[#1C1917] border border-[#EAE2D6] dark:border-[#2C2420] text-[#B26B4A] dark:text-[#D4A373] rounded-3xl hover:bg-[#FEFAE0] dark:hover:bg-[#2C2420] active:scale-95 transition-all shadow-sm",children:[R.jsx(MD,{className:"w-6 h-6 mb-2"}),R.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Nochmal"})]}),R.jsxs("button",{onClick:()=>D("good"),className:"flex flex-col items-center justify-center p-5 bg-[#6B705C] dark:bg-[#D4A373] text-white dark:text-[#12100E] rounded-3xl hover:bg-[#585E4A] dark:hover:bg-[#B26B4A] active:scale-95 transition-all shadow-xl",children:[R.jsx(dh,{className:"w-6 h-6 mb-2"}),R.jsx("span",{className:"font-bold text-xs uppercase tracking-widest",children:"Gelernt"})]})]}):R.jsx("div",{className:"w-full px-4",children:R.jsx("button",{onClick:()=>C(!0),className:"w-full bg-[#2C2420] dark:bg-[#D4A373] text-[#FDFBF7] dark:text-[#12100E] font-bold py-5 rounded-3xl shadow-2xl hover:bg-[#3D332D] dark:hover:bg-[#B26B4A] active:scale-95 transition-all uppercase text-xs tracking-[0.3em]",children:"Antwort zeigen"})})]})},cq=()=>{const[n,e]=Ce.useState(""),[t,i]=Ce.useState(!1),[s,a]=Ce.useState(!1);Ce.useEffect(()=>{const f=fv();f&&(i(!0),e(f))},[]);const l=()=>{n.trim()&&(Yx(n.trim()),i(!0),a(!0),setTimeout(()=>a(!1),3e3))},d=()=>{$9(),e(""),i(!1)};return R.jsxs("div",{className:"max-w-2xl mx-auto py-8 animate-fade-in",children:[R.jsxs("div",{className:"mb-10",children:[R.jsx("h2",{className:"text-3xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2",children:"Einstellungen"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Verwalte deinen Zugang zur KI und deine lokalen Daten."})]}),R.jsxs("div",{className:"space-y-6",children:[R.jsxs("section",{className:"bg-white dark:bg-[#1C1917] rounded-[2.5rem] border border-[#EAE2D6] dark:border-[#2C2420] p-8 shadow-sm",children:[R.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[R.jsx("div",{className:"w-12 h-12 bg-[#FEFAE0] dark:bg-[#2C2420] rounded-xl flex items-center justify-center text-[#B26B4A] dark:text-[#D4A373] shadow-sm",children:R.jsx(fh,{className:"w-6 h-6"})}),R.jsxs("div",{children:[R.jsx("h3",{className:"font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] text-xl",children:"API Konfiguration"}),R.jsx("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Dein persnlicher Schlssel fr Google Gemini."})]})]}),R.jsxs("div",{className:"space-y-4",children:[R.jsxs("div",{className:"relative",children:[R.jsx("input",{type:"password",value:n,onChange:f=>e(f.target.value),placeholder:"Geben Sie Ihren API Key ein...",className:"w-full bg-[#FDFBF7] dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-4 pr-12 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm font-mono"}),R.jsx(fh,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D] opacity-40"})]}),R.jsxs("div",{className:"flex flex-wrap gap-3",children:[R.jsxs("button",{onClick:l,disabled:!n.trim(),className:"flex-1 bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E] py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] shadow-lg active:scale-95 transition-all flex items-center justify-center gap-2 disabled:opacity-30",children:[s?R.jsx(K0,{className:"w-4 h-4"}):R.jsx(kD,{className:"w-4 h-4"}),s?"Gespeichert":"Key Speichern"]}),t&&R.jsxs("button",{onClick:d,className:"bg-red-50 dark:bg-red-900/10 text-red-600 dark:text-red-400 border border-red-100 dark:border-red-900/30 px-6 py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] active:scale-95 transition-all flex items-center justify-center gap-2",children:[R.jsx(PC,{className:"w-4 h-4"}),"Lschen"]})]}),R.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-2xl border transition-colors ${t?"bg-[#E9EDC9]/30 border-[#CCD5AE]/30":"bg-[#FEFAE0]/50 border-[#FAEDCD]"}`,children:[t?R.jsx(K0,{className:"w-5 h-5 text-[#6B705C] shrink-0 mt-0.5"}):R.jsx(tD,{className:"w-5 h-5 text-[#B26B4A] shrink-0 mt-0.5"}),R.jsxs("div",{children:[R.jsxs("p",{className:"text-xs font-bold uppercase tracking-widest text-[#2C2420] dark:text-[#FDFBF7] mb-1",children:["Status: ",t?"Persnlicher Key aktiv":"Kein Key konfiguriert"]}),R.jsx("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:t?"Dieser Key wird ausschlielich in deiner aktuellen Browser-Session verwendet und nicht permanent gespeichert.":"Bitte hinterlege einen Key, um die bersetzungs- und Audio-Funktionen nutzen zu knnen."})]})]})]})]}),R.jsxs("section",{className:"bg-[#FEFAE0]/30 dark:bg-[#1C1917]/50 rounded-[2.5rem] border border-[#FAEDCD] dark:border-[#2C2420] p-8",children:[R.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[R.jsx("div",{className:"w-10 h-10 bg-white dark:bg-[#2C2420] rounded-xl flex items-center justify-center text-[#6B705C] dark:text-[#A5A58D] shadow-sm",children:R.jsx(DC,{className:"w-5 h-5"})}),R.jsx("h3",{className:"font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7]",children:"Sicherheit & Lokalitt"})]}),R.jsxs("p",{className:"text-sm text-[#6B705C] dark:text-[#A5A58D] font-serif italic leading-relaxed",children:["Dein Lernfortschritt wird bei Gsten ausschlielich in deinem Browser (Local Storage) gespeichert. API Keys werden aus Sicherheitsgrnden nur im ",R.jsx("strong",{children:"Session Storage"})," gehalten  sie verschwinden, sobald du den Tab schliet."]})]})]})]})},dq=({onGuestLogin:n})=>{const[e,t]=Ce.useState(!0),[i,s]=Ce.useState(""),[a,l]=Ce.useState(""),[d,f]=Ce.useState(""),[p,_]=Ce.useState(!1),[E,T]=Ce.useState(null),C=async P=>{P.preventDefault(),_(!0),T(null);try{if(e)await RP(oi,i,a);else{const F=await wP(oi,i,a);await xP(F.user,{displayName:d})}}catch(F){console.error("Auth error:",F),T(F.message||"Authentifizierung fehlgeschlagen.")}finally{_(!1)}};return R.jsx("div",{className:"min-h-screen flex items-center justify-center p-6 bg-[#FDFBF7] dark:bg-[#12100E]",children:R.jsxs("div",{className:"w-full max-w-md animate-fade-in",children:[R.jsxs("div",{className:"text-center mb-8",children:[R.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-[#2C2420] dark:bg-[#D4A373] rounded-2xl text-[#FDFBF7] dark:text-[#12100E] shadow-xl mb-6",children:R.jsx(RC,{className:"w-8 h-8"})}),R.jsx("h1",{className:"text-3xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2 tracking-tight",children:"Spanish Reading Assistant"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Melde dich an, um deine Lesereise zu beginnen."})]}),R.jsxs("div",{className:"bg-white dark:bg-[#1C1917] p-8 rounded-[2.5rem] border border-[#EAE2D6] dark:border-[#2C2420] shadow-2xl",children:[R.jsxs("div",{className:"flex bg-[#FDFBF7] dark:bg-[#12100E] p-1 rounded-2xl border border-[#EAE2D6] dark:border-[#2C2420] mb-8",children:[R.jsx("button",{onClick:()=>t(!0),className:`flex-1 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest transition-all ${e?"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm":"text-[#6B705C] dark:text-[#A5A58D]"}`,children:"Anmelden"}),R.jsx("button",{onClick:()=>t(!1),className:`flex-1 py-2.5 rounded-xl text-[10px] font-bold uppercase tracking-widest transition-all ${e?"text-[#6B705C] dark:text-[#A5A58D]":"bg-white dark:bg-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] shadow-sm"}`,children:"Registrieren"})]}),R.jsxs("form",{onSubmit:C,className:"space-y-5",children:[!e&&R.jsxs("div",{className:"space-y-2",children:[R.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-[#6B705C] dark:text-[#A5A58D] ml-1",children:"Name"}),R.jsxs("div",{className:"relative",children:[R.jsx(kC,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D]"}),R.jsx("input",{type:"text",required:!0,value:d,onChange:P=>f(P.target.value),className:"w-full bg-[#FDFBF7] dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm",placeholder:"Dein Name"})]})]}),R.jsxs("div",{className:"space-y-2",children:[R.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-[#6B705C] dark:text-[#A5A58D] ml-1",children:"Email"}),R.jsxs("div",{className:"relative",children:[R.jsx(CD,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D]"}),R.jsx("input",{type:"email",required:!0,value:i,onChange:P=>s(P.target.value),className:"w-full bg-[#FDFBF7] dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm",placeholder:"name@beispiel.de"})]})]}),R.jsxs("div",{className:"space-y-2",children:[R.jsx("label",{className:"text-[10px] font-bold uppercase tracking-widest text-[#6B705C] dark:text-[#A5A58D] ml-1",children:"Passwort"}),R.jsxs("div",{className:"relative",children:[R.jsx(vD,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D]"}),R.jsx("input",{type:"password",required:!0,value:a,onChange:P=>l(P.target.value),className:"w-full bg-[#FDFBF7] dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm",placeholder:""})]})]}),E&&R.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-100 dark:border-red-900/30 rounded-2xl text-red-600 dark:text-red-400 text-xs font-serif italic",children:E}),R.jsx("button",{type:"submit",disabled:p,className:"w-full bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E] py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50",children:p?R.jsx(Po,{className:"w-4 h-4 animate-spin"}):e?R.jsxs(R.Fragment,{children:[R.jsx(TD,{className:"w-4 h-4"}),"Anmelden"]}):R.jsxs(R.Fragment,{children:[R.jsx(zD,{className:"w-4 h-4"}),"Konto erstellen"]})})]}),R.jsxs("div",{className:"relative my-8",children:[R.jsx("div",{className:"absolute inset-0 flex items-center",children:R.jsx("div",{className:"w-full border-t border-[#EAE2D6] dark:border-[#2C2420]"})}),R.jsx("div",{className:"relative flex justify-center text-[8px] font-bold uppercase tracking-[0.3em]",children:R.jsx("span",{className:"bg-white dark:bg-[#1C1917] px-4 text-[#A5A58D]",children:"Oder"})})]}),R.jsxs("button",{onClick:n,disabled:p,className:"w-full bg-white dark:bg-transparent border border-[#EAE2D6] dark:border-[#2C2420] text-[#2C2420] dark:text-[#FDFBF7] py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] shadow-sm active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-50 hover:bg-[#FDFBF7] dark:hover:bg-[#2C2420]/30",children:[R.jsx(sD,{className:"w-4 h-4"}),"Als Gast fortfahren"]}),R.jsxs("div",{className:"mt-8 pt-8 border-t border-[#EAE2D6] dark:border-[#2C2420] flex items-center justify-center gap-2 text-[#6B705C] dark:text-[#A5A58D]",children:[R.jsx(MC,{className:"w-4 h-4 opacity-50"}),R.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest opacity-50",children:"App by Spanish Learners"})]})]})]})})},fq=({onClose:n})=>{const[e,t]=Ce.useState(""),i=()=>{e.trim()&&(Yx(e.trim()),n())};return R.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-6 bg-[#12100E]/80 backdrop-blur-sm animate-fade-in",children:R.jsxs("div",{className:"w-full max-w-md bg-[#FDFBF7] dark:bg-[#1C1917] rounded-[2.5rem] shadow-2xl border border-[#EAE2D6] dark:border-[#2C2420] p-8 relative",children:[R.jsx("button",{onClick:n,className:"absolute top-6 right-6 p-2 text-[#A5A58D] hover:text-[#2C2420] dark:hover:text-[#FDFBF7] transition-colors",children:R.jsx(JD,{className:"w-5 h-5"})}),R.jsxs("div",{className:"mb-6",children:[R.jsx("div",{className:"w-14 h-14 bg-[#FEFAE0] dark:bg-[#2C2420] rounded-2xl flex items-center justify-center text-[#B26B4A] dark:text-[#D4A373] mb-4",children:R.jsx(fh,{className:"w-7 h-7"})}),R.jsx("h2",{className:"text-2xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-2",children:"API Key bentigt"}),R.jsx("p",{className:"text-[#6B705C] dark:text-[#A5A58D] text-sm font-serif italic",children:"Um die KI-Funktionen nutzen zu knnen, geben Sie bitte Ihren Gemini API Key ein. Dieser wird nur fr diese Sitzung gespeichert."})]}),R.jsxs("div",{className:"space-y-4",children:[R.jsxs("div",{className:"relative",children:[R.jsx(fh,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-[#A5A58D]"}),R.jsx("input",{type:"password",value:e,onChange:s=>t(s.target.value),placeholder:"Geben Sie Ihren Key ein...",className:"w-full bg-white dark:bg-[#12100E] border border-[#EAE2D6] dark:border-[#2C2420] rounded-2xl py-4 pl-12 pr-4 outline-none focus:ring-2 focus:ring-[#B26B4A]/20 transition-all text-sm font-mono"})]}),R.jsxs("div",{className:"flex items-center gap-2 p-3 bg-[#E9EDC9]/30 dark:bg-[#2C2420]/30 rounded-xl border border-[#CCD5AE]/30 dark:border-[#2C2420]/50",children:[R.jsx(DC,{className:"w-4 h-4 text-[#6B705C] dark:text-[#A5A58D]"}),R.jsx("p",{className:"text-[10px] text-[#6B705C] dark:text-[#A5A58D] font-serif",children:"Sicher: Der Key wird beim Schlieen des Tabs gelscht."})]}),R.jsxs("button",{onClick:i,disabled:!e.trim(),className:"w-full bg-[#2C2420] dark:bg-[#D4A373] text-white dark:text-[#12100E] py-4 rounded-2xl font-bold uppercase text-[10px] tracking-[0.2em] shadow-xl active:scale-95 transition-all flex items-center justify-center gap-3 disabled:opacity-30",children:["Sitzung starten",R.jsx(Jf,{className:"w-4 h-4"})]}),R.jsx("button",{onClick:n,className:"w-full text-[#A5A58D] text-[10px] font-bold uppercase tracking-widest mt-2 hover:text-[#6B705C] transition-colors",children:"Spter eingeben"})]})]})})};function hq(){const[n,e]=Ce.useState(St.HOME),[t,i]=Ce.useState(null),[s,a]=Ce.useState(0),[l,d]=Ce.useState(nq()),[f,p]=Ce.useState(null),[_,E]=Ce.useState(localStorage.getItem("spanish_assistant_is_guest")==="true"),[T,C]=Ce.useState(!0),[P,F]=Ce.useState(!1);Ce.useEffect(()=>{const le=MP(oi,ue=>{p(ue),ue&&(E(!1),localStorage.removeItem("spanish_assistant_is_guest"),V()),C(!1)});return()=>le()},[]),Ce.useEffect(()=>{i($x()),Os().then(le=>a(le.length))},[n,f,_]),Ce.useEffect(()=>{l==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"),iq(l)},[l]);const V=()=>{fv()||F(!0)},Q=()=>d(le=>le==="light"?"dark":"light"),j=()=>{E(!0),localStorage.setItem("spanish_assistant_is_guest","true"),V()},X=()=>{E(!1),localStorage.removeItem("spanish_assistant_is_guest")};if(T)return R.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#FDFBF7] dark:bg-[#12100E]",children:[R.jsx(Po,{className:"w-12 h-12 animate-spin text-[#B26B4A] dark:text-[#D4A373] mb-4"}),R.jsx("p",{className:"font-serif italic text-[#6B705C] dark:text-[#A5A58D]",children:"Wird geladen..."})]});if(!f&&!_)return R.jsx(dq,{onGuestLogin:j});const se=()=>{switch(n){case St.ANALYZE:return R.jsx(lq,{onChangeView:e});case St.VOCAB:return R.jsx(uq,{});case St.SETTINGS:return R.jsx(cq,{});case St.HOME:default:return R.jsxs("div",{className:"flex flex-col gap-6 py-4 animate-fade-in",children:[R.jsxs("div",{className:"bg-[#2C2420] dark:bg-[#1C1917] rounded-[2.5rem] p-8 text-[#FDFBF7] shadow-xl relative overflow-hidden border border-transparent dark:border-[#2C2420]",children:[R.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-[#B26B4A]/20 dark:bg-[#D4A373]/10 rounded-full -mr-12 -mt-12 blur-2xl"}),R.jsxs("div",{className:"relative z-10",children:[R.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[R.jsx(MC,{className:"text-[#FEFAE0] dark:text-[#D4A373] w-5 h-5"}),R.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-[#FEFAE0]/80 dark:text-[#D4A373]/80",children:_?"Bienvenido, Invitado":`Bienvenido, ${(f==null?void 0:f.displayName)||"Amigo"}`})]}),R.jsx("h2",{className:"text-4xl font-serif font-bold mb-4 tracking-tight",children:"Hola amigo."}),R.jsx("p",{className:"text-[#FDFBF7]/70 text-md font-serif italic leading-relaxed mb-6 max-w-sm",children:_?"Deine Vokabeln werden lokal im Browser gespeichert. Exportiere sie regelmig!":"Dein Fortschritt wird sicher in der Cloud synchronisiert."}),R.jsxs("div",{className:"flex flex-wrap gap-3",children:[R.jsxs("button",{onClick:()=>e(St.ANALYZE),className:"bg-[#B26B4A] dark:bg-[#D4A373] text-white dark:text-[#12100E] font-bold py-3.5 px-6 rounded-xl shadow-lg hover:bg-[#9E5A3B] transition-all inline-flex items-center gap-3 uppercase text-[10px] tracking-widest",children:[R.jsx(xC,{className:"w-4 h-4"}),"Seite scannen"]}),t&&R.jsxs("button",{onClick:()=>e(St.ANALYZE),className:"bg-white/10 text-white border border-white/20 font-bold py-3.5 px-6 rounded-xl shadow-lg hover:bg-white/20 transition-all inline-flex items-center gap-3 uppercase text-[10px] tracking-widest",children:[R.jsx(hD,{className:"w-4 h-4"}),"Letzte Seite fortsetzen"]})]})]})]}),R.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[R.jsxs("div",{onClick:()=>e(St.ANALYZE),className:"bg-white dark:bg-[#1C1917] p-6 rounded-[2rem] shadow-sm border border-[#EAE2D6] dark:border-[#2C2420] cursor-pointer hover:border-[#B26B4A]/30 dark:hover:border-[#D4A373]/30 hover:shadow-md transition-all group",children:[R.jsx("div",{className:"w-12 h-12 bg-[#FEFAE0] dark:bg-[#2C2420] rounded-xl flex items-center justify-center text-[#B26B4A] dark:text-[#D4A373] mb-4 group-hover:scale-105 transition-transform",children:R.jsx(RC,{className:"w-6 h-6"})}),R.jsxs("div",{className:"flex justify-between items-start",children:[R.jsxs("div",{children:[R.jsx("h3",{className:"text-xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-1",children:"Lesereise"}),R.jsx("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:"Analysiere Texte und lerne Schtze kennen."})]}),R.jsx(Jf,{className:"w-4 h-4 text-[#EAE2D6] dark:text-[#2C2420] group-hover:text-[#B26B4A] dark:group-hover:text-[#D4A373] transition-colors"})]})]}),R.jsxs("div",{onClick:()=>e(St.VOCAB),className:"bg-white dark:bg-[#1C1917] p-6 rounded-[2rem] shadow-sm border border-[#EAE2D6] dark:border-[#2C2420] cursor-pointer hover:border-[#B26B4A]/30 dark:hover:border-[#D4A373]/30 hover:shadow-md transition-all group",children:[R.jsx("div",{className:"w-12 h-12 bg-[#E9EDC9] dark:bg-[#2C2420] rounded-xl flex items-center justify-center text-[#6B705C] dark:text-[#A5A58D] mb-4 group-hover:scale-105 transition-transform",children:R.jsx(bC,{className:"w-6 h-6"})}),R.jsxs("div",{className:"flex justify-between items-start",children:[R.jsxs("div",{children:[R.jsx("h3",{className:"text-xl font-serif font-bold text-[#2C2420] dark:text-[#FDFBF7] mb-1",children:"Wortschatz"}),R.jsxs("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] font-serif italic",children:[s," Fundstcke in deiner Sammlung."]})]}),R.jsx(Jf,{className:"w-4 h-4 text-[#EAE2D6] dark:text-[#2C2420] group-hover:text-[#6B705C] dark:group-hover:text-[#D4A373] transition-colors"})]})]})]}),R.jsxs("div",{onClick:()=>e(St.SETTINGS),className:"bg-white dark:bg-[#1C1917] p-6 rounded-[2rem] border border-[#EAE2D6] dark:border-[#2C2420] cursor-pointer flex items-center justify-between hover:bg-[#FDFBF7] dark:hover:bg-[#12100E] transition-colors",children:[R.jsxs("div",{className:"flex items-center gap-4",children:[R.jsx("div",{className:"bg-[#2C2420]/5 dark:bg-white/5 p-3 rounded-xl",children:R.jsx(NC,{className:"w-5 h-5 text-[#6B705C] dark:text-[#A5A58D]"})}),R.jsxs("div",{children:[R.jsx("p",{className:"text-sm font-bold text-[#2C2420] dark:text-[#FDFBF7]",children:"Einstellungen"}),R.jsx("p",{className:"text-xs text-[#6B705C] dark:text-[#A5A58D] italic",children:"Verwalte deinen Zugang und lerne mehr."})]})]}),R.jsx(Jf,{className:"w-4 h-4 text-[#EAE2D6] dark:text-[#2C2420]"})]})]})}};return R.jsxs(LU,{currentView:n,onChangeView:e,theme:l,onToggleTheme:Q,isGuest:_,onLogoutGuest:X,children:[se(),P&&R.jsx(fq,{onClose:()=>F(!1)})]})}const Wx=document.getElementById("root");if(!Wx)throw new Error("Could not find root element to mount to");const pq=FN.createRoot(Wx);pq.render(R.jsx(DN.StrictMode,{children:R.jsx(hq,{})}));
